(global.webpackChunkiptvnator=global.webpackChunkiptvnator||[]).push([[668],{58755:(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var window=__webpack_require__(60397);module.exports=function(callback,decodeResponseBody){return void 0===decodeResponseBody&&(decodeResponseBody=!1),function(err,response,responseBody){if(err)callback(err);else if(response.statusCode>=400&&response.statusCode<=599){var cause=responseBody;if(decodeResponseBody)if(window.TextDecoder){var charset=(void 0===(contentTypeHeader=response.headers&&response.headers["content-type"])&&(contentTypeHeader=""),contentTypeHeader.toLowerCase().split(";").reduce(function(charset,contentType){var _contentType$split=contentType.split("="),value=_contentType$split[1];return"charset"===_contentType$split[0].trim()?value.trim():charset},"utf-8"));try{cause=new TextDecoder(charset).decode(responseBody)}catch(e){}}else cause=String.fromCharCode.apply(null,new Uint8Array(responseBody));callback({cause:cause})}else callback(null,responseBody);var contentTypeHeader}}},15729:(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var window=__webpack_require__(60397),_extends=__webpack_require__(36549),isFunction=__webpack_require__(50985);function initParams(uri,options,callback){var params=uri;return isFunction(options)?(callback=options,"string"==typeof uri&&(params={uri:uri})):params=_extends({},options,{uri:uri}),params.callback=callback,params}function createXHR(uri,options,callback){return _createXHR(options=initParams(uri,options,callback))}function _createXHR(options){if(void 0===options.callback)throw new Error("callback argument missing");var called=!1,callback=function(err,response,body){called||(called=!0,options.callback(err,response,body))};function getBody(){var body=void 0;if(body=xhr.response?xhr.response:xhr.responseText||function(xhr){try{if("document"===xhr.responseType)return xhr.responseXML;if(""===xhr.responseType&&(!xhr.responseXML||"parsererror"!==xhr.responseXML.documentElement.nodeName))return xhr.responseXML}catch(e){}return null}(xhr),isJson)try{body=JSON.parse(body)}catch(e){}return body}function errorFunc(evt){return clearTimeout(timeoutTimer),evt instanceof Error||(evt=new Error(""+(evt||"Unknown XMLHttpRequest Error"))),evt.statusCode=0,callback(evt,failureResponse)}function loadFunc(){if(!aborted){var status;clearTimeout(timeoutTimer);var response=failureResponse,err=null;return 0!==(status=options.useXDR&&void 0===xhr.status?200:1223===xhr.status?204:xhr.status)?(response={body:getBody(),statusCode:status,method:method,headers:{},url:uri,rawRequest:xhr},xhr.getAllResponseHeaders&&(response.headers=function(headers){var result={};return headers?(headers.trim().split("\n").forEach(function(row){var index=row.indexOf(":"),key=row.slice(0,index).trim().toLowerCase(),value=row.slice(index+1).trim();void 0===result[key]?result[key]=value:Array.isArray(result[key])?result[key].push(value):result[key]=[result[key],value]}),result):result}(xhr.getAllResponseHeaders()))):err=new Error("Internal XMLHttpRequest Error"),callback(err,response,response.body)}}var key,aborted,xhr=options.xhr||null;xhr||(xhr=options.cors||options.useXDR?new createXHR.XDomainRequest:new createXHR.XMLHttpRequest);var timeoutTimer,uri=xhr.url=options.uri||options.url,method=xhr.method=options.method||"GET",body=options.body||options.data,headers=xhr.headers=options.headers||{},sync=!!options.sync,isJson=!1,failureResponse={body:void 0,headers:{},statusCode:0,method:method,url:uri,rawRequest:xhr};if("json"in options&&!1!==options.json&&(isJson=!0,headers.accept||headers.Accept||(headers.Accept="application/json"),"GET"!==method&&"HEAD"!==method&&(headers["content-type"]||headers["Content-Type"]||(headers["Content-Type"]="application/json"),body=JSON.stringify(!0===options.json?body:options.json))),xhr.onreadystatechange=function(){4===xhr.readyState&&setTimeout(loadFunc,0)},xhr.onload=loadFunc,xhr.onerror=errorFunc,xhr.onprogress=function(){},xhr.onabort=function(){aborted=!0},xhr.ontimeout=errorFunc,xhr.open(method,uri,!sync,options.username,options.password),sync||(xhr.withCredentials=!!options.withCredentials),!sync&&options.timeout>0&&(timeoutTimer=setTimeout(function(){if(!aborted){aborted=!0,xhr.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",errorFunc(e)}},options.timeout)),xhr.setRequestHeader)for(key in headers)headers.hasOwnProperty(key)&&xhr.setRequestHeader(key,headers[key]);else if(options.headers&&!function(obj){for(var i in obj)if(obj.hasOwnProperty(i))return!1;return!0}(options.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in options&&(xhr.responseType=options.responseType),"beforeSend"in options&&"function"==typeof options.beforeSend&&options.beforeSend(xhr),xhr.send(body||null),xhr}createXHR.httpHandler=__webpack_require__(58755),module.exports=createXHR,module.exports.default=createXHR,createXHR.XMLHttpRequest=window.XMLHttpRequest||function(){},createXHR.XDomainRequest="withCredentials"in new createXHR.XMLHttpRequest?createXHR.XMLHttpRequest:window.XDomainRequest,function(array,iterator){for(var i=0;i<array.length;i++)iterator(array[i])}(["get","put","post","patch","head","delete"],function(method){createXHR["delete"===method?"del":method]=function(uri,options,callback){return(options=initParams(uri,options,callback)).method=method.toUpperCase(),_createXHR(options)}})},41469:(__unused_webpack_module,exports)=>{"use strict";function freeze(object,oc){return void 0===oc&&(oc=Object),oc&&"function"==typeof oc.freeze?oc.freeze(object):object}var MIME_TYPE=freeze({HTML:"text/html",isHTML:function(value){return value===MIME_TYPE.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),NAMESPACE=freeze({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(uri){return uri===NAMESPACE.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});exports.freeze=freeze,exports.MIME_TYPE=MIME_TYPE,exports.NAMESPACE=NAMESPACE},41343:(__unused_webpack_module,exports,__webpack_require__)=>{var conventions=__webpack_require__(41469),dom=__webpack_require__(3472),entities=__webpack_require__(38667),sax=__webpack_require__(93115),DOMImplementation=dom.DOMImplementation,NAMESPACE=conventions.NAMESPACE,ParseError=sax.ParseError,XMLReader=sax.XMLReader;function DOMParser(options){this.options=options||{locator:{}}}function DOMHandler(){this.cdata=!1}function position(locator,node){node.lineNumber=locator.lineNumber,node.columnNumber=locator.columnNumber}function _locator(l){if(l)return"\n@"+(l.systemId||"")+"#[line:"+l.lineNumber+",col:"+l.columnNumber+"]"}function _toString(chars,start,length){return"string"==typeof chars?chars.substr(start,length):chars.length>=start+length||start?new java.lang.String(chars,start,length)+"":chars}function appendElement(hander,node){hander.currentElement?hander.currentElement.appendChild(node):hander.doc.appendChild(node)}DOMParser.prototype.parseFromString=function(source,mimeType){var options=this.options,sax=new XMLReader,domBuilder=options.domBuilder||new DOMHandler,errorHandler=options.errorHandler,locator=options.locator,defaultNSMap=options.xmlns||{},isHTML=/\/x?html?$/.test(mimeType),entityMap=isHTML?entities.HTML_ENTITIES:entities.XML_ENTITIES;return locator&&domBuilder.setDocumentLocator(locator),sax.errorHandler=function(errorImpl,domBuilder,locator){if(!errorImpl){if(domBuilder instanceof DOMHandler)return domBuilder;errorImpl=domBuilder}var errorHandler={},isCallback=errorImpl instanceof Function;function build(key){var fn=errorImpl[key];!fn&&isCallback&&(fn=2==errorImpl.length?function(msg){errorImpl(key,msg)}:errorImpl),errorHandler[key]=fn&&function(msg){fn("[xmldom "+key+"]\t"+msg+_locator(locator))}||function(){}}return locator=locator||{},build("warning"),build("error"),build("fatalError"),errorHandler}(errorHandler,domBuilder,locator),sax.domBuilder=options.domBuilder||domBuilder,isHTML&&(defaultNSMap[""]=NAMESPACE.HTML),defaultNSMap.xml=defaultNSMap.xml||NAMESPACE.XML,source&&"string"==typeof source?sax.parse(source,defaultNSMap,entityMap):sax.errorHandler.error("invalid doc source"),domBuilder.doc},DOMHandler.prototype={startDocument:function(){this.doc=(new DOMImplementation).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(namespaceURI,localName,qName,attrs){var doc=this.doc,el=doc.createElementNS(namespaceURI,qName||localName),len=attrs.length;appendElement(this,el),this.currentElement=el,this.locator&&position(this.locator,el);for(var i=0;i<len;i++){namespaceURI=attrs.getURI(i);var value=attrs.getValue(i),attr=(qName=attrs.getQName(i),doc.createAttributeNS(namespaceURI,qName));this.locator&&position(attrs.getLocator(i),attr),attr.value=attr.nodeValue=value,el.setAttributeNode(attr)}},endElement:function(namespaceURI,localName,qName){this.currentElement=this.currentElement.parentNode},startPrefixMapping:function(prefix,uri){},endPrefixMapping:function(prefix){},processingInstruction:function(target,data){var ins=this.doc.createProcessingInstruction(target,data);this.locator&&position(this.locator,ins),appendElement(this,ins)},ignorableWhitespace:function(ch,start,length){},characters:function(chars,start,length){if(chars=_toString.apply(this,arguments)){if(this.cdata)var charNode=this.doc.createCDATASection(chars);else charNode=this.doc.createTextNode(chars);this.currentElement?this.currentElement.appendChild(charNode):/^\s*$/.test(chars)&&this.doc.appendChild(charNode),this.locator&&position(this.locator,charNode)}},skippedEntity:function(name){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(locator){(this.locator=locator)&&(locator.lineNumber=0)},comment:function(chars,start,length){chars=_toString.apply(this,arguments);var comm=this.doc.createComment(chars);this.locator&&position(this.locator,comm),appendElement(this,comm)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(name,publicId,systemId){var impl=this.doc.implementation;if(impl&&impl.createDocumentType){var dt=impl.createDocumentType(name,publicId,systemId);this.locator&&position(this.locator,dt),appendElement(this,dt),this.doc.doctype=dt}},warning:function(error){console.warn("[xmldom warning]\t"+error,_locator(this.locator))},error:function(_error){console.error("[xmldom error]\t"+_error,_locator(this.locator))},fatalError:function(error){throw new ParseError(error,this.locator)}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(key){DOMHandler.prototype[key]=function(){return null}}),exports.DOMParser=DOMParser},3472:(__unused_webpack_module,exports,__webpack_require__)=>{var NAMESPACE=__webpack_require__(41469).NAMESPACE;function notEmptyString(input){return""!==input}function orderedSetReducer(current,element){return current.hasOwnProperty(element)||(current[element]=!0),current}function toOrderedSet(input){if(!input)return[];var list=function(input){return input?input.split(/[\t\n\f\r ]+/).filter(notEmptyString):[]}(input);return Object.keys(list.reduce(orderedSetReducer,{}))}function copy(src,dest){for(var p in src)dest[p]=src[p]}function _extends(Class,Super){var pt=Class.prototype;if(!(pt instanceof Super)){var t=function(){};t.prototype=Super.prototype,copy(pt,t=new t),Class.prototype=pt=t}pt.constructor!=Class&&("function"!=typeof Class&&console.error("unknown Class:"+Class),pt.constructor=Class)}var NodeType={},ELEMENT_NODE=NodeType.ELEMENT_NODE=1,ATTRIBUTE_NODE=NodeType.ATTRIBUTE_NODE=2,TEXT_NODE=NodeType.TEXT_NODE=3,CDATA_SECTION_NODE=NodeType.CDATA_SECTION_NODE=4,ENTITY_REFERENCE_NODE=NodeType.ENTITY_REFERENCE_NODE=5,ENTITY_NODE=NodeType.ENTITY_NODE=6,PROCESSING_INSTRUCTION_NODE=NodeType.PROCESSING_INSTRUCTION_NODE=7,COMMENT_NODE=NodeType.COMMENT_NODE=8,DOCUMENT_NODE=NodeType.DOCUMENT_NODE=9,DOCUMENT_TYPE_NODE=NodeType.DOCUMENT_TYPE_NODE=10,DOCUMENT_FRAGMENT_NODE=NodeType.DOCUMENT_FRAGMENT_NODE=11,NOTATION_NODE=NodeType.NOTATION_NODE=12,ExceptionCode={},ExceptionMessage={},HIERARCHY_REQUEST_ERR=(ExceptionCode.INDEX_SIZE_ERR=(ExceptionMessage[1]="Index size error",1),ExceptionCode.DOMSTRING_SIZE_ERR=(ExceptionMessage[2]="DOMString size error",2),ExceptionCode.HIERARCHY_REQUEST_ERR=(ExceptionMessage[3]="Hierarchy request error",3)),NOT_FOUND_ERR=(ExceptionCode.WRONG_DOCUMENT_ERR=(ExceptionMessage[4]="Wrong document",4),ExceptionCode.INVALID_CHARACTER_ERR=(ExceptionMessage[5]="Invalid character",5),ExceptionCode.NO_DATA_ALLOWED_ERR=(ExceptionMessage[6]="No data allowed",6),ExceptionCode.NO_MODIFICATION_ALLOWED_ERR=(ExceptionMessage[7]="No modification allowed",7),ExceptionCode.NOT_FOUND_ERR=(ExceptionMessage[8]="Not found",8)),INUSE_ATTRIBUTE_ERR=(ExceptionCode.NOT_SUPPORTED_ERR=(ExceptionMessage[9]="Not supported",9),ExceptionCode.INUSE_ATTRIBUTE_ERR=(ExceptionMessage[10]="Attribute in use",10));function DOMException(code,message){if(message instanceof Error)var error=message;else error=this,Error.call(this,ExceptionMessage[code]),this.message=ExceptionMessage[code],Error.captureStackTrace&&Error.captureStackTrace(this,DOMException);return error.code=code,message&&(this.message=this.message+": "+message),error}function NodeList(){}function LiveNodeList(node,refresh){this._node=node,this._refresh=refresh,_updateLiveList(this)}function _updateLiveList(list){var inc=list._node._inc||list._node.ownerDocument._inc;if(list._inc!=inc){var ls=list._refresh(list._node);__set__(list,"length",ls.length),copy(ls,list),list._inc=inc}}function NamedNodeMap(){}function _findNodeIndex(list,node){for(var i=list.length;i--;)if(list[i]===node)return i}function _addNamedNode(el,list,newAttr,oldAttr){if(oldAttr?list[_findNodeIndex(list,oldAttr)]=newAttr:list[list.length++]=newAttr,el){newAttr.ownerElement=el;var doc=el.ownerDocument;doc&&(oldAttr&&_onRemoveAttribute(doc,el,oldAttr),function(doc,el,newAttr){doc&&doc._inc++,newAttr.namespaceURI===NAMESPACE.XMLNS&&(el._nsMap[newAttr.prefix?newAttr.localName:""]=newAttr.value)}(doc,el,newAttr))}}function _removeNamedNode(el,list,attr){var i=_findNodeIndex(list,attr);if(!(i>=0))throw DOMException(NOT_FOUND_ERR,new Error(el.tagName+"@"+attr));for(var lastIndex=list.length-1;i<lastIndex;)list[i]=list[++i];if(list.length=lastIndex,el){var doc=el.ownerDocument;doc&&(_onRemoveAttribute(doc,el,attr),attr.ownerElement=null)}}function DOMImplementation(){}function Node(){}function _xmlEncoder(c){return("<"==c?"&lt;":">"==c&&"&gt;")||"&"==c&&"&amp;"||'"'==c&&"&quot;"||"&#"+c.charCodeAt()+";"}function _visitNode(node,callback){if(callback(node))return!0;if(node=node.firstChild)do{if(_visitNode(node,callback))return!0}while(node=node.nextSibling)}function Document(){}function _onRemoveAttribute(doc,el,newAttr,remove){doc&&doc._inc++,newAttr.namespaceURI===NAMESPACE.XMLNS&&delete el._nsMap[newAttr.prefix?newAttr.localName:""]}function _onUpdateChild(doc,el,newChild){if(doc&&doc._inc){doc._inc++;var cs=el.childNodes;if(newChild)cs[cs.length++]=newChild;else{for(var child=el.firstChild,i=0;child;)cs[i++]=child,child=child.nextSibling;cs.length=i}}}function _removeChild(parentNode,child){var previous=child.previousSibling,next=child.nextSibling;return previous?previous.nextSibling=next:parentNode.firstChild=next,next?next.previousSibling=previous:parentNode.lastChild=previous,_onUpdateChild(parentNode.ownerDocument,parentNode),child}function _insertBefore(parentNode,newChild,nextChild){var cp=newChild.parentNode;if(cp&&cp.removeChild(newChild),newChild.nodeType===DOCUMENT_FRAGMENT_NODE){var newFirst=newChild.firstChild;if(null==newFirst)return newChild;var newLast=newChild.lastChild}else newFirst=newLast=newChild;var pre=nextChild?nextChild.previousSibling:parentNode.lastChild;newFirst.previousSibling=pre,newLast.nextSibling=nextChild,pre?pre.nextSibling=newFirst:parentNode.firstChild=newFirst,null==nextChild?parentNode.lastChild=newLast:nextChild.previousSibling=newLast;do{newFirst.parentNode=parentNode}while(newFirst!==newLast&&(newFirst=newFirst.nextSibling));return _onUpdateChild(parentNode.ownerDocument||parentNode,parentNode),newChild.nodeType==DOCUMENT_FRAGMENT_NODE&&(newChild.firstChild=newChild.lastChild=null),newChild}function Element(){this._nsMap={}}function Attr(){}function CharacterData(){}function Text(){}function Comment(){}function CDATASection(){}function DocumentType(){}function Notation(){}function Entity(){}function EntityReference(){}function DocumentFragment(){}function ProcessingInstruction(){}function XMLSerializer(){}function nodeSerializeToString(isHtml,nodeFilter){var buf=[],refNode=9==this.nodeType&&this.documentElement||this,prefix=refNode.prefix,uri=refNode.namespaceURI;if(uri&&null==prefix&&null==(prefix=refNode.lookupPrefix(uri)))var visibleNamespaces=[{namespace:uri,prefix:null}];return serializeToString(this,buf,isHtml,nodeFilter,visibleNamespaces),buf.join("")}function needNamespaceDefine(node,isHTML,visibleNamespaces){var prefix=node.prefix||"",uri=node.namespaceURI;if(!uri)return!1;if("xml"===prefix&&uri===NAMESPACE.XML||uri===NAMESPACE.XMLNS)return!1;for(var i=visibleNamespaces.length;i--;){var ns=visibleNamespaces[i];if(ns.prefix===prefix)return ns.namespace!==uri}return!0}function addSerializedAttribute(buf,qualifiedName,value){buf.push(" ",qualifiedName,'="',value.replace(/[<&"]/g,_xmlEncoder),'"')}function serializeToString(node,buf,isHTML,nodeFilter,visibleNamespaces){if(visibleNamespaces||(visibleNamespaces=[]),nodeFilter){if(!(node=nodeFilter(node)))return;if("string"==typeof node)return void buf.push(node)}switch(node.nodeType){case ELEMENT_NODE:var attrs=node.attributes,len=attrs.length,child=node.firstChild,nodeName=node.tagName,prefixedNodeName=nodeName;if(!(isHTML=NAMESPACE.isHTML(node.namespaceURI)||isHTML)&&!node.prefix&&node.namespaceURI){for(var defaultNS,ai=0;ai<attrs.length;ai++)if("xmlns"===attrs.item(ai).name){defaultNS=attrs.item(ai).value;break}if(!defaultNS)for(var nsi=visibleNamespaces.length-1;nsi>=0;nsi--)if(""===(namespace=visibleNamespaces[nsi]).prefix&&namespace.namespace===node.namespaceURI){defaultNS=namespace.namespace;break}if(defaultNS!==node.namespaceURI)for(nsi=visibleNamespaces.length-1;nsi>=0;nsi--){var namespace;if((namespace=visibleNamespaces[nsi]).namespace===node.namespaceURI){namespace.prefix&&(prefixedNodeName=namespace.prefix+":"+nodeName);break}}}buf.push("<",prefixedNodeName);for(var i=0;i<len;i++)"xmlns"==(attr=attrs.item(i)).prefix?visibleNamespaces.push({prefix:attr.localName,namespace:attr.value}):"xmlns"==attr.nodeName&&visibleNamespaces.push({prefix:"",namespace:attr.value});for(i=0;i<len;i++){var attr,prefix,uri;needNamespaceDefine(attr=attrs.item(i),0,visibleNamespaces)&&(addSerializedAttribute(buf,(prefix=attr.prefix||"")?"xmlns:"+prefix:"xmlns",uri=attr.namespaceURI),visibleNamespaces.push({prefix:prefix,namespace:uri})),serializeToString(attr,buf,isHTML,nodeFilter,visibleNamespaces)}if(nodeName===prefixedNodeName&&needNamespaceDefine(node,0,visibleNamespaces)&&(addSerializedAttribute(buf,(prefix=node.prefix||"")?"xmlns:"+prefix:"xmlns",uri=node.namespaceURI),visibleNamespaces.push({prefix:prefix,namespace:uri})),child||isHTML&&!/^(?:meta|link|img|br|hr|input)$/i.test(nodeName)){if(buf.push(">"),isHTML&&/^script$/i.test(nodeName))for(;child;)child.data?buf.push(child.data):serializeToString(child,buf,isHTML,nodeFilter,visibleNamespaces.slice()),child=child.nextSibling;else for(;child;)serializeToString(child,buf,isHTML,nodeFilter,visibleNamespaces.slice()),child=child.nextSibling;buf.push("</",prefixedNodeName,">")}else buf.push("/>");return;case DOCUMENT_NODE:case DOCUMENT_FRAGMENT_NODE:for(child=node.firstChild;child;)serializeToString(child,buf,isHTML,nodeFilter,visibleNamespaces.slice()),child=child.nextSibling;return;case ATTRIBUTE_NODE:return addSerializedAttribute(buf,node.name,node.value);case TEXT_NODE:return buf.push(node.data.replace(/[<&]/g,_xmlEncoder).replace(/]]>/g,"]]&gt;"));case CDATA_SECTION_NODE:return buf.push("<![CDATA[",node.data,"]]>");case COMMENT_NODE:return buf.push("\x3c!--",node.data,"--\x3e");case DOCUMENT_TYPE_NODE:var pubid=node.publicId,sysid=node.systemId;if(buf.push("<!DOCTYPE ",node.name),pubid)buf.push(" PUBLIC ",pubid),sysid&&"."!=sysid&&buf.push(" ",sysid),buf.push(">");else if(sysid&&"."!=sysid)buf.push(" SYSTEM ",sysid,">");else{var sub=node.internalSubset;sub&&buf.push(" [",sub,"]"),buf.push(">")}return;case PROCESSING_INSTRUCTION_NODE:return buf.push("<?",node.target," ",node.data,"?>");case ENTITY_REFERENCE_NODE:return buf.push("&",node.nodeName,";");default:buf.push("??",node.nodeName)}}function _importNode(doc,node,deep){var node2;switch(node.nodeType){case ELEMENT_NODE:(node2=node.cloneNode(!1)).ownerDocument=doc;case DOCUMENT_FRAGMENT_NODE:break;case ATTRIBUTE_NODE:deep=!0}if(node2||(node2=node.cloneNode(!1)),node2.ownerDocument=doc,node2.parentNode=null,deep)for(var child=node.firstChild;child;)node2.appendChild(_importNode(doc,child,deep)),child=child.nextSibling;return node2}function _cloneNode(doc,node,deep){var node2=new node.constructor;for(var n in node){var v=node[n];"object"!=typeof v&&v!=node2[n]&&(node2[n]=v)}switch(node.childNodes&&(node2.childNodes=new NodeList),node2.ownerDocument=doc,node2.nodeType){case ELEMENT_NODE:var attrs=node.attributes,attrs2=node2.attributes=new NamedNodeMap,len=attrs.length;attrs2._ownerElement=node2;for(var i=0;i<len;i++)node2.setAttributeNode(_cloneNode(doc,attrs.item(i),!0));break;case ATTRIBUTE_NODE:deep=!0}if(deep)for(var child=node.firstChild;child;)node2.appendChild(_cloneNode(doc,child,deep)),child=child.nextSibling;return node2}function __set__(object,key,value){object[key]=value}ExceptionCode.INVALID_STATE_ERR=(ExceptionMessage[11]="Invalid state",11),ExceptionCode.SYNTAX_ERR=(ExceptionMessage[12]="Syntax error",12),ExceptionCode.INVALID_MODIFICATION_ERR=(ExceptionMessage[13]="Invalid modification",13),ExceptionCode.NAMESPACE_ERR=(ExceptionMessage[14]="Invalid namespace",14),ExceptionCode.INVALID_ACCESS_ERR=(ExceptionMessage[15]="Invalid access",15),DOMException.prototype=Error.prototype,copy(ExceptionCode,DOMException),NodeList.prototype={length:0,item:function(index){return this[index]||null},toString:function(isHTML,nodeFilter){for(var buf=[],i=0;i<this.length;i++)serializeToString(this[i],buf,isHTML,nodeFilter);return buf.join("")}},LiveNodeList.prototype.item=function(i){return _updateLiveList(this),this[i]},_extends(LiveNodeList,NodeList),NamedNodeMap.prototype={length:0,item:NodeList.prototype.item,getNamedItem:function(key){for(var i=this.length;i--;){var attr=this[i];if(attr.nodeName==key)return attr}},setNamedItem:function(attr){var el=attr.ownerElement;if(el&&el!=this._ownerElement)throw new DOMException(INUSE_ATTRIBUTE_ERR);var oldAttr=this.getNamedItem(attr.nodeName);return _addNamedNode(this._ownerElement,this,attr,oldAttr),oldAttr},setNamedItemNS:function(attr){var oldAttr,el=attr.ownerElement;if(el&&el!=this._ownerElement)throw new DOMException(INUSE_ATTRIBUTE_ERR);return oldAttr=this.getNamedItemNS(attr.namespaceURI,attr.localName),_addNamedNode(this._ownerElement,this,attr,oldAttr),oldAttr},removeNamedItem:function(key){var attr=this.getNamedItem(key);return _removeNamedNode(this._ownerElement,this,attr),attr},removeNamedItemNS:function(namespaceURI,localName){var attr=this.getNamedItemNS(namespaceURI,localName);return _removeNamedNode(this._ownerElement,this,attr),attr},getNamedItemNS:function(namespaceURI,localName){for(var i=this.length;i--;){var node=this[i];if(node.localName==localName&&node.namespaceURI==namespaceURI)return node}return null}},DOMImplementation.prototype={hasFeature:function(feature,version){return!0},createDocument:function(namespaceURI,qualifiedName,doctype){var doc=new Document;if(doc.implementation=this,doc.childNodes=new NodeList,doc.doctype=doctype||null,doctype&&doc.appendChild(doctype),qualifiedName){var root=doc.createElementNS(namespaceURI,qualifiedName);doc.appendChild(root)}return doc},createDocumentType:function(qualifiedName,publicId,systemId){var node=new DocumentType;return node.name=qualifiedName,node.nodeName=qualifiedName,node.publicId=publicId||"",node.systemId=systemId||"",node}},Node.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(newChild,refChild){return _insertBefore(this,newChild,refChild)},replaceChild:function(newChild,oldChild){this.insertBefore(newChild,oldChild),oldChild&&this.removeChild(oldChild)},removeChild:function(oldChild){return _removeChild(this,oldChild)},appendChild:function(newChild){return this.insertBefore(newChild,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(deep){return _cloneNode(this.ownerDocument||this,this,deep)},normalize:function(){for(var child=this.firstChild;child;){var next=child.nextSibling;next&&next.nodeType==TEXT_NODE&&child.nodeType==TEXT_NODE?(this.removeChild(next),child.appendData(next.data)):(child.normalize(),child=next)}},isSupported:function(feature,version){return this.ownerDocument.implementation.hasFeature(feature,version)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(namespaceURI){for(var el=this;el;){var map=el._nsMap;if(map)for(var n in map)if(map[n]==namespaceURI)return n;el=el.nodeType==ATTRIBUTE_NODE?el.ownerDocument:el.parentNode}return null},lookupNamespaceURI:function(prefix){for(var el=this;el;){var map=el._nsMap;if(map&&prefix in map)return map[prefix];el=el.nodeType==ATTRIBUTE_NODE?el.ownerDocument:el.parentNode}return null},isDefaultNamespace:function(namespaceURI){return null==this.lookupPrefix(namespaceURI)}},copy(NodeType,Node),copy(NodeType,Node.prototype),Document.prototype={nodeName:"#document",nodeType:DOCUMENT_NODE,doctype:null,documentElement:null,_inc:1,insertBefore:function(newChild,refChild){if(newChild.nodeType==DOCUMENT_FRAGMENT_NODE){for(var child=newChild.firstChild;child;){var next=child.nextSibling;this.insertBefore(child,refChild),child=next}return newChild}return null==this.documentElement&&newChild.nodeType==ELEMENT_NODE&&(this.documentElement=newChild),_insertBefore(this,newChild,refChild),newChild.ownerDocument=this,newChild},removeChild:function(oldChild){return this.documentElement==oldChild&&(this.documentElement=null),_removeChild(this,oldChild)},importNode:function(importedNode,deep){return _importNode(this,importedNode,deep)},getElementById:function(id){var rtv=null;return _visitNode(this.documentElement,function(node){if(node.nodeType==ELEMENT_NODE&&node.getAttribute("id")==id)return rtv=node,!0}),rtv},getElementsByClassName:function(classNames){var classNamesSet=toOrderedSet(classNames);return new LiveNodeList(this,function(base){var ls=[];return classNamesSet.length>0&&_visitNode(base.documentElement,function(node){if(node!==base&&node.nodeType===ELEMENT_NODE){var nodeClassNames=node.getAttribute("class");if(nodeClassNames){var matches=classNames===nodeClassNames;if(!matches){var nodeClassNamesSet=toOrderedSet(nodeClassNames);matches=classNamesSet.every((list=nodeClassNamesSet,function(element){return list&&-1!==list.indexOf(element)}))}matches&&ls.push(node)}}var list}),ls})},createElement:function(tagName){var node=new Element;return node.ownerDocument=this,node.nodeName=tagName,node.tagName=tagName,node.localName=tagName,node.childNodes=new NodeList,(node.attributes=new NamedNodeMap)._ownerElement=node,node},createDocumentFragment:function(){var node=new DocumentFragment;return node.ownerDocument=this,node.childNodes=new NodeList,node},createTextNode:function(data){var node=new Text;return node.ownerDocument=this,node.appendData(data),node},createComment:function(data){var node=new Comment;return node.ownerDocument=this,node.appendData(data),node},createCDATASection:function(data){var node=new CDATASection;return node.ownerDocument=this,node.appendData(data),node},createProcessingInstruction:function(target,data){var node=new ProcessingInstruction;return node.ownerDocument=this,node.tagName=node.target=target,node.nodeValue=node.data=data,node},createAttribute:function(name){var node=new Attr;return node.ownerDocument=this,node.name=name,node.nodeName=name,node.localName=name,node.specified=!0,node},createEntityReference:function(name){var node=new EntityReference;return node.ownerDocument=this,node.nodeName=name,node},createElementNS:function(namespaceURI,qualifiedName){var node=new Element,pl=qualifiedName.split(":"),attrs=node.attributes=new NamedNodeMap;return node.childNodes=new NodeList,node.ownerDocument=this,node.nodeName=qualifiedName,node.tagName=qualifiedName,node.namespaceURI=namespaceURI,2==pl.length?(node.prefix=pl[0],node.localName=pl[1]):node.localName=qualifiedName,attrs._ownerElement=node,node},createAttributeNS:function(namespaceURI,qualifiedName){var node=new Attr,pl=qualifiedName.split(":");return node.ownerDocument=this,node.nodeName=qualifiedName,node.name=qualifiedName,node.namespaceURI=namespaceURI,node.specified=!0,2==pl.length?(node.prefix=pl[0],node.localName=pl[1]):node.localName=qualifiedName,node}},_extends(Document,Node),Document.prototype.getElementsByTagName=(Element.prototype={nodeType:ELEMENT_NODE,hasAttribute:function(name){return null!=this.getAttributeNode(name)},getAttribute:function(name){var attr=this.getAttributeNode(name);return attr&&attr.value||""},getAttributeNode:function(name){return this.attributes.getNamedItem(name)},setAttribute:function(name,value){var attr=this.ownerDocument.createAttribute(name);attr.value=attr.nodeValue=""+value,this.setAttributeNode(attr)},removeAttribute:function(name){var attr=this.getAttributeNode(name);attr&&this.removeAttributeNode(attr)},appendChild:function(newChild){return newChild.nodeType===DOCUMENT_FRAGMENT_NODE?this.insertBefore(newChild,null):function(parentNode,newChild){var cp=newChild.parentNode;if(cp){var pre=parentNode.lastChild;cp.removeChild(newChild),pre=parentNode.lastChild}return pre=parentNode.lastChild,newChild.parentNode=parentNode,newChild.previousSibling=pre,newChild.nextSibling=null,pre?pre.nextSibling=newChild:parentNode.firstChild=newChild,parentNode.lastChild=newChild,_onUpdateChild(parentNode.ownerDocument,parentNode,newChild),newChild}(this,newChild)},setAttributeNode:function(newAttr){return this.attributes.setNamedItem(newAttr)},setAttributeNodeNS:function(newAttr){return this.attributes.setNamedItemNS(newAttr)},removeAttributeNode:function(oldAttr){return this.attributes.removeNamedItem(oldAttr.nodeName)},removeAttributeNS:function(namespaceURI,localName){var old=this.getAttributeNodeNS(namespaceURI,localName);old&&this.removeAttributeNode(old)},hasAttributeNS:function(namespaceURI,localName){return null!=this.getAttributeNodeNS(namespaceURI,localName)},getAttributeNS:function(namespaceURI,localName){var attr=this.getAttributeNodeNS(namespaceURI,localName);return attr&&attr.value||""},setAttributeNS:function(namespaceURI,qualifiedName,value){var attr=this.ownerDocument.createAttributeNS(namespaceURI,qualifiedName);attr.value=attr.nodeValue=""+value,this.setAttributeNode(attr)},getAttributeNodeNS:function(namespaceURI,localName){return this.attributes.getNamedItemNS(namespaceURI,localName)},getElementsByTagName:function(tagName){return new LiveNodeList(this,function(base){var ls=[];return _visitNode(base,function(node){node===base||node.nodeType!=ELEMENT_NODE||"*"!==tagName&&node.tagName!=tagName||ls.push(node)}),ls})},getElementsByTagNameNS:function(namespaceURI,localName){return new LiveNodeList(this,function(base){var ls=[];return _visitNode(base,function(node){node===base||node.nodeType!==ELEMENT_NODE||"*"!==namespaceURI&&node.namespaceURI!==namespaceURI||"*"!==localName&&node.localName!=localName||ls.push(node)}),ls})}}).getElementsByTagName,Document.prototype.getElementsByTagNameNS=Element.prototype.getElementsByTagNameNS,_extends(Element,Node),Attr.prototype.nodeType=ATTRIBUTE_NODE,_extends(Attr,Node),CharacterData.prototype={data:"",substringData:function(offset,count){return this.data.substring(offset,offset+count)},appendData:function(text){this.nodeValue=this.data=text=this.data+text,this.length=text.length},insertData:function(offset,text){this.replaceData(offset,0,text)},appendChild:function(newChild){throw new Error(ExceptionMessage[HIERARCHY_REQUEST_ERR])},deleteData:function(offset,count){this.replaceData(offset,count,"")},replaceData:function(offset,count,text){var start=this.data.substring(0,offset),end=this.data.substring(offset+count);this.nodeValue=this.data=text=start+text+end,this.length=text.length}},_extends(CharacterData,Node),Text.prototype={nodeName:"#text",nodeType:TEXT_NODE,splitText:function(offset){var text=this.data,newText=text.substring(offset);text=text.substring(0,offset),this.data=this.nodeValue=text,this.length=text.length;var newNode=this.ownerDocument.createTextNode(newText);return this.parentNode&&this.parentNode.insertBefore(newNode,this.nextSibling),newNode}},_extends(Text,CharacterData),Comment.prototype={nodeName:"#comment",nodeType:COMMENT_NODE},_extends(Comment,CharacterData),CDATASection.prototype={nodeName:"#cdata-section",nodeType:CDATA_SECTION_NODE},_extends(CDATASection,CharacterData),DocumentType.prototype.nodeType=DOCUMENT_TYPE_NODE,_extends(DocumentType,Node),Notation.prototype.nodeType=NOTATION_NODE,_extends(Notation,Node),Entity.prototype.nodeType=ENTITY_NODE,_extends(Entity,Node),EntityReference.prototype.nodeType=ENTITY_REFERENCE_NODE,_extends(EntityReference,Node),DocumentFragment.prototype.nodeName="#document-fragment",DocumentFragment.prototype.nodeType=DOCUMENT_FRAGMENT_NODE,_extends(DocumentFragment,Node),ProcessingInstruction.prototype.nodeType=PROCESSING_INSTRUCTION_NODE,_extends(ProcessingInstruction,Node),XMLSerializer.prototype.serializeToString=function(node,isHtml,nodeFilter){return nodeSerializeToString.call(node,isHtml,nodeFilter)},Node.prototype.toString=nodeSerializeToString;try{if(Object.defineProperty){var getTextContent=function getTextContent(node){switch(node.nodeType){case ELEMENT_NODE:case DOCUMENT_FRAGMENT_NODE:var buf=[];for(node=node.firstChild;node;)7!==node.nodeType&&8!==node.nodeType&&buf.push(getTextContent(node)),node=node.nextSibling;return buf.join("");default:return node.nodeValue}};Object.defineProperty(LiveNodeList.prototype,"length",{get:function(){return _updateLiveList(this),this.$$length}}),Object.defineProperty(Node.prototype,"textContent",{get:function(){return getTextContent(this)},set:function(data){switch(this.nodeType){case ELEMENT_NODE:case DOCUMENT_FRAGMENT_NODE:for(;this.firstChild;)this.removeChild(this.firstChild);(data||String(data))&&this.appendChild(this.ownerDocument.createTextNode(data));break;default:this.data=data,this.value=data,this.nodeValue=data}}}),__set__=function(object,key,value){object["$$"+key]=value}}}catch(e){}exports.DocumentType=DocumentType,exports.DOMException=DOMException,exports.DOMImplementation=DOMImplementation,exports.Element=Element,exports.Node=Node,exports.NodeList=NodeList,exports.XMLSerializer=XMLSerializer},38667:(__unused_webpack_module,exports,__webpack_require__)=>{var freeze=__webpack_require__(41469).freeze;exports.XML_ENTITIES=freeze({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),exports.HTML_ENTITIES=freeze({lt:"<",gt:">",amp:"&",quot:'"',apos:"'",Agrave:"\xc0",Aacute:"\xc1",Acirc:"\xc2",Atilde:"\xc3",Auml:"\xc4",Aring:"\xc5",AElig:"\xc6",Ccedil:"\xc7",Egrave:"\xc8",Eacute:"\xc9",Ecirc:"\xca",Euml:"\xcb",Igrave:"\xcc",Iacute:"\xcd",Icirc:"\xce",Iuml:"\xcf",ETH:"\xd0",Ntilde:"\xd1",Ograve:"\xd2",Oacute:"\xd3",Ocirc:"\xd4",Otilde:"\xd5",Ouml:"\xd6",Oslash:"\xd8",Ugrave:"\xd9",Uacute:"\xda",Ucirc:"\xdb",Uuml:"\xdc",Yacute:"\xdd",THORN:"\xde",szlig:"\xdf",agrave:"\xe0",aacute:"\xe1",acirc:"\xe2",atilde:"\xe3",auml:"\xe4",aring:"\xe5",aelig:"\xe6",ccedil:"\xe7",egrave:"\xe8",eacute:"\xe9",ecirc:"\xea",euml:"\xeb",igrave:"\xec",iacute:"\xed",icirc:"\xee",iuml:"\xef",eth:"\xf0",ntilde:"\xf1",ograve:"\xf2",oacute:"\xf3",ocirc:"\xf4",otilde:"\xf5",ouml:"\xf6",oslash:"\xf8",ugrave:"\xf9",uacute:"\xfa",ucirc:"\xfb",uuml:"\xfc",yacute:"\xfd",thorn:"\xfe",yuml:"\xff",nbsp:"\xa0",iexcl:"\xa1",cent:"\xa2",pound:"\xa3",curren:"\xa4",yen:"\xa5",brvbar:"\xa6",sect:"\xa7",uml:"\xa8",copy:"\xa9",ordf:"\xaa",laquo:"\xab",not:"\xac",shy:"\xad\xad",reg:"\xae",macr:"\xaf",deg:"\xb0",plusmn:"\xb1",sup2:"\xb2",sup3:"\xb3",acute:"\xb4",micro:"\xb5",para:"\xb6",middot:"\xb7",cedil:"\xb8",sup1:"\xb9",ordm:"\xba",raquo:"\xbb",frac14:"\xbc",frac12:"\xbd",frac34:"\xbe",iquest:"\xbf",times:"\xd7",divide:"\xf7",forall:"\u2200",part:"\u2202",exist:"\u2203",empty:"\u2205",nabla:"\u2207",isin:"\u2208",notin:"\u2209",ni:"\u220b",prod:"\u220f",sum:"\u2211",minus:"\u2212",lowast:"\u2217",radic:"\u221a",prop:"\u221d",infin:"\u221e",ang:"\u2220",and:"\u2227",or:"\u2228",cap:"\u2229",cup:"\u222a",int:"\u222b",there4:"\u2234",sim:"\u223c",cong:"\u2245",asymp:"\u2248",ne:"\u2260",equiv:"\u2261",le:"\u2264",ge:"\u2265",sub:"\u2282",sup:"\u2283",nsub:"\u2284",sube:"\u2286",supe:"\u2287",oplus:"\u2295",otimes:"\u2297",perp:"\u22a5",sdot:"\u22c5",Alpha:"\u0391",Beta:"\u0392",Gamma:"\u0393",Delta:"\u0394",Epsilon:"\u0395",Zeta:"\u0396",Eta:"\u0397",Theta:"\u0398",Iota:"\u0399",Kappa:"\u039a",Lambda:"\u039b",Mu:"\u039c",Nu:"\u039d",Xi:"\u039e",Omicron:"\u039f",Pi:"\u03a0",Rho:"\u03a1",Sigma:"\u03a3",Tau:"\u03a4",Upsilon:"\u03a5",Phi:"\u03a6",Chi:"\u03a7",Psi:"\u03a8",Omega:"\u03a9",alpha:"\u03b1",beta:"\u03b2",gamma:"\u03b3",delta:"\u03b4",epsilon:"\u03b5",zeta:"\u03b6",eta:"\u03b7",theta:"\u03b8",iota:"\u03b9",kappa:"\u03ba",lambda:"\u03bb",mu:"\u03bc",nu:"\u03bd",xi:"\u03be",omicron:"\u03bf",pi:"\u03c0",rho:"\u03c1",sigmaf:"\u03c2",sigma:"\u03c3",tau:"\u03c4",upsilon:"\u03c5",phi:"\u03c6",chi:"\u03c7",psi:"\u03c8",omega:"\u03c9",thetasym:"\u03d1",upsih:"\u03d2",piv:"\u03d6",OElig:"\u0152",oelig:"\u0153",Scaron:"\u0160",scaron:"\u0161",Yuml:"\u0178",fnof:"\u0192",circ:"\u02c6",tilde:"\u02dc",ensp:"\u2002",emsp:"\u2003",thinsp:"\u2009",zwnj:"\u200c",zwj:"\u200d",lrm:"\u200e",rlm:"\u200f",ndash:"\u2013",mdash:"\u2014",lsquo:"\u2018",rsquo:"\u2019",sbquo:"\u201a",ldquo:"\u201c",rdquo:"\u201d",bdquo:"\u201e",dagger:"\u2020",Dagger:"\u2021",bull:"\u2022",hellip:"\u2026",permil:"\u2030",prime:"\u2032",Prime:"\u2033",lsaquo:"\u2039",rsaquo:"\u203a",oline:"\u203e",euro:"\u20ac",trade:"\u2122",larr:"\u2190",uarr:"\u2191",rarr:"\u2192",darr:"\u2193",harr:"\u2194",crarr:"\u21b5",lceil:"\u2308",rceil:"\u2309",lfloor:"\u230a",rfloor:"\u230b",loz:"\u25ca",spades:"\u2660",clubs:"\u2663",hearts:"\u2665",diams:"\u2666"}),exports.entityMap=exports.HTML_ENTITIES},83874:(__unused_webpack_module,exports,__webpack_require__)=>{__webpack_require__(3472);exports.DOMParser=__webpack_require__(41343).DOMParser},93115:(__unused_webpack_module,exports,__webpack_require__)=>{var NAMESPACE=__webpack_require__(41469).NAMESPACE,nameStartChar=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,nameChar=new RegExp("[\\-\\.0-9"+nameStartChar.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),tagNamePattern=new RegExp("^"+nameStartChar.source+nameChar.source+"*(?::"+nameStartChar.source+nameChar.source+"*)?$");function ParseError(message,locator){this.message=message,this.locator=locator,Error.captureStackTrace&&Error.captureStackTrace(this,ParseError)}function XMLReader(){}function copyLocator(f,t){return t.lineNumber=f.lineNumber,t.columnNumber=f.columnNumber,t}function parseElementStartPart(source,start,el,currentNSMap,entityReplacer,errorHandler){function addAttribute(qname,value,startIndex){el.attributeNames.hasOwnProperty(qname)&&errorHandler.fatalError("Attribute "+qname+" redefined"),el.addValue(qname,value,startIndex)}for(var attrName,p=++start,s=0;;){var c=source.charAt(p);switch(c){case"=":if(1===s)attrName=source.slice(start,p),s=3;else{if(2!==s)throw new Error("attribute equal must after attrName");s=3}break;case"'":case'"':if(3===s||1===s){if(1===s&&(errorHandler.warning('attribute value must after "="'),attrName=source.slice(start,p)),!((p=source.indexOf(c,start=p+1))>0))throw new Error("attribute value no end '"+c+"' match");addAttribute(attrName,value=source.slice(start,p).replace(/&#?\w+;/g,entityReplacer),start-1),s=5}else{if(4!=s)throw new Error('attribute value must after "="');addAttribute(attrName,value=source.slice(start,p).replace(/&#?\w+;/g,entityReplacer),start),errorHandler.warning('attribute "'+attrName+'" missed start quot('+c+")!!"),start=p+1,s=5}break;case"/":switch(s){case 0:el.setTagName(source.slice(start,p));case 5:case 6:case 7:s=7,el.closed=!0;case 4:case 1:case 2:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return errorHandler.error("unexpected end of input"),0==s&&el.setTagName(source.slice(start,p)),p;case">":switch(s){case 0:el.setTagName(source.slice(start,p));case 5:case 6:case 7:break;case 4:case 1:"/"===(value=source.slice(start,p)).slice(-1)&&(el.closed=!0,value=value.slice(0,-1));case 2:2===s&&(value=attrName),4==s?(errorHandler.warning('attribute "'+value+'" missed quot(")!'),addAttribute(attrName,value.replace(/&#?\w+;/g,entityReplacer),start)):(NAMESPACE.isHTML(currentNSMap[""])&&value.match(/^(?:disabled|checked|selected)$/i)||errorHandler.warning('attribute "'+value+'" missed value!! "'+value+'" instead!!'),addAttribute(value,value,start));break;case 3:throw new Error("attribute value missed!!")}return p;case"\x80":c=" ";default:if(c<=" ")switch(s){case 0:el.setTagName(source.slice(start,p)),s=6;break;case 1:attrName=source.slice(start,p),s=2;break;case 4:var value=source.slice(start,p).replace(/&#?\w+;/g,entityReplacer);errorHandler.warning('attribute "'+value+'" missed quot(")!!'),addAttribute(attrName,value,start);case 5:s=6}else switch(s){case 2:NAMESPACE.isHTML(currentNSMap[""])&&attrName.match(/^(?:disabled|checked|selected)$/i)||errorHandler.warning('attribute "'+attrName+'" missed value!! "'+attrName+'" instead2!!'),addAttribute(attrName,attrName,start),start=p,s=1;break;case 5:errorHandler.warning('attribute space is required"'+attrName+'"!!');case 6:s=1,start=p;break;case 3:s=4,start=p;break;case 7:throw new Error("elements closed character '/' and '>' must be connected to")}}p++}}function appendElement(el,domBuilder,currentNSMap){for(var tagName=el.tagName,localNSMap=null,i=el.length;i--;){var a=el[i],qName=a.qName,value=a.value;if((nsp=qName.indexOf(":"))>0)var prefix=a.prefix=qName.slice(0,nsp),localName=qName.slice(nsp+1),nsPrefix="xmlns"===prefix&&localName;else localName=qName,prefix=null,nsPrefix="xmlns"===qName&&"";a.localName=localName,!1!==nsPrefix&&(null==localNSMap&&(localNSMap={},_copy(currentNSMap,currentNSMap={})),currentNSMap[nsPrefix]=localNSMap[nsPrefix]=value,a.uri=NAMESPACE.XMLNS,domBuilder.startPrefixMapping(nsPrefix,value))}for(i=el.length;i--;)(prefix=(a=el[i]).prefix)&&("xml"===prefix&&(a.uri=NAMESPACE.XML),"xmlns"!==prefix&&(a.uri=currentNSMap[prefix||""]));var nsp;(nsp=tagName.indexOf(":"))>0?(prefix=el.prefix=tagName.slice(0,nsp),localName=el.localName=tagName.slice(nsp+1)):(prefix=null,localName=el.localName=tagName);var ns=el.uri=currentNSMap[prefix||""];if(domBuilder.startElement(ns,localName,tagName,el),!el.closed)return el.currentNSMap=currentNSMap,el.localNSMap=localNSMap,!0;if(domBuilder.endElement(ns,localName,tagName),localNSMap)for(prefix in localNSMap)domBuilder.endPrefixMapping(prefix)}function parseHtmlSpecialContent(source,elStartEnd,tagName,entityReplacer,domBuilder){if(/^(?:script|textarea)$/i.test(tagName)){var elEndStart=source.indexOf("</"+tagName+">",elStartEnd),text=source.substring(elStartEnd+1,elEndStart);if(/[&<]/.test(text))return/^script$/i.test(tagName)?(domBuilder.characters(text,0,text.length),elEndStart):(text=text.replace(/&#?\w+;/g,entityReplacer),domBuilder.characters(text,0,text.length),elEndStart)}return elStartEnd+1}function fixSelfClosed(source,elStartEnd,tagName,closeMap){var pos=closeMap[tagName];return null==pos&&((pos=source.lastIndexOf("</"+tagName+">"))<elStartEnd&&(pos=source.lastIndexOf("</"+tagName)),closeMap[tagName]=pos),pos<elStartEnd}function _copy(source,target){for(var n in source)target[n]=source[n]}function parseDCC(source,start,domBuilder,errorHandler){if("-"===source.charAt(start+2))return"-"===source.charAt(start+3)?(end=source.indexOf("--\x3e",start+4))>start?(domBuilder.comment(source,start+4,end-start-4),end+3):(errorHandler.error("Unclosed comment"),-1):-1;if("CDATA["==source.substr(start+3,6)){var end=source.indexOf("]]>",start+9);return domBuilder.startCDATA(),domBuilder.characters(source,start+9,end-start-9),domBuilder.endCDATA(),end+3}var matchs=function(source,start){var match,buf=[],reg=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(reg.lastIndex=start,reg.exec(source);match=reg.exec(source);)if(buf.push(match),match[1])return buf}(source,start),len=matchs.length;if(len>1&&/!doctype/i.test(matchs[0][0])){var name=matchs[1][0],pubid=!1,sysid=!1;len>3&&(/^public$/i.test(matchs[2][0])?(pubid=matchs[3][0],sysid=len>4&&matchs[4][0]):/^system$/i.test(matchs[2][0])&&(sysid=matchs[3][0]));var lastMatch=matchs[len-1];return domBuilder.startDTD(name,pubid,sysid),domBuilder.endDTD(),lastMatch.index+lastMatch[0].length}return-1}function parseInstruction(source,start,domBuilder){var end=source.indexOf("?>",start);if(end){var match=source.substring(start,end).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return match?(domBuilder.processingInstruction(match[1],match[2]),end+2):-1}return-1}function ElementAttributes(){this.attributeNames={}}(ParseError.prototype=new Error).name=ParseError.name,XMLReader.prototype={parse:function(source,defaultNSMap,entityMap){var domBuilder=this.domBuilder;domBuilder.startDocument(),_copy(defaultNSMap,defaultNSMap={}),function(source,defaultNSMapCopy,entityMap,domBuilder,errorHandler){function entityReplacer(a){var code,k=a.slice(1,-1);return k in entityMap?entityMap[k]:"#"===k.charAt(0)?(code=parseInt(k.substr(1).replace("x","0x")))>65535?(code-=65536,String.fromCharCode(55296+(code>>10),56320+(1023&code))):String.fromCharCode(code):(errorHandler.error("entity not found:"+a),a)}function appendText(end){if(end>start){var xt=source.substring(start,end).replace(/&#?\w+;/g,entityReplacer);locator&&position(start),domBuilder.characters(xt,0,end-start),start=end}}function position(p,m){for(;p>=lineEnd&&(m=linePattern.exec(source));)lineEnd=(lineStart=m.index)+m[0].length,locator.lineNumber++;locator.columnNumber=p-lineStart+1}for(var lineStart=0,lineEnd=0,linePattern=/.*(?:\r\n?|\n)|.*$/g,locator=domBuilder.locator,parseStack=[{currentNSMap:defaultNSMapCopy}],closeMap={},start=0;;){try{var tagStart=source.indexOf("<",start);if(tagStart<0){if(!source.substr(start).match(/^\s*$/)){var doc=domBuilder.doc,text=doc.createTextNode(source.substr(start));doc.appendChild(text),domBuilder.currentElement=text}return}switch(tagStart>start&&appendText(tagStart),source.charAt(tagStart+1)){case"/":var end=source.indexOf(">",tagStart+3),tagName=source.substring(tagStart+2,end).replace(/[ \t\n\r]+$/g,""),config=parseStack.pop();end<0?(tagName=source.substring(tagStart+2).replace(/[\s<].*/,""),errorHandler.error("end tag name: "+tagName+" is not complete:"+config.tagName),end=tagStart+1+tagName.length):tagName.match(/\s</)&&(tagName=tagName.replace(/[\s<].*/,""),errorHandler.error("end tag name: "+tagName+" maybe not complete"),end=tagStart+1+tagName.length);var localNSMap=config.localNSMap,endMatch=config.tagName==tagName;if(endMatch||config.tagName&&config.tagName.toLowerCase()==tagName.toLowerCase()){if(domBuilder.endElement(config.uri,config.localName,tagName),localNSMap)for(var prefix in localNSMap)domBuilder.endPrefixMapping(prefix);endMatch||errorHandler.fatalError("end tag name: "+tagName+" is not match the current start tagName:"+config.tagName)}else parseStack.push(config);end++;break;case"?":locator&&position(tagStart),end=parseInstruction(source,tagStart,domBuilder);break;case"!":locator&&position(tagStart),end=parseDCC(source,tagStart,domBuilder,errorHandler);break;default:locator&&position(tagStart);var el=new ElementAttributes,currentNSMap=parseStack[parseStack.length-1].currentNSMap,len=(end=parseElementStartPart(source,tagStart,el,currentNSMap,entityReplacer,errorHandler),el.length);if(!el.closed&&fixSelfClosed(source,end,el.tagName,closeMap)&&(el.closed=!0,entityMap.nbsp||errorHandler.warning("unclosed xml attribute")),locator&&len){for(var locator2=copyLocator(locator,{}),i=0;i<len;i++){var a=el[i];position(a.offset),a.locator=copyLocator(locator,{})}domBuilder.locator=locator2,appendElement(el,domBuilder,currentNSMap)&&parseStack.push(el),domBuilder.locator=locator}else appendElement(el,domBuilder,currentNSMap)&&parseStack.push(el);NAMESPACE.isHTML(el.uri)&&!el.closed?end=parseHtmlSpecialContent(source,end,el.tagName,entityReplacer,domBuilder):end++}}catch(e){if(e instanceof ParseError)throw e;errorHandler.error("element parse error: "+e),end=-1}end>start?start=end:appendText(Math.max(tagStart,start)+1)}}(source,defaultNSMap,entityMap,domBuilder,this.errorHandler),domBuilder.endDocument()}},ElementAttributes.prototype={setTagName:function(tagName){if(!tagNamePattern.test(tagName))throw new Error("invalid tagName:"+tagName);this.tagName=tagName},addValue:function(qName,value,offset){if(!tagNamePattern.test(qName))throw new Error("invalid attribute:"+qName);this.attributeNames[qName]=this.length,this[this.length++]={qName:qName,value:value,offset:offset}},length:0,getLocalName:function(i){return this[i].localName},getLocator:function(i){return this[i].locator},getQName:function(i){return this[i].qName},getURI:function(i){return this[i].uri},getValue:function(i){return this[i].value}},exports.XMLReader=XMLReader,exports.ParseError=ParseError},66193:(__unused_webpack_module,exports)=>{"use strict";exports.byteLength=function(b64){var lens=getLens(b64),placeHoldersLen=lens[1];return 3*(lens[0]+placeHoldersLen)/4-placeHoldersLen},exports.toByteArray=function(b64){var tmp,i,lens=getLens(b64),validLen=lens[0],placeHoldersLen=lens[1],arr=new Arr(function(b64,validLen,placeHoldersLen){return 3*(validLen+placeHoldersLen)/4-placeHoldersLen}(0,validLen,placeHoldersLen)),curByte=0,len=placeHoldersLen>0?validLen-4:validLen;for(i=0;i<len;i+=4)tmp=revLookup[b64.charCodeAt(i)]<<18|revLookup[b64.charCodeAt(i+1)]<<12|revLookup[b64.charCodeAt(i+2)]<<6|revLookup[b64.charCodeAt(i+3)],arr[curByte++]=tmp>>16&255,arr[curByte++]=tmp>>8&255,arr[curByte++]=255&tmp;return 2===placeHoldersLen&&(tmp=revLookup[b64.charCodeAt(i)]<<2|revLookup[b64.charCodeAt(i+1)]>>4,arr[curByte++]=255&tmp),1===placeHoldersLen&&(tmp=revLookup[b64.charCodeAt(i)]<<10|revLookup[b64.charCodeAt(i+1)]<<4|revLookup[b64.charCodeAt(i+2)]>>2,arr[curByte++]=tmp>>8&255,arr[curByte++]=255&tmp),arr},exports.fromByteArray=function(uint8){for(var tmp,len=uint8.length,extraBytes=len%3,parts=[],i=0,len2=len-extraBytes;i<len2;i+=16383)parts.push(encodeChunk(uint8,i,i+16383>len2?len2:i+16383));return 1===extraBytes?parts.push(lookup[(tmp=uint8[len-1])>>2]+lookup[tmp<<4&63]+"=="):2===extraBytes&&parts.push(lookup[(tmp=(uint8[len-2]<<8)+uint8[len-1])>>10]+lookup[tmp>>4&63]+lookup[tmp<<2&63]+"="),parts.join("")};for(var lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;function getLens(b64){var len=b64.length;if(len%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var validLen=b64.indexOf("=");return-1===validLen&&(validLen=len),[validLen,validLen===len?0:4-validLen%4]}function encodeChunk(uint8,start,end){for(var num,output=[],i=start;i<end;i+=3)output.push(lookup[(num=(uint8[i]<<16&16711680)+(uint8[i+1]<<8&65280)+(255&uint8[i+2]))>>18&63]+lookup[num>>12&63]+lookup[num>>6&63]+lookup[63&num]);return output.join("")}revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63},72449:(module,__unused_webpack_exports,__webpack_require__)=>{var doccy,topLevel="undefined"!=typeof global?global:"undefined"!=typeof window?window:{},minDoc=__webpack_require__(25893);"undefined"!=typeof document?doccy=document:(doccy=topLevel["__GLOBAL_DOCUMENT_CACHE@4"])||(doccy=topLevel["__GLOBAL_DOCUMENT_CACHE@4"]=minDoc),module.exports=doccy},60397:module=>{var win;win="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},module.exports=win},74026:function(module){var factory;"undefined"!=typeof window&&(factory=function(){return function(modules){var installedModules={};function __nested_webpack_require_624__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__nested_webpack_require_624__),module.l=!0,module.exports}return __nested_webpack_require_624__.m=modules,__nested_webpack_require_624__.c=installedModules,__nested_webpack_require_624__.d=function(exports,name,getter){__nested_webpack_require_624__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__nested_webpack_require_624__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__nested_webpack_require_624__.t=function(value,mode){if(1&mode&&(value=__nested_webpack_require_624__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__nested_webpack_require_624__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__nested_webpack_require_624__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__nested_webpack_require_624__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __nested_webpack_require_624__.d(getter,"a",getter),getter},__nested_webpack_require_624__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__nested_webpack_require_624__.p="/dist/",__nested_webpack_require_624__(__nested_webpack_require_624__.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":
/*!*********************************************!*\
        !*** ./node_modules/eventemitter3/index.js ***!
        \*********************************************/
/*! no static exports found */
function(module,exports,__webpack_require__){"use strict";var has=Object.prototype.hasOwnProperty,prefix="~";function Events(){}function EE(fn,context,once){this.fn=fn,this.context=context,this.once=once||!1}function addListener(emitter,event,fn,context,once){if("function"!=typeof fn)throw new TypeError("The listener must be a function");var listener=new EE(fn,context||emitter,once),evt=prefix?prefix+event:event;return emitter._events[evt]?emitter._events[evt].fn?emitter._events[evt]=[emitter._events[evt],listener]:emitter._events[evt].push(listener):(emitter._events[evt]=listener,emitter._eventsCount++),emitter}function clearEvent(emitter,evt){0==--emitter._eventsCount?emitter._events=new Events:delete emitter._events[evt]}function EventEmitter(){this._events=new Events,this._eventsCount=0}Object.create&&(Events.prototype=Object.create(null),(new Events).__proto__||(prefix=!1)),EventEmitter.prototype.eventNames=function(){var events,name,names=[];if(0===this._eventsCount)return names;for(name in events=this._events)has.call(events,name)&&names.push(prefix?name.slice(1):name);return Object.getOwnPropertySymbols?names.concat(Object.getOwnPropertySymbols(events)):names},EventEmitter.prototype.listeners=function(event){var handlers=this._events[prefix?prefix+event:event];if(!handlers)return[];if(handlers.fn)return[handlers.fn];for(var i=0,l=handlers.length,ee=new Array(l);i<l;i++)ee[i]=handlers[i].fn;return ee},EventEmitter.prototype.listenerCount=function(event){var listeners=this._events[prefix?prefix+event:event];return listeners?listeners.fn?1:listeners.length:0},EventEmitter.prototype.emit=function(event,a1,a2,a3,a4,a5){var evt=prefix?prefix+event:event;if(!this._events[evt])return!1;var args,i,listeners=this._events[evt],len=arguments.length;if(listeners.fn){switch(listeners.once&&this.removeListener(event,listeners.fn,void 0,!0),len){case 1:return listeners.fn.call(listeners.context),!0;case 2:return listeners.fn.call(listeners.context,a1),!0;case 3:return listeners.fn.call(listeners.context,a1,a2),!0;case 4:return listeners.fn.call(listeners.context,a1,a2,a3),!0;case 5:return listeners.fn.call(listeners.context,a1,a2,a3,a4),!0;case 6:return listeners.fn.call(listeners.context,a1,a2,a3,a4,a5),!0}for(i=1,args=new Array(len-1);i<len;i++)args[i-1]=arguments[i];listeners.fn.apply(listeners.context,args)}else{var j,length=listeners.length;for(i=0;i<length;i++)switch(listeners[i].once&&this.removeListener(event,listeners[i].fn,void 0,!0),len){case 1:listeners[i].fn.call(listeners[i].context);break;case 2:listeners[i].fn.call(listeners[i].context,a1);break;case 3:listeners[i].fn.call(listeners[i].context,a1,a2);break;case 4:listeners[i].fn.call(listeners[i].context,a1,a2,a3);break;default:if(!args)for(j=1,args=new Array(len-1);j<len;j++)args[j-1]=arguments[j];listeners[i].fn.apply(listeners[i].context,args)}}return!0},EventEmitter.prototype.on=function(event,fn,context){return addListener(this,event,fn,context,!1)},EventEmitter.prototype.once=function(event,fn,context){return addListener(this,event,fn,context,!0)},EventEmitter.prototype.removeListener=function(event,fn,context,once){var evt=prefix?prefix+event:event;if(!this._events[evt])return this;if(!fn)return clearEvent(this,evt),this;var listeners=this._events[evt];if(listeners.fn)listeners.fn!==fn||once&&!listeners.once||context&&listeners.context!==context||clearEvent(this,evt);else{for(var i=0,events=[],length=listeners.length;i<length;i++)(listeners[i].fn!==fn||once&&!listeners[i].once||context&&listeners[i].context!==context)&&events.push(listeners[i]);events.length?this._events[evt]=1===events.length?events[0]:events:clearEvent(this,evt)}return this},EventEmitter.prototype.removeAllListeners=function(event){var evt;return event?this._events[evt=prefix?prefix+event:event]&&clearEvent(this,evt):(this._events=new Events,this._eventsCount=0),this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.addListener=EventEmitter.prototype.on,EventEmitter.prefixed=prefix,EventEmitter.EventEmitter=EventEmitter,module.exports=EventEmitter},"./node_modules/url-toolkit/src/url-toolkit.js":
/*!*****************************************************!*\
        !*** ./node_modules/url-toolkit/src/url-toolkit.js ***!
        \*****************************************************/
/*! no static exports found */
function(module,exports,__webpack_require__){var URL_REGEX,FIRST_SEGMENT_REGEX,SLASH_DOT_REGEX,SLASH_DOT_DOT_REGEX,URLToolkit;URL_REGEX=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#[^]*)?$/,FIRST_SEGMENT_REGEX=/^([^\/?#]*)([^]*)$/,SLASH_DOT_REGEX=/(?:\/|^)\.(?=\/)/g,SLASH_DOT_DOT_REGEX=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,module.exports=URLToolkit={buildAbsoluteURL:function(baseURL,relativeURL,opts){if(opts=opts||{},baseURL=baseURL.trim(),!(relativeURL=relativeURL.trim())){if(!opts.alwaysNormalize)return baseURL;var basePartsForNormalise=URLToolkit.parseURL(baseURL);if(!basePartsForNormalise)throw new Error("Error trying to parse base URL.");return basePartsForNormalise.path=URLToolkit.normalizePath(basePartsForNormalise.path),URLToolkit.buildURLFromParts(basePartsForNormalise)}var relativeParts=URLToolkit.parseURL(relativeURL);if(!relativeParts)throw new Error("Error trying to parse relative URL.");if(relativeParts.scheme)return opts.alwaysNormalize?(relativeParts.path=URLToolkit.normalizePath(relativeParts.path),URLToolkit.buildURLFromParts(relativeParts)):relativeURL;var baseParts=URLToolkit.parseURL(baseURL);if(!baseParts)throw new Error("Error trying to parse base URL.");if(!baseParts.netLoc&&baseParts.path&&"/"!==baseParts.path[0]){var pathParts=FIRST_SEGMENT_REGEX.exec(baseParts.path);baseParts.netLoc=pathParts[1],baseParts.path=pathParts[2]}baseParts.netLoc&&!baseParts.path&&(baseParts.path="/");var builtParts={scheme:baseParts.scheme,netLoc:relativeParts.netLoc,path:null,params:relativeParts.params,query:relativeParts.query,fragment:relativeParts.fragment};if(!relativeParts.netLoc&&(builtParts.netLoc=baseParts.netLoc,"/"!==relativeParts.path[0]))if(relativeParts.path){var baseURLPath=baseParts.path,newPath=baseURLPath.substring(0,baseURLPath.lastIndexOf("/")+1)+relativeParts.path;builtParts.path=URLToolkit.normalizePath(newPath)}else builtParts.path=baseParts.path,relativeParts.params||(builtParts.params=baseParts.params,relativeParts.query||(builtParts.query=baseParts.query));return null===builtParts.path&&(builtParts.path=opts.alwaysNormalize?URLToolkit.normalizePath(relativeParts.path):relativeParts.path),URLToolkit.buildURLFromParts(builtParts)},parseURL:function(url){var parts=URL_REGEX.exec(url);return parts?{scheme:parts[1]||"",netLoc:parts[2]||"",path:parts[3]||"",params:parts[4]||"",query:parts[5]||"",fragment:parts[6]||""}:null},normalizePath:function(path){for(path=path.split("").reverse().join("").replace(SLASH_DOT_REGEX,"");path.length!==(path=path.replace(SLASH_DOT_DOT_REGEX,"")).length;);return path.split("").reverse().join("")},buildURLFromParts:function(parts){return parts.scheme+parts.netLoc+parts.path+parts.params+parts.query+parts.fragment}}},"./node_modules/webworkify-webpack/index.js":
/*!**************************************************!*\
        !*** ./node_modules/webworkify-webpack/index.js ***!
        \**************************************************/
/*! no static exports found */
function(module,exports,__nested_webpack_require_25782__){function webpackBootstrapFunc(modules){var installedModules={};function __nested_webpack_require_26044__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__nested_webpack_require_26044__),module.l=!0,module.exports}__nested_webpack_require_26044__.m=modules,__nested_webpack_require_26044__.c=installedModules,__nested_webpack_require_26044__.i=function(value){return value},__nested_webpack_require_26044__.d=function(exports,name,getter){__nested_webpack_require_26044__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__nested_webpack_require_26044__.r=function(exports){Object.defineProperty(exports,"__esModule",{value:!0})},__nested_webpack_require_26044__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __nested_webpack_require_26044__.d(getter,"a",getter),getter},__nested_webpack_require_26044__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__nested_webpack_require_26044__.p="/",__nested_webpack_require_26044__.oe=function(err){throw console.error(err),err};var f=__nested_webpack_require_26044__(__nested_webpack_require_26044__.s=ENTRY_MODULE);return f.default||f}function quoteRegExp(str){return(str+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function getModuleDependencies(sources,module,queueName){var retval={};retval[queueName]=[];var fnString=module.toString(),wrapperSignature=fnString.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!wrapperSignature)return retval;for(var match,webpackRequireName=wrapperSignature[1],re=new RegExp("(\\\\n|\\W)"+quoteRegExp(webpackRequireName)+"\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)","g");match=re.exec(fnString);)"dll-reference"!==match[3]&&retval[queueName].push(match[3]);for(re=new RegExp("\\("+quoteRegExp(webpackRequireName)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)',"g");match=re.exec(fnString);)sources[match[2]]||(retval[queueName].push(match[1]),sources[match[2]]=__nested_webpack_require_25782__(match[1]).m),retval[match[2]]=retval[match[2]]||[],retval[match[2]].push(match[4]);for(var keys=Object.keys(retval),i=0;i<keys.length;i++)for(var j=0;j<retval[keys[i]].length;j++)isNaN(1*retval[keys[i]][j])||(retval[keys[i]][j]=1*retval[keys[i]][j]);return retval}function hasValuesInQueues(queues){return Object.keys(queues).reduce(function(hasValues,key){return hasValues||queues[key].length>0},!1)}module.exports=function(moduleId,options){var sources={main:__nested_webpack_require_25782__.m},requiredModules=(options=options||{}).all?{main:Object.keys(sources.main)}:function(sources,moduleId){for(var modulesQueue={main:[moduleId]},requiredModules={main:[]},seenModules={main:{}};hasValuesInQueues(modulesQueue);)for(var queues=Object.keys(modulesQueue),i=0;i<queues.length;i++){var queueName=queues[i],moduleToCheck=modulesQueue[queueName].pop();if(seenModules[queueName]=seenModules[queueName]||{},!seenModules[queueName][moduleToCheck]&&sources[queueName][moduleToCheck]){seenModules[queueName][moduleToCheck]=!0,requiredModules[queueName]=requiredModules[queueName]||[],requiredModules[queueName].push(moduleToCheck);for(var newModules=getModuleDependencies(sources,sources[queueName][moduleToCheck],queueName),newModulesKeys=Object.keys(newModules),j=0;j<newModulesKeys.length;j++)modulesQueue[newModulesKeys[j]]=modulesQueue[newModulesKeys[j]]||[],modulesQueue[newModulesKeys[j]]=modulesQueue[newModulesKeys[j]].concat(newModules[newModulesKeys[j]])}}return requiredModules}(sources,moduleId),src="";Object.keys(requiredModules).filter(function(m){return"main"!==m}).forEach(function(module){for(var entryModule=0;requiredModules[module][entryModule];)entryModule++;requiredModules[module].push(entryModule),sources[module][entryModule]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",src=src+"var "+module+" = ("+webpackBootstrapFunc.toString().replace("ENTRY_MODULE",JSON.stringify(entryModule))+")({"+requiredModules[module].map(function(id){return JSON.stringify(id)+": "+sources[module][id].toString()}).join(",")+"});\n"}),src=src+"new (("+webpackBootstrapFunc.toString().replace("ENTRY_MODULE",JSON.stringify(moduleId))+")({"+requiredModules.main.map(function(id){return JSON.stringify(id)+": "+sources.main[id].toString()}).join(",")+"}))(self);";var blob=new window.Blob([src],{type:"text/javascript"});if(options.bare)return blob;var workerUrl=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(blob),worker=new window.Worker(workerUrl);return worker.objectURL=workerUrl,worker}},"./src/config.ts":
/*!***********************!*\
        !*** ./src/config.ts ***!
        \***********************/
/*! exports provided: hlsDefaultConfig, mergeConfig, enableStreamingMode */
function(module,__webpack_exports__,__nested_webpack_require_35920__){"use strict";__nested_webpack_require_35920__.r(__webpack_exports__),__nested_webpack_require_35920__.d(__webpack_exports__,"hlsDefaultConfig",function(){return hlsDefaultConfig}),__nested_webpack_require_35920__.d(__webpack_exports__,"mergeConfig",function(){return mergeConfig}),__nested_webpack_require_35920__.d(__webpack_exports__,"enableStreamingMode",function(){return enableStreamingMode});var _controller_abr_controller__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_35920__(
/*! ./controller/abr-controller */
"./src/controller/abr-controller.ts"),_controller_audio_stream_controller__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_35920__(
/*! ./controller/audio-stream-controller */
"./src/controller/audio-stream-controller.ts"),_controller_audio_track_controller__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_35920__(
/*! ./controller/audio-track-controller */
"./src/controller/audio-track-controller.ts"),_controller_subtitle_stream_controller__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_35920__(
/*! ./controller/subtitle-stream-controller */
"./src/controller/subtitle-stream-controller.ts"),_controller_subtitle_track_controller__WEBPACK_IMPORTED_MODULE_4__=__nested_webpack_require_35920__(
/*! ./controller/subtitle-track-controller */
"./src/controller/subtitle-track-controller.ts"),_controller_buffer_controller__WEBPACK_IMPORTED_MODULE_5__=__nested_webpack_require_35920__(
/*! ./controller/buffer-controller */
"./src/controller/buffer-controller.ts"),_controller_timeline_controller__WEBPACK_IMPORTED_MODULE_6__=__nested_webpack_require_35920__(
/*! ./controller/timeline-controller */
"./src/controller/timeline-controller.ts"),_controller_cap_level_controller__WEBPACK_IMPORTED_MODULE_7__=__nested_webpack_require_35920__(
/*! ./controller/cap-level-controller */
"./src/controller/cap-level-controller.ts"),_controller_fps_controller__WEBPACK_IMPORTED_MODULE_8__=__nested_webpack_require_35920__(
/*! ./controller/fps-controller */
"./src/controller/fps-controller.ts"),_controller_eme_controller__WEBPACK_IMPORTED_MODULE_9__=__nested_webpack_require_35920__(
/*! ./controller/eme-controller */
"./src/controller/eme-controller.ts"),_utils_xhr_loader__WEBPACK_IMPORTED_MODULE_10__=__nested_webpack_require_35920__(
/*! ./utils/xhr-loader */
"./src/utils/xhr-loader.ts"),_utils_fetch_loader__WEBPACK_IMPORTED_MODULE_11__=__nested_webpack_require_35920__(
/*! ./utils/fetch-loader */
"./src/utils/fetch-loader.ts"),_utils_cues__WEBPACK_IMPORTED_MODULE_12__=__nested_webpack_require_35920__(
/*! ./utils/cues */
"./src/utils/cues.ts"),_utils_mediakeys_helper__WEBPACK_IMPORTED_MODULE_13__=__nested_webpack_require_35920__(
/*! ./utils/mediakeys-helper */
"./src/utils/mediakeys-helper.ts"),_utils_logger__WEBPACK_IMPORTED_MODULE_14__=__nested_webpack_require_35920__(
/*! ./utils/logger */
"./src/utils/logger.ts");function _extends(){return _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var hlsDefaultConfig=_objectSpread(_objectSpread({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:_utils_xhr_loader__WEBPACK_IMPORTED_MODULE_10__.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:_controller_abr_controller__WEBPACK_IMPORTED_MODULE_0__.default,bufferController:_controller_buffer_controller__WEBPACK_IMPORTED_MODULE_5__.default,capLevelController:_controller_cap_level_controller__WEBPACK_IMPORTED_MODULE_7__.default,fpsController:_controller_fps_controller__WEBPACK_IMPORTED_MODULE_8__.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:_utils_mediakeys_helper__WEBPACK_IMPORTED_MODULE_13__.requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0},{cueHandler:_utils_cues__WEBPACK_IMPORTED_MODULE_12__.default,enableCEA708Captions:!0,enableWebVTT:!0,enableIMSC1:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:_controller_subtitle_stream_controller__WEBPACK_IMPORTED_MODULE_3__.SubtitleStreamController,subtitleTrackController:_controller_subtitle_track_controller__WEBPACK_IMPORTED_MODULE_4__.default,timelineController:_controller_timeline_controller__WEBPACK_IMPORTED_MODULE_6__.TimelineController,audioStreamController:_controller_audio_stream_controller__WEBPACK_IMPORTED_MODULE_1__.default,audioTrackController:_controller_audio_track_controller__WEBPACK_IMPORTED_MODULE_2__.default,emeController:_controller_eme_controller__WEBPACK_IMPORTED_MODULE_9__.default});function mergeConfig(defaultConfig,userConfig){if((userConfig.liveSyncDurationCount||userConfig.liveMaxLatencyDurationCount)&&(userConfig.liveSyncDuration||userConfig.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==userConfig.liveMaxLatencyDurationCount&&(void 0===userConfig.liveSyncDurationCount||userConfig.liveMaxLatencyDurationCount<=userConfig.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==userConfig.liveMaxLatencyDuration&&(void 0===userConfig.liveSyncDuration||userConfig.liveMaxLatencyDuration<=userConfig.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return _extends({},defaultConfig,userConfig)}function enableStreamingMode(config){var currentLoader=config.loader;currentLoader!==_utils_fetch_loader__WEBPACK_IMPORTED_MODULE_11__.default&&currentLoader!==_utils_xhr_loader__WEBPACK_IMPORTED_MODULE_10__.default?(_utils_logger__WEBPACK_IMPORTED_MODULE_14__.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),config.progressive=!1):Object(_utils_fetch_loader__WEBPACK_IMPORTED_MODULE_11__.fetchSupported)()&&(config.loader=_utils_fetch_loader__WEBPACK_IMPORTED_MODULE_11__.default,config.progressive=!0,config.enableSoftwareAES=!0,_utils_logger__WEBPACK_IMPORTED_MODULE_14__.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}},"./src/controller/abr-controller.ts":
/*!******************************************!*\
        !*** ./src/controller/abr-controller.ts ***!
        \******************************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_52193__){"use strict";__nested_webpack_require_52193__.r(__webpack_exports__);var _home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_52193__(
/*! ./src/polyfills/number */
"./src/polyfills/number.ts"),_utils_ewma_bandwidth_estimator__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_52193__(
/*! ../utils/ewma-bandwidth-estimator */
"./src/utils/ewma-bandwidth-estimator.ts"),_events__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_52193__(
/*! ../events */
"./src/events.ts"),_utils_buffer_helper__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_52193__(
/*! ../utils/buffer-helper */
"./src/utils/buffer-helper.ts"),_errors__WEBPACK_IMPORTED_MODULE_4__=__nested_webpack_require_52193__(
/*! ../errors */
"./src/errors.ts"),_types_loader__WEBPACK_IMPORTED_MODULE_5__=__nested_webpack_require_52193__(
/*! ../types/loader */
"./src/types/loader.ts"),_utils_logger__WEBPACK_IMPORTED_MODULE_6__=__nested_webpack_require_52193__(
/*! ../utils/logger */
"./src/utils/logger.ts");function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}__webpack_exports__.default=function(){function AbrController(hls){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=hls;var config=hls.config;this.bwEstimator=new _utils_ewma_bandwidth_estimator__WEBPACK_IMPORTED_MODULE_1__.default(config.abrEwmaSlowVoD,config.abrEwmaFastVoD,config.abrEwmaDefaultEstimate),this.registerListeners()}var Constructor,protoProps,_proto=AbrController.prototype;return _proto.registerListeners=function(){var hls=this.hls;hls.on(_events__WEBPACK_IMPORTED_MODULE_2__.Events.FRAG_LOADING,this.onFragLoading,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_2__.Events.FRAG_LOADED,this.onFragLoaded,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_2__.Events.FRAG_BUFFERED,this.onFragBuffered,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_2__.Events.LEVEL_LOADED,this.onLevelLoaded,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_2__.Events.ERROR,this.onError,this)},_proto.unregisterListeners=function(){var hls=this.hls;hls.off(_events__WEBPACK_IMPORTED_MODULE_2__.Events.FRAG_LOADING,this.onFragLoading,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_2__.Events.FRAG_LOADED,this.onFragLoaded,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_2__.Events.FRAG_BUFFERED,this.onFragBuffered,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_2__.Events.LEVEL_LOADED,this.onLevelLoaded,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_2__.Events.ERROR,this.onError,this)},_proto.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},_proto.onFragLoading=function(event,data){var _data$part,frag=data.frag;frag.type===_types_loader__WEBPACK_IMPORTED_MODULE_5__.PlaylistLevelType.MAIN&&(this.timer||(this.fragCurrent=frag,this.partCurrent=null!=(_data$part=data.part)?_data$part:null,this.timer=self.setInterval(this.onCheck,100)))},_proto.onLevelLoaded=function(event,data){var config=this.hls.config;data.details.live?this.bwEstimator.update(config.abrEwmaSlowLive,config.abrEwmaFastLive):this.bwEstimator.update(config.abrEwmaSlowVoD,config.abrEwmaFastVoD)},_proto._abandonRulesCheck=function(){var frag=this.fragCurrent,part=this.partCurrent,hls=this.hls,autoLevelEnabled=hls.autoLevelEnabled,config=hls.config,media=hls.media;if(frag&&media){var stats=part?part.stats:frag.stats,duration=part?part.duration:frag.duration;if(stats.aborted)return _utils_logger__WEBPACK_IMPORTED_MODULE_6__.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);if(autoLevelEnabled&&!media.paused&&media.playbackRate&&media.readyState){var requestDelay=performance.now()-stats.loading.start,playbackRate=Math.abs(media.playbackRate);if(!(requestDelay<=500*duration/playbackRate)){var levels=hls.levels,minAutoLevel=hls.minAutoLevel,expectedLen=stats.total||Math.max(stats.loaded,Math.round(duration*levels[frag.level].maxBitrate/8)),loadRate=Math.max(1,stats.bwEstimate?stats.bwEstimate/8:1e3*stats.loaded/requestDelay),fragLoadedDelay=(expectedLen-stats.loaded)/loadRate,pos=media.currentTime,bufferStarvationDelay=(_utils_buffer_helper__WEBPACK_IMPORTED_MODULE_3__.BufferHelper.bufferInfo(media,pos,config.maxBufferHole).end-pos)/playbackRate;if(!(bufferStarvationDelay>=2*duration/playbackRate||fragLoadedDelay<=bufferStarvationDelay)){var nextLoadLevel,fragLevelNextLoadedDelay=Number.POSITIVE_INFINITY;for(nextLoadLevel=frag.level-1;nextLoadLevel>minAutoLevel&&!((fragLevelNextLoadedDelay=duration*levels[nextLoadLevel].maxBitrate/(6.4*loadRate))<bufferStarvationDelay);nextLoadLevel--);if(!(fragLevelNextLoadedDelay>=fragLoadedDelay)){var bwEstimate=this.bwEstimator.getEstimate();_utils_logger__WEBPACK_IMPORTED_MODULE_6__.logger.warn("Fragment "+frag.sn+(part?" part "+part.index:"")+" of level "+frag.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+nextLoadLevel+"\n      Current BW estimate: "+(Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(bwEstimate)?(bwEstimate/1024).toFixed(3):"Unknown")+" Kb/s\n      Estimated load time for current fragment: "+fragLoadedDelay.toFixed(3)+" s\n      Estimated load time for the next fragment: "+fragLevelNextLoadedDelay.toFixed(3)+" s\n      Time to underbuffer: "+bufferStarvationDelay.toFixed(3)+" s"),hls.nextLoadLevel=nextLoadLevel,this.bwEstimator.sample(requestDelay,stats.loaded),this.clearTimer(),frag.loader&&(this.fragCurrent=this.partCurrent=null,frag.loader.abort()),hls.trigger(_events__WEBPACK_IMPORTED_MODULE_2__.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:frag,part:part,stats:stats})}}}}}},_proto.onFragLoaded=function(event,_ref){var frag=_ref.frag,part=_ref.part;if(frag.type===_types_loader__WEBPACK_IMPORTED_MODULE_5__.PlaylistLevelType.MAIN&&Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(frag.sn)){var stats=part?part.stats:frag.stats,duration=part?part.duration:frag.duration;if(this.clearTimer(),this.lastLoadedFragLevel=frag.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var level=this.hls.levels[frag.level],loadedBytes=(level.loaded?level.loaded.bytes:0)+stats.loaded,loadedDuration=(level.loaded?level.loaded.duration:0)+duration;level.loaded={bytes:loadedBytes,duration:loadedDuration},level.realBitrate=Math.round(8*loadedBytes/loadedDuration)}frag.bitrateTest&&(this.onFragBuffered(_events__WEBPACK_IMPORTED_MODULE_2__.Events.FRAG_BUFFERED,{stats:stats,frag:frag,part:part,id:frag.type}),frag.bitrateTest=!1)}},_proto.onFragBuffered=function(event,data){var frag=data.frag,part=data.part,stats=part?part.stats:frag.stats;if(!stats.aborted&&frag.type===_types_loader__WEBPACK_IMPORTED_MODULE_5__.PlaylistLevelType.MAIN&&"initSegment"!==frag.sn){var processingMs=stats.parsing.end-stats.loading.start;this.bwEstimator.sample(processingMs,stats.loaded),stats.bwEstimate=this.bwEstimator.getEstimate(),this.bitrateTestDelay=frag.bitrateTest?processingMs/1e3:0}},_proto.onError=function(event,data){switch(data.details){case _errors__WEBPACK_IMPORTED_MODULE_4__.ErrorDetails.FRAG_LOAD_ERROR:case _errors__WEBPACK_IMPORTED_MODULE_4__.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}},_proto.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},_proto.getNextABRAutoLevel=function(){var fragCurrent=this.fragCurrent,partCurrent=this.partCurrent,hls=this.hls,maxAutoLevel=hls.maxAutoLevel,config=hls.config,minAutoLevel=hls.minAutoLevel,media=hls.media,currentFragDuration=partCurrent?partCurrent.duration:fragCurrent?fragCurrent.duration:0,pos=media?media.currentTime:0,playbackRate=media&&0!==media.playbackRate?Math.abs(media.playbackRate):1,avgbw=this.bwEstimator?this.bwEstimator.getEstimate():config.abrEwmaDefaultEstimate,bufferStarvationDelay=(_utils_buffer_helper__WEBPACK_IMPORTED_MODULE_3__.BufferHelper.bufferInfo(media,pos,config.maxBufferHole).end-pos)/playbackRate,bestLevel=this.findBestLevel(avgbw,minAutoLevel,maxAutoLevel,bufferStarvationDelay,config.abrBandWidthFactor,config.abrBandWidthUpFactor);if(bestLevel>=0)return bestLevel;_utils_logger__WEBPACK_IMPORTED_MODULE_6__.logger.trace((bufferStarvationDelay?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var maxStarvationDelay=currentFragDuration?Math.min(currentFragDuration,config.maxStarvationDelay):config.maxStarvationDelay,bwFactor=config.abrBandWidthFactor,bwUpFactor=config.abrBandWidthUpFactor;if(!bufferStarvationDelay){var bitrateTestDelay=this.bitrateTestDelay;bitrateTestDelay&&(maxStarvationDelay=(currentFragDuration?Math.min(currentFragDuration,config.maxLoadingDelay):config.maxLoadingDelay)-bitrateTestDelay,_utils_logger__WEBPACK_IMPORTED_MODULE_6__.logger.trace("bitrate test took "+Math.round(1e3*bitrateTestDelay)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*maxStarvationDelay)+" ms"),bwFactor=bwUpFactor=1)}return bestLevel=this.findBestLevel(avgbw,minAutoLevel,maxAutoLevel,bufferStarvationDelay+maxStarvationDelay,bwFactor,bwUpFactor),Math.max(bestLevel,0)},_proto.findBestLevel=function(currentBw,minAutoLevel,maxAutoLevel,maxFetchDuration,bwFactor,bwUpFactor){for(var _level$details,fragCurrent=this.fragCurrent,partCurrent=this.partCurrent,currentLevel=this.lastLoadedFragLevel,levels=this.hls.levels,level=levels[currentLevel],live=!(null==level||null===(_level$details=level.details)||void 0===_level$details||!_level$details.live),currentCodecSet=null==level?void 0:level.codecSet,currentFragDuration=partCurrent?partCurrent.duration:fragCurrent?fragCurrent.duration:0,i=maxAutoLevel;i>=minAutoLevel;i--){var levelInfo=levels[i];if(levelInfo&&(!currentCodecSet||levelInfo.codecSet===currentCodecSet)){var adjustedbw,levelDetails=levelInfo.details,avgDuration=(partCurrent?null==levelDetails?void 0:levelDetails.partTarget:null==levelDetails?void 0:levelDetails.averagetargetduration)||currentFragDuration,bitrate=levels[i].maxBitrate,fetchDuration=bitrate*avgDuration/(adjustedbw=i<=currentLevel?bwFactor*currentBw:bwUpFactor*currentBw);if(_utils_logger__WEBPACK_IMPORTED_MODULE_6__.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+i+"/"+Math.round(adjustedbw)+"/"+bitrate+"/"+avgDuration+"/"+maxFetchDuration+"/"+fetchDuration),adjustedbw>bitrate&&(!fetchDuration||live&&!this.bitrateTestDelay||fetchDuration<maxFetchDuration))return i}}return-1},Constructor=AbrController,(protoProps=[{key:"nextAutoLevel",get:function(){var forcedAutoLevel=this._nextAutoLevel,bwEstimator=this.bwEstimator;if(!(-1===forcedAutoLevel||bwEstimator&&bwEstimator.canEstimate()))return forcedAutoLevel;var nextABRAutoLevel=this.getNextABRAutoLevel();return-1!==forcedAutoLevel&&(nextABRAutoLevel=Math.min(forcedAutoLevel,nextABRAutoLevel)),nextABRAutoLevel},set:function(nextLevel){this._nextAutoLevel=nextLevel}}])&&_defineProperties(Constructor.prototype,protoProps),AbrController}()},"./src/controller/audio-stream-controller.ts":
/*!***************************************************!*\
        !*** ./src/controller/audio-stream-controller.ts ***!
        \***************************************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_74620__){"use strict";__nested_webpack_require_74620__.r(__webpack_exports__);var _home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_74620__(
/*! ./src/polyfills/number */
"./src/polyfills/number.ts"),_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_74620__(
/*! ./base-stream-controller */
"./src/controller/base-stream-controller.ts"),_events__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_74620__(
/*! ../events */
"./src/events.ts"),_utils_buffer_helper__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_74620__(
/*! ../utils/buffer-helper */
"./src/utils/buffer-helper.ts"),_fragment_tracker__WEBPACK_IMPORTED_MODULE_4__=__nested_webpack_require_74620__(
/*! ./fragment-tracker */
"./src/controller/fragment-tracker.ts"),_types_level__WEBPACK_IMPORTED_MODULE_5__=__nested_webpack_require_74620__(
/*! ../types/level */
"./src/types/level.ts"),_types_loader__WEBPACK_IMPORTED_MODULE_6__=__nested_webpack_require_74620__(
/*! ../types/loader */
"./src/types/loader.ts"),_loader_fragment__WEBPACK_IMPORTED_MODULE_7__=__nested_webpack_require_74620__(
/*! ../loader/fragment */
"./src/loader/fragment.ts"),_demux_chunk_cache__WEBPACK_IMPORTED_MODULE_8__=__nested_webpack_require_74620__(
/*! ../demux/chunk-cache */
"./src/demux/chunk-cache.ts"),_demux_transmuxer_interface__WEBPACK_IMPORTED_MODULE_9__=__nested_webpack_require_74620__(
/*! ../demux/transmuxer-interface */
"./src/demux/transmuxer-interface.ts"),_types_transmuxer__WEBPACK_IMPORTED_MODULE_10__=__nested_webpack_require_74620__(
/*! ../types/transmuxer */
"./src/types/transmuxer.ts"),_fragment_finders__WEBPACK_IMPORTED_MODULE_11__=__nested_webpack_require_74620__(
/*! ./fragment-finders */
"./src/controller/fragment-finders.ts"),_utils_discontinuities__WEBPACK_IMPORTED_MODULE_12__=__nested_webpack_require_74620__(
/*! ../utils/discontinuities */
"./src/utils/discontinuities.ts"),_errors__WEBPACK_IMPORTED_MODULE_13__=__nested_webpack_require_74620__(
/*! ../errors */
"./src/errors.ts"),_utils_logger__WEBPACK_IMPORTED_MODULE_14__=__nested_webpack_require_74620__(
/*! ../utils/logger */
"./src/utils/logger.ts");function _extends(){return _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}__webpack_exports__.default=function(_BaseStreamController){var subClass,superClass;function AudioStreamController(hls,fragmentTracker){var _this;return(_this=_BaseStreamController.call(this,hls,fragmentTracker,"[audio-stream-controller]")||this).videoBuffer=null,_this.videoTrackCC=-1,_this.waitingVideoCC=-1,_this.audioSwitch=!1,_this.trackId=-1,_this.waitingData=null,_this.mainDetails=null,_this.bufferFlushed=!1,_this._registerListeners(),_this}superClass=_BaseStreamController,(subClass=AudioStreamController).prototype=Object.create(superClass.prototype),subClass.prototype.constructor=subClass,_setPrototypeOf(subClass,superClass);var _proto=AudioStreamController.prototype;return _proto.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},_proto._registerListeners=function(){var hls=this.hls;hls.on(_events__WEBPACK_IMPORTED_MODULE_2__.Events.MEDIA_ATTACHED,this.onMediaAttached,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_2__.Events.MEDIA_DETACHING,this.onMediaDetaching,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_2__.Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_2__.Events.LEVEL_LOADED,this.onLevelLoaded,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_2__.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_2__.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_2__.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_2__.Events.ERROR,this.onError,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_2__.Events.BUFFER_RESET,this.onBufferReset,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_2__.Events.BUFFER_CREATED,this.onBufferCreated,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_2__.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_2__.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_2__.Events.FRAG_BUFFERED,this.onFragBuffered,this)},_proto._unregisterListeners=function(){var hls=this.hls;hls.off(_events__WEBPACK_IMPORTED_MODULE_2__.Events.MEDIA_ATTACHED,this.onMediaAttached,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_2__.Events.MEDIA_DETACHING,this.onMediaDetaching,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_2__.Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_2__.Events.LEVEL_LOADED,this.onLevelLoaded,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_2__.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_2__.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_2__.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_2__.Events.ERROR,this.onError,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_2__.Events.BUFFER_RESET,this.onBufferReset,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_2__.Events.BUFFER_CREATED,this.onBufferCreated,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_2__.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_2__.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_2__.Events.FRAG_BUFFERED,this.onFragBuffered,this)},_proto.onInitPtsFound=function(event,_ref){var frag=_ref.frag,initPTS=_ref.initPTS;if("main"===_ref.id){var cc=frag.cc;this.initPTS[frag.cc]=initPTS,this.log("InitPTS for cc: "+cc+" found from main: "+initPTS),this.videoTrackCC=cc,this.state===_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.WAITING_INIT_PTS&&this.tick()}},_proto.startLoad=function(startPosition){if(!this.levels)return this.startPosition=startPosition,void(this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.STOPPED);var lastCurrentTime=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,lastCurrentTime>0&&-1===startPosition?(this.log("Override startPosition with lastCurrentTime @"+lastCurrentTime.toFixed(3)),this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.IDLE):(this.loadedmetadata=!1,this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=startPosition,this.tick()},_proto.doTick=function(){switch(this.state){case _base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.IDLE:this.doTickIdle();break;case _base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.WAITING_TRACK:var _levels$trackId,levels=this.levels,details=null==levels||null===(_levels$trackId=levels[this.trackId])||void 0===_levels$trackId?void 0:_levels$trackId.details;if(details){if(this.waitForCdnTuneIn(details))break;this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.WAITING_INIT_PTS}break;case _base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.FRAG_LOADING_WAITING_RETRY:var _this$media,now=performance.now(),retryDate=this.retryDate;(!retryDate||now>=retryDate||null!==(_this$media=this.media)&&void 0!==_this$media&&_this$media.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.IDLE);break;case _base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.WAITING_INIT_PTS:var waitingData=this.waitingData;if(waitingData){var frag=waitingData.frag,part=waitingData.part,cache=waitingData.cache,complete=waitingData.complete;if(void 0!==this.initPTS[frag.cc]){this.waitingData=null,this.waitingVideoCC=-1,this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.FRAG_LOADING;var data={frag:frag,part:part,payload:cache.flush(),networkDetails:null};this._handleFragmentLoadProgress(data),complete&&_BaseStreamController.prototype._handleFragmentLoadComplete.call(this,data)}else if(this.videoTrackCC!==this.waitingVideoCC)_utils_logger__WEBPACK_IMPORTED_MODULE_14__.logger.log("Waiting fragment cc ("+frag.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var pos=this.getLoadPosition(),bufferInfo=_utils_buffer_helper__WEBPACK_IMPORTED_MODULE_3__.BufferHelper.bufferInfo(this.mediaBuffer,pos,this.config.maxBufferHole);Object(_fragment_finders__WEBPACK_IMPORTED_MODULE_11__.fragmentWithinToleranceTest)(bufferInfo.end,this.config.maxFragLookUpTolerance,frag)<0&&(_utils_logger__WEBPACK_IMPORTED_MODULE_14__.logger.log("Waiting fragment cc ("+frag.cc+") @ "+frag.start+" cancelled because another fragment at "+bufferInfo.end+" is needed"),this.clearWaitingFragment())}}else this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.IDLE}this.onTickEnd()},_proto.clearWaitingFragment=function(){var waitingData=this.waitingData;waitingData&&(this.fragmentTracker.removeFragment(waitingData.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.IDLE)},_proto.onTickEnd=function(){var media=this.media;media&&media.readyState&&(!this.loadedmetadata&&(this.mediaBuffer?this.mediaBuffer:media).buffered.length&&(this.loadedmetadata=!0),this.lastCurrentTime=media.currentTime)},_proto.doTickIdle=function(){var _frag$decryptdata,_frag$decryptdata2,hls=this.hls,levels=this.levels,media=this.media,trackId=this.trackId;if(levels&&levels[trackId]&&(media||!this.startFragRequested&&hls.config.startFragPrefetch)){var trackDetails=levels[trackId].details;if(!trackDetails||trackDetails.live&&this.levelLastLoaded!==trackId||this.waitForCdnTuneIn(trackDetails))this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.WAITING_TRACK;else{this.bufferFlushed&&(this.bufferFlushed=!1,this.afterBufferFlushed(this.mediaBuffer?this.mediaBuffer:this.media,_loader_fragment__WEBPACK_IMPORTED_MODULE_7__.ElementaryStreamTypes.AUDIO,_types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistLevelType.AUDIO));var bufferInfo=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,_types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistLevelType.AUDIO);if(null!==bufferInfo){var bufferLen=bufferInfo.len,maxBufLen=this.getMaxBufferLength(),audioSwitch=this.audioSwitch;if(!(bufferLen>=maxBufLen)||audioSwitch){if(!audioSwitch&&this._streamEnded(bufferInfo,trackDetails))return hls.trigger(_events__WEBPACK_IMPORTED_MODULE_2__.Events.BUFFER_EOS,{type:"audio"}),void(this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.ENDED);var start=trackDetails.fragments[0].start,targetBufferTime=bufferInfo.end;if(audioSwitch){var pos=this.getLoadPosition();targetBufferTime=pos,trackDetails.PTSKnown&&pos<start&&(bufferInfo.end>start||bufferInfo.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),media.currentTime=start+.05)}var frag=this.getNextFragment(targetBufferTime,trackDetails);frag?"identity"!==(null===(_frag$decryptdata=frag.decryptdata)||void 0===_frag$decryptdata?void 0:_frag$decryptdata.keyFormat)||null!==(_frag$decryptdata2=frag.decryptdata)&&void 0!==_frag$decryptdata2&&_frag$decryptdata2.key?this.loadFragment(frag,trackDetails,targetBufferTime):this.loadKey(frag,trackDetails):this.bufferFlushed=!0}}}}},_proto.getMaxBufferLength=function(){var maxConfigBuffer=_BaseStreamController.prototype.getMaxBufferLength.call(this),mainBufferInfo=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,_types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistLevelType.MAIN);return null===mainBufferInfo?maxConfigBuffer:Math.max(maxConfigBuffer,mainBufferInfo.len)},_proto.onMediaDetaching=function(){this.videoBuffer=null,_BaseStreamController.prototype.onMediaDetaching.call(this)},_proto.onAudioTracksUpdated=function(event,_ref2){var audioTracks=_ref2.audioTracks;this.resetTransmuxer(),this.levels=audioTracks.map(function(mediaPlaylist){return new _types_level__WEBPACK_IMPORTED_MODULE_5__.Level(mediaPlaylist)})},_proto.onAudioTrackSwitching=function(event,data){var altAudio=!!data.url;this.trackId=data.id;var fragCurrent=this.fragCurrent;null!=fragCurrent&&fragCurrent.loader&&fragCurrent.loader.abort(),this.fragCurrent=null,this.clearWaitingFragment(),altAudio?this.setInterval(100):this.resetTransmuxer(),altAudio?(this.audioSwitch=!0,this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.IDLE):this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.STOPPED,this.tick()},_proto.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1},_proto.onLevelLoaded=function(event,data){this.mainDetails=data.details},_proto.onAudioTrackLoaded=function(event,data){var _track$details,levels=this.levels,newDetails=data.details,trackId=data.id;if(levels){this.log("Track "+trackId+" loaded ["+newDetails.startSN+","+newDetails.endSN+"],duration:"+newDetails.totalduration);var track=levels[trackId],sliding=0;if(newDetails.live||null!==(_track$details=track.details)&&void 0!==_track$details&&_track$details.live){var mainDetails=this.mainDetails;if(newDetails.fragments[0]||(newDetails.deltaUpdateFailed=!0),newDetails.deltaUpdateFailed||!mainDetails)return;!track.details&&newDetails.hasProgramDateTime&&mainDetails.hasProgramDateTime?(Object(_utils_discontinuities__WEBPACK_IMPORTED_MODULE_12__.alignMediaPlaylistByPDT)(newDetails,mainDetails),sliding=newDetails.fragments[0].start):sliding=this.alignPlaylists(newDetails,track.details)}track.details=newDetails,this.levelLastLoaded=trackId,this.startFragRequested||!this.mainDetails&&newDetails.live||this.setStartPosition(track.details,sliding),this.state!==_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.WAITING_TRACK||this.waitForCdnTuneIn(newDetails)||(this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.IDLE),this.tick()}else this.warn("Audio tracks were reset while loading level "+trackId)},_proto._handleFragmentLoadProgress=function(data){var _frag$initSegment,frag=data.frag,part=data.part,payload=data.payload,config=this.config,trackId=this.trackId,levels=this.levels;if(levels){var track=levels[trackId];console.assert(track,"Audio track is defined on fragment load progress");var details=track.details;console.assert(details,"Audio track details are defined on fragment load progress");var audioCodec=config.defaultAudioCodec||track.audioCodec||"mp4a.40.2",transmuxer=this.transmuxer;transmuxer||(transmuxer=this.transmuxer=new _demux_transmuxer_interface__WEBPACK_IMPORTED_MODULE_9__.default(this.hls,_types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var initPTS=this.initPTS[frag.cc],initSegmentData=null===(_frag$initSegment=frag.initSegment)||void 0===_frag$initSegment?void 0:_frag$initSegment.data;if(void 0!==initPTS){var partIndex=part?part.index:-1,chunkMeta=new _types_transmuxer__WEBPACK_IMPORTED_MODULE_10__.ChunkMetadata(frag.level,frag.sn,frag.stats.chunkCount,payload.byteLength,partIndex,-1!==partIndex);transmuxer.push(payload,initSegmentData,audioCodec,"",frag,part,details.totalduration,!1,chunkMeta,initPTS)}else _utils_logger__WEBPACK_IMPORTED_MODULE_14__.logger.log("Unknown video PTS for cc "+frag.cc+", waiting for video PTS before demuxing audio frag "+frag.sn+" of ["+details.startSN+" ,"+details.endSN+"],track "+trackId),(this.waitingData=this.waitingData||{frag:frag,part:part,cache:new _demux_chunk_cache__WEBPACK_IMPORTED_MODULE_8__.default,complete:!1}).cache.push(new Uint8Array(payload)),this.waitingVideoCC=this.videoTrackCC,this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.WAITING_INIT_PTS}else this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+frag.sn+" of level "+frag.level+" will not be buffered")},_proto._handleFragmentLoadComplete=function(fragLoadedData){this.waitingData?this.waitingData.complete=!0:_BaseStreamController.prototype._handleFragmentLoadComplete.call(this,fragLoadedData)},_proto.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},_proto.onBufferCreated=function(event,data){var audioTrack=data.tracks.audio;audioTrack&&(this.mediaBuffer=audioTrack.buffer),data.tracks.video&&(this.videoBuffer=data.tracks.video.buffer)},_proto.onFragBuffered=function(event,data){var frag=data.frag,part=data.part;frag.type===_types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistLevelType.AUDIO&&(this.fragContextChanged(frag)?this.warn("Fragment "+frag.sn+(part?" p: "+part.index:"")+" of level "+frag.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch):("initSegment"!==frag.sn&&(this.fragPrevious=frag,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_2__.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(frag,part)))},_proto.onError=function(event,data){switch(data.details){case _errors__WEBPACK_IMPORTED_MODULE_13__.ErrorDetails.FRAG_LOAD_ERROR:case _errors__WEBPACK_IMPORTED_MODULE_13__.ErrorDetails.FRAG_LOAD_TIMEOUT:case _errors__WEBPACK_IMPORTED_MODULE_13__.ErrorDetails.KEY_LOAD_ERROR:case _errors__WEBPACK_IMPORTED_MODULE_13__.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(_types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistLevelType.AUDIO,data);break;case _errors__WEBPACK_IMPORTED_MODULE_13__.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case _errors__WEBPACK_IMPORTED_MODULE_13__.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.ERROR&&this.state!==_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.STOPPED&&(this.state=data.fatal?_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.ERROR:_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.IDLE,this.warn(data.details+" while loading frag, switching to "+this.state+" state"));break;case _errors__WEBPACK_IMPORTED_MODULE_13__.ErrorDetails.BUFFER_FULL_ERROR:if("audio"===data.parent&&(this.state===_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.PARSING||this.state===_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.PARSED)){var flushBuffer=!0,bufferedInfo=this.getFwdBufferInfo(this.mediaBuffer,_types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistLevelType.AUDIO);bufferedInfo&&bufferedInfo.len>.5&&(flushBuffer=!this.reduceMaxBufferLength(bufferedInfo.len)),flushBuffer&&(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,_BaseStreamController.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.resetLoadingState()}}},_proto.onBufferFlushed=function(event,_ref3){_ref3.type===_loader_fragment__WEBPACK_IMPORTED_MODULE_7__.ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0)},_proto._handleTransmuxComplete=function(transmuxResult){var _id3$samples,id="audio",hls=this.hls,remuxResult=transmuxResult.remuxResult,chunkMeta=transmuxResult.chunkMeta,context=this.getCurrentContext(chunkMeta);if(!context)return this.warn("The loading context changed while buffering fragment "+chunkMeta.sn+" of level "+chunkMeta.level+". This chunk will not be buffered."),void this.resetLiveStartWhenNotLoaded(chunkMeta.level);var frag=context.frag,part=context.part,audio=remuxResult.audio,text=remuxResult.text,id3=remuxResult.id3,initSegment=remuxResult.initSegment;if(!this.fragContextChanged(frag)){if(this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.PARSING,this.audioSwitch&&audio&&this.completeAudioSwitch(),null!=initSegment&&initSegment.tracks&&(this._bufferInitSegment(initSegment.tracks,frag,chunkMeta),hls.trigger(_events__WEBPACK_IMPORTED_MODULE_2__.Events.FRAG_PARSING_INIT_SEGMENT,{frag:frag,id:id,tracks:initSegment.tracks})),audio){var startPTS=audio.startPTS,endPTS=audio.endPTS,startDTS=audio.startDTS,endDTS=audio.endDTS;part&&(part.elementaryStreams[_loader_fragment__WEBPACK_IMPORTED_MODULE_7__.ElementaryStreamTypes.AUDIO]={startPTS:startPTS,endPTS:endPTS,startDTS:startDTS,endDTS:endDTS}),frag.setElementaryStreamInfo(_loader_fragment__WEBPACK_IMPORTED_MODULE_7__.ElementaryStreamTypes.AUDIO,startPTS,endPTS,startDTS,endDTS),this.bufferFragmentData(audio,frag,part,chunkMeta)}if(null!=id3&&null!==(_id3$samples=id3.samples)&&void 0!==_id3$samples&&_id3$samples.length){var emittedID3=_extends({frag:frag,id:id},id3);hls.trigger(_events__WEBPACK_IMPORTED_MODULE_2__.Events.FRAG_PARSING_METADATA,emittedID3)}if(text){var emittedText=_extends({frag:frag,id:id},text);hls.trigger(_events__WEBPACK_IMPORTED_MODULE_2__.Events.FRAG_PARSING_USERDATA,emittedText)}}},_proto._bufferInitSegment=function(tracks,frag,chunkMeta){if(this.state===_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.PARSING){tracks.video&&delete tracks.video;var track=tracks.audio;if(track){track.levelCodec=track.codec,track.id="audio",this.log("Init audio buffer, container:"+track.container+", codecs[parsed]=["+track.codec+"]"),this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_2__.Events.BUFFER_CODECS,tracks);var initSegment=track.initSegment;null!=initSegment&&initSegment.byteLength&&this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_2__.Events.BUFFER_APPENDING,{type:"audio",frag:frag,part:null,chunkMeta:chunkMeta,parent:frag.type,data:initSegment}),this.tick()}}},_proto.loadFragment=function(frag,trackDetails,targetBufferTime){var fragState=this.fragmentTracker.getState(frag);this.fragCurrent=frag,(this.audioSwitch||fragState===_fragment_tracker__WEBPACK_IMPORTED_MODULE_4__.FragmentState.NOT_LOADED||fragState===_fragment_tracker__WEBPACK_IMPORTED_MODULE_4__.FragmentState.PARTIAL)&&("initSegment"===frag.sn?this._loadInitSegment(frag):trackDetails.live&&!Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(this.initPTS[frag.cc])?(this.log("Waiting for video PTS in continuity counter "+frag.cc+" of live stream before loading audio fragment "+frag.sn+" of level "+this.trackId),this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.WAITING_INIT_PTS):(this.startFragRequested=!0,_BaseStreamController.prototype.loadFragment.call(this,frag,trackDetails,targetBufferTime)))},_proto.completeAudioSwitch=function(){var hls=this.hls,trackId=this.trackId;this.media&&(this.log("Switching audio track : flushing all audio"),_BaseStreamController.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.audioSwitch=!1,hls.trigger(_events__WEBPACK_IMPORTED_MODULE_2__.Events.AUDIO_TRACK_SWITCHED,{id:trackId})},AudioStreamController}(_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.default)},"./src/controller/audio-track-controller.ts":
/*!**************************************************!*\
        !*** ./src/controller/audio-track-controller.ts ***!
        \**************************************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_115382__){"use strict";__nested_webpack_require_115382__.r(__webpack_exports__);var _events__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_115382__(
/*! ../events */
"./src/events.ts"),_errors__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_115382__(
/*! ../errors */
"./src/errors.ts"),_base_playlist_controller__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_115382__(
/*! ./base-playlist-controller */
"./src/controller/base-playlist-controller.ts"),_types_loader__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_115382__(
/*! ../types/loader */
"./src/types/loader.ts");function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}__webpack_exports__.default=function(_BasePlaylistControll){var subClass,superClass;function AudioTrackController(hls){var _this;return(_this=_BasePlaylistControll.call(this,hls,"[audio-track-controller]")||this).tracks=[],_this.groupId=null,_this.tracksInGroup=[],_this.trackId=-1,_this.trackName="",_this.selectDefaultTrack=!0,_this.registerListeners(),_this}superClass=_BasePlaylistControll,(subClass=AudioTrackController).prototype=Object.create(superClass.prototype),subClass.prototype.constructor=subClass,_setPrototypeOf(subClass,superClass);var Constructor,protoProps,_proto=AudioTrackController.prototype;return _proto.registerListeners=function(){var hls=this.hls;hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MANIFEST_PARSED,this.onManifestParsed,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.LEVEL_LOADING,this.onLevelLoading,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.ERROR,this.onError,this)},_proto.unregisterListeners=function(){var hls=this.hls;hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MANIFEST_PARSED,this.onManifestParsed,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.LEVEL_LOADING,this.onLevelLoading,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.ERROR,this.onError,this)},_proto.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,_BasePlaylistControll.prototype.destroy.call(this)},_proto.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.trackName="",this.selectDefaultTrack=!0},_proto.onManifestParsed=function(event,data){this.tracks=data.audioTracks||[]},_proto.onAudioTrackLoaded=function(event,data){var id=data.id,details=data.details,currentTrack=this.tracksInGroup[id];if(currentTrack){var curDetails=currentTrack.details;currentTrack.details=data.details,this.log("audioTrack "+id+" loaded ["+details.startSN+"-"+details.endSN+"]"),id===this.trackId&&(this.retryCount=0,this.playlistLoaded(id,data,curDetails))}else this.warn("Invalid audio track id "+id)},_proto.onLevelLoading=function(event,data){this.switchLevel(data.level)},_proto.onLevelSwitching=function(event,data){this.switchLevel(data.level)},_proto.switchLevel=function(levelIndex){var levelInfo=this.hls.levels[levelIndex];if(null!=levelInfo&&levelInfo.audioGroupIds){var audioGroupId=levelInfo.audioGroupIds[levelInfo.urlId];if(this.groupId!==audioGroupId){this.groupId=audioGroupId;var audioTracks=this.tracks.filter(function(track){return!audioGroupId||track.groupId===audioGroupId});this.selectDefaultTrack&&!audioTracks.some(function(track){return track.default})&&(this.selectDefaultTrack=!1),this.tracksInGroup=audioTracks;var audioTracksUpdated={audioTracks:audioTracks};this.log("Updating audio tracks, "+audioTracks.length+' track(s) found in "'+audioGroupId+'" group-id'),this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_0__.Events.AUDIO_TRACKS_UPDATED,audioTracksUpdated),this.selectInitialTrack()}}},_proto.onError=function(event,data){_BasePlaylistControll.prototype.onError.call(this,event,data),!data.fatal&&data.context&&data.context.type===_types_loader__WEBPACK_IMPORTED_MODULE_3__.PlaylistContextType.AUDIO_TRACK&&data.context.id===this.trackId&&data.context.groupId===this.groupId&&this.retryLoadingOrFail(data)},_proto.setAudioTrack=function(newId){var tracks=this.tracksInGroup;if(newId<0||newId>=tracks.length)this.warn("Invalid id passed to audio-track controller");else{this.clearTimer();var lastTrack=tracks[this.trackId];this.log("Now switching to audio-track index "+newId);var track=tracks[newId],id=track.id,_track$groupId=track.groupId,groupId=void 0===_track$groupId?"":_track$groupId,name=track.name,type=track.type,url=track.url;if(this.trackId=newId,this.trackName=name,this.selectDefaultTrack=!1,this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_0__.Events.AUDIO_TRACK_SWITCHING,{id:id,groupId:groupId,name:name,type:type,url:url}),!track.details||track.details.live){var hlsUrlParameters=this.switchParams(track.url,null==lastTrack?void 0:lastTrack.details);this.loadPlaylist(hlsUrlParameters)}}},_proto.selectInitialTrack=function(){console.assert(this.tracksInGroup.length,"Initial audio track should be selected when tracks are known");var trackId=this.findTrackId(this.trackName)||this.findTrackId();-1!==trackId?this.setAudioTrack(trackId):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_0__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorTypes.MEDIA_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},_proto.findTrackId=function(name){for(var audioTracks=this.tracksInGroup,i=0;i<audioTracks.length;i++){var track=audioTracks[i];if((!this.selectDefaultTrack||track.default)&&(!name||name===track.name))return track.id}return-1},_proto.loadPlaylist=function(hlsUrlParameters){var audioTrack=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(audioTrack)){var id=audioTrack.id,groupId=audioTrack.groupId,url=audioTrack.url;if(hlsUrlParameters)try{url=hlsUrlParameters.addDirectives(url)}catch(error){this.warn("Could not construct new URL with HLS Delivery Directives: "+error)}this.log("loading audio-track playlist for id: "+id),this.clearTimer(),this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_0__.Events.AUDIO_TRACK_LOADING,{url:url,id:id,groupId:groupId,deliveryDirectives:hlsUrlParameters||null})}},Constructor=AudioTrackController,(protoProps=[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(newId){this.selectDefaultTrack=!1,this.setAudioTrack(newId)}}])&&_defineProperties(Constructor.prototype,protoProps),AudioTrackController}(_base_playlist_controller__WEBPACK_IMPORTED_MODULE_2__.default)},"./src/controller/base-playlist-controller.ts":
/*!****************************************************!*\
        !*** ./src/controller/base-playlist-controller.ts ***!
        \****************************************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_128125__){"use strict";__nested_webpack_require_128125__.r(__webpack_exports__),__nested_webpack_require_128125__.d(__webpack_exports__,"default",function(){return BasePlaylistController});var _home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_128125__(
/*! ./src/polyfills/number */
"./src/polyfills/number.ts"),_types_level__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_128125__(
/*! ../types/level */
"./src/types/level.ts"),_level_helper__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_128125__(
/*! ./level-helper */
"./src/controller/level-helper.ts"),_utils_logger__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_128125__(
/*! ../utils/logger */
"./src/utils/logger.ts"),_errors__WEBPACK_IMPORTED_MODULE_4__=__nested_webpack_require_128125__(
/*! ../errors */
"./src/errors.ts"),BasePlaylistController=function(){function BasePlaylistController(hls,logPrefix){this.hls=void 0,this.timer=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=_utils_logger__WEBPACK_IMPORTED_MODULE_3__.logger.log.bind(_utils_logger__WEBPACK_IMPORTED_MODULE_3__.logger,logPrefix+":"),this.warn=_utils_logger__WEBPACK_IMPORTED_MODULE_3__.logger.warn.bind(_utils_logger__WEBPACK_IMPORTED_MODULE_3__.logger,logPrefix+":"),this.hls=hls}var _proto=BasePlaylistController.prototype;return _proto.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},_proto.onError=function(event,data){data.fatal&&data.type===_errors__WEBPACK_IMPORTED_MODULE_4__.ErrorTypes.NETWORK_ERROR&&this.clearTimer()},_proto.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},_proto.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.loadPlaylist()},_proto.stopLoad=function(){this.canLoad=!1,this.clearTimer()},_proto.switchParams=function(playlistUri,previous){var renditionReports=null==previous?void 0:previous.renditionReports;if(renditionReports)for(var i=0;i<renditionReports.length;i++){var attr=renditionReports[i],uri=""+attr.URI;if(uri===playlistUri.substr(-uri.length)){var msn=parseInt(attr["LAST-MSN"]),part=parseInt(attr["LAST-PART"]);if(previous&&this.hls.config.lowLatencyMode){var currentGoal=Math.min(previous.age-previous.partTarget,previous.targetduration);void 0!==part&&currentGoal>previous.partTarget&&(part+=1)}if(Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(msn))return new _types_level__WEBPACK_IMPORTED_MODULE_1__.HlsUrlParameters(msn,Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(part)?part:void 0,_types_level__WEBPACK_IMPORTED_MODULE_1__.HlsSkip.No)}}},_proto.loadPlaylist=function(hlsUrlParameters){},_proto.shouldLoadTrack=function(track){return this.canLoad&&track&&!!track.url&&(!track.details||track.details.live)},_proto.playlistLoaded=function(index,data,previousDetails){var _this=this,details=data.details,stats=data.stats,elapsed=stats.loading.end?Math.max(0,self.performance.now()-stats.loading.end):0;if(details.advancedDateTime=Date.now()-elapsed,details.live||null!=previousDetails&&previousDetails.live){if(details.reloaded(previousDetails),previousDetails&&this.log("live playlist "+index+" "+(details.advanced?"REFRESHED "+details.lastPartSn+"-"+details.lastPartIndex:"MISSED")),previousDetails&&details.fragments.length>0&&Object(_level_helper__WEBPACK_IMPORTED_MODULE_2__.mergeDetails)(previousDetails,details),!this.canLoad||!details.live)return;var deliveryDirectives,msn=void 0,part=void 0;if(details.canBlockReload&&details.endSN&&details.advanced){var lowLatencyMode=this.hls.config.lowLatencyMode,lastPartSn=details.lastPartSn,endSn=details.endSN,lastPartIndex=details.lastPartIndex,lastPart=lastPartSn===endSn;-1!==lastPartIndex?(msn=lastPart?endSn+1:lastPartSn,part=lastPart?lowLatencyMode?0:lastPartIndex:lastPartIndex+1):msn=endSn+1;var lastAdvanced=details.age,currentGoal=Math.min(lastAdvanced+details.ageHeader-details.partTarget,1.5*details.targetduration);if(currentGoal>0){if(previousDetails&&currentGoal>previousDetails.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+previousDetails.tuneInGoal+" to: "+currentGoal+" with playlist age: "+details.age),currentGoal=0;else{var segments=Math.floor(currentGoal/details.targetduration);msn+=segments,void 0!==part&&(part+=Math.round(currentGoal%details.targetduration/details.partTarget)),this.log("CDN Tune-in age: "+details.ageHeader+"s last advanced "+lastAdvanced.toFixed(2)+"s goal: "+currentGoal+" skip sn "+segments+" to part "+part)}details.tuneInGoal=currentGoal}if(deliveryDirectives=this.getDeliveryDirectives(details,data.deliveryDirectives,msn,part),lowLatencyMode||!lastPart)return void this.loadPlaylist(deliveryDirectives)}else deliveryDirectives=this.getDeliveryDirectives(details,data.deliveryDirectives,msn,part);var reloadInterval=Object(_level_helper__WEBPACK_IMPORTED_MODULE_2__.computeReloadInterval)(details,stats);void 0!==msn&&details.canBlockReload&&(reloadInterval-=details.partTarget||1),this.log("reload live playlist "+index+" in "+Math.round(reloadInterval)+" ms"),this.timer=self.setTimeout(function(){return _this.loadPlaylist(deliveryDirectives)},reloadInterval)}else this.clearTimer()},_proto.getDeliveryDirectives=function(details,previousDeliveryDirectives,msn,part){var skip=Object(_types_level__WEBPACK_IMPORTED_MODULE_1__.getSkipValue)(details,msn);return null!=previousDeliveryDirectives&&previousDeliveryDirectives.skip&&details.deltaUpdateFailed&&(msn=previousDeliveryDirectives.msn,part=previousDeliveryDirectives.part,skip=_types_level__WEBPACK_IMPORTED_MODULE_1__.HlsSkip.No),new _types_level__WEBPACK_IMPORTED_MODULE_1__.HlsUrlParameters(msn,part,skip)},_proto.retryLoadingOrFail=function(errorEvent){var _errorEvent$context,_this2=this,config=this.hls.config,retry=this.retryCount<config.levelLoadingMaxRetry;if(retry)if(this.retryCount++,errorEvent.details.indexOf("LoadTimeOut")>-1&&null!==(_errorEvent$context=errorEvent.context)&&void 0!==_errorEvent$context&&_errorEvent$context.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+errorEvent.details+'"'),this.loadPlaylist();else{var delay=Math.min(Math.pow(2,this.retryCount)*config.levelLoadingRetryDelay,config.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout(function(){return _this2.loadPlaylist()},delay),this.warn("retry playlist loading #"+this.retryCount+" in "+delay+' ms after "'+errorEvent.details+'"')}else this.warn('cannot recover from error "'+errorEvent.details+'"'),this.clearTimer(),errorEvent.fatal=!0;return retry},BasePlaylistController}()},"./src/controller/base-stream-controller.ts":
/*!**************************************************!*\
        !*** ./src/controller/base-stream-controller.ts ***!
        \**************************************************/
/*! exports provided: State, default */
function(module,__webpack_exports__,__nested_webpack_require_140136__){"use strict";__nested_webpack_require_140136__.r(__webpack_exports__),__nested_webpack_require_140136__.d(__webpack_exports__,"State",function(){return State}),__nested_webpack_require_140136__.d(__webpack_exports__,"default",function(){return BaseStreamController});var _home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_140136__(
/*! ./src/polyfills/number */
"./src/polyfills/number.ts"),_task_loop__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_140136__(
/*! ../task-loop */
"./src/task-loop.ts"),_fragment_tracker__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_140136__(
/*! ./fragment-tracker */
"./src/controller/fragment-tracker.ts"),_utils_buffer_helper__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_140136__(
/*! ../utils/buffer-helper */
"./src/utils/buffer-helper.ts"),_utils_logger__WEBPACK_IMPORTED_MODULE_4__=__nested_webpack_require_140136__(
/*! ../utils/logger */
"./src/utils/logger.ts"),_events__WEBPACK_IMPORTED_MODULE_5__=__nested_webpack_require_140136__(
/*! ../events */
"./src/events.ts"),_errors__WEBPACK_IMPORTED_MODULE_6__=__nested_webpack_require_140136__(
/*! ../errors */
"./src/errors.ts"),_types_transmuxer__WEBPACK_IMPORTED_MODULE_7__=__nested_webpack_require_140136__(
/*! ../types/transmuxer */
"./src/types/transmuxer.ts"),_utils_mp4_tools__WEBPACK_IMPORTED_MODULE_8__=__nested_webpack_require_140136__(
/*! ../utils/mp4-tools */
"./src/utils/mp4-tools.ts"),_utils_discontinuities__WEBPACK_IMPORTED_MODULE_9__=__nested_webpack_require_140136__(
/*! ../utils/discontinuities */
"./src/utils/discontinuities.ts"),_fragment_finders__WEBPACK_IMPORTED_MODULE_10__=__nested_webpack_require_140136__(
/*! ./fragment-finders */
"./src/controller/fragment-finders.ts"),_level_helper__WEBPACK_IMPORTED_MODULE_11__=__nested_webpack_require_140136__(
/*! ./level-helper */
"./src/controller/level-helper.ts"),_loader_fragment_loader__WEBPACK_IMPORTED_MODULE_12__=__nested_webpack_require_140136__(
/*! ../loader/fragment-loader */
"./src/loader/fragment-loader.ts"),_crypt_decrypter__WEBPACK_IMPORTED_MODULE_13__=__nested_webpack_require_140136__(
/*! ../crypt/decrypter */
"./src/crypt/decrypter.ts"),_utils_time_ranges__WEBPACK_IMPORTED_MODULE_14__=__nested_webpack_require_140136__(
/*! ../utils/time-ranges */
"./src/utils/time-ranges.ts"),_types_loader__WEBPACK_IMPORTED_MODULE_15__=__nested_webpack_require_140136__(
/*! ../types/loader */
"./src/types/loader.ts");function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}var State={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BACKTRACKING:"BACKTRACKING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},BaseStreamController=function(_TaskLoop){var subClass,superClass;function BaseStreamController(hls,fragmentTracker,logPrefix){var _this;return(_this=_TaskLoop.call(this)||this).hls=void 0,_this.fragPrevious=null,_this.fragCurrent=null,_this.fragmentTracker=void 0,_this.transmuxer=null,_this._state=State.STOPPED,_this.media=void 0,_this.mediaBuffer=void 0,_this.config=void 0,_this.bitrateTest=!1,_this.lastCurrentTime=0,_this.nextLoadPosition=0,_this.startPosition=0,_this.loadedmetadata=!1,_this.fragLoadError=0,_this.retryDate=0,_this.levels=null,_this.fragmentLoader=void 0,_this.levelLastLoaded=null,_this.startFragRequested=!1,_this.decrypter=void 0,_this.initPTS=[],_this.onvseeking=null,_this.onvended=null,_this.logPrefix="",_this.log=void 0,_this.warn=void 0,_this.logPrefix=logPrefix,_this.log=_utils_logger__WEBPACK_IMPORTED_MODULE_4__.logger.log.bind(_utils_logger__WEBPACK_IMPORTED_MODULE_4__.logger,logPrefix+":"),_this.warn=_utils_logger__WEBPACK_IMPORTED_MODULE_4__.logger.warn.bind(_utils_logger__WEBPACK_IMPORTED_MODULE_4__.logger,logPrefix+":"),_this.hls=hls,_this.fragmentLoader=new _loader_fragment_loader__WEBPACK_IMPORTED_MODULE_12__.default(hls.config),_this.fragmentTracker=fragmentTracker,_this.config=hls.config,_this.decrypter=new _crypt_decrypter__WEBPACK_IMPORTED_MODULE_13__.default(hls,hls.config),hls.on(_events__WEBPACK_IMPORTED_MODULE_5__.Events.KEY_LOADED,_this.onKeyLoaded,function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(_this)),_this}superClass=_TaskLoop,(subClass=BaseStreamController).prototype=Object.create(superClass.prototype),subClass.prototype.constructor=subClass,_setPrototypeOf(subClass,superClass);var Constructor,protoProps,_proto=BaseStreamController.prototype;return _proto.doTick=function(){this.onTickEnd()},_proto.onTickEnd=function(){},_proto.startLoad=function(startPosition){},_proto.stopLoad=function(){this.fragmentLoader.abort();var frag=this.fragCurrent;frag&&this.fragmentTracker.removeFragment(frag),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=State.STOPPED},_proto._streamEnded=function(bufferInfo,levelDetails){var fragCurrent=this.fragCurrent;if(!levelDetails.live&&fragCurrent&&fragCurrent.sn===levelDetails.endSN&&!bufferInfo.nextStart){var fragState=this.fragmentTracker.getState(fragCurrent);return fragState===_fragment_tracker__WEBPACK_IMPORTED_MODULE_2__.FragmentState.PARTIAL||fragState===_fragment_tracker__WEBPACK_IMPORTED_MODULE_2__.FragmentState.OK}return!1},_proto.onMediaAttached=function(event,data){var media=this.media=this.mediaBuffer=data.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),media.addEventListener("seeking",this.onvseeking),media.addEventListener("ended",this.onvended);var config=this.config;this.levels&&config.autoStartLoad&&this.state===State.STOPPED&&this.startLoad(config.startPosition)},_proto.onMediaDetaching=function(){var media=this.media;null!=media&&media.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),media&&(media.removeEventListener("seeking",this.onvseeking),media.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},_proto.onMediaSeeking=function(){var config=this.config,fragCurrent=this.fragCurrent,media=this.media,state=this.state,currentTime=media?media.currentTime:0,bufferInfo=_utils_buffer_helper__WEBPACK_IMPORTED_MODULE_3__.BufferHelper.bufferInfo(this.mediaBuffer||media,currentTime,config.maxBufferHole);if(this.log("media seeking to "+(Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(currentTime)?currentTime.toFixed(3):currentTime)+", state: "+state),state===State.ENDED)this.resetLoadingState();else if(fragCurrent&&!bufferInfo.len){var tolerance=config.maxFragLookUpTolerance,pastFragment=currentTime>fragCurrent.start+fragCurrent.duration+tolerance;(currentTime<fragCurrent.start-tolerance||pastFragment)&&(pastFragment&&fragCurrent.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),fragCurrent.loader.abort()),this.resetLoadingState())}media&&(this.lastCurrentTime=currentTime),this.loadedmetadata||bufferInfo.len||(this.nextLoadPosition=this.startPosition=currentTime),this.tickImmediate()},_proto.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},_proto.onKeyLoaded=function(event,data){if(this.state===State.KEY_LOADING&&data.frag===this.fragCurrent&&this.levels){this.state=State.IDLE;var levelDetails=this.levels[data.frag.level].details;levelDetails&&this.loadFragment(data.frag,levelDetails,data.frag.start)}},_proto.onHandlerDestroying=function(){this.stopLoad(),_TaskLoop.prototype.onHandlerDestroying.call(this)},_proto.onHandlerDestroyed=function(){this.state=State.STOPPED,this.hls.off(_events__WEBPACK_IMPORTED_MODULE_5__.Events.KEY_LOADED,this.onKeyLoaded,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.fragmentLoader=this.fragmentTracker=null,_TaskLoop.prototype.onHandlerDestroyed.call(this)},_proto.loadKey=function(frag,details){this.log("Loading key for "+frag.sn+" of ["+details.startSN+"-"+details.endSN+"], "+("[stream-controller]"===this.logPrefix?"level":"track")+" "+frag.level),this.state=State.KEY_LOADING,this.fragCurrent=frag,this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_5__.Events.KEY_LOADING,{frag:frag})},_proto.loadFragment=function(frag,levelDetails,targetBufferTime){this._loadFragForPlayback(frag,levelDetails,targetBufferTime)},_proto._loadFragForPlayback=function(frag,levelDetails,targetBufferTime){var _this2=this;this._doFragLoad(frag,levelDetails,targetBufferTime,function(data){if(_this2.fragContextChanged(frag))return _this2.warn("Fragment "+frag.sn+(data.part?" p: "+data.part.index:"")+" of level "+frag.level+" was dropped during download."),void _this2.fragmentTracker.removeFragment(frag);frag.stats.chunkCount++,_this2._handleFragmentLoadProgress(data)}).then(function(data){if(data){_this2.fragLoadError=0;var state=_this2.state;if(!_this2.fragContextChanged(frag))return"payload"in data&&(_this2.log("Loaded fragment "+frag.sn+" of level "+frag.level),_this2.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_5__.Events.FRAG_LOADED,data),_this2.state===State.BACKTRACKING)?(_this2.fragmentTracker.backtrack(frag,data),void _this2.resetFragmentLoading(frag)):void _this2._handleFragmentLoadComplete(data);(state===State.FRAG_LOADING||state===State.BACKTRACKING||!_this2.fragCurrent&&state===State.PARSING)&&(_this2.fragmentTracker.removeFragment(frag),_this2.state=State.IDLE)}}).catch(function(reason){_this2.warn(reason),_this2.resetFragmentLoading(frag)})},_proto.flushMainBuffer=function(startOffset,endOffset,type){if(void 0===type&&(type=null),startOffset-endOffset){var flushScope={startOffset:startOffset,endOffset:endOffset,type:type};this.fragLoadError=0,this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_5__.Events.BUFFER_FLUSHING,flushScope)}},_proto._loadInitSegment=function(frag){var _this3=this;this._doFragLoad(frag).then(function(data){if(!data||_this3.fragContextChanged(frag)||!_this3.levels)throw new Error("init load aborted");return data}).then(function(data){var hls=_this3.hls,payload=data.payload,decryptData=frag.decryptdata;if(payload&&payload.byteLength>0&&decryptData&&decryptData.key&&decryptData.iv&&"AES-128"===decryptData.method){var startTime=self.performance.now();return _this3.decrypter.webCryptoDecrypt(new Uint8Array(payload),decryptData.key.buffer,decryptData.iv.buffer).then(function(decryptedData){var endTime=self.performance.now();return hls.trigger(_events__WEBPACK_IMPORTED_MODULE_5__.Events.FRAG_DECRYPTED,{frag:frag,payload:decryptedData,stats:{tstart:startTime,tdecrypt:endTime}}),data.payload=decryptedData,data})}return data}).then(function(data){var fragCurrent=_this3.fragCurrent,hls=_this3.hls,levels=_this3.levels;if(!levels)throw new Error("init load aborted, missing levels");console.assert(levels[frag.level].details,"Level details are defined when init segment is loaded");var stats=frag.stats;_this3.state=State.IDLE,_this3.fragLoadError=0,frag.data=new Uint8Array(data.payload),stats.parsing.start=stats.buffering.start=self.performance.now(),stats.parsing.end=stats.buffering.end=self.performance.now(),data.frag===fragCurrent&&hls.trigger(_events__WEBPACK_IMPORTED_MODULE_5__.Events.FRAG_BUFFERED,{stats:stats,frag:fragCurrent,part:null,id:frag.type}),_this3.tick()}).catch(function(reason){_this3.warn(reason),_this3.resetFragmentLoading(frag)})},_proto.fragContextChanged=function(frag){var fragCurrent=this.fragCurrent;return!frag||!fragCurrent||frag.level!==fragCurrent.level||frag.sn!==fragCurrent.sn||frag.urlId!==fragCurrent.urlId},_proto.fragBufferedComplete=function(frag,part){this.log("Buffered "+frag.type+" sn: "+frag.sn+(part?" part: "+part.index:"")+" of "+("[stream-controller]"===this.logPrefix?"level":"track")+" "+frag.level+" "+_utils_time_ranges__WEBPACK_IMPORTED_MODULE_14__.default.toString(_utils_buffer_helper__WEBPACK_IMPORTED_MODULE_3__.BufferHelper.getBuffered(this.mediaBuffer?this.mediaBuffer:this.media))),this.state=State.IDLE,this.tick()},_proto._handleFragmentLoadComplete=function(fragLoadedEndData){var transmuxer=this.transmuxer;if(transmuxer){var frag=fragLoadedEndData.frag,part=fragLoadedEndData.part,partsLoaded=fragLoadedEndData.partsLoaded,complete=!partsLoaded||0===partsLoaded.length||partsLoaded.some(function(fragLoaded){return!fragLoaded}),chunkMeta=new _types_transmuxer__WEBPACK_IMPORTED_MODULE_7__.ChunkMetadata(frag.level,frag.sn,frag.stats.chunkCount+1,0,part?part.index:-1,!complete);transmuxer.flush(chunkMeta)}},_proto._handleFragmentLoadProgress=function(frag){},_proto._doFragLoad=function(frag,details,targetBufferTime,progressCallback){var _this4=this;if(void 0===targetBufferTime&&(targetBufferTime=null),!this.levels)throw new Error("frag load aborted, missing levels");if(targetBufferTime=Math.max(frag.start,targetBufferTime||0),this.config.lowLatencyMode&&details){var partList=details.partList;if(partList&&progressCallback){targetBufferTime>frag.end&&details.fragmentHint&&(frag=details.fragmentHint);var partIndex=this.getNextPart(partList,frag,targetBufferTime);if(partIndex>-1){var part=partList[partIndex];return this.log("Loading part sn: "+frag.sn+" p: "+part.index+" cc: "+frag.cc+" of playlist ["+details.startSN+"-"+details.endSN+"] parts [0-"+partIndex+"-"+(partList.length-1)+"] "+("[stream-controller]"===this.logPrefix?"level":"track")+": "+frag.level+", target: "+parseFloat(targetBufferTime.toFixed(3))),this.nextLoadPosition=part.start+part.duration,this.state=State.FRAG_LOADING,this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_5__.Events.FRAG_LOADING,{frag:frag,part:partList[partIndex],targetBufferTime:targetBufferTime}),this.doFragPartsLoad(frag,partList,partIndex,progressCallback).catch(function(error){return _this4.handleFragLoadError(error)})}if(!frag.url||this.loadedEndOfParts(partList,targetBufferTime))return Promise.resolve(null)}}return this.log("Loading fragment "+frag.sn+" cc: "+frag.cc+" "+(details?"of ["+details.startSN+"-"+details.endSN+"] ":"")+("[stream-controller]"===this.logPrefix?"level":"track")+": "+frag.level+", target: "+parseFloat(targetBufferTime.toFixed(3))),Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(frag.sn)&&!this.bitrateTest&&(this.nextLoadPosition=frag.start+frag.duration),this.state=State.FRAG_LOADING,this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_5__.Events.FRAG_LOADING,{frag:frag,targetBufferTime:targetBufferTime}),this.fragmentLoader.load(frag,progressCallback).catch(function(error){return _this4.handleFragLoadError(error)})},_proto.doFragPartsLoad=function(frag,partList,partIndex,progressCallback){var _this5=this;return new Promise(function(resolve,reject){var partsLoaded=[];!function loadPartIndex(index){var part=partList[index];_this5.fragmentLoader.loadPart(frag,part,progressCallback).then(function(partLoadedData){partsLoaded[part.index]=partLoadedData;var loadedPart=partLoadedData.part;_this5.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_5__.Events.FRAG_LOADED,partLoadedData);var nextPart=partList[index+1];if(!nextPart||nextPart.fragment!==frag)return resolve({frag:frag,part:loadedPart,partsLoaded:partsLoaded});loadPartIndex(index+1)}).catch(reject)}(partIndex)})},_proto.handleFragLoadError=function(_ref){var data=_ref.data;return data&&data.details===_errors__WEBPACK_IMPORTED_MODULE_6__.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(data.frag,data.part):this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_5__.Events.ERROR,data),null},_proto._handleTransmuxerFlush=function(chunkMeta){var context=this.getCurrentContext(chunkMeta);if(context&&this.state===State.PARSING){var frag=context.frag,part=context.part,level=context.level,now=self.performance.now();frag.stats.parsing.end=now,part&&(part.stats.parsing.end=now),this.updateLevelTiming(frag,part,level,chunkMeta.partial)}else this.fragCurrent||(this.state=State.IDLE)},_proto.getCurrentContext=function(chunkMeta){var levels=this.levels,levelIndex=chunkMeta.level,sn=chunkMeta.sn,partIndex=chunkMeta.part;if(!levels||!levels[levelIndex])return this.warn("Levels object was unset while buffering fragment "+sn+" of level "+levelIndex+". The current chunk will not be buffered."),null;var level=levels[levelIndex],part=partIndex>-1?Object(_level_helper__WEBPACK_IMPORTED_MODULE_11__.getPartWith)(level,sn,partIndex):null,frag=part?part.fragment:Object(_level_helper__WEBPACK_IMPORTED_MODULE_11__.getFragmentWithSN)(level,sn,this.fragCurrent);return frag?{frag:frag,part:part,level:level}:null},_proto.bufferFragmentData=function(data,frag,part,chunkMeta){if(data&&this.state===State.PARSING){var data1=data.data1,data2=data.data2,buffer=data1;data1&&data2&&(buffer=Object(_utils_mp4_tools__WEBPACK_IMPORTED_MODULE_8__.appendUint8Array)(data1,data2)),buffer&&buffer.length&&(this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_5__.Events.BUFFER_APPENDING,{type:data.type,frag:frag,part:part,chunkMeta:chunkMeta,parent:frag.type,data:buffer}),data.dropped&&data.independent&&!part&&this.flushBufferGap(frag))}},_proto.flushBufferGap=function(frag){var media=this.media;if(media)if(_utils_buffer_helper__WEBPACK_IMPORTED_MODULE_3__.BufferHelper.isBuffered(media,media.currentTime)){var currentTime=media.currentTime,bufferInfo=_utils_buffer_helper__WEBPACK_IMPORTED_MODULE_3__.BufferHelper.bufferInfo(media,currentTime,0),segmentFraction=Math.min(2*this.config.maxFragLookUpTolerance,.25*frag.duration),start=Math.max(Math.min(frag.start-segmentFraction,bufferInfo.end-segmentFraction),currentTime+segmentFraction);frag.start-start>segmentFraction&&this.flushMainBuffer(start,frag.start)}else this.flushMainBuffer(0,frag.start)},_proto.getFwdBufferInfo=function(bufferable,type){var config=this.config,pos=this.getLoadPosition();if(!Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(pos))return null;var bufferInfo=_utils_buffer_helper__WEBPACK_IMPORTED_MODULE_3__.BufferHelper.bufferInfo(bufferable,pos,config.maxBufferHole);if(0===bufferInfo.len&&void 0!==bufferInfo.nextStart){var bufferedFragAtPos=this.fragmentTracker.getBufferedFrag(pos,type);if(bufferedFragAtPos&&bufferInfo.nextStart<bufferedFragAtPos.end)return _utils_buffer_helper__WEBPACK_IMPORTED_MODULE_3__.BufferHelper.bufferInfo(bufferable,pos,Math.max(bufferInfo.nextStart,config.maxBufferHole))}return bufferInfo},_proto.getMaxBufferLength=function(levelBitrate){var maxBufLen,config=this.config;return maxBufLen=levelBitrate?Math.max(8*config.maxBufferSize/levelBitrate,config.maxBufferLength):config.maxBufferLength,Math.min(maxBufLen,config.maxMaxBufferLength)},_proto.reduceMaxBufferLength=function(threshold){var config=this.config;return config.maxMaxBufferLength>=(threshold||config.maxBufferLength)&&(config.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+config.maxMaxBufferLength+"s"),!0)},_proto.getNextFragment=function(pos,levelDetails){var _frag,_frag2,fragments=levelDetails.fragments,fragLen=fragments.length;if(!fragLen)return null;var frag,config=this.config,start=fragments[0].start;if(levelDetails.live){var initialLiveManifestSize=config.initialLiveManifestSize;if(fragLen<initialLiveManifestSize)return this.warn("Not enough fragments to start playback (have: "+fragLen+", need: "+initialLiveManifestSize+")"),null;levelDetails.PTSKnown||this.startFragRequested||-1!==this.startPosition||(frag=this.getInitialLiveFragment(levelDetails,fragments),this.startPosition=frag?this.hls.liveSyncPosition||frag.start:pos)}else pos<=start&&(frag=fragments[0]);return frag||(frag=this.getFragmentAtPosition(pos,config.lowLatencyMode?levelDetails.partEnd:levelDetails.fragmentEnd,levelDetails)),null===(_frag=frag)||void 0===_frag||!_frag.initSegment||null!==(_frag2=frag)&&void 0!==_frag2&&_frag2.initSegment.data||this.bitrateTest||(frag=frag.initSegment),frag},_proto.getNextPart=function(partList,frag,targetBufferTime){for(var nextPart=-1,contiguous=!1,independentAttrOmitted=!0,i=0,len=partList.length;i<len;i++){var part=partList[i];if(independentAttrOmitted=independentAttrOmitted&&!part.independent,nextPart>-1&&targetBufferTime<part.start)break;var loaded=part.loaded;!loaded&&(contiguous||part.independent||independentAttrOmitted)&&part.fragment===frag&&(nextPart=i),contiguous=loaded}return nextPart},_proto.loadedEndOfParts=function(partList,targetBufferTime){var lastPart=partList[partList.length-1];return lastPart&&targetBufferTime>lastPart.start&&lastPart.loaded},_proto.getInitialLiveFragment=function(levelDetails,fragments){var fragPrevious=this.fragPrevious,frag=null;if(fragPrevious){if(levelDetails.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+fragPrevious.programDateTime),frag=Object(_fragment_finders__WEBPACK_IMPORTED_MODULE_10__.findFragmentByPDT)(fragments,fragPrevious.endProgramDateTime,this.config.maxFragLookUpTolerance)),!frag){var targetSN=fragPrevious.sn+1;if(targetSN>=levelDetails.startSN&&targetSN<=levelDetails.endSN){var fragNext=fragments[targetSN-levelDetails.startSN];fragPrevious.cc===fragNext.cc&&this.log("Live playlist, switching playlist, load frag with next SN: "+(frag=fragNext).sn)}frag||(frag=Object(_fragment_finders__WEBPACK_IMPORTED_MODULE_10__.findFragWithCC)(fragments,fragPrevious.cc))&&this.log("Live playlist, switching playlist, load frag with same CC: "+frag.sn)}}else{var liveStart=this.hls.liveSyncPosition;null!==liveStart&&(frag=this.getFragmentAtPosition(liveStart,this.bitrateTest?levelDetails.fragmentEnd:levelDetails.edge,levelDetails))}return frag},_proto.getFragmentAtPosition=function(bufferEnd,end,levelDetails){var frag,config=this.config,fragPrevious=this.fragPrevious,fragments=levelDetails.fragments,endSN=levelDetails.endSN,fragmentHint=levelDetails.fragmentHint,tolerance=config.maxFragLookUpTolerance,loadingParts=!!(config.lowLatencyMode&&levelDetails.partList&&fragmentHint);if(loadingParts&&fragmentHint&&!this.bitrateTest&&(fragments=fragments.concat(fragmentHint),endSN=fragmentHint.sn),bufferEnd<end){var lookupTolerance=bufferEnd>end-tolerance?0:tolerance;frag=Object(_fragment_finders__WEBPACK_IMPORTED_MODULE_10__.findFragmentByPTS)(fragPrevious,fragments,bufferEnd,lookupTolerance)}else frag=fragments[fragments.length-1];if(frag){var curSNIdx=frag.sn-levelDetails.startSN,sameLevel=fragPrevious&&frag.level===fragPrevious.level,nextFrag=fragments[curSNIdx+1];if(this.fragmentTracker.getState(frag)===_fragment_tracker__WEBPACK_IMPORTED_MODULE_2__.FragmentState.BACKTRACKED){frag=null;for(var i=curSNIdx;fragments[i]&&this.fragmentTracker.getState(fragments[i])===_fragment_tracker__WEBPACK_IMPORTED_MODULE_2__.FragmentState.BACKTRACKED;)frag=fragPrevious?fragments[i--]:fragments[--i];frag||(frag=nextFrag)}else fragPrevious&&frag.sn===fragPrevious.sn&&!loadingParts&&sameLevel&&(frag.sn<endSN&&this.fragmentTracker.getState(nextFrag)!==_fragment_tracker__WEBPACK_IMPORTED_MODULE_2__.FragmentState.OK?(this.log("SN "+frag.sn+" just loaded, load next one: "+nextFrag.sn),frag=nextFrag):frag=null)}return frag},_proto.synchronizeToLiveEdge=function(levelDetails){var config=this.config,media=this.media;if(media){var liveSyncPosition=this.hls.liveSyncPosition,currentTime=media.currentTime,end=levelDetails.edge,withinSlidingWindow=currentTime>=levelDetails.fragments[0].start-config.maxFragLookUpTolerance&&currentTime<=end;null!==liveSyncPosition&&media.duration>liveSyncPosition&&(currentTime<liveSyncPosition||!withinSlidingWindow)&&(!withinSlidingWindow&&media.readyState<4||currentTime<end-(void 0!==config.liveMaxLatencyDuration?config.liveMaxLatencyDuration:config.liveMaxLatencyDurationCount*levelDetails.targetduration))&&(this.loadedmetadata||(this.nextLoadPosition=liveSyncPosition),media.readyState&&(this.warn("Playback: "+currentTime.toFixed(3)+" is located too far from the end of live sliding playlist: "+end+", reset currentTime to : "+liveSyncPosition.toFixed(3)),media.currentTime=liveSyncPosition))}},_proto.alignPlaylists=function(details,previousDetails){var levelLastLoaded=this.levelLastLoaded,fragPrevious=this.fragPrevious,lastLevel=null!==levelLastLoaded?this.levels[levelLastLoaded]:null,length=details.fragments.length;if(!length)return this.warn("No fragments in live playlist"),0;var slidingStart=details.fragments[0].start,firstLevelLoad=!previousDetails,aligned=details.alignedSliding&&Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(slidingStart);if(firstLevelLoad||!aligned&&!slidingStart){Object(_utils_discontinuities__WEBPACK_IMPORTED_MODULE_9__.alignStream)(fragPrevious,lastLevel,details);var alignedSlidingStart=details.fragments[0].start;return this.log("Live playlist sliding: "+alignedSlidingStart.toFixed(2)+" start-sn: "+(previousDetails?previousDetails.startSN:"na")+"->"+details.startSN+" prev-sn: "+(fragPrevious?fragPrevious.sn:"na")+" fragments: "+length),alignedSlidingStart}return slidingStart},_proto.waitForCdnTuneIn=function(details){return details.live&&details.canBlockReload&&details.tuneInGoal>Math.max(details.partHoldBack,3*details.partTarget)},_proto.setStartPosition=function(details,sliding){var startPosition=this.startPosition;if(startPosition<sliding&&(startPosition=-1),-1===startPosition||-1===this.lastCurrentTime){var startTimeOffset=details.startTimeOffset;Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(startTimeOffset)?(startPosition=sliding+startTimeOffset,startTimeOffset<0&&(startPosition+=details.totalduration),startPosition=Math.min(Math.max(sliding,startPosition),sliding+details.totalduration),this.log("Start time offset "+startTimeOffset+" found in playlist, adjust startPosition to "+startPosition),this.startPosition=startPosition):details.live?startPosition=this.hls.liveSyncPosition||sliding:this.startPosition=startPosition=0,this.lastCurrentTime=startPosition}this.nextLoadPosition=startPosition},_proto.getLoadPosition=function(){var media=this.media,pos=0;return this.loadedmetadata&&media?pos=media.currentTime:this.nextLoadPosition&&(pos=this.nextLoadPosition),pos},_proto.handleFragLoadAborted=function(frag,part){this.transmuxer&&"initSegment"!==frag.sn&&frag.stats.aborted&&(this.warn("Fragment "+frag.sn+(part?" part"+part.index:"")+" of level "+frag.level+" was aborted"),this.resetFragmentLoading(frag))},_proto.resetFragmentLoading=function(frag){this.fragCurrent&&this.fragContextChanged(frag)||(this.state=State.IDLE)},_proto.onFragmentOrKeyLoadError=function(filterType,data){if(!data.fatal){var frag=data.frag;if(frag&&frag.type===filterType){var fragCurrent=this.fragCurrent;console.assert(fragCurrent&&frag.sn===fragCurrent.sn&&frag.level===fragCurrent.level&&frag.urlId===fragCurrent.urlId,"Frag load error must match current frag to retry");var config=this.config;if(this.fragLoadError+1<=config.fragLoadingMaxRetry){if(this.resetLiveStartWhenNotLoaded(frag.level))return;var delay=Math.min(Math.pow(2,this.fragLoadError)*config.fragLoadingRetryDelay,config.fragLoadingMaxRetryTimeout);this.warn("Fragment "+frag.sn+" of "+filterType+" "+frag.level+" failed to load, retrying in "+delay+"ms"),this.retryDate=self.performance.now()+delay,this.fragLoadError++,this.state=State.FRAG_LOADING_WAITING_RETRY}else data.levelRetry?(filterType===_types_loader__WEBPACK_IMPORTED_MODULE_15__.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=State.IDLE):(_utils_logger__WEBPACK_IMPORTED_MODULE_4__.logger.error(data.details+" reaches max retry, redispatch as fatal ..."),data.fatal=!0,this.hls.stopLoad(),this.state=State.ERROR)}}},_proto.afterBufferFlushed=function(media,bufferType,playlistType){if(media){var bufferedTimeRanges=_utils_buffer_helper__WEBPACK_IMPORTED_MODULE_3__.BufferHelper.getBuffered(media);this.fragmentTracker.detectEvictedFragments(bufferType,bufferedTimeRanges,playlistType),this.state===State.ENDED&&this.resetLoadingState()}},_proto.resetLoadingState=function(){this.fragCurrent=null,this.fragPrevious=null,this.state=State.IDLE},_proto.resetLiveStartWhenNotLoaded=function(level){if(!this.loadedmetadata){this.startFragRequested=!1;var details=this.levels?this.levels[level].details:null;if(null!=details&&details.live)return this.startPosition=-1,this.setStartPosition(details,0),this.resetLoadingState(),!0;this.nextLoadPosition=this.startPosition}return!1},_proto.updateLevelTiming=function(frag,part,level,partial){var _this6=this,details=level.details;console.assert(!!details,"level.details must be defined"),Object.keys(frag.elementaryStreams).reduce(function(result,type){var info=frag.elementaryStreams[type];if(info){var parsedDuration=info.endPTS-info.startPTS;if(parsedDuration<=0)return _this6.warn("Could not parse fragment "+frag.sn+" "+type+" duration reliably ("+parsedDuration+") resetting transmuxer to fallback to playlist timing"),_this6.resetTransmuxer(),result||!1;var drift=partial?0:Object(_level_helper__WEBPACK_IMPORTED_MODULE_11__.updateFragPTSDTS)(details,frag,info.startPTS,info.endPTS,info.startDTS,info.endDTS);return _this6.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_5__.Events.LEVEL_PTS_UPDATED,{details:details,level:level,drift:drift,type:type,frag:frag,start:info.startPTS,end:info.endPTS}),!0}return result},!1)?(this.state=State.PARSED,this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_5__.Events.FRAG_PARSED,{frag:frag,part:part})):this.resetLoadingState()},_proto.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},Constructor=BaseStreamController,(protoProps=[{key:"state",get:function(){return this._state},set:function(nextState){var previousState=this._state;previousState!==nextState&&(this._state=nextState,this.log(previousState+"->"+nextState))}}])&&_defineProperties(Constructor.prototype,protoProps),BaseStreamController}(_task_loop__WEBPACK_IMPORTED_MODULE_1__.default)},"./src/controller/buffer-controller.ts":
/*!*********************************************!*\
        !*** ./src/controller/buffer-controller.ts ***!
        \*********************************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_196819__){"use strict";__nested_webpack_require_196819__.r(__webpack_exports__),__nested_webpack_require_196819__.d(__webpack_exports__,"default",function(){return BufferController});var _home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_196819__(
/*! ./src/polyfills/number */
"./src/polyfills/number.ts"),_events__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_196819__(
/*! ../events */
"./src/events.ts"),_utils_logger__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_196819__(
/*! ../utils/logger */
"./src/utils/logger.ts"),_errors__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_196819__(
/*! ../errors */
"./src/errors.ts"),_utils_buffer_helper__WEBPACK_IMPORTED_MODULE_4__=__nested_webpack_require_196819__(
/*! ../utils/buffer-helper */
"./src/utils/buffer-helper.ts"),_utils_mediasource_helper__WEBPACK_IMPORTED_MODULE_5__=__nested_webpack_require_196819__(
/*! ../utils/mediasource-helper */
"./src/utils/mediasource-helper.ts"),_loader_fragment__WEBPACK_IMPORTED_MODULE_6__=__nested_webpack_require_196819__(
/*! ../loader/fragment */
"./src/loader/fragment.ts"),_buffer_operation_queue__WEBPACK_IMPORTED_MODULE_7__=__nested_webpack_require_196819__(
/*! ./buffer-operation-queue */
"./src/controller/buffer-operation-queue.ts"),MediaSource=Object(_utils_mediasource_helper__WEBPACK_IMPORTED_MODULE_5__.getMediaSource)(),VIDEO_CODEC_PROFILE_REPACE=/([ha]vc.)(?:\.[^.,]+)+/,BufferController=function(){function BufferController(_hls){var _this=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var hls=_this.hls,media=_this.media,mediaSource=_this.mediaSource;_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.log("[buffer-controller]: Media source opened"),media&&(_this.updateMediaElementDuration(),hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.MEDIA_ATTACHED,{media:media})),mediaSource&&mediaSource.removeEventListener("sourceopen",_this._onMediaSourceOpen),_this.checkPendingTracks()},this._onMediaSourceClose=function(){_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.log("[buffer-controller]: Media source ended")},this.hls=_hls,this._initSourceBuffer(),this.registerListeners()}var _proto=BufferController.prototype;return _proto.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},_proto.destroy=function(){this.unregisterListeners(),this.details=null},_proto.registerListeners=function(){var hls=this.hls;hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.MEDIA_DETACHING,this.onMediaDetaching,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.MANIFEST_PARSED,this.onManifestParsed,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.BUFFER_RESET,this.onBufferReset,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.BUFFER_APPENDING,this.onBufferAppending,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.BUFFER_CODECS,this.onBufferCodecs,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.BUFFER_EOS,this.onBufferEos,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.LEVEL_UPDATED,this.onLevelUpdated,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.FRAG_PARSED,this.onFragParsed,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.FRAG_CHANGED,this.onFragChanged,this)},_proto.unregisterListeners=function(){var hls=this.hls;hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.MEDIA_DETACHING,this.onMediaDetaching,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.MANIFEST_PARSED,this.onManifestParsed,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.BUFFER_RESET,this.onBufferReset,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.BUFFER_APPENDING,this.onBufferAppending,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.BUFFER_CODECS,this.onBufferCodecs,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.BUFFER_EOS,this.onBufferEos,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.LEVEL_UPDATED,this.onLevelUpdated,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.FRAG_PARSED,this.onFragParsed,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.FRAG_CHANGED,this.onFragChanged,this)},_proto._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new _buffer_operation_queue__WEBPACK_IMPORTED_MODULE_7__.default(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]}},_proto.onManifestParsed=function(event,data){var codecEvents=2;(data.audio&&!data.video||!data.altAudio)&&(codecEvents=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=codecEvents,this.details=null,_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},_proto.onMediaAttaching=function(event,data){var media=this.media=data.media;if(media&&MediaSource){var ms=this.mediaSource=new MediaSource;ms.addEventListener("sourceopen",this._onMediaSourceOpen),ms.addEventListener("sourceended",this._onMediaSourceEnded),ms.addEventListener("sourceclose",this._onMediaSourceClose),media.src=self.URL.createObjectURL(ms),this._objectUrl=media.src}},_proto.onMediaDetaching=function(){var media=this.media,mediaSource=this.mediaSource,_objectUrl=this._objectUrl;if(mediaSource){if(_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.log("[buffer-controller]: media source detaching"),"open"===mediaSource.readyState)try{mediaSource.endOfStream()}catch(err){_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.warn("[buffer-controller]: onMediaDetaching: "+err.message+" while calling endOfStream")}this.onBufferReset(),mediaSource.removeEventListener("sourceopen",this._onMediaSourceOpen),mediaSource.removeEventListener("sourceended",this._onMediaSourceEnded),mediaSource.removeEventListener("sourceclose",this._onMediaSourceClose),media&&(_objectUrl&&self.URL.revokeObjectURL(_objectUrl),media.src===_objectUrl?(media.removeAttribute("src"),media.load()):_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.MEDIA_DETACHED,void 0)},_proto.onBufferReset=function(){var _this2=this;this.getSourceBufferTypes().forEach(function(type){var sb=_this2.sourceBuffer[type];try{sb&&(_this2.removeBufferListeners(type),_this2.mediaSource&&_this2.mediaSource.removeSourceBuffer(sb),_this2.sourceBuffer[type]=void 0)}catch(err){_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.warn("[buffer-controller]: Failed to reset the "+type+" buffer",err)}}),this._initSourceBuffer()},_proto.onBufferCodecs=function(event,data){var _this3=this,sourceBufferCount=this.getSourceBufferTypes().length;Object.keys(data).forEach(function(trackName){if(sourceBufferCount){var track=_this3.tracks[trackName];if(track&&"function"==typeof track.buffer.changeType){var _data$trackName=data[trackName],codec=_data$trackName.codec,levelCodec=_data$trackName.levelCodec,container=_data$trackName.container;(track.levelCodec||track.codec).replace(VIDEO_CODEC_PROFILE_REPACE,"$1")!==(levelCodec||codec).replace(VIDEO_CODEC_PROFILE_REPACE,"$1")&&_this3.appendChangeType(trackName,container+";codecs="+(levelCodec||codec))}}else _this3.pendingTracks[trackName]=data[trackName]}),sourceBufferCount||(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())},_proto.appendChangeType=function(type,mimeType){var _this4=this,operationQueue=this.operationQueue,operation={execute:function(){var sb=_this4.sourceBuffer[type];sb&&(_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.log("[buffer-controller]: changing "+type+" sourceBuffer type to "+mimeType),sb.changeType(mimeType)),operationQueue.shiftAndExecuteNext(type)},onStart:function(){},onComplete:function(){},onError:function(e){_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.warn("[buffer-controller]: Failed to change "+type+" SourceBuffer type",e)}};operationQueue.append(operation,type)},_proto.onBufferAppending=function(event,eventData){var _this5=this,hls=this.hls,operationQueue=this.operationQueue,tracks=this.tracks,data=eventData.data,type=eventData.type,frag=eventData.frag,part=eventData.part,chunkMeta=eventData.chunkMeta,chunkStats=chunkMeta.buffering[type],bufferAppendingStart=self.performance.now();chunkStats.start=bufferAppendingStart;var fragBuffering=frag.stats.buffering,partBuffering=part?part.stats.buffering:null;0===fragBuffering.start&&(fragBuffering.start=bufferAppendingStart),partBuffering&&0===partBuffering.start&&(partBuffering.start=bufferAppendingStart);var audioTrack=tracks.audio,checkTimestampOffset="audio"===type&&1===chunkMeta.id&&"audio/mpeg"===(null==audioTrack?void 0:audioTrack.container),operation={execute:function(){if(chunkStats.executeStart=self.performance.now(),checkTimestampOffset){var sb=_this5.sourceBuffer[type];if(sb){var delta=frag.start-sb.timestampOffset;Math.abs(delta)>=.1&&(_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+frag.start+" (delta: "+delta+") sn: "+frag.sn+")"),sb.timestampOffset=frag.start)}}_this5.appendExecutor(data,type)},onStart:function(){},onComplete:function(){var end=self.performance.now();chunkStats.executeEnd=chunkStats.end=end,0===fragBuffering.first&&(fragBuffering.first=end),partBuffering&&0===partBuffering.first&&(partBuffering.first=end);var sourceBuffer=_this5.sourceBuffer,timeRanges={};for(var _type in sourceBuffer)timeRanges[_type]=_utils_buffer_helper__WEBPACK_IMPORTED_MODULE_4__.BufferHelper.getBuffered(sourceBuffer[_type]);_this5.appendError=0,_this5.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.BUFFER_APPENDED,{type:type,frag:frag,part:part,chunkMeta:chunkMeta,parent:frag.type,timeRanges:timeRanges})},onError:function(err){_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error("[buffer-controller]: Error encountered while trying to append to the "+type+" SourceBuffer",err);var event={type:_errors__WEBPACK_IMPORTED_MODULE_3__.ErrorTypes.MEDIA_ERROR,parent:frag.type,details:_errors__WEBPACK_IMPORTED_MODULE_3__.ErrorDetails.BUFFER_APPEND_ERROR,err:err,fatal:!1};err.code===DOMException.QUOTA_EXCEEDED_ERR?event.details=_errors__WEBPACK_IMPORTED_MODULE_3__.ErrorDetails.BUFFER_FULL_ERROR:(_this5.appendError++,event.details=_errors__WEBPACK_IMPORTED_MODULE_3__.ErrorDetails.BUFFER_APPEND_ERROR,_this5.appendError>hls.config.appendErrorMaxRetry&&(_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error("[buffer-controller]: Failed "+hls.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),event.fatal=!0)),hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.ERROR,event)}};operationQueue.append(operation,type)},_proto.onBufferFlushing=function(event,data){var _this6=this,operationQueue=this.operationQueue,flushOperation=function(type){return{execute:_this6.removeExecutor.bind(_this6,type,data.startOffset,data.endOffset),onStart:function(){},onComplete:function(){_this6.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.BUFFER_FLUSHED,{type:type})},onError:function(e){_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.warn("[buffer-controller]: Failed to remove from "+type+" SourceBuffer",e)}}};data.type?operationQueue.append(flushOperation(data.type),data.type):this.getSourceBufferTypes().forEach(function(type){operationQueue.append(flushOperation(type),type)})},_proto.onFragParsed=function(event,data){var _this7=this,frag=data.frag,part=data.part,buffersAppendedTo=[],elementaryStreams=part?part.elementaryStreams:frag.elementaryStreams;elementaryStreams[_loader_fragment__WEBPACK_IMPORTED_MODULE_6__.ElementaryStreamTypes.AUDIOVIDEO]?buffersAppendedTo.push("audiovideo"):(elementaryStreams[_loader_fragment__WEBPACK_IMPORTED_MODULE_6__.ElementaryStreamTypes.AUDIO]&&buffersAppendedTo.push("audio"),elementaryStreams[_loader_fragment__WEBPACK_IMPORTED_MODULE_6__.ElementaryStreamTypes.VIDEO]&&buffersAppendedTo.push("video")),0===buffersAppendedTo.length&&_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+frag.type+" level: "+frag.level+" sn: "+frag.sn),this.blockBuffers(function(){var now=self.performance.now();frag.stats.buffering.end=now,part&&(part.stats.buffering.end=now),_this7.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.FRAG_BUFFERED,{frag:frag,part:part,stats:part?part.stats:frag.stats,id:frag.type})},buffersAppendedTo)},_proto.onFragChanged=function(event,data){this.flushBackBuffer()},_proto.onBufferEos=function(event,data){var _this8=this;this.getSourceBufferTypes().reduce(function(acc,type){var sb=_this8.sourceBuffer[type];return data.type&&data.type!==type||sb&&!sb.ended&&(sb.ended=!0,_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.log("[buffer-controller]: "+type+" sourceBuffer now EOS")),acc&&!(sb&&!sb.ended)},!0)&&this.blockBuffers(function(){var mediaSource=_this8.mediaSource;mediaSource&&"open"===mediaSource.readyState&&mediaSource.endOfStream()})},_proto.onLevelUpdated=function(event,_ref){var details=_ref.details;details.fragments.length&&(this.details=details,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},_proto.flushBackBuffer=function(){var hls=this.hls,details=this.details,media=this.media,sourceBuffer=this.sourceBuffer;if(media&&null!==details){var sourceBufferTypes=this.getSourceBufferTypes();if(sourceBufferTypes.length){var backBufferLength=details.live&&null!==hls.config.liveBackBufferLength?hls.config.liveBackBufferLength:hls.config.backBufferLength;if(Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(backBufferLength)&&!(backBufferLength<0)){var currentTime=media.currentTime,targetDuration=details.levelTargetDuration,maxBackBufferLength=Math.max(backBufferLength,targetDuration),targetBackBufferPosition=Math.floor(currentTime/targetDuration)*targetDuration-maxBackBufferLength;sourceBufferTypes.forEach(function(type){var sb=sourceBuffer[type];if(sb){var buffered=_utils_buffer_helper__WEBPACK_IMPORTED_MODULE_4__.BufferHelper.getBuffered(sb);buffered.length>0&&targetBackBufferPosition>buffered.start(0)&&(hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.BACK_BUFFER_REACHED,{bufferEnd:targetBackBufferPosition}),details.live&&hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:targetBackBufferPosition}),hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:targetBackBufferPosition,type:type}))}})}}}},_proto.updateMediaElementDuration=function(){if(this.details&&this.media&&this.mediaSource&&"open"===this.mediaSource.readyState){var details=this.details,hls=this.hls,mediaSource=this.mediaSource,levelDuration=details.fragments[0].start+details.totalduration,mediaDuration=this.media.duration,msDuration=Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(mediaSource.duration)?mediaSource.duration:0;details.live&&hls.config.liveDurationInfinity?(_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),mediaSource.duration=1/0,this.updateSeekableRange(details)):(levelDuration>msDuration&&levelDuration>mediaDuration||!Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(mediaDuration))&&(_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.log("[buffer-controller]: Updating Media Source duration to "+levelDuration.toFixed(3)),mediaSource.duration=levelDuration)}},_proto.updateSeekableRange=function(levelDetails){var mediaSource=this.mediaSource,fragments=levelDetails.fragments;if(fragments.length&&levelDetails.live&&null!=mediaSource&&mediaSource.setLiveSeekableRange){var start=Math.max(0,fragments[0].start),end=Math.max(start,start+levelDetails.totalduration);mediaSource.setLiveSeekableRange(start,end)}},_proto.checkPendingTracks=function(){var bufferCodecEventsExpected=this.bufferCodecEventsExpected,operationQueue=this.operationQueue,pendingTracks=this.pendingTracks,pendingTracksCount=Object.keys(pendingTracks).length;if(pendingTracksCount&&!bufferCodecEventsExpected||2===pendingTracksCount){this.createSourceBuffers(pendingTracks),this.pendingTracks={};var buffers=this.getSourceBufferTypes();if(0===buffers.length)return void this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_3__.ErrorTypes.MEDIA_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_3__.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});buffers.forEach(function(type){operationQueue.executeNext(type)})}},_proto.createSourceBuffers=function(tracks){var sourceBuffer=this.sourceBuffer,mediaSource=this.mediaSource;if(!mediaSource)throw Error("createSourceBuffers called when mediaSource was null");var tracksCreated=0;for(var trackName in tracks)if(!sourceBuffer[trackName]){var track=tracks[trackName];if(!track)throw Error("source buffer exists for track "+trackName+", however track does not");var codec=track.levelCodec||track.codec,mimeType=track.container+";codecs="+codec;_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.log("[buffer-controller]: creating sourceBuffer("+mimeType+")");try{var sb=sourceBuffer[trackName]=mediaSource.addSourceBuffer(mimeType),sbName=trackName;this.addBufferListener(sbName,"updatestart",this._onSBUpdateStart),this.addBufferListener(sbName,"updateend",this._onSBUpdateEnd),this.addBufferListener(sbName,"error",this._onSBUpdateError),this.tracks[trackName]={buffer:sb,codec:codec,container:track.container,levelCodec:track.levelCodec,id:track.id},tracksCreated++}catch(err){_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+err.message),this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_3__.ErrorTypes.MEDIA_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_3__.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:err,mimeType:mimeType})}}tracksCreated&&this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.BUFFER_CREATED,{tracks:this.tracks})},_proto._onSBUpdateStart=function(type){this.operationQueue.current(type).onStart()},_proto._onSBUpdateEnd=function(type){var operationQueue=this.operationQueue;operationQueue.current(type).onComplete(),operationQueue.shiftAndExecuteNext(type)},_proto._onSBUpdateError=function(type,event){_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error("[buffer-controller]: "+type+" SourceBuffer error",event),this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_3__.ErrorTypes.MEDIA_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_3__.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var operation=this.operationQueue.current(type);operation&&operation.onError(event)},_proto.removeExecutor=function(type,startOffset,endOffset){var media=this.media,mediaSource=this.mediaSource,operationQueue=this.operationQueue,sb=this.sourceBuffer[type];if(!media||!mediaSource||!sb)return _utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.warn("[buffer-controller]: Attempting to remove from the "+type+" SourceBuffer, but it does not exist"),void operationQueue.shiftAndExecuteNext(type);var mediaDuration=Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(media.duration)?media.duration:1/0,msDuration=Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(mediaSource.duration)?mediaSource.duration:1/0,removeStart=Math.max(0,startOffset),removeEnd=Math.min(endOffset,mediaDuration,msDuration);removeEnd>removeStart?(_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.log("[buffer-controller]: Removing ["+removeStart+","+removeEnd+"] from the "+type+" SourceBuffer"),console.assert(!sb.updating,type+" sourceBuffer must not be updating"),sb.remove(removeStart,removeEnd)):operationQueue.shiftAndExecuteNext(type)},_proto.appendExecutor=function(data,type){var operationQueue=this.operationQueue,sb=this.sourceBuffer[type];if(!sb)return _utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.warn("[buffer-controller]: Attempting to append to the "+type+" SourceBuffer, but it does not exist"),void operationQueue.shiftAndExecuteNext(type);sb.ended=!1,console.assert(!sb.updating,type+" sourceBuffer must not be updating"),sb.appendBuffer(data)},_proto.blockBuffers=function(onUnblocked,buffers){var _this9=this;if(void 0===buffers&&(buffers=this.getSourceBufferTypes()),!buffers.length)return _utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),void Promise.resolve(onUnblocked);var operationQueue=this.operationQueue,blockingOperations=buffers.map(function(type){return operationQueue.appendBlocker(type)});Promise.all(blockingOperations).then(function(){onUnblocked(),buffers.forEach(function(type){var sb=_this9.sourceBuffer[type];sb&&sb.updating||operationQueue.shiftAndExecuteNext(type)})})},_proto.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},_proto.addBufferListener=function(type,event,fn){var buffer=this.sourceBuffer[type];if(buffer){var listener=fn.bind(this,type);this.listeners[type].push({event:event,listener:listener}),buffer.addEventListener(event,listener)}},_proto.removeBufferListeners=function(type){var buffer=this.sourceBuffer[type];buffer&&this.listeners[type].forEach(function(l){buffer.removeEventListener(l.event,l.listener)})},BufferController}()},"./src/controller/buffer-operation-queue.ts":
/*!**************************************************!*\
        !*** ./src/controller/buffer-operation-queue.ts ***!
        \**************************************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_240210__){"use strict";__nested_webpack_require_240210__.r(__webpack_exports__),__nested_webpack_require_240210__.d(__webpack_exports__,"default",function(){return BufferOperationQueue});var _utils_logger__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_240210__(
/*! ../utils/logger */
"./src/utils/logger.ts"),BufferOperationQueue=function(){function BufferOperationQueue(sourceBufferReference){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=sourceBufferReference}var _proto=BufferOperationQueue.prototype;return _proto.append=function(operation,type){var queue=this.queues[type];queue.push(operation),1===queue.length&&this.buffers[type]&&this.executeNext(type)},_proto.insertAbort=function(operation,type){this.queues[type].unshift(operation),this.executeNext(type)},_proto.appendBlocker=function(type){var execute,promise=new Promise(function(resolve){execute=resolve});return this.append({execute:execute,onStart:function(){},onComplete:function(){},onError:function(){}},type),promise},_proto.executeNext=function(type){var sb=this.buffers[type],queue=this.queues[type];if(queue.length){var operation=queue[0];try{operation.execute()}catch(e){_utils_logger__WEBPACK_IMPORTED_MODULE_0__.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),operation.onError(e),sb&&sb.updating||(queue.shift(),this.executeNext(type))}}},_proto.shiftAndExecuteNext=function(type){this.queues[type].shift(),this.executeNext(type)},_proto.current=function(type){return this.queues[type][0]},BufferOperationQueue}()},"./src/controller/cap-level-controller.ts":
/*!************************************************!*\
        !*** ./src/controller/cap-level-controller.ts ***!
        \************************************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_243800__){"use strict";__nested_webpack_require_243800__.r(__webpack_exports__);var _events__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_243800__(
/*! ../events */
"./src/events.ts");function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}__webpack_exports__.default=function(){function CapLevelController(hls){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=hls,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var Constructor,protoProps,staticProps,_proto=CapLevelController.prototype;return _proto.setStreamController=function(streamController){this.streamController=streamController},_proto.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},_proto.registerListeners=function(){var hls=this.hls;hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MANIFEST_PARSED,this.onManifestParsed,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.BUFFER_CODECS,this.onBufferCodecs,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},_proto.unregisterListener=function(){var hls=this.hls;hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MANIFEST_PARSED,this.onManifestParsed,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.BUFFER_CODECS,this.onBufferCodecs,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},_proto.onFpsDropLevelCapping=function(event,data){CapLevelController.isLevelAllowed(data.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(data.droppedLevel)},_proto.onMediaAttaching=function(event,data){this.media=data.media instanceof HTMLVideoElement?data.media:null},_proto.onManifestParsed=function(event,data){var hls=this.hls;this.restrictedLevels=[],this.firstLevel=data.firstLevel,hls.config.capLevelToPlayerSize&&data.video&&this.startCapping()},_proto.onBufferCodecs=function(event,data){this.hls.config.capLevelToPlayerSize&&data.video&&this.startCapping()},_proto.onMediaDetaching=function(){this.stopCapping()},_proto.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var levels=this.hls.levels;if(levels.length){var hls=this.hls;hls.autoLevelCapping=this.getMaxLevel(levels.length-1),hls.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=hls.autoLevelCapping}}},_proto.getMaxLevel=function(capLevelIndex){var _this=this,levels=this.hls.levels;if(!levels.length)return-1;var validLevels=levels.filter(function(level,index){return CapLevelController.isLevelAllowed(index,_this.restrictedLevels)&&index<=capLevelIndex});return this.clientRect=null,CapLevelController.getMaxLevelByMediaSize(validLevels,this.mediaWidth,this.mediaHeight)},_proto.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},_proto.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},_proto.getDimensions=function(){if(this.clientRect)return this.clientRect;var media=this.media,boundsRect={width:0,height:0};if(media){var clientRect=media.getBoundingClientRect();boundsRect.width=clientRect.width,boundsRect.height=clientRect.height,boundsRect.width||boundsRect.height||(boundsRect.width=clientRect.right-clientRect.left||media.width||0,boundsRect.height=clientRect.bottom-clientRect.top||media.height||0)}return this.clientRect=boundsRect,boundsRect},CapLevelController.isLevelAllowed=function(level,restrictedLevels){return void 0===restrictedLevels&&(restrictedLevels=[]),-1===restrictedLevels.indexOf(level)},CapLevelController.getMaxLevelByMediaSize=function(levels,width,height){if(!levels||!levels.length)return-1;for(var curLevel,nextLevel,maxLevelIndex=levels.length-1,i=0;i<levels.length;i+=1){var level=levels[i];if((level.width>=width||level.height>=height)&&(curLevel=level,!(nextLevel=levels[i+1])||curLevel.width!==nextLevel.width||curLevel.height!==nextLevel.height)){maxLevelIndex=i;break}}return maxLevelIndex},Constructor=CapLevelController,staticProps=[{key:"contentScaleFactor",get:function(){var pixelRatio=1;try{pixelRatio=self.devicePixelRatio}catch(e){}return pixelRatio}}],(protoProps=[{key:"mediaWidth",get:function(){return this.getDimensions().width*CapLevelController.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*CapLevelController.contentScaleFactor}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),CapLevelController}()},"./src/controller/eme-controller.ts":
/*!******************************************!*\
        !*** ./src/controller/eme-controller.ts ***!
        \******************************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_255264__){"use strict";__nested_webpack_require_255264__.r(__webpack_exports__);var _events__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_255264__(
/*! ../events */
"./src/events.ts"),_errors__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_255264__(
/*! ../errors */
"./src/errors.ts"),_utils_logger__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_255264__(
/*! ../utils/logger */
"./src/utils/logger.ts"),_utils_mediakeys_helper__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_255264__(
/*! ../utils/mediakeys-helper */
"./src/utils/mediakeys-helper.ts");function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}__webpack_exports__.default=function(){function EMEController(hls){this.hls=void 0,this._widevineLicenseUrl=void 0,this._licenseXhrSetup=void 0,this._licenseResponseCallback=void 0,this._emeEnabled=void 0,this._requestMediaKeySystemAccess=void 0,this._drmSystemOptions=void 0,this._config=void 0,this._mediaKeysList=[],this._media=null,this._hasSetMediaKeys=!1,this._requestLicenseFailureCount=0,this.mediaKeysPromise=null,this._onMediaEncrypted=this.onMediaEncrypted.bind(this),this.hls=hls,this._config=hls.config,this._widevineLicenseUrl=this._config.widevineLicenseUrl,this._licenseXhrSetup=this._config.licenseXhrSetup,this._licenseResponseCallback=this._config.licenseResponseCallback,this._emeEnabled=this._config.emeEnabled,this._requestMediaKeySystemAccess=this._config.requestMediaKeySystemAccessFunc,this._drmSystemOptions=this._config.drmSystemOptions,this._registerListeners()}var Constructor,protoProps,_proto=EMEController.prototype;return _proto.destroy=function(){this._unregisterListeners(),this.hls=this._onMediaEncrypted=null,this._requestMediaKeySystemAccess=null},_proto._registerListeners=function(){this.hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MANIFEST_PARSED,this.onManifestParsed,this)},_proto._unregisterListeners=function(){this.hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MANIFEST_PARSED,this.onManifestParsed,this)},_proto.getLicenseServerUrl=function(keySystem){switch(keySystem){case _utils_mediakeys_helper__WEBPACK_IMPORTED_MODULE_3__.KeySystems.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+keySystem+'"')},_proto._attemptKeySystemAccess=function(keySystem,audioCodecs,videoCodecs){var _this=this,mediaKeySystemConfigs=function(keySystem,audioCodecs,videoCodecs,drmSystemOptions){if(keySystem===_utils_mediakeys_helper__WEBPACK_IMPORTED_MODULE_3__.KeySystems.WIDEVINE)return function(audioCodecs,videoCodecs,drmSystemOptions){var baseConfig={audioCapabilities:[],videoCapabilities:[]};return audioCodecs.forEach(function(codec){baseConfig.audioCapabilities.push({contentType:'audio/mp4; codecs="'+codec+'"',robustness:drmSystemOptions.audioRobustness||""})}),videoCodecs.forEach(function(codec){baseConfig.videoCapabilities.push({contentType:'video/mp4; codecs="'+codec+'"',robustness:drmSystemOptions.videoRobustness||""})}),[baseConfig]}(audioCodecs,videoCodecs,drmSystemOptions);throw new Error("Unknown key-system: "+keySystem)}(keySystem,audioCodecs,videoCodecs,this._drmSystemOptions);_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.log("Requesting encrypted media key-system access");var keySystemAccessPromise=this.requestMediaKeySystemAccess(keySystem,mediaKeySystemConfigs);this.mediaKeysPromise=keySystemAccessPromise.then(function(mediaKeySystemAccess){return _this._onMediaKeySystemAccessObtained(keySystem,mediaKeySystemAccess)}),keySystemAccessPromise.catch(function(err){_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error('Failed to obtain key-system "'+keySystem+'" access:',err)})},_proto._onMediaKeySystemAccessObtained=function(keySystem,mediaKeySystemAccess){var _this2=this;_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.log('Access for key-system "'+keySystem+'" obtained');var mediaKeysListItem={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:mediaKeySystemAccess,mediaKeySystemDomain:keySystem};this._mediaKeysList.push(mediaKeysListItem);var mediaKeysPromise=Promise.resolve().then(function(){return mediaKeySystemAccess.createMediaKeys()}).then(function(mediaKeys){return mediaKeysListItem.mediaKeys=mediaKeys,_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.log('Media-keys created for key-system "'+keySystem+'"'),_this2._onMediaKeysCreated(),mediaKeys});return mediaKeysPromise.catch(function(err){_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error("Failed to create media-keys:",err)}),mediaKeysPromise},_proto._onMediaKeysCreated=function(){var _this3=this;this._mediaKeysList.forEach(function(mediaKeysListItem){mediaKeysListItem.mediaKeysSession||(mediaKeysListItem.mediaKeysSession=mediaKeysListItem.mediaKeys.createSession(),_this3._onNewMediaKeySession(mediaKeysListItem.mediaKeysSession))})},_proto._onNewMediaKeySession=function(keySession){var _this4=this;_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.log("New key-system session "+keySession.sessionId),keySession.addEventListener("message",function(event){_this4._onKeySessionMessage(keySession,event.message)},!1)},_proto._onKeySessionMessage=function(keySession,message){_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.log("Got EME message event, creating license request"),this._requestLicense(message,function(data){_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.log("Received license data (length: "+(data?data.byteLength:data)+"), updating key-session"),keySession.update(data)})},_proto.onMediaEncrypted=function(e){var _this5=this;if(_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.log('Media is encrypted using "'+e.initDataType+'" init data type'),!this.mediaKeysPromise)return _utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),void this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_0__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorTypes.KEY_SYSTEM_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});var finallySetKeyAndStartSession=function(mediaKeys){_this5._media&&(_this5._attemptSetMediaKeys(mediaKeys),_this5._generateRequestWithPreferredKeySession(e.initDataType,e.initData))};this.mediaKeysPromise.then(finallySetKeyAndStartSession).catch(finallySetKeyAndStartSession)},_proto._attemptSetMediaKeys=function(mediaKeys){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var keysListItem=this._mediaKeysList[0];if(!keysListItem||!keysListItem.mediaKeys)return _utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_0__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorTypes.KEY_SYSTEM_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(keysListItem.mediaKeys),this._hasSetMediaKeys=!0}},_proto._generateRequestWithPreferredKeySession=function(initDataType,initData){var _this6=this,keysListItem=this._mediaKeysList[0];if(!keysListItem)return _utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_0__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorTypes.KEY_SYSTEM_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(keysListItem.mediaKeysSessionInitialized)_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.warn("Key-Session already initialized but requested again");else{var keySession=keysListItem.mediaKeysSession;if(!keySession)return _utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error("Fatal: Media is encrypted but no key-session existing"),void this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_0__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorTypes.KEY_SYSTEM_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});if(!initData)return _utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.warn("Fatal: initData required for generating a key session is null"),void this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_0__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorTypes.KEY_SYSTEM_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.log('Generating key-session request for "'+initDataType+'" init data type'),keysListItem.mediaKeysSessionInitialized=!0,keySession.generateRequest(initDataType,initData).then(function(){_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.debug("Key-session generation succeeded")}).catch(function(err){_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error("Error generating key-session request:",err),_this6.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_0__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorTypes.KEY_SYSTEM_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})}},_proto._createLicenseXhr=function(url,keyMessage,callback){var xhr=new XMLHttpRequest;xhr.responseType="arraybuffer",xhr.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,xhr,url,keyMessage,callback);var licenseXhrSetup=this._licenseXhrSetup;if(licenseXhrSetup)try{licenseXhrSetup.call(this.hls,xhr,url),licenseXhrSetup=void 0}catch(e){_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(e)}try{xhr.readyState||xhr.open("POST",url,!0),licenseXhrSetup&&licenseXhrSetup.call(this.hls,xhr,url)}catch(e){throw new Error("issue setting up KeySystem license XHR "+e)}return xhr},_proto._onLicenseRequestReadyStageChange=function(xhr,url,keyMessage,callback){if(4===xhr.readyState)if(200===xhr.status){this._requestLicenseFailureCount=0,_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.log("License request succeeded");var _data=xhr.response,licenseResponseCallback=this._licenseResponseCallback;if(licenseResponseCallback)try{_data=licenseResponseCallback.call(this.hls,xhr,url)}catch(e){_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(e)}callback(_data)}else{if(_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error("License Request XHR failed ("+url+"). Status: "+xhr.status+" ("+xhr.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>3)return void this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_0__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorTypes.KEY_SYSTEM_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.warn("Retrying license request, "+(3-this._requestLicenseFailureCount+1)+" attempts left"),this._requestLicense(keyMessage,callback)}},_proto._generateLicenseRequestChallenge=function(keysListItem,keyMessage){if(keysListItem.mediaKeySystemDomain===_utils_mediakeys_helper__WEBPACK_IMPORTED_MODULE_3__.KeySystems.WIDEVINE)return keyMessage;throw new Error("unsupported key-system: "+keysListItem.mediaKeySystemDomain)},_proto._requestLicense=function(keyMessage,callback){_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.log("Requesting content license for key-system");var keysListItem=this._mediaKeysList[0];if(!keysListItem)return _utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_0__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorTypes.KEY_SYSTEM_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});try{var _url=this.getLicenseServerUrl(keysListItem.mediaKeySystemDomain),_xhr=this._createLicenseXhr(_url,keyMessage,callback);_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.log("Sending license request to URL: "+_url);var challenge=this._generateLicenseRequestChallenge(keysListItem,keyMessage);_xhr.send(challenge)}catch(e){_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error("Failure requesting DRM license: "+e),this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_0__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorTypes.KEY_SYSTEM_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},_proto.onMediaAttached=function(event,data){if(this._emeEnabled){var media=data.media;this._media=media,media.addEventListener("encrypted",this._onMediaEncrypted)}},_proto.onMediaDetached=function(){var media=this._media,mediaKeysList=this._mediaKeysList;media&&(media.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(mediaKeysList.map(function(mediaKeysListItem){if(mediaKeysListItem.mediaKeysSession)return mediaKeysListItem.mediaKeysSession.close().catch(function(){})})).then(function(){return media.setMediaKeys(null)}).catch(function(){}))},_proto.onManifestParsed=function(event,data){if(this._emeEnabled){var audioCodecs=data.levels.map(function(level){return level.audioCodec}).filter(function(audioCodec){return!!audioCodec}),videoCodecs=data.levels.map(function(level){return level.videoCodec}).filter(function(videoCodec){return!!videoCodec});this._attemptKeySystemAccess(_utils_mediakeys_helper__WEBPACK_IMPORTED_MODULE_3__.KeySystems.WIDEVINE,audioCodecs,videoCodecs)}},Constructor=EMEController,(protoProps=[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}])&&_defineProperties(Constructor.prototype,protoProps),EMEController}()},"./src/controller/fps-controller.ts":
/*!******************************************!*\
        !*** ./src/controller/fps-controller.ts ***!
        \******************************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_285455__){"use strict";__nested_webpack_require_285455__.r(__webpack_exports__);var _events__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_285455__(
/*! ../events */
"./src/events.ts"),_utils_logger__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_285455__(
/*! ../utils/logger */
"./src/utils/logger.ts");__webpack_exports__.default=function(){function FPSController(hls){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=hls,this.registerListeners()}var _proto=FPSController.prototype;return _proto.setStreamController=function(streamController){this.streamController=streamController},_proto.registerListeners=function(){this.hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},_proto.unregisterListeners=function(){this.hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MEDIA_ATTACHING,this.onMediaAttaching)},_proto.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},_proto.onMediaAttaching=function(event,data){var config=this.hls.config;if(config.capLevelOnFPSDrop){var media=data.media instanceof self.HTMLVideoElement?data.media:null;this.media=media,media&&"function"==typeof media.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),config.fpsDroppedMonitoringPeriod)}},_proto.checkFPS=function(video,decodedFrames,droppedFrames){var currentTime=performance.now();if(decodedFrames){if(this.lastTime){var currentDropped=droppedFrames-this.lastDroppedFrames,currentDecoded=decodedFrames-this.lastDecodedFrames,droppedFPS=1e3*currentDropped/(currentTime-this.lastTime),hls=this.hls;if(hls.trigger(_events__WEBPACK_IMPORTED_MODULE_0__.Events.FPS_DROP,{currentDropped:currentDropped,currentDecoded:currentDecoded,totalDroppedFrames:droppedFrames}),droppedFPS>0&&currentDropped>hls.config.fpsDroppedMonitoringThreshold*currentDecoded){var currentLevel=hls.currentLevel;_utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+currentLevel),currentLevel>0&&(-1===hls.autoLevelCapping||hls.autoLevelCapping>=currentLevel)&&(hls.trigger(_events__WEBPACK_IMPORTED_MODULE_0__.Events.FPS_DROP_LEVEL_CAPPING,{level:currentLevel-=1,droppedLevel:hls.currentLevel}),hls.autoLevelCapping=currentLevel,this.streamController.nextLevelSwitch())}}this.lastTime=currentTime,this.lastDroppedFrames=droppedFrames,this.lastDecodedFrames=decodedFrames}},_proto.checkFPSInterval=function(){var video=this.media;if(video)if(this.isVideoPlaybackQualityAvailable){var videoPlaybackQuality=video.getVideoPlaybackQuality();this.checkFPS(video,videoPlaybackQuality.totalVideoFrames,videoPlaybackQuality.droppedVideoFrames)}else this.checkFPS(video,video.webkitDecodedFrameCount,video.webkitDroppedFrameCount)},FPSController}()},"./src/controller/fragment-finders.ts":
/*!********************************************!*\
        !*** ./src/controller/fragment-finders.ts ***!
        \********************************************/
/*! exports provided: findFragmentByPDT, findFragmentByPTS, fragmentWithinToleranceTest, pdtWithinToleranceTest, findFragWithCC */
function(module,__webpack_exports__,__nested_webpack_require_291241__){"use strict";__nested_webpack_require_291241__.r(__webpack_exports__),__nested_webpack_require_291241__.d(__webpack_exports__,"findFragmentByPDT",function(){return findFragmentByPDT}),__nested_webpack_require_291241__.d(__webpack_exports__,"findFragmentByPTS",function(){return findFragmentByPTS}),__nested_webpack_require_291241__.d(__webpack_exports__,"fragmentWithinToleranceTest",function(){return fragmentWithinToleranceTest}),__nested_webpack_require_291241__.d(__webpack_exports__,"pdtWithinToleranceTest",function(){return pdtWithinToleranceTest}),__nested_webpack_require_291241__.d(__webpack_exports__,"findFragWithCC",function(){return findFragWithCC});var _home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_291241__(
/*! ./src/polyfills/number */
"./src/polyfills/number.ts"),_utils_binary_search__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_291241__(
/*! ../utils/binary-search */
"./src/utils/binary-search.ts");function findFragmentByPDT(fragments,PDTValue,maxFragLookUpTolerance){if(null===PDTValue||!Array.isArray(fragments)||!fragments.length||!Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(PDTValue))return null;if(PDTValue<(fragments[0].programDateTime||0))return null;if(PDTValue>=(fragments[fragments.length-1].endProgramDateTime||0))return null;maxFragLookUpTolerance=maxFragLookUpTolerance||0;for(var seg=0;seg<fragments.length;++seg){var frag=fragments[seg];if(pdtWithinToleranceTest(PDTValue,maxFragLookUpTolerance,frag))return frag}return null}function findFragmentByPTS(fragPrevious,fragments,bufferEnd,maxFragLookUpTolerance){void 0===bufferEnd&&(bufferEnd=0),void 0===maxFragLookUpTolerance&&(maxFragLookUpTolerance=0);var fragNext=null;return fragPrevious?fragNext=fragments[fragPrevious.sn-fragments[0].sn+1]||null:0===bufferEnd&&0===fragments[0].start&&(fragNext=fragments[0]),fragNext&&0===fragmentWithinToleranceTest(bufferEnd,maxFragLookUpTolerance,fragNext)?fragNext:_utils_binary_search__WEBPACK_IMPORTED_MODULE_1__.default.search(fragments,fragmentWithinToleranceTest.bind(null,bufferEnd,maxFragLookUpTolerance))||fragNext}function fragmentWithinToleranceTest(bufferEnd,maxFragLookUpTolerance,candidate){void 0===bufferEnd&&(bufferEnd=0),void 0===maxFragLookUpTolerance&&(maxFragLookUpTolerance=0);var candidateLookupTolerance=Math.min(maxFragLookUpTolerance,candidate.duration+(candidate.deltaPTS?candidate.deltaPTS:0));return candidate.start+candidate.duration-candidateLookupTolerance<=bufferEnd?1:candidate.start-candidateLookupTolerance>bufferEnd&&candidate.start?-1:0}function pdtWithinToleranceTest(pdtBufferEnd,maxFragLookUpTolerance,candidate){var candidateLookupTolerance=1e3*Math.min(maxFragLookUpTolerance,candidate.duration+(candidate.deltaPTS?candidate.deltaPTS:0));return(candidate.endProgramDateTime||0)-candidateLookupTolerance>pdtBufferEnd}function findFragWithCC(fragments,cc){return _utils_binary_search__WEBPACK_IMPORTED_MODULE_1__.default.search(fragments,function(candidate){return candidate.cc<cc?1:candidate.cc>cc?-1:0})}},"./src/controller/fragment-tracker.ts":
/*!********************************************!*\
        !*** ./src/controller/fragment-tracker.ts ***!
        \********************************************/
/*! exports provided: FragmentState, FragmentTracker */
function(module,__webpack_exports__,__nested_webpack_require_300451__){"use strict";__nested_webpack_require_300451__.r(__webpack_exports__),__nested_webpack_require_300451__.d(__webpack_exports__,"FragmentState",function(){return FragmentState}),__nested_webpack_require_300451__.d(__webpack_exports__,"FragmentTracker",function(){return FragmentTracker});var _events__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_300451__(
/*! ../events */
"./src/events.ts"),_types_loader__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_300451__(
/*! ../types/loader */
"./src/types/loader.ts"),FragmentState=function(){return function(FragmentState){FragmentState.NOT_LOADED="NOT_LOADED",FragmentState.BACKTRACKED="BACKTRACKED",FragmentState.APPENDING="APPENDING",FragmentState.PARTIAL="PARTIAL",FragmentState.OK="OK"}(FragmentState||(FragmentState={})),FragmentState}(),FragmentTracker=function(){function FragmentTracker(hls){this.activeFragment=null,this.activeParts=null,this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=hls,this._registerListeners()}var _proto=FragmentTracker.prototype;return _proto._registerListeners=function(){var hls=this.hls;hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.BUFFER_APPENDED,this.onBufferAppended,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.FRAG_BUFFERED,this.onFragBuffered,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.FRAG_LOADED,this.onFragLoaded,this)},_proto._unregisterListeners=function(){var hls=this.hls;hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.BUFFER_APPENDED,this.onBufferAppended,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.FRAG_BUFFERED,this.onFragBuffered,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.FRAG_LOADED,this.onFragLoaded,this)},_proto.destroy=function(){this._unregisterListeners(),this.fragments=this.timeRanges=null},_proto.getAppendedFrag=function(position,levelType){if(levelType===_types_loader__WEBPACK_IMPORTED_MODULE_1__.PlaylistLevelType.MAIN){var activeFragment=this.activeFragment,activeParts=this.activeParts;if(!activeFragment)return null;if(activeParts)for(var i=activeParts.length;i--;){var activePart=activeParts[i],appendedPTS=activePart?activePart.end:activeFragment.appendedPTS;if(activePart.start<=position&&void 0!==appendedPTS&&position<=appendedPTS)return i>9&&(this.activeParts=activeParts.slice(i-9)),activePart}else if(activeFragment.start<=position&&void 0!==activeFragment.appendedPTS&&position<=activeFragment.appendedPTS)return activeFragment}return this.getBufferedFrag(position,levelType)},_proto.getBufferedFrag=function(position,levelType){for(var fragments=this.fragments,keys=Object.keys(fragments),i=keys.length;i--;){var fragmentEntity=fragments[keys[i]];if((null==fragmentEntity?void 0:fragmentEntity.body.type)===levelType&&fragmentEntity.buffered){var frag=fragmentEntity.body;if(frag.start<=position&&position<=frag.end)return frag}}return null},_proto.detectEvictedFragments=function(elementaryStream,timeRange,playlistType){var _this=this;Object.keys(this.fragments).forEach(function(key){var fragmentEntity=_this.fragments[key];if(fragmentEntity)if(fragmentEntity.buffered){var esData=fragmentEntity.range[elementaryStream];esData&&esData.time.some(function(time){var isNotBuffered=!_this.isTimeBuffered(time.startPTS,time.endPTS,timeRange);return isNotBuffered&&_this.removeFragment(fragmentEntity.body),isNotBuffered})}else fragmentEntity.body.type===playlistType&&_this.removeFragment(fragmentEntity.body)})},_proto.detectPartialFragments=function(data){var _this2=this,timeRanges=this.timeRanges,frag=data.frag,part=data.part;if(timeRanges&&"initSegment"!==frag.sn){var fragKey=getFragmentKey(frag),fragmentEntity=this.fragments[fragKey];fragmentEntity&&(Object.keys(timeRanges).forEach(function(elementaryStream){var streamInfo=frag.elementaryStreams[elementaryStream];streamInfo&&(fragmentEntity.range[elementaryStream]=_this2.getBufferedTimes(frag,part,null!==part||!0===streamInfo.partial,timeRanges[elementaryStream]))}),fragmentEntity.backtrack=fragmentEntity.loaded=null,Object.keys(fragmentEntity.range).length?fragmentEntity.buffered=!0:this.removeFragment(fragmentEntity.body))}},_proto.fragBuffered=function(frag){var fragKey=getFragmentKey(frag),fragmentEntity=this.fragments[fragKey];fragmentEntity&&(fragmentEntity.backtrack=fragmentEntity.loaded=null,fragmentEntity.buffered=!0)},_proto.getBufferedTimes=function(fragment,part,partial,timeRange){for(var buffered={time:[],partial:partial},startPTS=part?part.start:fragment.start,endPTS=part?part.end:fragment.end,minEndPTS=fragment.minEndPTS||endPTS,maxStartPTS=fragment.maxStartPTS||startPTS,i=0;i<timeRange.length;i++){var startTime=timeRange.start(i)-this.bufferPadding,endTime=timeRange.end(i)+this.bufferPadding;if(maxStartPTS>=startTime&&minEndPTS<=endTime){buffered.time.push({startPTS:Math.max(startPTS,timeRange.start(i)),endPTS:Math.min(endPTS,timeRange.end(i))});break}if(startPTS<endTime&&endPTS>startTime)buffered.partial=!0,buffered.time.push({startPTS:Math.max(startPTS,timeRange.start(i)),endPTS:Math.min(endPTS,timeRange.end(i))});else if(endPTS<=startTime)break}return buffered},_proto.getPartialFragment=function(time){var timePadding,startTime,endTime,bestFragment=null,bestOverlap=0,bufferPadding=this.bufferPadding,fragments=this.fragments;return Object.keys(fragments).forEach(function(key){var fragmentEntity=fragments[key];fragmentEntity&&isPartial(fragmentEntity)&&(endTime=fragmentEntity.body.end+bufferPadding,time>=(startTime=fragmentEntity.body.start-bufferPadding)&&time<=endTime&&(timePadding=Math.min(time-startTime,endTime-time),bestOverlap<=timePadding&&(bestFragment=fragmentEntity.body,bestOverlap=timePadding)))}),bestFragment},_proto.getState=function(fragment){var fragKey=getFragmentKey(fragment),fragmentEntity=this.fragments[fragKey];return fragmentEntity?fragmentEntity.buffered?isPartial(fragmentEntity)?FragmentState.PARTIAL:FragmentState.OK:fragmentEntity.backtrack?FragmentState.BACKTRACKED:FragmentState.APPENDING:FragmentState.NOT_LOADED},_proto.backtrack=function(frag,data){var fragKey=getFragmentKey(frag),fragmentEntity=this.fragments[fragKey];if(!fragmentEntity||fragmentEntity.backtrack)return null;var backtrack=fragmentEntity.backtrack=data||fragmentEntity.loaded;return fragmentEntity.loaded=null,backtrack},_proto.getBacktrackData=function(fragment){var fragKey=getFragmentKey(fragment),fragmentEntity=this.fragments[fragKey];if(fragmentEntity){var _backtrack$payload,backtrack=fragmentEntity.backtrack;if(null!=backtrack&&null!==(_backtrack$payload=backtrack.payload)&&void 0!==_backtrack$payload&&_backtrack$payload.byteLength)return backtrack;this.removeFragment(fragment)}return null},_proto.isTimeBuffered=function(startPTS,endPTS,timeRange){for(var startTime,endTime,i=0;i<timeRange.length;i++){if(startTime=timeRange.start(i)-this.bufferPadding,endTime=timeRange.end(i)+this.bufferPadding,startPTS>=startTime&&endPTS<=endTime)return!0;if(endPTS<=startTime)return!1}return!1},_proto.onFragLoaded=function(event,data){var frag=data.frag;if("initSegment"!==frag.sn&&!frag.bitrateTest&&!data.part){var fragKey=getFragmentKey(frag);this.fragments[fragKey]={body:frag,loaded:data,backtrack:null,buffered:!1,range:Object.create(null)}}},_proto.onBufferAppended=function(event,data){var _this3=this,frag=data.frag,part=data.part,timeRanges=data.timeRanges;if(frag.type===_types_loader__WEBPACK_IMPORTED_MODULE_1__.PlaylistLevelType.MAIN)if(this.activeFragment=frag,part){var activeParts=this.activeParts;activeParts||(this.activeParts=activeParts=[]),activeParts.push(part)}else this.activeParts=null;this.timeRanges=timeRanges,Object.keys(timeRanges).forEach(function(elementaryStream){var timeRange=timeRanges[elementaryStream];if(_this3.detectEvictedFragments(elementaryStream,timeRange),!part)for(var i=0;i<timeRange.length;i++)frag.appendedPTS=Math.max(timeRange.end(i),frag.appendedPTS||0)})},_proto.onFragBuffered=function(event,data){this.detectPartialFragments(data)},_proto.hasFragment=function(fragment){var fragKey=getFragmentKey(fragment);return!!this.fragments[fragKey]},_proto.removeFragmentsInRange=function(start,end,playlistType){var _this4=this;Object.keys(this.fragments).forEach(function(key){var fragmentEntity=_this4.fragments[key];if(fragmentEntity&&fragmentEntity.buffered){var frag=fragmentEntity.body;frag.type===playlistType&&frag.start<end&&frag.end>start&&_this4.removeFragment(frag)}})},_proto.removeFragment=function(fragment){var fragKey=getFragmentKey(fragment);fragment.stats.loaded=0,fragment.clearElementaryStreamInfo(),delete this.fragments[fragKey]},_proto.removeAllFragments=function(){this.fragments=Object.create(null),this.activeFragment=null,this.activeParts=null},FragmentTracker}();function isPartial(fragmentEntity){var _fragmentEntity$range,_fragmentEntity$range2;return fragmentEntity.buffered&&((null===(_fragmentEntity$range=fragmentEntity.range.video)||void 0===_fragmentEntity$range?void 0:_fragmentEntity$range.partial)||(null===(_fragmentEntity$range2=fragmentEntity.range.audio)||void 0===_fragmentEntity$range2?void 0:_fragmentEntity$range2.partial))}function getFragmentKey(fragment){return fragment.type+"_"+fragment.level+"_"+fragment.urlId+"_"+fragment.sn}},"./src/controller/gap-controller.ts":
/*!******************************************!*\
        !*** ./src/controller/gap-controller.ts ***!
        \******************************************/
/*! exports provided: STALL_MINIMUM_DURATION_MS, MAX_START_GAP_JUMP, SKIP_BUFFER_HOLE_STEP_SECONDS, SKIP_BUFFER_RANGE_START, default */
function(module,__webpack_exports__,__nested_webpack_require_319180__){"use strict";__nested_webpack_require_319180__.r(__webpack_exports__),__nested_webpack_require_319180__.d(__webpack_exports__,"STALL_MINIMUM_DURATION_MS",function(){return STALL_MINIMUM_DURATION_MS}),__nested_webpack_require_319180__.d(__webpack_exports__,"MAX_START_GAP_JUMP",function(){return MAX_START_GAP_JUMP}),__nested_webpack_require_319180__.d(__webpack_exports__,"SKIP_BUFFER_HOLE_STEP_SECONDS",function(){return SKIP_BUFFER_HOLE_STEP_SECONDS}),__nested_webpack_require_319180__.d(__webpack_exports__,"SKIP_BUFFER_RANGE_START",function(){return SKIP_BUFFER_RANGE_START}),__nested_webpack_require_319180__.d(__webpack_exports__,"default",function(){return GapController});var _utils_buffer_helper__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_319180__(
/*! ../utils/buffer-helper */
"./src/utils/buffer-helper.ts"),_errors__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_319180__(
/*! ../errors */
"./src/errors.ts"),_events__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_319180__(
/*! ../events */
"./src/events.ts"),_utils_logger__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_319180__(
/*! ../utils/logger */
"./src/utils/logger.ts"),STALL_MINIMUM_DURATION_MS=250,MAX_START_GAP_JUMP=2,SKIP_BUFFER_HOLE_STEP_SECONDS=.1,SKIP_BUFFER_RANGE_START=.05,GapController=function(){function GapController(config,media,fragmentTracker,hls){this.config=void 0,this.media=void 0,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=config,this.media=media,this.fragmentTracker=fragmentTracker,this.hls=hls}var _proto=GapController.prototype;return _proto.destroy=function(){this.hls=this.fragmentTracker=this.media=null},_proto.poll=function(lastCurrentTime){var config=this.config,media=this.media,stalled=this.stalled,currentTime=media.currentTime,seeking=media.seeking,seeked=this.seeking&&!seeking,beginSeek=!this.seeking&&seeking;if(this.seeking=seeking,currentTime===lastCurrentTime){if((beginSeek||seeked)&&(this.stalled=null),!media.paused&&!media.ended&&0!==media.playbackRate&&_utils_buffer_helper__WEBPACK_IMPORTED_MODULE_0__.BufferHelper.getBuffered(media).length){var bufferInfo=_utils_buffer_helper__WEBPACK_IMPORTED_MODULE_0__.BufferHelper.bufferInfo(media,currentTime,0),nextStart=bufferInfo.nextStart||0;if(bufferInfo.len>0||nextStart){if(seeking){var hasEnoughBuffer=bufferInfo.len>MAX_START_GAP_JUMP,noBufferGap=!nextStart||nextStart-currentTime>MAX_START_GAP_JUMP&&!this.fragmentTracker.getPartialFragment(currentTime);if(hasEnoughBuffer||noBufferGap)return;this.moved=!1}if(!this.moved&&null!==this.stalled){var _level$details,startJump=Math.max(nextStart,bufferInfo.start||0)-currentTime,level=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,isLive=null==level||null===(_level$details=level.details)||void 0===_level$details?void 0:_level$details.live;if(startJump>0&&startJump<=(isLive?2*level.details.targetduration:MAX_START_GAP_JUMP))return void this._trySkipBufferHole(null)}var tnow=self.performance.now();if(null!==stalled){var stalledDuration=tnow-stalled;!seeking&&stalledDuration>=STALL_MINIMUM_DURATION_MS&&this._reportStall(bufferInfo.len);var bufferedWithHoles=_utils_buffer_helper__WEBPACK_IMPORTED_MODULE_0__.BufferHelper.bufferInfo(media,currentTime,config.maxBufferHole);this._tryFixBufferStall(bufferedWithHoles,stalledDuration)}else this.stalled=tnow}}}else if(this.moved=!0,null!==stalled){if(this.stallReported){var _stalledDuration=self.performance.now()-stalled;_utils_logger__WEBPACK_IMPORTED_MODULE_3__.logger.warn("playback not stuck anymore @"+currentTime+", after "+Math.round(_stalledDuration)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}},_proto._tryFixBufferStall=function(bufferInfo,stalledDurationMs){var config=this.config,partial=this.fragmentTracker.getPartialFragment(this.media.currentTime);partial&&this._trySkipBufferHole(partial)||bufferInfo.len>config.maxBufferHole&&stalledDurationMs>1e3*config.highBufferWatchdogPeriod&&(_utils_logger__WEBPACK_IMPORTED_MODULE_3__.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},_proto._reportStall=function(bufferLen){var hls=this.hls,media=this.media;this.stallReported||(this.stallReported=!0,_utils_logger__WEBPACK_IMPORTED_MODULE_3__.logger.warn("Playback stalling at @"+media.currentTime+" due to low buffer (buffer="+bufferLen+")"),hls.trigger(_events__WEBPACK_IMPORTED_MODULE_2__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorTypes.MEDIA_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:bufferLen}))},_proto._trySkipBufferHole=function(partial){for(var config=this.config,hls=this.hls,media=this.media,currentTime=media.currentTime,lastEndTime=0,buffered=_utils_buffer_helper__WEBPACK_IMPORTED_MODULE_0__.BufferHelper.getBuffered(media),i=0;i<buffered.length;i++){var startTime=buffered.start(i);if(currentTime+config.maxBufferHole>=lastEndTime&&currentTime<startTime){var targetTime=Math.max(startTime+SKIP_BUFFER_RANGE_START,media.currentTime+SKIP_BUFFER_HOLE_STEP_SECONDS);return _utils_logger__WEBPACK_IMPORTED_MODULE_3__.logger.warn("skipping hole, adjusting currentTime from "+currentTime+" to "+targetTime),this.moved=!0,this.stalled=null,media.currentTime=targetTime,partial&&hls.trigger(_events__WEBPACK_IMPORTED_MODULE_2__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorTypes.MEDIA_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+currentTime+" to "+targetTime,frag:partial}),targetTime}lastEndTime=buffered.end(i)}return 0},_proto._tryNudgeBuffer=function(){var config=this.config,hls=this.hls,media=this.media,currentTime=media.currentTime,nudgeRetry=(this.nudgeRetry||0)+1;if(this.nudgeRetry=nudgeRetry,nudgeRetry<config.nudgeMaxRetry){var targetTime=currentTime+nudgeRetry*config.nudgeOffset;_utils_logger__WEBPACK_IMPORTED_MODULE_3__.logger.warn("Nudging 'currentTime' from "+currentTime+" to "+targetTime),media.currentTime=targetTime,hls.trigger(_events__WEBPACK_IMPORTED_MODULE_2__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorTypes.MEDIA_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else _utils_logger__WEBPACK_IMPORTED_MODULE_3__.logger.error("Playhead still not moving while enough data buffered @"+currentTime+" after "+config.nudgeMaxRetry+" nudges"),hls.trigger(_events__WEBPACK_IMPORTED_MODULE_2__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorTypes.MEDIA_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},GapController}()},"./src/controller/id3-track-controller.ts":
/*!************************************************!*\
        !*** ./src/controller/id3-track-controller.ts ***!
        \************************************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_333975__){"use strict";__nested_webpack_require_333975__.r(__webpack_exports__);var _events__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_333975__(
/*! ../events */
"./src/events.ts"),_utils_texttrack_utils__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_333975__(
/*! ../utils/texttrack-utils */
"./src/utils/texttrack-utils.ts"),_demux_id3__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_333975__(
/*! ../demux/id3 */
"./src/demux/id3.ts");__webpack_exports__.default=function(){function ID3TrackController(hls){this.hls=void 0,this.id3Track=null,this.media=null,this.hls=hls,this._registerListeners()}var _proto=ID3TrackController.prototype;return _proto.destroy=function(){this._unregisterListeners()},_proto._registerListeners=function(){var hls=this.hls;hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MEDIA_ATTACHED,this.onMediaAttached,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MEDIA_DETACHING,this.onMediaDetaching,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},_proto._unregisterListeners=function(){var hls=this.hls;hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MEDIA_ATTACHED,this.onMediaAttached,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MEDIA_DETACHING,this.onMediaDetaching,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},_proto.onMediaAttached=function(event,data){this.media=data.media},_proto.onMediaDetaching=function(){this.id3Track&&(Object(_utils_texttrack_utils__WEBPACK_IMPORTED_MODULE_1__.clearCurrentCues)(this.id3Track),this.id3Track=null,this.media=null)},_proto.getID3Track=function(textTracks){if(this.media){for(var i=0;i<textTracks.length;i++){var textTrack=textTracks[i];if("metadata"===textTrack.kind&&"id3"===textTrack.label)return Object(_utils_texttrack_utils__WEBPACK_IMPORTED_MODULE_1__.sendAddTrackEvent)(textTrack,this.media),textTrack}return this.media.addTextTrack("metadata","id3")}},_proto.onFragParsingMetadata=function(event,data){if(this.media){var fragment=data.frag,samples=data.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var Cue=self.WebKitDataCue||self.VTTCue||self.TextTrackCue,i=0;i<samples.length;i++){var frames=_demux_id3__WEBPACK_IMPORTED_MODULE_2__.getID3Frames(samples[i].data);if(frames){var startTime=samples[i].pts,endTime=i<samples.length-1?samples[i+1].pts:fragment.end;endTime-startTime<=0&&(endTime=startTime+.25);for(var j=0;j<frames.length;j++){var frame=frames[j];if(!_demux_id3__WEBPACK_IMPORTED_MODULE_2__.isTimeStampFrame(frame)){var cue=new Cue(startTime,endTime,"");cue.value=frame,this.id3Track.addCue(cue)}}}}}},_proto.onBufferFlushing=function(event,_ref){var startOffset=_ref.startOffset,endOffset=_ref.endOffset,type=_ref.type;if(!type||"audio"===type){var id3Track=this.id3Track;id3Track&&Object(_utils_texttrack_utils__WEBPACK_IMPORTED_MODULE_1__.removeCuesInRange)(id3Track,startOffset,endOffset)}},ID3TrackController}()},"./src/controller/latency-controller.ts":
/*!**********************************************!*\
        !*** ./src/controller/latency-controller.ts ***!
        \**********************************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_340237__){"use strict";__nested_webpack_require_340237__.r(__webpack_exports__),__nested_webpack_require_340237__.d(__webpack_exports__,"default",function(){return LatencyController});var _errors__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_340237__(
/*! ../errors */
"./src/errors.ts"),_events__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_340237__(
/*! ../events */
"./src/events.ts"),_utils_logger__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_340237__(
/*! ../utils/logger */
"./src/utils/logger.ts");function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var LatencyController=function(){function LatencyController(hls){var _this=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return _this.timeupdate()},this.hls=hls,this.config=hls.config,this.registerListeners()}var Constructor,protoProps,_proto=LatencyController.prototype;return _proto.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},_proto.registerListeners=function(){this.hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.ERROR,this.onError,this)},_proto.unregisterListeners=function(){this.hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.ERROR,this.onError)},_proto.onMediaAttached=function(event,data){this.media=data.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},_proto.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},_proto.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},_proto.onLevelUpdated=function(event,_ref){var details=_ref.details;this.levelDetails=details,details.advanced&&this.timeupdate(),!details.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},_proto.onError=function(event,data){data.details===_errors__WEBPACK_IMPORTED_MODULE_0__.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},_proto.timeupdate=function(){var media=this.media,levelDetails=this.levelDetails;if(media&&levelDetails){this.currentTime=media.currentTime;var latency=this.computeLatency();if(null!==latency){this._latency=latency;var _this$config=this.config,maxLiveSyncPlaybackRate=_this$config.maxLiveSyncPlaybackRate;if(_this$config.lowLatencyMode&&1!==maxLiveSyncPlaybackRate){var targetLatency=this.targetLatency;if(null!==targetLatency){var distanceFromTarget=latency-targetLatency,liveMinLatencyDuration=Math.min(this.maxLatency,targetLatency+levelDetails.targetduration);if(levelDetails.live&&distanceFromTarget<liveMinLatencyDuration&&distanceFromTarget>.05&&this.forwardBufferLength>1){var max=Math.min(2,Math.max(1,maxLiveSyncPlaybackRate)),rate=Math.round(2/(1+Math.exp(-.75*distanceFromTarget-this.edgeStalled))*20)/20;media.playbackRate=Math.min(max,Math.max(1,rate))}else 1!==media.playbackRate&&0!==media.playbackRate&&(media.playbackRate=1)}}}}},_proto.estimateLiveEdge=function(){var levelDetails=this.levelDetails;return null===levelDetails?null:levelDetails.edge+levelDetails.age},_proto.computeLatency=function(){var liveEdge=this.estimateLiveEdge();return null===liveEdge?null:liveEdge-this.currentTime},Constructor=LatencyController,(protoProps=[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var config=this.config,levelDetails=this.levelDetails;return void 0!==config.liveMaxLatencyDuration?config.liveMaxLatencyDuration:levelDetails?config.liveMaxLatencyDurationCount*levelDetails.targetduration:0}},{key:"targetLatency",get:function(){var levelDetails=this.levelDetails;if(null===levelDetails)return null;var targetduration=levelDetails.targetduration,_this$config2=this.config,liveSyncDuration=_this$config2.liveSyncDuration,userConfig=this.hls.userConfig,targetLatency=_this$config2.lowLatencyMode&&levelDetails.partHoldBack||levelDetails.holdBack;return(userConfig.liveSyncDuration||userConfig.liveSyncDurationCount||0===targetLatency)&&(targetLatency=void 0!==liveSyncDuration?liveSyncDuration:_this$config2.liveSyncDurationCount*targetduration),targetLatency+Math.min(1*this.stallCount,targetduration)}},{key:"liveSyncPosition",get:function(){var liveEdge=this.estimateLiveEdge(),targetLatency=this.targetLatency,levelDetails=this.levelDetails;if(null===liveEdge||null===targetLatency||null===levelDetails)return null;var edge=levelDetails.edge,max=edge-(this.config.lowLatencyMode&&levelDetails.partTarget||levelDetails.targetduration);return Math.min(Math.max(edge-levelDetails.totalduration,liveEdge-targetLatency-this.edgeStalled),max)}},{key:"drift",get:function(){var levelDetails=this.levelDetails;return null===levelDetails?1:levelDetails.drift}},{key:"edgeStalled",get:function(){var levelDetails=this.levelDetails;return null===levelDetails?0:Math.max(levelDetails.age-3*(this.config.lowLatencyMode&&levelDetails.partTarget||levelDetails.targetduration),0)}},{key:"forwardBufferLength",get:function(){var media=this.media,levelDetails=this.levelDetails;if(!media||!levelDetails)return 0;var bufferedRanges=media.buffered.length;return bufferedRanges?media.buffered.end(bufferedRanges-1):levelDetails.edge-this.currentTime}}])&&_defineProperties(Constructor.prototype,protoProps),LatencyController}()},"./src/controller/level-controller.ts":
/*!********************************************!*\
        !*** ./src/controller/level-controller.ts ***!
        \********************************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_351973__){"use strict";__nested_webpack_require_351973__.r(__webpack_exports__),__nested_webpack_require_351973__.d(__webpack_exports__,"default",function(){return LevelController});var _types_level__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_351973__(
/*! ../types/level */
"./src/types/level.ts"),_events__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_351973__(
/*! ../events */
"./src/events.ts"),_errors__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_351973__(
/*! ../errors */
"./src/errors.ts"),_utils_codecs__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_351973__(
/*! ../utils/codecs */
"./src/utils/codecs.ts"),_level_helper__WEBPACK_IMPORTED_MODULE_4__=__nested_webpack_require_351973__(
/*! ./level-helper */
"./src/controller/level-helper.ts"),_base_playlist_controller__WEBPACK_IMPORTED_MODULE_5__=__nested_webpack_require_351973__(
/*! ./base-playlist-controller */
"./src/controller/base-playlist-controller.ts"),_types_loader__WEBPACK_IMPORTED_MODULE_6__=__nested_webpack_require_351973__(
/*! ../types/loader */
"./src/types/loader.ts");function _extends(){return _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}var chromeOrFirefox=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),LevelController=function(_BasePlaylistControll){var subClass,superClass;function LevelController(hls){var _this;return(_this=_BasePlaylistControll.call(this,hls,"[level-controller]")||this)._levels=[],_this._firstLevel=-1,_this._startLevel=void 0,_this.currentLevelIndex=-1,_this.manualLevelIndex=-1,_this.onParsedComplete=void 0,_this._registerListeners(),_this}superClass=_BasePlaylistControll,(subClass=LevelController).prototype=Object.create(superClass.prototype),subClass.prototype.constructor=subClass,_setPrototypeOf(subClass,superClass);var Constructor,protoProps,_proto=LevelController.prototype;return _proto._registerListeners=function(){var hls=this.hls;hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.MANIFEST_LOADED,this.onManifestLoaded,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.LEVEL_LOADED,this.onLevelLoaded,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.FRAG_LOADED,this.onFragLoaded,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.ERROR,this.onError,this)},_proto._unregisterListeners=function(){var hls=this.hls;hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.MANIFEST_LOADED,this.onManifestLoaded,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.LEVEL_LOADED,this.onLevelLoaded,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.FRAG_LOADED,this.onFragLoaded,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.ERROR,this.onError,this)},_proto.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,_BasePlaylistControll.prototype.destroy.call(this)},_proto.startLoad=function(){this._levels.forEach(function(level){level.loadError=0}),_BasePlaylistControll.prototype.startLoad.call(this)},_proto.onManifestLoaded=function(event,data){var bitrateStart,levelFromSet,levels=[],audioTracks=[],subtitleTracks=[],levelSet={},resolutionFound=!1,videoCodecFound=!1,audioCodecFound=!1;if(data.levels.forEach(function(levelParsed){var attributes=levelParsed.attrs;resolutionFound=resolutionFound||!(!levelParsed.width||!levelParsed.height),videoCodecFound=videoCodecFound||!!levelParsed.videoCodec,audioCodecFound=audioCodecFound||!!levelParsed.audioCodec,chromeOrFirefox&&levelParsed.audioCodec&&-1!==levelParsed.audioCodec.indexOf("mp4a.40.34")&&(levelParsed.audioCodec=void 0);var levelKey=levelParsed.bitrate+"-"+levelParsed.attrs.RESOLUTION+"-"+levelParsed.attrs.CODECS;(levelFromSet=levelSet[levelKey])?levelFromSet.url.push(levelParsed.url):(levelFromSet=new _types_level__WEBPACK_IMPORTED_MODULE_0__.Level(levelParsed),levelSet[levelKey]=levelFromSet,levels.push(levelFromSet)),attributes&&(attributes.AUDIO&&Object(_level_helper__WEBPACK_IMPORTED_MODULE_4__.addGroupId)(levelFromSet,"audio",attributes.AUDIO),attributes.SUBTITLES&&Object(_level_helper__WEBPACK_IMPORTED_MODULE_4__.addGroupId)(levelFromSet,"text",attributes.SUBTITLES))}),(resolutionFound||videoCodecFound)&&audioCodecFound&&(levels=levels.filter(function(_ref){return!!_ref.videoCodec||!(!_ref.width||!_ref.height)})),levels=levels.filter(function(_ref2){var audioCodec=_ref2.audioCodec,videoCodec=_ref2.videoCodec;return(!audioCodec||Object(_utils_codecs__WEBPACK_IMPORTED_MODULE_3__.isCodecSupportedInMp4)(audioCodec,"audio"))&&(!videoCodec||Object(_utils_codecs__WEBPACK_IMPORTED_MODULE_3__.isCodecSupportedInMp4)(videoCodec,"video"))}),data.audioTracks&&(audioTracks=data.audioTracks.filter(function(track){return!track.audioCodec||Object(_utils_codecs__WEBPACK_IMPORTED_MODULE_3__.isCodecSupportedInMp4)(track.audioCodec,"audio")}),Object(_level_helper__WEBPACK_IMPORTED_MODULE_4__.assignTrackIdsByGroup)(audioTracks)),data.subtitles&&(subtitleTracks=data.subtitles,Object(_level_helper__WEBPACK_IMPORTED_MODULE_4__.assignTrackIdsByGroup)(subtitleTracks)),levels.length>0){bitrateStart=levels[0].bitrate,levels.sort(function(a,b){return a.bitrate-b.bitrate}),this._levels=levels;for(var i=0;i<levels.length;i++)if(levels[i].bitrate===bitrateStart){this._firstLevel=i,this.log("manifest loaded, "+levels.length+" level(s) found, first bitrate: "+bitrateStart);break}var edata={levels:levels,audioTracks:audioTracks,subtitleTracks:subtitleTracks,firstLevel:this._firstLevel,stats:data.stats,audio:audioCodecFound,video:videoCodecFound,altAudio:!(audioCodecFound&&!videoCodecFound)&&audioTracks.some(function(t){return!!t.url})};this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.MANIFEST_PARSED,edata),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_2__.ErrorTypes.MEDIA_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_2__.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:data.url,reason:"no level with compatible codecs found in manifest"})},_proto.onError=function(event,data){if(_BasePlaylistControll.prototype.onError.call(this,event,data),!data.fatal){var context=data.context,level=this._levels[this.currentLevelIndex];if(context&&(context.type===_types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistContextType.AUDIO_TRACK&&level.audioGroupIds&&context.groupId===level.audioGroupIds[level.urlId]||context.type===_types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistContextType.SUBTITLE_TRACK&&level.textGroupIds&&context.groupId===level.textGroupIds[level.urlId]))this.redundantFailover(this.currentLevelIndex);else{var levelIndex,levelError=!1,levelSwitch=!0;switch(data.details){case _errors__WEBPACK_IMPORTED_MODULE_2__.ErrorDetails.FRAG_LOAD_ERROR:case _errors__WEBPACK_IMPORTED_MODULE_2__.ErrorDetails.FRAG_LOAD_TIMEOUT:case _errors__WEBPACK_IMPORTED_MODULE_2__.ErrorDetails.KEY_LOAD_ERROR:case _errors__WEBPACK_IMPORTED_MODULE_2__.ErrorDetails.KEY_LOAD_TIMEOUT:if(data.frag){var _level=this._levels[data.frag.level];_level?(_level.fragmentError++,_level.fragmentError>this.hls.config.fragLoadingMaxRetry&&(levelIndex=data.frag.level)):levelIndex=data.frag.level}break;case _errors__WEBPACK_IMPORTED_MODULE_2__.ErrorDetails.LEVEL_LOAD_ERROR:case _errors__WEBPACK_IMPORTED_MODULE_2__.ErrorDetails.LEVEL_LOAD_TIMEOUT:context&&(context.deliveryDirectives&&(levelSwitch=!1),levelIndex=context.level),levelError=!0;break;case _errors__WEBPACK_IMPORTED_MODULE_2__.ErrorDetails.REMUX_ALLOC_ERROR:levelIndex=data.level,levelError=!0}void 0!==levelIndex&&this.recoverLevel(data,levelIndex,levelError,levelSwitch)}}},_proto.recoverLevel=function(errorEvent,levelIndex,levelError,levelSwitch){var errorDetails=errorEvent.details,level=this._levels[levelIndex];if(level.loadError++,levelError){if(!this.retryLoadingOrFail(errorEvent))return void(this.currentLevelIndex=-1);errorEvent.levelRetry=!0}if(levelSwitch){var redundantLevels=level.url.length;if(redundantLevels>1&&level.loadError<redundantLevels)errorEvent.levelRetry=!0,this.redundantFailover(levelIndex);else if(-1===this.manualLevelIndex){var nextLevel=0===levelIndex?this._levels.length-1:levelIndex-1;this.currentLevelIndex!==nextLevel&&0===this._levels[nextLevel].loadError&&(this.warn(errorDetails+": switch to "+nextLevel),errorEvent.levelRetry=!0,this.hls.nextAutoLevel=nextLevel)}}},_proto.redundantFailover=function(levelIndex){var level=this._levels[levelIndex],redundantLevels=level.url.length;if(redundantLevels>1){var newUrlId=(level.urlId+1)%redundantLevels;this.warn("Switching to redundant URL-id "+newUrlId),this._levels.forEach(function(level){level.urlId=newUrlId}),this.level=levelIndex}},_proto.onFragLoaded=function(event,_ref3){var frag=_ref3.frag;if(void 0!==frag&&frag.type===_types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistLevelType.MAIN){var level=this._levels[frag.level];void 0!==level&&(level.fragmentError=0,level.loadError=0)}},_proto.onLevelLoaded=function(event,data){var _data$deliveryDirecti2,_data$deliveryDirecti,level=data.level,details=data.details,curLevel=this._levels[level];if(!curLevel)return this.warn("Invalid level index "+level),void(null!==(_data$deliveryDirecti=data.deliveryDirectives)&&void 0!==_data$deliveryDirecti&&_data$deliveryDirecti.skip&&(details.deltaUpdateFailed=!0));level===this.currentLevelIndex?(0===curLevel.fragmentError&&(curLevel.loadError=0,this.retryCount=0),this.playlistLoaded(level,data,curLevel.details)):null!==(_data$deliveryDirecti2=data.deliveryDirectives)&&void 0!==_data$deliveryDirecti2&&_data$deliveryDirecti2.skip&&(details.deltaUpdateFailed=!0)},_proto.onAudioTrackSwitched=function(event,data){var currentLevel=this.hls.levels[this.currentLevelIndex];if(currentLevel&&currentLevel.audioGroupIds){for(var urlId=-1,audioGroupId=this.hls.audioTracks[data.id].groupId,i=0;i<currentLevel.audioGroupIds.length;i++)if(currentLevel.audioGroupIds[i]===audioGroupId){urlId=i;break}urlId!==currentLevel.urlId&&(currentLevel.urlId=urlId,this.startLoad())}},_proto.loadPlaylist=function(hlsUrlParameters){var level=this.currentLevelIndex,currentLevel=this._levels[level];if(this.canLoad&&currentLevel&&currentLevel.url.length>0){var id=currentLevel.urlId,url=currentLevel.url[id];if(hlsUrlParameters)try{url=hlsUrlParameters.addDirectives(url)}catch(error){this.warn("Could not construct new URL with HLS Delivery Directives: "+error)}this.log("Attempt loading level index "+level+(hlsUrlParameters?" at sn "+hlsUrlParameters.msn+" part "+hlsUrlParameters.part:"")+" with URL-id "+id+" "+url),this.clearTimer(),this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.LEVEL_LOADING,{url:url,level:level,id:id,deliveryDirectives:hlsUrlParameters||null})}},_proto.removeLevel=function(levelIndex,urlId){var filterLevelAndGroupByIdIndex=function(url,id){return id!==urlId},levels=this._levels.filter(function(level,index){return index!==levelIndex||level.url.length>1&&void 0!==urlId&&(level.url=level.url.filter(filterLevelAndGroupByIdIndex),level.audioGroupIds&&(level.audioGroupIds=level.audioGroupIds.filter(filterLevelAndGroupByIdIndex)),level.textGroupIds&&(level.textGroupIds=level.textGroupIds.filter(filterLevelAndGroupByIdIndex)),level.urlId=0,!0)}).map(function(level,index){var details=level.details;return null!=details&&details.fragments&&details.fragments.forEach(function(fragment){fragment.level=index}),level});this._levels=levels,this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.LEVELS_UPDATED,{levels:levels})},Constructor=LevelController,(protoProps=[{key:"levels",get:function(){return 0===this._levels.length?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(newLevel){var _levels$newLevel,levels=this._levels;if(0!==levels.length&&(this.currentLevelIndex!==newLevel||null===(_levels$newLevel=levels[newLevel])||void 0===_levels$newLevel||!_levels$newLevel.details)){if(newLevel<0||newLevel>=levels.length){var fatal=newLevel<0;if(this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_2__.ErrorTypes.OTHER_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_2__.ErrorDetails.LEVEL_SWITCH_ERROR,level:newLevel,fatal:fatal,reason:"invalid level idx"}),fatal)return;newLevel=Math.min(newLevel,levels.length-1)}this.clearTimer();var lastLevelIndex=this.currentLevelIndex,lastLevel=levels[lastLevelIndex],level=levels[newLevel];this.log("switching to level "+newLevel+" from "+lastLevelIndex),this.currentLevelIndex=newLevel;var levelSwitchingData=_extends({},level,{level:newLevel,maxBitrate:level.maxBitrate,uri:level.uri,urlId:level.urlId});delete levelSwitchingData._urlId,this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.LEVEL_SWITCHING,levelSwitchingData);var levelDetails=level.details;if(!levelDetails||levelDetails.live){var hlsUrlParameters=this.switchParams(level.uri,null==lastLevel?void 0:lastLevel.details);this.loadPlaylist(hlsUrlParameters)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(newLevel){this.manualLevelIndex=newLevel,void 0===this._startLevel&&(this._startLevel=newLevel),-1!==newLevel&&(this.level=newLevel)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(newLevel){this._firstLevel=newLevel}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var configStartLevel=this.hls.config.startLevel;return void 0!==configStartLevel?configStartLevel:this._firstLevel}return this._startLevel},set:function(newLevel){this._startLevel=newLevel}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(nextLevel){this.level=nextLevel,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=nextLevel)}}])&&_defineProperties(Constructor.prototype,protoProps),LevelController}(_base_playlist_controller__WEBPACK_IMPORTED_MODULE_5__.default)},"./src/controller/level-helper.ts":
/*!****************************************!*\
        !*** ./src/controller/level-helper.ts ***!
        \****************************************/
/*! exports provided: addGroupId, assignTrackIdsByGroup, updatePTS, updateFragPTSDTS, mergeDetails, mapPartIntersection, mapFragmentIntersection, adjustSliding, addSliding, computeReloadInterval, getFragmentWithSN, getPartWith */
function(module,__webpack_exports__,__nested_webpack_require_379924__){"use strict";__nested_webpack_require_379924__.r(__webpack_exports__),__nested_webpack_require_379924__.d(__webpack_exports__,"addGroupId",function(){return addGroupId}),__nested_webpack_require_379924__.d(__webpack_exports__,"assignTrackIdsByGroup",function(){return assignTrackIdsByGroup}),__nested_webpack_require_379924__.d(__webpack_exports__,"updatePTS",function(){return updatePTS}),__nested_webpack_require_379924__.d(__webpack_exports__,"updateFragPTSDTS",function(){return updateFragPTSDTS}),__nested_webpack_require_379924__.d(__webpack_exports__,"mergeDetails",function(){return mergeDetails}),__nested_webpack_require_379924__.d(__webpack_exports__,"mapPartIntersection",function(){return mapPartIntersection}),__nested_webpack_require_379924__.d(__webpack_exports__,"mapFragmentIntersection",function(){return mapFragmentIntersection}),__nested_webpack_require_379924__.d(__webpack_exports__,"adjustSliding",function(){return adjustSliding}),__nested_webpack_require_379924__.d(__webpack_exports__,"addSliding",function(){return addSliding}),__nested_webpack_require_379924__.d(__webpack_exports__,"computeReloadInterval",function(){return computeReloadInterval}),__nested_webpack_require_379924__.d(__webpack_exports__,"getFragmentWithSN",function(){return getFragmentWithSN}),__nested_webpack_require_379924__.d(__webpack_exports__,"getPartWith",function(){return getPartWith});var _home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_379924__(
/*! ./src/polyfills/number */
"./src/polyfills/number.ts"),_utils_logger__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_379924__(
/*! ../utils/logger */
"./src/utils/logger.ts");function addGroupId(level,type,id){switch(type){case"audio":level.audioGroupIds||(level.audioGroupIds=[]),level.audioGroupIds.push(id);break;case"text":level.textGroupIds||(level.textGroupIds=[]),level.textGroupIds.push(id)}}function assignTrackIdsByGroup(tracks){var groups={};tracks.forEach(function(track){var groupId=track.groupId||"";track.id=groups[groupId]=groups[groupId]||0,groups[groupId]++})}function updatePTS(fragments,fromIdx,toIdx){updateFromToPTS(fragments[fromIdx],fragments[toIdx])}function updateFromToPTS(fragFrom,fragTo){var fragToPTS=fragTo.startPTS;if(Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(fragToPTS)){var frag,duration=0;fragTo.sn>fragFrom.sn?(duration=fragToPTS-fragFrom.start,frag=fragFrom):(duration=fragFrom.start-fragToPTS,frag=fragTo),frag.duration!==duration&&(frag.duration=duration)}else fragTo.start=fragTo.sn>fragFrom.sn?fragFrom.cc===fragTo.cc&&fragFrom.minEndPTS?fragFrom.start+(fragFrom.minEndPTS-fragFrom.start):fragFrom.start+fragFrom.duration:Math.max(fragFrom.start-fragTo.duration,0)}function updateFragPTSDTS(details,frag,startPTS,endPTS,startDTS,endDTS){endPTS-startPTS<=0&&(_utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.warn("Fragment should have a positive duration",frag),endPTS=startPTS+frag.duration,endDTS=startDTS+frag.duration);var maxStartPTS=startPTS,minEndPTS=endPTS,fragStartPts=frag.startPTS,fragEndPts=frag.endPTS;if(Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(fragStartPts)){var deltaPTS=Math.abs(fragStartPts-startPTS);frag.deltaPTS=Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(frag.deltaPTS)?Math.max(deltaPTS,frag.deltaPTS):deltaPTS,maxStartPTS=Math.max(startPTS,fragStartPts),startPTS=Math.min(startPTS,fragStartPts),startDTS=Math.min(startDTS,frag.startDTS),minEndPTS=Math.min(endPTS,fragEndPts),endPTS=Math.max(endPTS,fragEndPts),endDTS=Math.max(endDTS,frag.endDTS)}frag.duration=endPTS-startPTS;var drift=startPTS-frag.start;frag.appendedPTS=endPTS,frag.start=frag.startPTS=startPTS,frag.maxStartPTS=maxStartPTS,frag.startDTS=startDTS,frag.endPTS=endPTS,frag.minEndPTS=minEndPTS,frag.endDTS=endDTS;var i,sn=frag.sn;if(!details||sn<details.startSN||sn>details.endSN)return 0;var fragIdx=sn-details.startSN,fragments=details.fragments;for(fragments[fragIdx]=frag,i=fragIdx;i>0;i--)updateFromToPTS(fragments[i],fragments[i-1]);for(i=fragIdx;i<fragments.length-1;i++)updateFromToPTS(fragments[i],fragments[i+1]);return details.fragmentHint&&updateFromToPTS(fragments[fragments.length-1],details.fragmentHint),details.PTSKnown=details.alignedSliding=!0,drift}function mergeDetails(oldDetails,newDetails){for(var currentInitSegment=null,oldFragments=oldDetails.fragments,i=oldFragments.length-1;i>=0;i--){var oldInit=oldFragments[i].initSegment;if(oldInit){currentInitSegment=oldInit;break}}oldDetails.fragmentHint&&delete oldDetails.fragmentHint.endPTS;var PTSFrag,ccOffset=0;if(mapFragmentIntersection(oldDetails,newDetails,function(oldFrag,newFrag){var _currentInitSegment;oldFrag.relurl&&(ccOffset=oldFrag.cc-newFrag.cc),Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(oldFrag.startPTS)&&Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(oldFrag.endPTS)&&(newFrag.start=newFrag.startPTS=oldFrag.startPTS,newFrag.startDTS=oldFrag.startDTS,newFrag.appendedPTS=oldFrag.appendedPTS,newFrag.maxStartPTS=oldFrag.maxStartPTS,newFrag.endPTS=oldFrag.endPTS,newFrag.endDTS=oldFrag.endDTS,newFrag.minEndPTS=oldFrag.minEndPTS,newFrag.duration=oldFrag.endPTS-oldFrag.startPTS,newFrag.duration&&(PTSFrag=newFrag),newDetails.PTSKnown=newDetails.alignedSliding=!0),newFrag.elementaryStreams=oldFrag.elementaryStreams,newFrag.loader=oldFrag.loader,newFrag.stats=oldFrag.stats,newFrag.urlId=oldFrag.urlId,oldFrag.initSegment?(newFrag.initSegment=oldFrag.initSegment,currentInitSegment=oldFrag.initSegment):newFrag.initSegment&&newFrag.initSegment.relurl!=(null===(_currentInitSegment=currentInitSegment)||void 0===_currentInitSegment?void 0:_currentInitSegment.relurl)||(newFrag.initSegment=currentInitSegment)}),newDetails.skippedSegments&&(newDetails.deltaUpdateFailed=newDetails.fragments.some(function(frag){return!frag}),newDetails.deltaUpdateFailed)){_utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var _i=newDetails.skippedSegments;_i--;)newDetails.fragments.shift();newDetails.startSN=newDetails.fragments[0].sn,newDetails.startCC=newDetails.fragments[0].cc}var newFragments=newDetails.fragments;if(ccOffset){_utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.warn("discontinuity sliding from playlist, take drift into account");for(var _i2=0;_i2<newFragments.length;_i2++)newFragments[_i2].cc+=ccOffset}newDetails.skippedSegments&&(newDetails.startCC=newDetails.fragments[0].cc),mapPartIntersection(oldDetails.partList,newDetails.partList,function(oldPart,newPart){newPart.elementaryStreams=oldPart.elementaryStreams,newPart.stats=oldPart.stats}),PTSFrag?updateFragPTSDTS(newDetails,PTSFrag,PTSFrag.startPTS,PTSFrag.endPTS,PTSFrag.startDTS,PTSFrag.endDTS):adjustSliding(oldDetails,newDetails),newFragments.length&&(newDetails.totalduration=newDetails.edge-newFragments[0].start),newDetails.driftStartTime=oldDetails.driftStartTime,newDetails.driftStart=oldDetails.driftStart;var advancedDateTime=newDetails.advancedDateTime;if(newDetails.advanced&&advancedDateTime){var edge=newDetails.edge;newDetails.driftStart||(newDetails.driftStartTime=advancedDateTime,newDetails.driftStart=edge),newDetails.driftEndTime=advancedDateTime,newDetails.driftEnd=edge}else newDetails.driftEndTime=oldDetails.driftEndTime,newDetails.driftEnd=oldDetails.driftEnd,newDetails.advancedDateTime=oldDetails.advancedDateTime}function mapPartIntersection(oldParts,newParts,intersectionFn){if(oldParts&&newParts)for(var delta=0,i=0,len=oldParts.length;i<=len;i++){var _oldPart=oldParts[i],_newPart=newParts[i+delta];_oldPart&&_newPart&&_oldPart.index===_newPart.index&&_oldPart.fragment.sn===_newPart.fragment.sn?intersectionFn(_oldPart,_newPart):delta--}}function mapFragmentIntersection(oldDetails,newDetails,intersectionFn){for(var skippedSegments=newDetails.skippedSegments,start=Math.max(oldDetails.startSN,newDetails.startSN)-newDetails.startSN,end=(oldDetails.fragmentHint?1:0)+(skippedSegments?newDetails.endSN:Math.min(oldDetails.endSN,newDetails.endSN))-newDetails.startSN,delta=newDetails.startSN-oldDetails.startSN,newFrags=newDetails.fragmentHint?newDetails.fragments.concat(newDetails.fragmentHint):newDetails.fragments,oldFrags=oldDetails.fragmentHint?oldDetails.fragments.concat(oldDetails.fragmentHint):oldDetails.fragments,i=start;i<=end;i++){var _oldFrag=oldFrags[delta+i],_newFrag=newFrags[i];skippedSegments&&!_newFrag&&i<skippedSegments&&(_newFrag=newDetails.fragments[i]=_oldFrag),_oldFrag&&_newFrag&&intersectionFn(_oldFrag,_newFrag)}}function adjustSliding(oldDetails,newDetails){var delta=newDetails.startSN+newDetails.skippedSegments-oldDetails.startSN,oldFragments=oldDetails.fragments;delta<0||delta>=oldFragments.length||addSliding(newDetails,oldFragments[delta].start)}function addSliding(details,start){if(start){for(var fragments=details.fragments,i=details.skippedSegments;i<fragments.length;i++)fragments[i].start+=start;details.fragmentHint&&(details.fragmentHint.start+=start)}}function computeReloadInterval(newDetails,stats){var estimatedTimeUntilUpdate,reloadInterval=1e3*newDetails.levelTargetDuration,reloadIntervalAfterMiss=reloadInterval/2,timeSinceLastModified=newDetails.age,useLastModified=timeSinceLastModified>0&&timeSinceLastModified<3*reloadInterval,roundTrip=stats.loading.end-stats.loading.start,availabilityDelay=newDetails.availabilityDelay;if(!1===newDetails.updated)if(useLastModified){var minRetry=333*newDetails.misses;estimatedTimeUntilUpdate=Math.max(Math.min(reloadIntervalAfterMiss,2*roundTrip),minRetry),newDetails.availabilityDelay=(newDetails.availabilityDelay||0)+estimatedTimeUntilUpdate}else estimatedTimeUntilUpdate=reloadIntervalAfterMiss;else useLastModified?(availabilityDelay=Math.min(availabilityDelay||reloadInterval/2,timeSinceLastModified),newDetails.availabilityDelay=availabilityDelay,estimatedTimeUntilUpdate=availabilityDelay+reloadInterval-timeSinceLastModified):estimatedTimeUntilUpdate=reloadInterval-roundTrip;return Math.round(estimatedTimeUntilUpdate)}function getFragmentWithSN(level,sn,fragCurrent){if(!level||!level.details)return null;var levelDetails=level.details,fragment=levelDetails.fragments[sn-levelDetails.startSN];return fragment||((fragment=levelDetails.fragmentHint)&&fragment.sn===sn?fragment:sn<levelDetails.startSN&&fragCurrent&&fragCurrent.sn===sn?fragCurrent:null)}function getPartWith(level,sn,partIndex){if(!level||!level.details)return null;var partList=level.details.partList;if(partList)for(var i=partList.length;i--;){var part=partList[i];if(part.index===partIndex&&part.fragment.sn===sn)return part}return null}},"./src/controller/stream-controller.ts":
/*!*********************************************!*\
        !*** ./src/controller/stream-controller.ts ***!
        \*********************************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_400718__){"use strict";__nested_webpack_require_400718__.r(__webpack_exports__),__nested_webpack_require_400718__.d(__webpack_exports__,"default",function(){return StreamController});var _home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_400718__(
/*! ./src/polyfills/number */
"./src/polyfills/number.ts"),_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_400718__(
/*! ./base-stream-controller */
"./src/controller/base-stream-controller.ts"),_is_supported__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_400718__(
/*! ../is-supported */
"./src/is-supported.ts"),_events__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_400718__(
/*! ../events */
"./src/events.ts"),_utils_buffer_helper__WEBPACK_IMPORTED_MODULE_4__=__nested_webpack_require_400718__(
/*! ../utils/buffer-helper */
"./src/utils/buffer-helper.ts"),_fragment_tracker__WEBPACK_IMPORTED_MODULE_5__=__nested_webpack_require_400718__(
/*! ./fragment-tracker */
"./src/controller/fragment-tracker.ts"),_types_loader__WEBPACK_IMPORTED_MODULE_6__=__nested_webpack_require_400718__(
/*! ../types/loader */
"./src/types/loader.ts"),_loader_fragment__WEBPACK_IMPORTED_MODULE_7__=__nested_webpack_require_400718__(
/*! ../loader/fragment */
"./src/loader/fragment.ts"),_demux_transmuxer_interface__WEBPACK_IMPORTED_MODULE_8__=__nested_webpack_require_400718__(
/*! ../demux/transmuxer-interface */
"./src/demux/transmuxer-interface.ts"),_types_transmuxer__WEBPACK_IMPORTED_MODULE_9__=__nested_webpack_require_400718__(
/*! ../types/transmuxer */
"./src/types/transmuxer.ts"),_gap_controller__WEBPACK_IMPORTED_MODULE_10__=__nested_webpack_require_400718__(
/*! ./gap-controller */
"./src/controller/gap-controller.ts"),_errors__WEBPACK_IMPORTED_MODULE_11__=__nested_webpack_require_400718__(
/*! ../errors */
"./src/errors.ts"),_utils_logger__WEBPACK_IMPORTED_MODULE_12__=__nested_webpack_require_400718__(
/*! ../utils/logger */
"./src/utils/logger.ts");function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}var StreamController=function(_BaseStreamController){var subClass,superClass;function StreamController(hls,fragmentTracker){var _this;return(_this=_BaseStreamController.call(this,hls,fragmentTracker,"[stream-controller]")||this).audioCodecSwap=!1,_this.gapController=null,_this.level=-1,_this._forceStartLoad=!1,_this.altAudio=!1,_this.audioOnly=!1,_this.fragPlaying=null,_this.onvplaying=null,_this.onvseeked=null,_this.fragLastKbps=0,_this.stalled=!1,_this.couldBacktrack=!1,_this.audioCodecSwitch=!1,_this.videoBuffer=null,_this._registerListeners(),_this}superClass=_BaseStreamController,(subClass=StreamController).prototype=Object.create(superClass.prototype),subClass.prototype.constructor=subClass,_setPrototypeOf(subClass,superClass);var Constructor,protoProps,_proto=StreamController.prototype;return _proto._registerListeners=function(){var hls=this.hls;hls.on(_events__WEBPACK_IMPORTED_MODULE_3__.Events.MEDIA_ATTACHED,this.onMediaAttached,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_3__.Events.MEDIA_DETACHING,this.onMediaDetaching,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_3__.Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_3__.Events.MANIFEST_PARSED,this.onManifestParsed,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_3__.Events.LEVEL_LOADING,this.onLevelLoading,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_3__.Events.LEVEL_LOADED,this.onLevelLoaded,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_3__.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_3__.Events.ERROR,this.onError,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_3__.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_3__.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_3__.Events.BUFFER_CREATED,this.onBufferCreated,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_3__.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_3__.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_3__.Events.FRAG_BUFFERED,this.onFragBuffered,this)},_proto._unregisterListeners=function(){var hls=this.hls;hls.off(_events__WEBPACK_IMPORTED_MODULE_3__.Events.MEDIA_ATTACHED,this.onMediaAttached,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_3__.Events.MEDIA_DETACHING,this.onMediaDetaching,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_3__.Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_3__.Events.MANIFEST_PARSED,this.onManifestParsed,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_3__.Events.LEVEL_LOADED,this.onLevelLoaded,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_3__.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_3__.Events.ERROR,this.onError,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_3__.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_3__.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_3__.Events.BUFFER_CREATED,this.onBufferCreated,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_3__.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_3__.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_3__.Events.FRAG_BUFFERED,this.onFragBuffered,this)},_proto.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},_proto.startLoad=function(startPosition){if(this.levels){var lastCurrentTime=this.lastCurrentTime,hls=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var startLevel=hls.startLevel;-1===startLevel&&(hls.config.testBandwidth?(startLevel=0,this.bitrateTest=!0):startLevel=hls.nextAutoLevel),this.level=hls.nextLoadLevel=startLevel,this.loadedmetadata=!1}lastCurrentTime>0&&-1===startPosition&&(this.log("Override startPosition with lastCurrentTime @"+lastCurrentTime.toFixed(3)),startPosition=lastCurrentTime),this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=startPosition,this.tick()}else this._forceStartLoad=!0,this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.STOPPED},_proto.stopLoad=function(){this._forceStartLoad=!1,_BaseStreamController.prototype.stopLoad.call(this)},_proto.doTick=function(){switch(this.state){case _base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.IDLE:this.doTickIdle();break;case _base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.WAITING_LEVEL:var _levels$level,levels=this.levels,details=null==levels||null===(_levels$level=levels[this.level])||void 0===_levels$level?void 0:_levels$level.details;if(details&&(!details.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(details))break;this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.IDLE;break}break;case _base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.FRAG_LOADING_WAITING_RETRY:var _this$media,now=self.performance.now(),retryDate=this.retryDate;(!retryDate||now>=retryDate||null!==(_this$media=this.media)&&void 0!==_this$media&&_this$media.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.IDLE)}this.onTickEnd()},_proto.onTickEnd=function(){_BaseStreamController.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},_proto.doTickIdle=function(){var _frag$decryptdata,_frag$decryptdata2,hls=this.hls,levels=this.levels,media=this.media,level=hls.nextLoadLevel;if(null!==this.levelLastLoaded&&(media||!this.startFragRequested&&hls.config.startFragPrefetch)&&(!this.altAudio||!this.audioOnly)&&levels&&levels[level]){var levelInfo=levels[level];this.level=hls.nextLoadLevel=level;var levelDetails=levelInfo.details;if(!levelDetails||this.state===_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.WAITING_LEVEL||levelDetails.live&&this.levelLastLoaded!==level)this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.WAITING_LEVEL;else{var bufferInfo=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:media,_types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistLevelType.MAIN);if(null!==bufferInfo&&!(bufferInfo.len>=this.getMaxBufferLength(levelInfo.maxBitrate))){if(this._streamEnded(bufferInfo,levelDetails)){var data={};return this.altAudio&&(data.type="video"),this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_3__.Events.BUFFER_EOS,data),void(this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.ENDED)}var targetBufferTime=bufferInfo.end,frag=this.getNextFragment(targetBufferTime,levelDetails);if(this.couldBacktrack&&!this.fragPrevious&&frag&&"initSegment"!==frag.sn){var fragIdx=frag.sn-levelDetails.startSN;fragIdx>1&&this.fragmentTracker.removeFragment(frag=levelDetails.fragments[fragIdx-1])}frag&&this.fragmentTracker.getState(frag)===_fragment_tracker__WEBPACK_IMPORTED_MODULE_5__.FragmentState.OK&&this.nextLoadPosition>targetBufferTime&&(this.afterBufferFlushed(media,this.audioOnly&&!this.altAudio?_loader_fragment__WEBPACK_IMPORTED_MODULE_7__.ElementaryStreamTypes.AUDIO:_loader_fragment__WEBPACK_IMPORTED_MODULE_7__.ElementaryStreamTypes.VIDEO,_types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistLevelType.MAIN),frag=this.getNextFragment(this.nextLoadPosition,levelDetails)),frag&&(!frag.initSegment||frag.initSegment.data||this.bitrateTest||(frag=frag.initSegment),"identity"!==(null===(_frag$decryptdata=frag.decryptdata)||void 0===_frag$decryptdata?void 0:_frag$decryptdata.keyFormat)||null!==(_frag$decryptdata2=frag.decryptdata)&&void 0!==_frag$decryptdata2&&_frag$decryptdata2.key?this.loadFragment(frag,levelDetails,targetBufferTime):this.loadKey(frag,levelDetails))}}}},_proto.loadFragment=function(frag,levelDetails,targetBufferTime){var _this$media2,fragState=this.fragmentTracker.getState(frag);if(this.fragCurrent=frag,fragState===_fragment_tracker__WEBPACK_IMPORTED_MODULE_5__.FragmentState.BACKTRACKED){var data=this.fragmentTracker.getBacktrackData(frag);if(data)return this._handleFragmentLoadProgress(data),void this._handleFragmentLoadComplete(data);fragState=_fragment_tracker__WEBPACK_IMPORTED_MODULE_5__.FragmentState.NOT_LOADED}fragState===_fragment_tracker__WEBPACK_IMPORTED_MODULE_5__.FragmentState.NOT_LOADED||fragState===_fragment_tracker__WEBPACK_IMPORTED_MODULE_5__.FragmentState.PARTIAL?"initSegment"===frag.sn?this._loadInitSegment(frag):this.bitrateTest?(frag.bitrateTest=!0,this.log("Fragment "+frag.sn+" of level "+frag.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(frag)):(this.startFragRequested=!0,_BaseStreamController.prototype.loadFragment.call(this,frag,levelDetails,targetBufferTime)):fragState===_fragment_tracker__WEBPACK_IMPORTED_MODULE_5__.FragmentState.APPENDING?this.reduceMaxBufferLength(frag.duration)&&this.fragmentTracker.removeFragment(frag):0===(null===(_this$media2=this.media)||void 0===_this$media2?void 0:_this$media2.buffered.length)&&this.fragmentTracker.removeAllFragments()},_proto.getAppendedFrag=function(position){var fragOrPart=this.fragmentTracker.getAppendedFrag(position,_types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistLevelType.MAIN);return fragOrPart&&"fragment"in fragOrPart?fragOrPart.fragment:fragOrPart},_proto.getBufferedFrag=function(position){return this.fragmentTracker.getBufferedFrag(position,_types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistLevelType.MAIN)},_proto.followingBufferedFrag=function(frag){return frag?this.getBufferedFrag(frag.end+.5):null},_proto.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},_proto.nextLevelSwitch=function(){var levels=this.levels,media=this.media;if(null!=media&&media.readyState){var fetchdelay,fragPlayingCurrent=this.getAppendedFrag(media.currentTime);if(fragPlayingCurrent&&fragPlayingCurrent.start>1&&this.flushMainBuffer(0,fragPlayingCurrent.start-1),!media.paused&&levels){var fragLastKbps=this.fragLastKbps;fetchdelay=fragLastKbps&&this.fragCurrent?this.fragCurrent.duration*levels[this.hls.nextLoadLevel].maxBitrate/(1e3*fragLastKbps)+1:0}else fetchdelay=0;var bufferedFrag=this.getBufferedFrag(media.currentTime+fetchdelay);if(bufferedFrag){var nextBufferedFrag=this.followingBufferedFrag(bufferedFrag);if(nextBufferedFrag){this.abortCurrentFrag();var fragDuration=nextBufferedFrag.duration,startPts=Math.max(bufferedFrag.end,(nextBufferedFrag.maxStartPTS?nextBufferedFrag.maxStartPTS:nextBufferedFrag.start)+Math.min(Math.max(fragDuration-this.config.maxFragLookUpTolerance,.5*fragDuration),.75*fragDuration));this.flushMainBuffer(startPts,Number.POSITIVE_INFINITY)}}}},_proto.abortCurrentFrag=function(){var fragCurrent=this.fragCurrent;this.fragCurrent=null,null!=fragCurrent&&fragCurrent.loader&&fragCurrent.loader.abort(),this.state===_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.KEY_LOADING&&(this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.IDLE),this.nextLoadPosition=this.getLoadPosition()},_proto.flushMainBuffer=function(startOffset,endOffset){_BaseStreamController.prototype.flushMainBuffer.call(this,startOffset,endOffset,this.altAudio?"video":null)},_proto.onMediaAttached=function(event,data){_BaseStreamController.prototype.onMediaAttached.call(this,event,data);var media=data.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),media.addEventListener("playing",this.onvplaying),media.addEventListener("seeked",this.onvseeked),this.gapController=new _gap_controller__WEBPACK_IMPORTED_MODULE_10__.default(this.config,media,this.fragmentTracker,this.hls)},_proto.onMediaDetaching=function(){var media=this.media;media&&(media.removeEventListener("playing",this.onvplaying),media.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),_BaseStreamController.prototype.onMediaDetaching.call(this)},_proto.onMediaPlaying=function(){this.tick()},_proto.onMediaSeeked=function(){var media=this.media,currentTime=media?media.currentTime:null;Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(currentTime)&&this.log("Media seeked to "+currentTime.toFixed(3)),this.tick()},_proto.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_3__.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=this.stalled=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null},_proto.onManifestParsed=function(event,data){var codec,aac=!1,heaac=!1;data.levels.forEach(function(level){(codec=level.audioCodec)&&(-1!==codec.indexOf("mp4a.40.2")&&(aac=!0),-1!==codec.indexOf("mp4a.40.5")&&(heaac=!0))}),this.audioCodecSwitch=aac&&heaac&&!Object(_is_supported__WEBPACK_IMPORTED_MODULE_2__.changeTypeSupported)(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=data.levels,this.startFragRequested=!1},_proto.onLevelLoading=function(event,data){var levels=this.levels;if(levels&&this.state===_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.IDLE){var level=levels[data.level];(!level.details||level.details.live&&this.levelLastLoaded!==data.level||this.waitForCdnTuneIn(level.details))&&(this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.WAITING_LEVEL)}},_proto.onLevelLoaded=function(event,data){var _curLevel$details,levels=this.levels,newLevelId=data.level,newDetails=data.details;if(levels){this.log("Level "+newLevelId+" loaded ["+newDetails.startSN+","+newDetails.endSN+"], cc ["+newDetails.startCC+", "+newDetails.endCC+"] duration:"+newDetails.totalduration);var fragCurrent=this.fragCurrent;!fragCurrent||this.state!==_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.FRAG_LOADING&&this.state!==_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.FRAG_LOADING_WAITING_RETRY||fragCurrent.level!==data.level&&fragCurrent.loader&&(this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.IDLE,fragCurrent.loader.abort());var curLevel=levels[newLevelId],sliding=0;if(newDetails.live||null!==(_curLevel$details=curLevel.details)&&void 0!==_curLevel$details&&_curLevel$details.live){if(newDetails.fragments[0]||(newDetails.deltaUpdateFailed=!0),newDetails.deltaUpdateFailed)return;sliding=this.alignPlaylists(newDetails,curLevel.details)}if(curLevel.details=newDetails,this.levelLastLoaded=newLevelId,this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_3__.Events.LEVEL_UPDATED,{details:newDetails,level:newLevelId}),this.state===_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.WAITING_LEVEL){if(this.waitForCdnTuneIn(newDetails))return;this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.IDLE}this.startFragRequested?newDetails.live&&this.synchronizeToLiveEdge(newDetails):this.setStartPosition(newDetails,sliding),this.tick()}else this.warn("Levels were reset while loading level "+newLevelId)},_proto._handleFragmentLoadProgress=function(data){var _frag$initSegment,frag=data.frag,part=data.part,payload=data.payload,levels=this.levels;if(levels){var currentLevel=levels[frag.level],details=currentLevel.details;if(details){var videoCodec=currentLevel.videoCodec,accurateTimeOffset=details.PTSKnown||!details.live,initSegmentData=null===(_frag$initSegment=frag.initSegment)||void 0===_frag$initSegment?void 0:_frag$initSegment.data,audioCodec=this._getAudioCodec(currentLevel),transmuxer=this.transmuxer=this.transmuxer||new _demux_transmuxer_interface__WEBPACK_IMPORTED_MODULE_8__.default(this.hls,_types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),partIndex=part?part.index:-1,chunkMeta=new _types_transmuxer__WEBPACK_IMPORTED_MODULE_9__.ChunkMetadata(frag.level,frag.sn,frag.stats.chunkCount,payload.byteLength,partIndex,-1!==partIndex);transmuxer.push(payload,initSegmentData,audioCodec,videoCodec,frag,part,details.totalduration,accurateTimeOffset,chunkMeta,this.initPTS[frag.cc])}else this.warn("Dropping fragment "+frag.sn+" of level "+frag.level+" after level details were reset")}else this.warn("Levels were reset while fragment load was in progress. Fragment "+frag.sn+" of level "+frag.level+" will not be buffered")},_proto.onAudioTrackSwitching=function(event,data){var fromAltAudio=this.altAudio,trackId=data.id;if(!data.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var fragCurrent=this.fragCurrent;null!=fragCurrent&&fragCurrent.loader&&(this.log("Switching to main audio track, cancel main fragment load"),fragCurrent.loader.abort()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var hls=this.hls;fromAltAudio&&hls.trigger(_events__WEBPACK_IMPORTED_MODULE_3__.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),hls.trigger(_events__WEBPACK_IMPORTED_MODULE_3__.Events.AUDIO_TRACK_SWITCHED,{id:trackId})}},_proto.onAudioTrackSwitched=function(event,data){var altAudio=!!this.hls.audioTracks[data.id].url;if(altAudio){var videoBuffer=this.videoBuffer;videoBuffer&&this.mediaBuffer!==videoBuffer&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=videoBuffer)}this.altAudio=altAudio,this.tick()},_proto.onBufferCreated=function(event,data){var mediaTrack,name,tracks=data.tracks,alternate=!1;for(var type in tracks){var track=tracks[type];if("main"===track.id){if(name=type,mediaTrack=track,"video"===type){var videoTrack=tracks[type];videoTrack&&(this.videoBuffer=videoTrack.buffer)}}else alternate=!0}alternate&&mediaTrack?(this.log("Alternate track found, use "+name+".buffered to schedule main fragment loading"),this.mediaBuffer=mediaTrack.buffer):this.mediaBuffer=this.media},_proto.onFragBuffered=function(event,data){var frag=data.frag,part=data.part;if(!frag||frag.type===_types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistLevelType.MAIN){if(this.fragContextChanged(frag))return this.warn("Fragment "+frag.sn+(part?" p: "+part.index:"")+" of level "+frag.level+" finished buffering, but was aborted. state: "+this.state),void(this.state===_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.PARSED&&(this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.IDLE));var stats=part?part.stats:frag.stats;this.fragLastKbps=Math.round(8*stats.total/(stats.buffering.end-stats.loading.first)),"initSegment"!==frag.sn&&(this.fragPrevious=frag),this.fragBufferedComplete(frag,part)}},_proto.onError=function(event,data){switch(data.details){case _errors__WEBPACK_IMPORTED_MODULE_11__.ErrorDetails.FRAG_LOAD_ERROR:case _errors__WEBPACK_IMPORTED_MODULE_11__.ErrorDetails.FRAG_LOAD_TIMEOUT:case _errors__WEBPACK_IMPORTED_MODULE_11__.ErrorDetails.KEY_LOAD_ERROR:case _errors__WEBPACK_IMPORTED_MODULE_11__.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(_types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistLevelType.MAIN,data);break;case _errors__WEBPACK_IMPORTED_MODULE_11__.ErrorDetails.LEVEL_LOAD_ERROR:case _errors__WEBPACK_IMPORTED_MODULE_11__.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.ERROR&&(data.fatal?(this.warn(""+data.details),this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.ERROR):data.levelRetry||this.state!==_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.WAITING_LEVEL||(this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.IDLE));break;case _errors__WEBPACK_IMPORTED_MODULE_11__.ErrorDetails.BUFFER_FULL_ERROR:if("main"===data.parent&&(this.state===_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.PARSING||this.state===_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.PARSED)){var flushBuffer=!0,bufferedInfo=this.getFwdBufferInfo(this.media,_types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistLevelType.MAIN);bufferedInfo&&bufferedInfo.len>.5&&(flushBuffer=!this.reduceMaxBufferLength(bufferedInfo.len)),flushBuffer&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch()),this.resetLoadingState()}}},_proto.checkBuffer=function(){var media=this.media,gapController=this.gapController;if(media&&gapController&&media.readyState){var buffered=_utils_buffer_helper__WEBPACK_IMPORTED_MODULE_4__.BufferHelper.getBuffered(media);!this.loadedmetadata&&buffered.length?(this.loadedmetadata=!0,this.seekToStartPos()):gapController.poll(this.lastCurrentTime),this.lastCurrentTime=media.currentTime}},_proto.onFragLoadEmergencyAborted=function(){this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},_proto.onBufferFlushed=function(event,_ref){var type=_ref.type;(type!==_loader_fragment__WEBPACK_IMPORTED_MODULE_7__.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio)&&this.afterBufferFlushed((type===_loader_fragment__WEBPACK_IMPORTED_MODULE_7__.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media,type,_types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistLevelType.MAIN)},_proto.onLevelsUpdated=function(event,data){this.levels=data.levels},_proto.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},_proto.seekToStartPos=function(){var media=this.media,currentTime=media.currentTime,startPosition=this.startPosition;if(startPosition>=0&&currentTime<startPosition){if(media.seeking)return void _utils_logger__WEBPACK_IMPORTED_MODULE_12__.logger.log("could not seek to "+startPosition+", already seeking at "+currentTime);var buffered=_utils_buffer_helper__WEBPACK_IMPORTED_MODULE_4__.BufferHelper.getBuffered(media),delta=(buffered.length?buffered.start(0):0)-startPosition;delta>0&&(delta<this.config.maxBufferHole||delta<this.config.maxFragLookUpTolerance)&&(_utils_logger__WEBPACK_IMPORTED_MODULE_12__.logger.log("adjusting start position by "+delta+" to match buffer start"),this.startPosition=startPosition+=delta),this.log("seek to target start position "+startPosition+" from current time "+currentTime),media.currentTime=startPosition}},_proto._getAudioCodec=function(currentLevel){var audioCodec=this.config.defaultAudioCodec||currentLevel.audioCodec;return this.audioCodecSwap&&audioCodec&&(this.log("Swapping audio codec"),audioCodec=-1!==audioCodec.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),audioCodec},_proto._loadBitrateTestFrag=function(frag){var _this2=this;this._doFragLoad(frag).then(function(data){var hls=_this2.hls;if(data&&!hls.nextLoadLevel&&!_this2.fragContextChanged(frag)){_this2.fragLoadError=0,_this2.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.IDLE,_this2.startFragRequested=!1,_this2.bitrateTest=!1;var stats=frag.stats;stats.parsing.start=stats.parsing.end=stats.buffering.start=stats.buffering.end=self.performance.now(),hls.trigger(_events__WEBPACK_IMPORTED_MODULE_3__.Events.FRAG_LOADED,data)}})},_proto._handleTransmuxComplete=function(transmuxResult){var _id3$samples,id="main",hls=this.hls,remuxResult=transmuxResult.remuxResult,chunkMeta=transmuxResult.chunkMeta,context=this.getCurrentContext(chunkMeta);if(!context)return this.warn("The loading context changed while buffering fragment "+chunkMeta.sn+" of level "+chunkMeta.level+". This chunk will not be buffered."),void this.resetLiveStartWhenNotLoaded(chunkMeta.level);var frag=context.frag,part=context.part,level=context.level,video=remuxResult.video,text=remuxResult.text,id3=remuxResult.id3,initSegment=remuxResult.initSegment,audio=this.altAudio?void 0:remuxResult.audio;if(!this.fragContextChanged(frag)){if(this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.PARSING,initSegment){initSegment.tracks&&(this._bufferInitSegment(level,initSegment.tracks,frag,chunkMeta),hls.trigger(_events__WEBPACK_IMPORTED_MODULE_3__.Events.FRAG_PARSING_INIT_SEGMENT,{frag:frag,id:id,tracks:initSegment.tracks}));var initPTS=initSegment.initPTS,timescale=initSegment.timescale;Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(initPTS)&&(this.initPTS[frag.cc]=initPTS,hls.trigger(_events__WEBPACK_IMPORTED_MODULE_3__.Events.INIT_PTS_FOUND,{frag:frag,id:id,initPTS:initPTS,timescale:timescale}))}if(video&&!1!==remuxResult.independent){if(level.details){var startPTS=video.startPTS,endPTS=video.endPTS,startDTS=video.startDTS,endDTS=video.endDTS;if(part)part.elementaryStreams[video.type]={startPTS:startPTS,endPTS:endPTS,startDTS:startDTS,endDTS:endDTS};else if(video.firstKeyFrame&&video.independent&&(this.couldBacktrack=!0),video.dropped&&video.independent){if(this.getLoadPosition()+this.config.maxBufferHole<startPTS)return void this.backtrack(frag);frag.setElementaryStreamInfo(video.type,frag.start,endPTS,frag.start,endDTS,!0)}frag.setElementaryStreamInfo(video.type,startPTS,endPTS,startDTS,endDTS),this.bufferFragmentData(video,frag,part,chunkMeta)}}else if(!1===remuxResult.independent)return void this.backtrack(frag);if(audio){var _startPTS=audio.startPTS,_endPTS=audio.endPTS,_startDTS=audio.startDTS,_endDTS=audio.endDTS;part&&(part.elementaryStreams[_loader_fragment__WEBPACK_IMPORTED_MODULE_7__.ElementaryStreamTypes.AUDIO]={startPTS:_startPTS,endPTS:_endPTS,startDTS:_startDTS,endDTS:_endDTS}),frag.setElementaryStreamInfo(_loader_fragment__WEBPACK_IMPORTED_MODULE_7__.ElementaryStreamTypes.AUDIO,_startPTS,_endPTS,_startDTS,_endDTS),this.bufferFragmentData(audio,frag,part,chunkMeta)}null!=id3&&null!==(_id3$samples=id3.samples)&&void 0!==_id3$samples&&_id3$samples.length&&hls.trigger(_events__WEBPACK_IMPORTED_MODULE_3__.Events.FRAG_PARSING_METADATA,{frag:frag,id:id,samples:id3.samples}),text&&hls.trigger(_events__WEBPACK_IMPORTED_MODULE_3__.Events.FRAG_PARSING_USERDATA,{frag:frag,id:id,samples:text.samples})}},_proto._bufferInitSegment=function(currentLevel,tracks,frag,chunkMeta){var _this3=this;if(this.state===_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.PARSING){this.audioOnly=!!tracks.audio&&!tracks.video,this.altAudio&&!this.audioOnly&&delete tracks.audio;var audio=tracks.audio,video=tracks.video,audiovideo=tracks.audiovideo;if(audio){var audioCodec=currentLevel.audioCodec,ua=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(audioCodec&&(audioCodec=-1!==audioCodec.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),1!==audio.metadata.channelCount&&-1===ua.indexOf("firefox")&&(audioCodec="mp4a.40.5")),-1!==ua.indexOf("android")&&"audio/mpeg"!==audio.container&&this.log("Android: force audio codec to "+(audioCodec="mp4a.40.2")),currentLevel.audioCodec&&currentLevel.audioCodec!==audioCodec&&this.log('Swapping manifest audio codec "'+currentLevel.audioCodec+'" for "'+audioCodec+'"'),audio.levelCodec=audioCodec,audio.id="main",this.log("Init audio buffer, container:"+audio.container+", codecs[selected/level/parsed]=["+(audioCodec||"")+"/"+(currentLevel.audioCodec||"")+"/"+audio.codec+"]")}video&&(video.levelCodec=currentLevel.videoCodec,video.id="main",this.log("Init video buffer, container:"+video.container+", codecs[level/parsed]=["+(currentLevel.videoCodec||"")+"/"+video.codec+"]")),audiovideo&&this.log("Init audiovideo buffer, container:"+audiovideo.container+", codecs[level/parsed]=["+(currentLevel.attrs.CODECS||"")+"/"+audiovideo.codec+"]"),this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_3__.Events.BUFFER_CODECS,tracks),Object.keys(tracks).forEach(function(trackName){var initSegment=tracks[trackName].initSegment;null!=initSegment&&initSegment.byteLength&&_this3.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_3__.Events.BUFFER_APPENDING,{type:trackName,data:initSegment,frag:frag,part:null,chunkMeta:chunkMeta,parent:frag.type})}),this.tick()}},_proto.backtrack=function(frag){this.couldBacktrack=!0,this.resetTransmuxer(),this.flushBufferGap(frag);var data=this.fragmentTracker.backtrack(frag);this.fragPrevious=null,this.nextLoadPosition=frag.start,data?this.resetFragmentLoading(frag):this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.State.BACKTRACKING},_proto.checkFragmentChanged=function(){var video=this.media,fragPlayingCurrent=null;if(video&&video.readyState>1&&!1===video.seeking){var currentTime=video.currentTime;if(_utils_buffer_helper__WEBPACK_IMPORTED_MODULE_4__.BufferHelper.isBuffered(video,currentTime)?fragPlayingCurrent=this.getAppendedFrag(currentTime):_utils_buffer_helper__WEBPACK_IMPORTED_MODULE_4__.BufferHelper.isBuffered(video,currentTime+.1)&&(fragPlayingCurrent=this.getAppendedFrag(currentTime+.1)),fragPlayingCurrent){var fragPlaying=this.fragPlaying,fragCurrentLevel=fragPlayingCurrent.level;fragPlaying&&fragPlayingCurrent.sn===fragPlaying.sn&&fragPlaying.level===fragCurrentLevel&&fragPlayingCurrent.urlId===fragPlaying.urlId||(this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_3__.Events.FRAG_CHANGED,{frag:fragPlayingCurrent}),fragPlaying&&fragPlaying.level===fragCurrentLevel||this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_3__.Events.LEVEL_SWITCHED,{level:fragCurrentLevel}),this.fragPlaying=fragPlayingCurrent)}}},Constructor=StreamController,(protoProps=[{key:"nextLevel",get:function(){var frag=this.nextBufferedFrag;return frag?frag.level:-1}},{key:"currentLevel",get:function(){var media=this.media;if(media){var fragPlayingCurrent=this.getAppendedFrag(media.currentTime);if(fragPlayingCurrent)return fragPlayingCurrent.level}return-1}},{key:"nextBufferedFrag",get:function(){var media=this.media;if(media){var fragPlayingCurrent=this.getAppendedFrag(media.currentTime);return this.followingBufferedFrag(fragPlayingCurrent)}return null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}])&&_defineProperties(Constructor.prototype,protoProps),StreamController}(_base_stream_controller__WEBPACK_IMPORTED_MODULE_1__.default)},"./src/controller/subtitle-stream-controller.ts":
/*!******************************************************!*\
        !*** ./src/controller/subtitle-stream-controller.ts ***!
        \******************************************************/
/*! exports provided: SubtitleStreamController */
function(module,__webpack_exports__,__nested_webpack_require_463087__){"use strict";__nested_webpack_require_463087__.r(__webpack_exports__),__nested_webpack_require_463087__.d(__webpack_exports__,"SubtitleStreamController",function(){return SubtitleStreamController});var _events__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_463087__(
/*! ../events */
"./src/events.ts"),_utils_logger__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_463087__(
/*! ../utils/logger */
"./src/utils/logger.ts"),_utils_buffer_helper__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_463087__(
/*! ../utils/buffer-helper */
"./src/utils/buffer-helper.ts"),_fragment_finders__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_463087__(
/*! ./fragment-finders */
"./src/controller/fragment-finders.ts"),_utils_discontinuities__WEBPACK_IMPORTED_MODULE_4__=__nested_webpack_require_463087__(
/*! ../utils/discontinuities */
"./src/utils/discontinuities.ts"),_level_helper__WEBPACK_IMPORTED_MODULE_5__=__nested_webpack_require_463087__(
/*! ./level-helper */
"./src/controller/level-helper.ts"),_fragment_tracker__WEBPACK_IMPORTED_MODULE_6__=__nested_webpack_require_463087__(
/*! ./fragment-tracker */
"./src/controller/fragment-tracker.ts"),_base_stream_controller__WEBPACK_IMPORTED_MODULE_7__=__nested_webpack_require_463087__(
/*! ./base-stream-controller */
"./src/controller/base-stream-controller.ts"),_types_loader__WEBPACK_IMPORTED_MODULE_8__=__nested_webpack_require_463087__(
/*! ../types/loader */
"./src/types/loader.ts"),_types_level__WEBPACK_IMPORTED_MODULE_9__=__nested_webpack_require_463087__(
/*! ../types/level */
"./src/types/level.ts");function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}var SubtitleStreamController=function(_BaseStreamController){var subClass,superClass;function SubtitleStreamController(hls,fragmentTracker){var _this;return(_this=_BaseStreamController.call(this,hls,fragmentTracker,"[subtitle-stream-controller]")||this).levels=[],_this.currentTrackId=-1,_this.tracksBuffered=[],_this.mainDetails=null,_this._registerListeners(),_this}superClass=_BaseStreamController,(subClass=SubtitleStreamController).prototype=Object.create(superClass.prototype),subClass.prototype.constructor=subClass,_setPrototypeOf(subClass,superClass);var Constructor,protoProps,_proto=SubtitleStreamController.prototype;return _proto.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},_proto._registerListeners=function(){var hls=this.hls;hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MEDIA_ATTACHED,this.onMediaAttached,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MEDIA_DETACHING,this.onMediaDetaching,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.LEVEL_LOADED,this.onLevelLoaded,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.ERROR,this.onError,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},_proto._unregisterListeners=function(){var hls=this.hls;hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MEDIA_ATTACHED,this.onMediaAttached,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MEDIA_DETACHING,this.onMediaDetaching,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.LEVEL_LOADED,this.onLevelLoaded,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.ERROR,this.onError,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},_proto.startLoad=function(){this.stopLoad(),this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_7__.State.IDLE,this.setInterval(500),this.tick()},_proto.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},_proto.onLevelLoaded=function(event,data){this.mainDetails=data.details},_proto.onSubtitleFragProcessed=function(event,data){var frag=data.frag,success=data.success;if(this.fragPrevious=frag,this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_7__.State.IDLE,success){var buffered=this.tracksBuffered[this.currentTrackId];if(buffered){for(var timeRange,fragStart=frag.start,i=0;i<buffered.length;i++)if(fragStart>=buffered[i].start&&fragStart<=buffered[i].end){timeRange=buffered[i];break}var fragEnd=frag.start+frag.duration;timeRange?timeRange.end=fragEnd:buffered.push(timeRange={start:fragStart,end:fragEnd}),this.fragmentTracker.fragBuffered(frag)}}},_proto.onBufferFlushing=function(event,data){var startOffset=data.startOffset,endOffset=data.endOffset;if(0===startOffset&&endOffset!==Number.POSITIVE_INFINITY){var currentTrackId=this.currentTrackId,levels=this.levels;if(!levels.length||!levels[currentTrackId]||!levels[currentTrackId].details)return;var endOffsetSubtitles=endOffset-levels[currentTrackId].details.targetduration;if(endOffsetSubtitles<=0)return;data.endOffsetSubtitles=Math.max(0,endOffsetSubtitles),this.tracksBuffered.forEach(function(buffered){for(var i=0;i<buffered.length;)if(buffered[i].end<=endOffsetSubtitles)buffered.shift();else{if(!(buffered[i].start<endOffsetSubtitles))break;buffered[i].start=endOffsetSubtitles,i++}}),this.fragmentTracker.removeFragmentsInRange(startOffset,endOffsetSubtitles,_types_loader__WEBPACK_IMPORTED_MODULE_8__.PlaylistLevelType.SUBTITLE)}},_proto.onError=function(event,data){var _this$fragCurrent,frag=data.frag;frag&&frag.type===_types_loader__WEBPACK_IMPORTED_MODULE_8__.PlaylistLevelType.SUBTITLE&&(null!==(_this$fragCurrent=this.fragCurrent)&&void 0!==_this$fragCurrent&&_this$fragCurrent.loader&&this.fragCurrent.loader.abort(),this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_7__.State.IDLE)},_proto.onSubtitleTracksUpdated=function(event,_ref){var _this2=this,subtitleTracks=_ref.subtitleTracks;this.tracksBuffered=[],this.levels=subtitleTracks.map(function(mediaPlaylist){return new _types_level__WEBPACK_IMPORTED_MODULE_9__.Level(mediaPlaylist)}),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach(function(level){_this2.tracksBuffered[level.id]=[]}),this.mediaBuffer=null},_proto.onSubtitleTrackSwitch=function(event,data){if(this.currentTrackId=data.id,this.levels.length&&-1!==this.currentTrackId){var currentTrack=this.levels[this.currentTrackId];null!=currentTrack&&currentTrack.details?(this.mediaBuffer=this.mediaBufferTimeRanges,this.setInterval(500)):this.mediaBuffer=null}else this.clearInterval()},_proto.onSubtitleTrackLoaded=function(event,data){var _track$details,newDetails=data.details,trackId=data.id,currentTrackId=this.currentTrackId,levels=this.levels;if(levels.length){var track=levels[currentTrackId];if(!(trackId>=levels.length||trackId!==currentTrackId)&&track){if(this.mediaBuffer=this.mediaBufferTimeRanges,newDetails.live||null!==(_track$details=track.details)&&void 0!==_track$details&&_track$details.live){var mainDetails=this.mainDetails;if(newDetails.deltaUpdateFailed||!mainDetails)return;var mainSlidingStartFragment=mainDetails.fragments[0];track.details?0===this.alignPlaylists(newDetails,track.details)&&mainSlidingStartFragment&&Object(_level_helper__WEBPACK_IMPORTED_MODULE_5__.addSliding)(newDetails,mainSlidingStartFragment.start):newDetails.hasProgramDateTime&&mainDetails.hasProgramDateTime?Object(_utils_discontinuities__WEBPACK_IMPORTED_MODULE_4__.alignMediaPlaylistByPDT)(newDetails,mainDetails):mainSlidingStartFragment&&Object(_level_helper__WEBPACK_IMPORTED_MODULE_5__.addSliding)(newDetails,mainSlidingStartFragment.start)}track.details=newDetails,this.levelLastLoaded=trackId,this.tick(),newDetails.live&&!this.fragCurrent&&this.media&&this.state===_base_stream_controller__WEBPACK_IMPORTED_MODULE_7__.State.IDLE&&(Object(_fragment_finders__WEBPACK_IMPORTED_MODULE_3__.findFragmentByPTS)(null,newDetails.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),track.details=void 0))}}},_proto._handleFragmentLoadComplete=function(fragLoadedData){var frag=fragLoadedData.frag,payload=fragLoadedData.payload,decryptData=frag.decryptdata,hls=this.hls;if(!this.fragContextChanged(frag)&&payload&&payload.byteLength>0&&decryptData&&decryptData.key&&decryptData.iv&&"AES-128"===decryptData.method){var startTime=performance.now();this.decrypter.webCryptoDecrypt(new Uint8Array(payload),decryptData.key.buffer,decryptData.iv.buffer).then(function(decryptedData){var endTime=performance.now();hls.trigger(_events__WEBPACK_IMPORTED_MODULE_0__.Events.FRAG_DECRYPTED,{frag:frag,payload:decryptedData,stats:{tstart:startTime,tdecrypt:endTime}})})}},_proto.doTick=function(){if(this.media){if(this.state===_base_stream_controller__WEBPACK_IMPORTED_MODULE_7__.State.IDLE){var _foundFrag,currentTrackId=this.currentTrackId,levels=this.levels;if(!levels.length||!levels[currentTrackId]||!levels[currentTrackId].details)return;var trackDetails=levels[currentTrackId].details,targetDuration=trackDetails.targetduration,config=this.config,bufferedInfo=_utils_buffer_helper__WEBPACK_IMPORTED_MODULE_2__.BufferHelper.bufferedInfo(this.mediaBufferTimeRanges,this.media.currentTime-targetDuration,config.maxBufferHole),targetBufferTime=bufferedInfo.end;if(bufferedInfo.len>this.getMaxBufferLength()+targetDuration)return;console.assert(trackDetails,"Subtitle track details are defined on idle subtitle stream controller tick");var foundFrag,fragments=trackDetails.fragments,fragLen=fragments.length,fragPrevious=this.fragPrevious;if(targetBufferTime<trackDetails.edge){var maxFragLookUpTolerance=config.maxFragLookUpTolerance;fragPrevious&&trackDetails.hasProgramDateTime&&(foundFrag=Object(_fragment_finders__WEBPACK_IMPORTED_MODULE_3__.findFragmentByPDT)(fragments,fragPrevious.endProgramDateTime,maxFragLookUpTolerance)),foundFrag||!(foundFrag=Object(_fragment_finders__WEBPACK_IMPORTED_MODULE_3__.findFragmentByPTS)(fragPrevious,fragments,targetBufferTime,maxFragLookUpTolerance))&&fragPrevious&&fragPrevious.start<fragments[0].start&&(foundFrag=fragments[0])}else foundFrag=fragments[fragLen-1];null!==(_foundFrag=foundFrag)&&void 0!==_foundFrag&&_foundFrag.encrypted?(_utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.log("Loading key for "+foundFrag.sn),this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_7__.State.KEY_LOADING,this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_0__.Events.KEY_LOADING,{frag:foundFrag})):foundFrag&&this.fragmentTracker.getState(foundFrag)===_fragment_tracker__WEBPACK_IMPORTED_MODULE_6__.FragmentState.NOT_LOADED&&this.loadFragment(foundFrag,trackDetails,targetBufferTime)}}else this.state=_base_stream_controller__WEBPACK_IMPORTED_MODULE_7__.State.IDLE},_proto.loadFragment=function(frag,levelDetails,targetBufferTime){this.fragCurrent=frag,_BaseStreamController.prototype.loadFragment.call(this,frag,levelDetails,targetBufferTime)},Constructor=SubtitleStreamController,(protoProps=[{key:"mediaBufferTimeRanges",get:function(){return this.tracksBuffered[this.currentTrackId]||[]}}])&&_defineProperties(Constructor.prototype,protoProps),SubtitleStreamController}(_base_stream_controller__WEBPACK_IMPORTED_MODULE_7__.default)},"./src/controller/subtitle-track-controller.ts":
/*!*****************************************************!*\
        !*** ./src/controller/subtitle-track-controller.ts ***!
        \*****************************************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_483731__){"use strict";__nested_webpack_require_483731__.r(__webpack_exports__);var _events__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_483731__(
/*! ../events */
"./src/events.ts"),_utils_texttrack_utils__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_483731__(
/*! ../utils/texttrack-utils */
"./src/utils/texttrack-utils.ts"),_base_playlist_controller__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_483731__(
/*! ./base-playlist-controller */
"./src/controller/base-playlist-controller.ts"),_types_loader__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_483731__(
/*! ../types/loader */
"./src/types/loader.ts");function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function filterSubtitleTracks(textTrackList){for(var tracks=[],i=0;i<textTrackList.length;i++){var track=textTrackList[i];"subtitles"===track.kind&&track.label&&tracks.push(textTrackList[i])}return tracks}__webpack_exports__.default=function(_BasePlaylistControll){var subClass,superClass;function SubtitleTrackController(hls){var _this;return(_this=_BasePlaylistControll.call(this,hls,"[subtitle-track-controller]")||this).media=null,_this.tracks=[],_this.groupId=null,_this.tracksInGroup=[],_this.trackId=-1,_this.selectDefaultTrack=!0,_this.queuedDefaultTrack=-1,_this.trackChangeListener=function(){return _this.onTextTracksChanged()},_this.asyncPollTrackChange=function(){return _this.pollTrackChange(0)},_this.useTextTrackPolling=!1,_this.subtitlePollingInterval=-1,_this.subtitleDisplay=!0,_this.registerListeners(),_this}superClass=_BasePlaylistControll,(subClass=SubtitleTrackController).prototype=Object.create(superClass.prototype),subClass.prototype.constructor=subClass,_setPrototypeOf(subClass,superClass);var Constructor,protoProps,_proto=SubtitleTrackController.prototype;return _proto.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,_BasePlaylistControll.prototype.destroy.call(this)},_proto.registerListeners=function(){var hls=this.hls;hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MEDIA_ATTACHED,this.onMediaAttached,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MEDIA_DETACHING,this.onMediaDetaching,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MANIFEST_PARSED,this.onManifestParsed,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.LEVEL_LOADING,this.onLevelLoading,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.ERROR,this.onError,this)},_proto.unregisterListeners=function(){var hls=this.hls;hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MEDIA_ATTACHED,this.onMediaAttached,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MEDIA_DETACHING,this.onMediaDetaching,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.MANIFEST_PARSED,this.onManifestParsed,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.LEVEL_LOADING,this.onLevelLoading,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.ERROR,this.onError,this)},_proto.onMediaAttached=function(event,data){this.media=data.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},_proto.pollTrackChange=function(timeout){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,timeout)},_proto.onMediaDetaching=function(){this.media&&(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),filterSubtitleTracks(this.media.textTracks).forEach(function(track){Object(_utils_texttrack_utils__WEBPACK_IMPORTED_MODULE_1__.clearCurrentCues)(track)}),this.subtitleTrack=-1,this.media=null)},_proto.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},_proto.onManifestParsed=function(event,data){this.tracks=data.subtitleTracks},_proto.onSubtitleTrackLoaded=function(event,data){var id=data.id,details=data.details,currentTrack=this.tracksInGroup[this.trackId];if(currentTrack){var curDetails=currentTrack.details;currentTrack.details=data.details,this.log("subtitle track "+id+" loaded ["+details.startSN+"-"+details.endSN+"]"),id===this.trackId&&(this.retryCount=0,this.playlistLoaded(id,data,curDetails))}else this.warn("Invalid subtitle track id "+id)},_proto.onLevelLoading=function(event,data){this.switchLevel(data.level)},_proto.onLevelSwitching=function(event,data){this.switchLevel(data.level)},_proto.switchLevel=function(levelIndex){var levelInfo=this.hls.levels[levelIndex];if(null!=levelInfo&&levelInfo.textGroupIds){var textGroupId=levelInfo.textGroupIds[levelInfo.urlId];if(this.groupId!==textGroupId){var lastTrack=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,subtitleTracks=this.tracks.filter(function(track){return!textGroupId||track.groupId===textGroupId});this.tracksInGroup=subtitleTracks;var initialTrackId=this.findTrackId(null==lastTrack?void 0:lastTrack.name)||this.findTrackId();this.groupId=textGroupId;var subtitleTracksUpdated={subtitleTracks:subtitleTracks};this.log("Updating subtitle tracks, "+subtitleTracks.length+' track(s) found in "'+textGroupId+'" group-id'),this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_0__.Events.SUBTITLE_TRACKS_UPDATED,subtitleTracksUpdated),-1!==initialTrackId&&this.setSubtitleTrack(initialTrackId,lastTrack)}}},_proto.findTrackId=function(name){for(var textTracks=this.tracksInGroup,i=0;i<textTracks.length;i++){var track=textTracks[i];if((!this.selectDefaultTrack||track.default)&&(!name||name===track.name))return track.id}return-1},_proto.onError=function(event,data){_BasePlaylistControll.prototype.onError.call(this,event,data),!data.fatal&&data.context&&data.context.type===_types_loader__WEBPACK_IMPORTED_MODULE_3__.PlaylistContextType.SUBTITLE_TRACK&&data.context.id===this.trackId&&data.context.groupId===this.groupId&&this.retryLoadingOrFail(data)},_proto.loadPlaylist=function(hlsUrlParameters){var currentTrack=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(currentTrack)){var id=currentTrack.id,groupId=currentTrack.groupId,url=currentTrack.url;if(hlsUrlParameters)try{url=hlsUrlParameters.addDirectives(url)}catch(error){this.warn("Could not construct new URL with HLS Delivery Directives: "+error)}this.log("Loading subtitle playlist for id "+id),this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_0__.Events.SUBTITLE_TRACK_LOADING,{url:url,id:id,groupId:groupId,deliveryDirectives:hlsUrlParameters||null})}},_proto.toggleTrackModes=function(newId){var _this2=this,media=this.media,subtitleDisplay=this.subtitleDisplay,trackId=this.trackId;if(media){var textTracks=filterSubtitleTracks(media.textTracks),groupTracks=textTracks.filter(function(track){return track.groupId===_this2.groupId});if(-1===newId)[].slice.call(textTracks).forEach(function(track){track.mode="disabled"});else{var oldTrack=groupTracks[trackId];oldTrack&&(oldTrack.mode="disabled")}var nextTrack=groupTracks[newId];nextTrack&&(nextTrack.mode=subtitleDisplay?"showing":"hidden")}},_proto.setSubtitleTrack=function(newId,lastTrack){var _tracks$newId,tracks=this.tracksInGroup;if(this.media){if(this.trackId!==newId&&this.toggleTrackModes(newId),!(this.trackId===newId&&(-1===newId||null!==(_tracks$newId=tracks[newId])&&void 0!==_tracks$newId&&_tracks$newId.details)||newId<-1||newId>=tracks.length)){this.clearTimer();var track=tracks[newId];if(this.log("Switching to subtitle track "+newId),this.trackId=newId,track){var _track$groupId=track.groupId;this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_0__.Events.SUBTITLE_TRACK_SWITCH,{id:track.id,groupId:void 0===_track$groupId?"":_track$groupId,name:track.name,type:track.type,url:track.url});var hlsUrlParameters=this.switchParams(track.url,null==lastTrack?void 0:lastTrack.details);this.loadPlaylist(hlsUrlParameters)}else this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_0__.Events.SUBTITLE_TRACK_SWITCH,{id:newId})}}else this.queuedDefaultTrack=newId},_proto.onTextTracksChanged=function(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),this.media&&this.hls.config.renderTextTracksNatively){for(var trackId=-1,tracks=filterSubtitleTracks(this.media.textTracks),id=0;id<tracks.length;id++)if("hidden"===tracks[id].mode)trackId=id;else if("showing"===tracks[id].mode){trackId=id;break}this.subtitleTrack!==trackId&&(this.subtitleTrack=trackId)}},Constructor=SubtitleTrackController,(protoProps=[{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(newId){this.selectDefaultTrack=!1,this.setSubtitleTrack(newId,this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0)}}])&&_defineProperties(Constructor.prototype,protoProps),SubtitleTrackController}(_base_playlist_controller__WEBPACK_IMPORTED_MODULE_2__.default)},"./src/controller/timeline-controller.ts":
/*!***********************************************!*\
        !*** ./src/controller/timeline-controller.ts ***!
        \***********************************************/
/*! exports provided: TimelineController */
function(module,__webpack_exports__,__nested_webpack_require_502404__){"use strict";__nested_webpack_require_502404__.r(__webpack_exports__),__nested_webpack_require_502404__.d(__webpack_exports__,"TimelineController",function(){return TimelineController});var _home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_502404__(
/*! ./src/polyfills/number */
"./src/polyfills/number.ts"),_events__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_502404__(
/*! ../events */
"./src/events.ts"),_utils_cea_608_parser__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_502404__(
/*! ../utils/cea-608-parser */
"./src/utils/cea-608-parser.ts"),_utils_output_filter__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_502404__(
/*! ../utils/output-filter */
"./src/utils/output-filter.ts"),_utils_webvtt_parser__WEBPACK_IMPORTED_MODULE_4__=__nested_webpack_require_502404__(
/*! ../utils/webvtt-parser */
"./src/utils/webvtt-parser.ts"),_utils_texttrack_utils__WEBPACK_IMPORTED_MODULE_5__=__nested_webpack_require_502404__(
/*! ../utils/texttrack-utils */
"./src/utils/texttrack-utils.ts"),_utils_imsc1_ttml_parser__WEBPACK_IMPORTED_MODULE_6__=__nested_webpack_require_502404__(
/*! ../utils/imsc1-ttml-parser */
"./src/utils/imsc1-ttml-parser.ts"),_types_loader__WEBPACK_IMPORTED_MODULE_7__=__nested_webpack_require_502404__(
/*! ../types/loader */
"./src/types/loader.ts"),_utils_logger__WEBPACK_IMPORTED_MODULE_8__=__nested_webpack_require_502404__(
/*! ../utils/logger */
"./src/utils/logger.ts"),TimelineController=function(){function TimelineController(hls){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},this.captionsProperties=void 0,this.hls=hls,this.config=hls.config,this.Cues=hls.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var channel1=new _utils_output_filter__WEBPACK_IMPORTED_MODULE_3__.default(this,"textTrack1"),channel2=new _utils_output_filter__WEBPACK_IMPORTED_MODULE_3__.default(this,"textTrack2"),channel3=new _utils_output_filter__WEBPACK_IMPORTED_MODULE_3__.default(this,"textTrack3"),channel4=new _utils_output_filter__WEBPACK_IMPORTED_MODULE_3__.default(this,"textTrack4");this.cea608Parser1=new _utils_cea_608_parser__WEBPACK_IMPORTED_MODULE_2__.default(1,channel1,channel2),this.cea608Parser2=new _utils_cea_608_parser__WEBPACK_IMPORTED_MODULE_2__.default(3,channel3,channel4)}hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.MEDIA_DETACHING,this.onMediaDetaching,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.MANIFEST_LOADED,this.onManifestLoaded,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.FRAG_LOADING,this.onFragLoading,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.FRAG_LOADED,this.onFragLoaded,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var _proto=TimelineController.prototype;return _proto.destroy=function(){var hls=this.hls;hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.MEDIA_DETACHING,this.onMediaDetaching,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.MANIFEST_LOADED,this.onManifestLoaded,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.FRAG_LOADING,this.onFragLoading,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.FRAG_LOADED,this.onFragLoaded,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},_proto.addCues=function(trackName,startTime,endTime,screen,cueRanges){for(var x1,y1,merged=!1,i=cueRanges.length;i--;){var cueRange=cueRanges[i],overlap=(x1=cueRange[0],y1=startTime,Math.min(cueRange[1],endTime)-Math.max(x1,y1));if(overlap>=0&&(cueRange[0]=Math.min(cueRange[0],startTime),cueRange[1]=Math.max(cueRange[1],endTime),merged=!0,overlap/(endTime-startTime)>.5))return}if(merged||cueRanges.push([startTime,endTime]),this.config.renderTextTracksNatively)this.Cues.newCue(this.captionsTracks[trackName],startTime,endTime,screen);else{var cues=this.Cues.newCue(null,startTime,endTime,screen);this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.CUES_PARSED,{type:"captions",cues:cues,track:trackName})}},_proto.onInitPtsFound=function(event,_ref){var _this=this,frag=_ref.frag,timescale=_ref.timescale,unparsedVttFrags=this.unparsedVttFrags;"main"===_ref.id&&(this.initPTS[frag.cc]=_ref.initPTS,this.timescale[frag.cc]=timescale),unparsedVttFrags.length&&(this.unparsedVttFrags=[],unparsedVttFrags.forEach(function(frag){_this.onFragLoaded(_events__WEBPACK_IMPORTED_MODULE_1__.Events.FRAG_LOADED,frag)}))},_proto.getExistingTrack=function(trackName){var media=this.media;if(media)for(var i=0;i<media.textTracks.length;i++){var textTrack=media.textTracks[i];if(textTrack[trackName])return textTrack}return null},_proto.createCaptionsTrack=function(trackName){this.config.renderTextTracksNatively?this.createNativeTrack(trackName):this.createNonNativeTrack(trackName)},_proto.createNativeTrack=function(trackName){if(!this.captionsTracks[trackName]){var captionsTracks=this.captionsTracks,media=this.media,_captionsProperties$t=this.captionsProperties[trackName],label=_captionsProperties$t.label,languageCode=_captionsProperties$t.languageCode,existingTrack=this.getExistingTrack(trackName);if(existingTrack)captionsTracks[trackName]=existingTrack,Object(_utils_texttrack_utils__WEBPACK_IMPORTED_MODULE_5__.clearCurrentCues)(captionsTracks[trackName]),Object(_utils_texttrack_utils__WEBPACK_IMPORTED_MODULE_5__.sendAddTrackEvent)(captionsTracks[trackName],media);else{var textTrack=this.createTextTrack("captions",label,languageCode);textTrack&&(textTrack[trackName]=!0,captionsTracks[trackName]=textTrack)}}},_proto.createNonNativeTrack=function(trackName){if(!this.nonNativeCaptionsTracks[trackName]){var trackProperties=this.captionsProperties[trackName];if(trackProperties){var track={_id:trackName,label:trackProperties.label,kind:"captions",default:!!trackProperties.media&&!!trackProperties.media.default,closedCaptions:trackProperties.media};this.nonNativeCaptionsTracks[trackName]=track,this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[track]})}}},_proto.createTextTrack=function(kind,label,lang){var media=this.media;if(media)return media.addTextTrack(kind,label,lang)},_proto.onMediaAttaching=function(event,data){this.media=data.media,this._cleanTracks()},_proto.onMediaDetaching=function(){var captionsTracks=this.captionsTracks;Object.keys(captionsTracks).forEach(function(trackName){Object(_utils_texttrack_utils__WEBPACK_IMPORTED_MODULE_5__.clearCurrentCues)(captionsTracks[trackName]),delete captionsTracks[trackName]}),this.nonNativeCaptionsTracks={}},_proto.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},_proto._cleanTracks=function(){var media=this.media;if(media){var textTracks=media.textTracks;if(textTracks)for(var i=0;i<textTracks.length;i++)Object(_utils_texttrack_utils__WEBPACK_IMPORTED_MODULE_5__.clearCurrentCues)(textTracks[i])}},_proto.onSubtitleTracksUpdated=function(event,data){var _this2=this;this.textTracks=[];var tracks=data.subtitleTracks||[],hasIMSC1=tracks.some(function(track){return track.textCodec===_utils_imsc1_ttml_parser__WEBPACK_IMPORTED_MODULE_6__.IMSC1_CODEC});if(this.config.enableWebVTT||hasIMSC1&&this.config.enableIMSC1){var sameTracks=this.tracks&&tracks&&this.tracks.length===tracks.length;if(this.tracks=tracks||[],this.config.renderTextTracksNatively){var inUseTracks=this.media?this.media.textTracks:[];this.tracks.forEach(function(track,index){var textTrack;if(index<inUseTracks.length){for(var inUseTrack=null,i=0;i<inUseTracks.length;i++)if(canReuseVttTextTrack(inUseTracks[i],track)){inUseTrack=inUseTracks[i];break}inUseTrack&&(textTrack=inUseTrack)}textTrack?Object(_utils_texttrack_utils__WEBPACK_IMPORTED_MODULE_5__.clearCurrentCues)(textTrack):(textTrack=_this2.createTextTrack("subtitles",track.name,track.lang))&&(textTrack.mode="disabled"),textTrack&&(textTrack.groupId=track.groupId,_this2.textTracks.push(textTrack))})}else if(!sameTracks&&this.tracks&&this.tracks.length){var tracksList=this.tracks.map(function(track){return{label:track.name,kind:track.type.toLowerCase(),default:track.default,subtitleTrack:track}});this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:tracksList})}}},_proto.onManifestLoaded=function(event,data){var _this3=this;this.config.enableCEA708Captions&&data.captions&&data.captions.forEach(function(captionsTrack){var instreamIdMatch=/(?:CC|SERVICE)([1-4])/.exec(captionsTrack.instreamId);if(instreamIdMatch){var trackProperties=_this3.captionsProperties["textTrack"+instreamIdMatch[1]];trackProperties&&(trackProperties.label=captionsTrack.name,captionsTrack.lang&&(trackProperties.languageCode=captionsTrack.lang),trackProperties.media=captionsTrack)}})},_proto.onFragLoading=function(event,data){var cea608Parser1=this.cea608Parser1,cea608Parser2=this.cea608Parser2;if(this.enabled&&cea608Parser1&&cea608Parser2&&data.frag.type===_types_loader__WEBPACK_IMPORTED_MODULE_7__.PlaylistLevelType.MAIN){var sn=data.frag.sn;sn!==this.lastSn+1&&(cea608Parser1.reset(),cea608Parser2.reset()),this.lastSn=sn}},_proto.onFragLoaded=function(event,data){var frag=data.frag,payload=data.payload,initPTS=this.initPTS,unparsedVttFrags=this.unparsedVttFrags;if(frag.type===_types_loader__WEBPACK_IMPORTED_MODULE_7__.PlaylistLevelType.SUBTITLE)if(payload.byteLength){if(!Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(initPTS[frag.cc]))return unparsedVttFrags.push(data),void(initPTS.length&&this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:frag,error:new Error("Missing initial subtitle PTS")}));var decryptData=frag.decryptdata;if(null==decryptData||null==decryptData.key||"AES-128"!==decryptData.method){var trackPlaylistMedia=this.tracks[frag.level],vttCCs=this.vttCCs;vttCCs[frag.cc]||(vttCCs[frag.cc]={start:frag.start,prevCC:this.prevCC,new:!0},this.prevCC=frag.cc),trackPlaylistMedia&&trackPlaylistMedia.textCodec===_utils_imsc1_ttml_parser__WEBPACK_IMPORTED_MODULE_6__.IMSC1_CODEC?this._parseIMSC1(frag,payload):this._parseVTTs(frag,payload,vttCCs)}}else this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:frag,error:new Error("Empty subtitle payload")})},_proto._parseIMSC1=function(frag,payload){var _this4=this,hls=this.hls;Object(_utils_imsc1_ttml_parser__WEBPACK_IMPORTED_MODULE_6__.parseIMSC1)(payload,this.initPTS[frag.cc],this.timescale[frag.cc],function(cues){_this4._appendCues(cues,frag.level),hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:frag})},function(error){_utils_logger__WEBPACK_IMPORTED_MODULE_8__.logger.log("Failed to parse IMSC1: "+error),hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:frag,error:error})})},_proto._parseVTTs=function(frag,payload,vttCCs){var _this5=this,hls=this.hls;Object(_utils_webvtt_parser__WEBPACK_IMPORTED_MODULE_4__.parseWebVTT)(payload,this.initPTS[frag.cc],this.timescale[frag.cc],vttCCs,frag.cc,frag.start,function(cues){_this5._appendCues(cues,frag.level),hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:frag})},function(error){_this5._fallbackToIMSC1(frag,payload),_utils_logger__WEBPACK_IMPORTED_MODULE_8__.logger.log("Failed to parse VTT cue: "+error),hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:frag,error:error})})},_proto._fallbackToIMSC1=function(frag,payload){var _this6=this,trackPlaylistMedia=this.tracks[frag.level];trackPlaylistMedia.textCodec||Object(_utils_imsc1_ttml_parser__WEBPACK_IMPORTED_MODULE_6__.parseIMSC1)(payload,this.initPTS[frag.cc],this.timescale[frag.cc],function(){trackPlaylistMedia.textCodec=_utils_imsc1_ttml_parser__WEBPACK_IMPORTED_MODULE_6__.IMSC1_CODEC,_this6._parseIMSC1(frag,payload)},function(){trackPlaylistMedia.textCodec="wvtt"})},_proto._appendCues=function(cues,fragLevel){var hls=this.hls;if(this.config.renderTextTracksNatively){var textTrack=this.textTracks[fragLevel];if("disabled"===textTrack.mode)return;cues.forEach(function(cue){return Object(_utils_texttrack_utils__WEBPACK_IMPORTED_MODULE_5__.addCueToTrack)(textTrack,cue)})}else hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.CUES_PARSED,{type:"subtitles",cues:cues,track:this.tracks[fragLevel].default?"default":"subtitles"+fragLevel})},_proto.onFragDecrypted=function(event,data){var frag=data.frag;if(frag.type===_types_loader__WEBPACK_IMPORTED_MODULE_7__.PlaylistLevelType.SUBTITLE){if(!Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(this.initPTS[frag.cc]))return void this.unparsedVttFrags.push(data);this.onFragLoaded(_events__WEBPACK_IMPORTED_MODULE_1__.Events.FRAG_LOADED,data)}},_proto.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},_proto.onFragParsingUserdata=function(event,data){var cea608Parser1=this.cea608Parser1,cea608Parser2=this.cea608Parser2;if(this.enabled&&cea608Parser1&&cea608Parser2)for(var i=0;i<data.samples.length;i++){var ccBytes=data.samples[i].bytes;if(ccBytes){var ccdatas=this.extractCea608Data(ccBytes);cea608Parser1.addData(data.samples[i].pts,ccdatas[0]),cea608Parser2.addData(data.samples[i].pts,ccdatas[1])}}},_proto.onBufferFlushing=function(event,_ref2){var startOffset=_ref2.startOffset,endOffset=_ref2.endOffset,endOffsetSubtitles=_ref2.endOffsetSubtitles,type=_ref2.type,media=this.media;if(media&&!(media.currentTime<endOffset)){if(!type||"video"===type){var captionsTracks=this.captionsTracks;Object.keys(captionsTracks).forEach(function(trackName){return Object(_utils_texttrack_utils__WEBPACK_IMPORTED_MODULE_5__.removeCuesInRange)(captionsTracks[trackName],startOffset,endOffset)})}if(this.config.renderTextTracksNatively&&0===startOffset&&void 0!==endOffsetSubtitles){var textTracks=this.textTracks;Object.keys(textTracks).forEach(function(trackName){return Object(_utils_texttrack_utils__WEBPACK_IMPORTED_MODULE_5__.removeCuesInRange)(textTracks[trackName],startOffset,endOffsetSubtitles)})}}},_proto.extractCea608Data=function(byteArray){for(var count=31&byteArray[0],position=2,actualCCBytes=[[],[]],j=0;j<count;j++){var tmpByte=byteArray[position++],ccbyte1=127&byteArray[position++],ccbyte2=127&byteArray[position++],ccType=3&tmpByte;0===ccbyte1&&0===ccbyte2||0!=(4&tmpByte)&&(0!==ccType&&1!==ccType||(actualCCBytes[ccType].push(ccbyte1),actualCCBytes[ccType].push(ccbyte2)))}return actualCCBytes},TimelineController}();function canReuseVttTextTrack(inUseTrack,manifestTrack){return inUseTrack&&inUseTrack.label===manifestTrack.name&&!(inUseTrack.textTrack1||inUseTrack.textTrack2)}},"./src/crypt/aes-crypto.ts":
/*!*********************************!*\
        !*** ./src/crypt/aes-crypto.ts ***!
        \*********************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_533372__){"use strict";__nested_webpack_require_533372__.r(__webpack_exports__),__nested_webpack_require_533372__.d(__webpack_exports__,"default",function(){return AESCrypto});var AESCrypto=function(){function AESCrypto(subtle,iv){this.subtle=void 0,this.aesIV=void 0,this.subtle=subtle,this.aesIV=iv}return AESCrypto.prototype.decrypt=function(data,key){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},key,data)},AESCrypto}()},"./src/crypt/aes-decryptor.ts":
/*!************************************!*\
        !*** ./src/crypt/aes-decryptor.ts ***!
        \************************************/
/*! exports provided: removePadding, default */
function(module,__webpack_exports__,__nested_webpack_require_534503__){"use strict";__nested_webpack_require_534503__.r(__webpack_exports__),__nested_webpack_require_534503__.d(__webpack_exports__,"removePadding",function(){return removePadding}),__nested_webpack_require_534503__.d(__webpack_exports__,"default",function(){return AESDecryptor});var _utils_typed_array__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_534503__(
/*! ../utils/typed-array */
"./src/utils/typed-array.ts");function removePadding(array){var outputBytes=array.byteLength,paddingBytes=outputBytes&&new DataView(array.buffer).getUint8(outputBytes-1);return paddingBytes?Object(_utils_typed_array__WEBPACK_IMPORTED_MODULE_0__.sliceUint8)(array,0,outputBytes-paddingBytes):array}var AESDecryptor=function(){function AESDecryptor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var _proto=AESDecryptor.prototype;return _proto.uint8ArrayToUint32Array_=function(arrayBuffer){for(var view=new DataView(arrayBuffer),newArray=new Uint32Array(4),i=0;i<4;i++)newArray[i]=view.getUint32(4*i);return newArray},_proto.initTable=function(){var sBox=this.sBox,invSBox=this.invSBox,subMix=this.subMix,subMix0=subMix[0],subMix1=subMix[1],subMix2=subMix[2],subMix3=subMix[3],invSubMix=this.invSubMix,invSubMix0=invSubMix[0],invSubMix1=invSubMix[1],invSubMix2=invSubMix[2],invSubMix3=invSubMix[3],d=new Uint32Array(256),x=0,xi=0,i=0;for(i=0;i<256;i++)d[i]=i<128?i<<1:i<<1^283;for(i=0;i<256;i++){var sx=xi^xi<<1^xi<<2^xi<<3^xi<<4;sBox[x]=sx=sx>>>8^255&sx^99,invSBox[sx]=x;var x2=d[x],x4=d[x2],x8=d[x4],t=257*d[sx]^16843008*sx;subMix0[x]=t<<24|t>>>8,subMix1[x]=t<<16|t>>>16,subMix2[x]=t<<8|t>>>24,subMix3[x]=t,invSubMix0[sx]=(t=16843009*x8^65537*x4^257*x2^16843008*x)<<24|t>>>8,invSubMix1[sx]=t<<16|t>>>16,invSubMix2[sx]=t<<8|t>>>24,invSubMix3[sx]=t,x?(x=x2^d[d[d[x8^x2]]],xi^=d[d[xi]]):x=xi=1}},_proto.expandKey=function(keyBuffer){for(var key=this.uint8ArrayToUint32Array_(keyBuffer),sameKey=!0,offset=0;offset<key.length&&sameKey;)sameKey=key[offset]===this.key[offset],offset++;if(!sameKey){this.key=key;var keySize=this.keySize=key.length;if(4!==keySize&&6!==keySize&&8!==keySize)throw new Error("Invalid aes key size="+keySize);var ksRow,invKsRow,prev,t,ksRows=this.ksRows=4*(keySize+6+1),keySchedule=this.keySchedule=new Uint32Array(ksRows),invKeySchedule=this.invKeySchedule=new Uint32Array(ksRows),sbox=this.sBox,rcon=this.rcon,invSubMix=this.invSubMix,invSubMix0=invSubMix[0],invSubMix1=invSubMix[1],invSubMix2=invSubMix[2],invSubMix3=invSubMix[3];for(ksRow=0;ksRow<ksRows;ksRow++)ksRow<keySize?prev=keySchedule[ksRow]=key[ksRow]:(t=prev,ksRow%keySize==0?(t=sbox[(t=t<<8|t>>>24)>>>24]<<24|sbox[t>>>16&255]<<16|sbox[t>>>8&255]<<8|sbox[255&t],t^=rcon[ksRow/keySize|0]<<24):keySize>6&&ksRow%keySize==4&&(t=sbox[t>>>24]<<24|sbox[t>>>16&255]<<16|sbox[t>>>8&255]<<8|sbox[255&t]),keySchedule[ksRow]=prev=(keySchedule[ksRow-keySize]^t)>>>0);for(invKsRow=0;invKsRow<ksRows;invKsRow++)ksRow=ksRows-invKsRow,t=3&invKsRow?keySchedule[ksRow]:keySchedule[ksRow-4],invKeySchedule[invKsRow]=invKsRow<4||ksRow<=4?t:invSubMix0[sbox[t>>>24]]^invSubMix1[sbox[t>>>16&255]]^invSubMix2[sbox[t>>>8&255]]^invSubMix3[sbox[255&t]],invKeySchedule[invKsRow]=invKeySchedule[invKsRow]>>>0}},_proto.networkToHostOrderSwap=function(word){return word<<24|(65280&word)<<8|(16711680&word)>>8|word>>>24},_proto.decrypt=function(inputArrayBuffer,offset,aesIV){for(var t1,t2,t3,s0,s1,s2,s3,inputWords0,inputWords1,inputWords2,inputWords3,ksRow,i,nRounds=this.keySize+6,invKeySchedule=this.invKeySchedule,invSBOX=this.invSBox,invSubMix=this.invSubMix,invSubMix0=invSubMix[0],invSubMix1=invSubMix[1],invSubMix2=invSubMix[2],invSubMix3=invSubMix[3],initVector=this.uint8ArrayToUint32Array_(aesIV),initVector0=initVector[0],initVector1=initVector[1],initVector2=initVector[2],initVector3=initVector[3],inputInt32=new Int32Array(inputArrayBuffer),outputInt32=new Int32Array(inputInt32.length),swapWord=this.networkToHostOrderSwap;offset<inputInt32.length;){for(inputWords0=swapWord(inputInt32[offset]),inputWords1=swapWord(inputInt32[offset+1]),inputWords2=swapWord(inputInt32[offset+2]),inputWords3=swapWord(inputInt32[offset+3]),s0=inputWords0^invKeySchedule[0],s1=inputWords3^invKeySchedule[1],s2=inputWords2^invKeySchedule[2],s3=inputWords1^invKeySchedule[3],ksRow=4,i=1;i<nRounds;i++)t1=invSubMix0[s1>>>24]^invSubMix1[s2>>16&255]^invSubMix2[s3>>8&255]^invSubMix3[255&s0]^invKeySchedule[ksRow+1],t2=invSubMix0[s2>>>24]^invSubMix1[s3>>16&255]^invSubMix2[s0>>8&255]^invSubMix3[255&s1]^invKeySchedule[ksRow+2],t3=invSubMix0[s3>>>24]^invSubMix1[s0>>16&255]^invSubMix2[s1>>8&255]^invSubMix3[255&s2]^invKeySchedule[ksRow+3],s0=invSubMix0[s0>>>24]^invSubMix1[s1>>16&255]^invSubMix2[s2>>8&255]^invSubMix3[255&s3]^invKeySchedule[ksRow],s1=t1,s2=t2,s3=t3,ksRow+=4;t1=invSBOX[s1>>>24]<<24^invSBOX[s2>>16&255]<<16^invSBOX[s3>>8&255]<<8^invSBOX[255&s0]^invKeySchedule[ksRow+1],t2=invSBOX[s2>>>24]<<24^invSBOX[s3>>16&255]<<16^invSBOX[s0>>8&255]<<8^invSBOX[255&s1]^invKeySchedule[ksRow+2],t3=invSBOX[s3>>>24]<<24^invSBOX[s0>>16&255]<<16^invSBOX[s1>>8&255]<<8^invSBOX[255&s2]^invKeySchedule[ksRow+3],outputInt32[offset]=swapWord(invSBOX[s0>>>24]<<24^invSBOX[s1>>16&255]<<16^invSBOX[s2>>8&255]<<8^invSBOX[255&s3]^invKeySchedule[ksRow]^initVector0),outputInt32[offset+1]=swapWord(t3^initVector1),outputInt32[offset+2]=swapWord(t2^initVector2),outputInt32[offset+3]=swapWord(t1^initVector3),initVector0=inputWords0,initVector1=inputWords1,initVector2=inputWords2,initVector3=inputWords3,offset+=4}return outputInt32.buffer},AESDecryptor}()},"./src/crypt/decrypter.ts":
/*!********************************!*\
        !*** ./src/crypt/decrypter.ts ***!
        \********************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_545755__){"use strict";__nested_webpack_require_545755__.r(__webpack_exports__),__nested_webpack_require_545755__.d(__webpack_exports__,"default",function(){return Decrypter});var _aes_crypto__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_545755__(
/*! ./aes-crypto */
"./src/crypt/aes-crypto.ts"),_fast_aes_key__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_545755__(
/*! ./fast-aes-key */
"./src/crypt/fast-aes-key.ts"),_aes_decryptor__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_545755__(
/*! ./aes-decryptor */
"./src/crypt/aes-decryptor.ts"),_utils_logger__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_545755__(
/*! ../utils/logger */
"./src/utils/logger.ts"),_utils_mp4_tools__WEBPACK_IMPORTED_MODULE_4__=__nested_webpack_require_545755__(
/*! ../utils/mp4-tools */
"./src/utils/mp4-tools.ts"),_utils_typed_array__WEBPACK_IMPORTED_MODULE_5__=__nested_webpack_require_545755__(
/*! ../utils/typed-array */
"./src/utils/typed-array.ts"),Decrypter=function(){function Decrypter(observer,config,_temp){var _ref$removePKCS7Paddi=(void 0===_temp?{}:_temp).removePKCS7Padding,removePKCS7Padding=void 0===_ref$removePKCS7Paddi||_ref$removePKCS7Paddi;if(this.logEnabled=!0,this.observer=void 0,this.config=void 0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.observer=observer,this.config=config,this.removePKCS7Padding=removePKCS7Padding,removePKCS7Padding)try{var browserCrypto=self.crypto;browserCrypto&&(this.subtle=browserCrypto.subtle||browserCrypto.webkitSubtle)}catch(e){}null===this.subtle&&(this.config.enableSoftwareAES=!0)}var _proto=Decrypter.prototype;return _proto.destroy=function(){this.observer=null},_proto.isSync=function(){return this.config.enableSoftwareAES},_proto.flush=function(){var currentResult=this.currentResult;if(currentResult){var data=new Uint8Array(currentResult);return this.reset(),this.removePKCS7Padding?Object(_aes_decryptor__WEBPACK_IMPORTED_MODULE_2__.removePadding)(data):data}this.reset()},_proto.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},_proto.decrypt=function(data,key,iv,callback){if(this.config.enableSoftwareAES){this.softwareDecrypt(new Uint8Array(data),key,iv);var decryptResult=this.flush();decryptResult&&callback(decryptResult.buffer)}else this.webCryptoDecrypt(new Uint8Array(data),key,iv).then(callback)},_proto.softwareDecrypt=function(data,key,iv){var currentIV=this.currentIV,currentResult=this.currentResult,remainderData=this.remainderData;this.logOnce("JS AES decrypt"),remainderData&&(data=Object(_utils_mp4_tools__WEBPACK_IMPORTED_MODULE_4__.appendUint8Array)(remainderData,data),this.remainderData=null);var currentChunk=this.getValidChunk(data);if(!currentChunk.length)return null;currentIV&&(iv=currentIV);var softwareDecrypter=this.softwareDecrypter;softwareDecrypter||(softwareDecrypter=this.softwareDecrypter=new _aes_decryptor__WEBPACK_IMPORTED_MODULE_2__.default),softwareDecrypter.expandKey(key);var result=currentResult;return this.currentResult=softwareDecrypter.decrypt(currentChunk.buffer,0,iv),this.currentIV=Object(_utils_typed_array__WEBPACK_IMPORTED_MODULE_5__.sliceUint8)(currentChunk,-16).buffer,result||null},_proto.webCryptoDecrypt=function(data,key,iv){var _this=this,subtle=this.subtle;return this.key===key&&this.fastAesKey||(this.key=key,this.fastAesKey=new _fast_aes_key__WEBPACK_IMPORTED_MODULE_1__.default(subtle,key)),this.fastAesKey.expandKey().then(function(aesKey){return subtle?new _aes_crypto__WEBPACK_IMPORTED_MODULE_0__.default(subtle,iv).decrypt(data.buffer,aesKey):Promise.reject(new Error("web crypto not initialized"))}).catch(function(err){return _this.onWebCryptoError(err,data,key,iv)})},_proto.onWebCryptoError=function(err,data,key,iv){return _utils_logger__WEBPACK_IMPORTED_MODULE_3__.logger.warn("[decrypter.ts]: WebCrypto Error, disable WebCrypto API:",err),this.config.enableSoftwareAES=!0,this.logEnabled=!0,this.softwareDecrypt(data,key,iv)},_proto.getValidChunk=function(data){var currentChunk=data,splitPoint=data.length-data.length%16;return splitPoint!==data.length&&(currentChunk=Object(_utils_typed_array__WEBPACK_IMPORTED_MODULE_5__.sliceUint8)(data,0,splitPoint),this.remainderData=Object(_utils_typed_array__WEBPACK_IMPORTED_MODULE_5__.sliceUint8)(data,splitPoint)),currentChunk},_proto.logOnce=function(msg){this.logEnabled&&(_utils_logger__WEBPACK_IMPORTED_MODULE_3__.logger.log("[decrypter.ts]: "+msg),this.logEnabled=!1)},Decrypter}()},"./src/crypt/fast-aes-key.ts":
/*!***********************************!*\
        !*** ./src/crypt/fast-aes-key.ts ***!
        \***********************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_554251__){"use strict";__nested_webpack_require_554251__.r(__webpack_exports__),__nested_webpack_require_554251__.d(__webpack_exports__,"default",function(){return FastAESKey});var FastAESKey=function(){function FastAESKey(subtle,key){this.subtle=void 0,this.key=void 0,this.subtle=subtle,this.key=key}return FastAESKey.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},FastAESKey}()},"./src/demux/aacdemuxer.ts":
/*!*********************************!*\
        !*** ./src/demux/aacdemuxer.ts ***!
        \*********************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_555360__){"use strict";__nested_webpack_require_555360__.r(__webpack_exports__);var _base_audio_demuxer__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_555360__(
/*! ./base-audio-demuxer */
"./src/demux/base-audio-demuxer.ts"),_adts__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_555360__(
/*! ./adts */
"./src/demux/adts.ts"),_utils_logger__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_555360__(
/*! ../utils/logger */
"./src/utils/logger.ts"),_demux_id3__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_555360__(
/*! ../demux/id3 */
"./src/demux/id3.ts");function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}var AACDemuxer=function(_BaseAudioDemuxer){var subClass,superClass;function AACDemuxer(observer,config){var _this;return(_this=_BaseAudioDemuxer.call(this)||this).observer=void 0,_this.config=void 0,_this.observer=observer,_this.config=config,_this}superClass=_BaseAudioDemuxer,(subClass=AACDemuxer).prototype=Object.create(superClass.prototype),subClass.prototype.constructor=subClass,_setPrototypeOf(subClass,superClass);var _proto=AACDemuxer.prototype;return _proto.resetInitSegment=function(audioCodec,videoCodec,duration){_BaseAudioDemuxer.prototype.resetInitSegment.call(this,audioCodec,videoCodec,duration),this._audioTrack={container:"audio/adts",type:"audio",id:0,pid:-1,sequenceNumber:0,isAAC:!0,samples:[],manifestCodec:audioCodec,duration:duration,inputTimeScale:9e4,dropped:0}},AACDemuxer.probe=function(data){if(!data)return!1;for(var offset=(_demux_id3__WEBPACK_IMPORTED_MODULE_3__.getID3Data(data,0)||[]).length,length=data.length;offset<length;offset++)if(_adts__WEBPACK_IMPORTED_MODULE_1__.probe(data,offset))return _utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.log("ADTS sync word found !"),!0;return!1},_proto.canParse=function(data,offset){return _adts__WEBPACK_IMPORTED_MODULE_1__.canParse(data,offset)},_proto.appendFrame=function(track,data,offset){_adts__WEBPACK_IMPORTED_MODULE_1__.initTrackConfig(track,this.observer,data,offset,track.manifestCodec);var frame=_adts__WEBPACK_IMPORTED_MODULE_1__.appendFrame(track,data,offset,this.initPTS,this.frameIndex);if(frame&&0===frame.missing)return frame},AACDemuxer}(_base_audio_demuxer__WEBPACK_IMPORTED_MODULE_0__.default);AACDemuxer.minProbeByteLength=9,__webpack_exports__.default=AACDemuxer},"./src/demux/adts.ts":
/*!***************************!*\
        !*** ./src/demux/adts.ts ***!
        \***************************/
/*! exports provided: getAudioConfig, isHeaderPattern, getHeaderLength, getFullFrameLength, canGetFrameLength, isHeader, canParse, probe, initTrackConfig, getFrameDuration, parseFrameHeader, appendFrame */
function(module,__webpack_exports__,__nested_webpack_require_560038__){"use strict";__nested_webpack_require_560038__.r(__webpack_exports__),__nested_webpack_require_560038__.d(__webpack_exports__,"getAudioConfig",function(){return getAudioConfig}),__nested_webpack_require_560038__.d(__webpack_exports__,"isHeaderPattern",function(){return isHeaderPattern}),__nested_webpack_require_560038__.d(__webpack_exports__,"getHeaderLength",function(){return getHeaderLength}),__nested_webpack_require_560038__.d(__webpack_exports__,"getFullFrameLength",function(){return getFullFrameLength}),__nested_webpack_require_560038__.d(__webpack_exports__,"canGetFrameLength",function(){return canGetFrameLength}),__nested_webpack_require_560038__.d(__webpack_exports__,"isHeader",function(){return isHeader}),__nested_webpack_require_560038__.d(__webpack_exports__,"canParse",function(){return canParse}),__nested_webpack_require_560038__.d(__webpack_exports__,"probe",function(){return probe}),__nested_webpack_require_560038__.d(__webpack_exports__,"initTrackConfig",function(){return initTrackConfig}),__nested_webpack_require_560038__.d(__webpack_exports__,"getFrameDuration",function(){return getFrameDuration}),__nested_webpack_require_560038__.d(__webpack_exports__,"parseFrameHeader",function(){return parseFrameHeader}),__nested_webpack_require_560038__.d(__webpack_exports__,"appendFrame",function(){return appendFrame});var _utils_logger__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_560038__(
/*! ../utils/logger */
"./src/utils/logger.ts"),_errors__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_560038__(
/*! ../errors */
"./src/errors.ts"),_events__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_560038__(
/*! ../events */
"./src/events.ts");function getAudioConfig(observer,data,offset,audioCodec){var adtsObjectType,adtsExtensionSamplingIndex,adtsChanelConfig,config,userAgent=navigator.userAgent.toLowerCase(),manifestCodec=audioCodec,adtsSampleingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];adtsObjectType=1+((192&data[offset+2])>>>6);var adtsSamplingIndex=(60&data[offset+2])>>>2;if(!(adtsSamplingIndex>adtsSampleingRates.length-1))return adtsChanelConfig=(1&data[offset+2])<<2,adtsChanelConfig|=(192&data[offset+3])>>>6,_utils_logger__WEBPACK_IMPORTED_MODULE_0__.logger.log("manifest codec:"+audioCodec+", ADTS type:"+adtsObjectType+", samplingIndex:"+adtsSamplingIndex),/firefox/i.test(userAgent)?adtsSamplingIndex>=6?(adtsObjectType=5,config=new Array(4),adtsExtensionSamplingIndex=adtsSamplingIndex-3):(adtsObjectType=2,config=new Array(2),adtsExtensionSamplingIndex=adtsSamplingIndex):-1!==userAgent.indexOf("android")?(adtsObjectType=2,config=new Array(2),adtsExtensionSamplingIndex=adtsSamplingIndex):(adtsObjectType=5,config=new Array(4),audioCodec&&(-1!==audioCodec.indexOf("mp4a.40.29")||-1!==audioCodec.indexOf("mp4a.40.5"))||!audioCodec&&adtsSamplingIndex>=6?adtsExtensionSamplingIndex=adtsSamplingIndex-3:((audioCodec&&-1!==audioCodec.indexOf("mp4a.40.2")&&(adtsSamplingIndex>=6&&1===adtsChanelConfig||/vivaldi/i.test(userAgent))||!audioCodec&&1===adtsChanelConfig)&&(adtsObjectType=2,config=new Array(2)),adtsExtensionSamplingIndex=adtsSamplingIndex)),config[0]=adtsObjectType<<3,config[0]|=(14&adtsSamplingIndex)>>1,config[1]|=(1&adtsSamplingIndex)<<7,config[1]|=adtsChanelConfig<<3,5===adtsObjectType&&(config[1]|=(14&adtsExtensionSamplingIndex)>>1,config[2]=(1&adtsExtensionSamplingIndex)<<7,config[2]|=8,config[3]=0),{config:config,samplerate:adtsSampleingRates[adtsSamplingIndex],channelCount:adtsChanelConfig,codec:"mp4a.40."+adtsObjectType,manifestCodec:manifestCodec};observer.trigger(_events__WEBPACK_IMPORTED_MODULE_2__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorTypes.MEDIA_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+adtsSamplingIndex})}function isHeaderPattern(data,offset){return 255===data[offset]&&240==(246&data[offset+1])}function getHeaderLength(data,offset){return 1&data[offset+1]?7:9}function getFullFrameLength(data,offset){return(3&data[offset+3])<<11|data[offset+4]<<3|(224&data[offset+5])>>>5}function canGetFrameLength(data,offset){return offset+5<data.length}function isHeader(data,offset){return offset+1<data.length&&isHeaderPattern(data,offset)}function canParse(data,offset){return canGetFrameLength(data,offset)&&isHeaderPattern(data,offset)&&getFullFrameLength(data,offset)<=data.length-offset}function probe(data,offset){if(isHeader(data,offset)){var headerLength=getHeaderLength(data,offset);if(offset+headerLength>=data.length)return!1;var frameLength=getFullFrameLength(data,offset);if(frameLength<=headerLength)return!1;var newOffset=offset+frameLength;return newOffset===data.length||isHeader(data,newOffset)}return!1}function initTrackConfig(track,observer,data,offset,audioCodec){if(!track.samplerate){var config=getAudioConfig(observer,data,offset,audioCodec);if(!config)return;track.config=config.config,track.samplerate=config.samplerate,track.channelCount=config.channelCount,track.codec=config.codec,track.manifestCodec=config.manifestCodec,_utils_logger__WEBPACK_IMPORTED_MODULE_0__.logger.log("parsed codec:"+track.codec+", rate:"+config.samplerate+", channels:"+config.channelCount)}}function getFrameDuration(samplerate){return 9216e4/samplerate}function parseFrameHeader(data,offset,pts,frameIndex,frameDuration){var headerLength=getHeaderLength(data,offset),frameLength=getFullFrameLength(data,offset);if((frameLength-=headerLength)>0)return{headerLength:headerLength,frameLength:frameLength,stamp:pts+frameIndex*frameDuration}}function appendFrame(track,data,offset,pts,frameIndex){var header=parseFrameHeader(data,offset,pts,frameIndex,getFrameDuration(track.samplerate));if(header){var unit,headerLength=header.headerLength,stamp=header.stamp,length=headerLength+header.frameLength,missing=Math.max(0,offset+length-data.length);missing?(unit=new Uint8Array(length-headerLength)).set(data.subarray(offset+headerLength,data.length),0):unit=data.subarray(offset+headerLength,offset+length);var sample={unit:unit,pts:stamp};return missing||track.samples.push(sample),{sample:sample,length:length,missing:missing}}}},"./src/demux/base-audio-demuxer.ts":
/*!*****************************************!*\
        !*** ./src/demux/base-audio-demuxer.ts ***!
        \*****************************************/
/*! exports provided: initPTSFn, default */
function(module,__webpack_exports__,__nested_webpack_require_573966__){"use strict";__nested_webpack_require_573966__.r(__webpack_exports__),__nested_webpack_require_573966__.d(__webpack_exports__,"initPTSFn",function(){return initPTSFn});var _home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_573966__(
/*! ./src/polyfills/number */
"./src/polyfills/number.ts"),_demux_id3__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_573966__(
/*! ../demux/id3 */
"./src/demux/id3.ts"),_dummy_demuxed_track__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_573966__(
/*! ./dummy-demuxed-track */
"./src/demux/dummy-demuxed-track.ts"),_utils_mp4_tools__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_573966__(
/*! ../utils/mp4-tools */
"./src/utils/mp4-tools.ts"),_utils_typed_array__WEBPACK_IMPORTED_MODULE_4__=__nested_webpack_require_573966__(
/*! ../utils/typed-array */
"./src/utils/typed-array.ts"),BaseAudioDemuxer=function(){function BaseAudioDemuxer(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.initPTS=null}var _proto=BaseAudioDemuxer.prototype;return _proto.resetInitSegment=function(audioCodec,videoCodec,duration){this._id3Track={type:"id3",id:0,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},_proto.resetTimeStamp=function(){},_proto.resetContiguity=function(){},_proto.canParse=function(data,offset){return!1},_proto.appendFrame=function(track,data,offset){},_proto.demux=function(data,timeOffset){this.cachedData&&(data=Object(_utils_mp4_tools__WEBPACK_IMPORTED_MODULE_3__.appendUint8Array)(this.cachedData,data),this.cachedData=null);var lastDataIndex,pts,id3Data=_demux_id3__WEBPACK_IMPORTED_MODULE_1__.getID3Data(data,0),offset=id3Data?id3Data.length:0,track=this._audioTrack,id3Track=this._id3Track,timestamp=id3Data?_demux_id3__WEBPACK_IMPORTED_MODULE_1__.getTimeStamp(id3Data):void 0,length=data.length;for(0!==this.frameIndex&&null!==this.initPTS||(this.initPTS=initPTSFn(timestamp,timeOffset)),id3Data&&id3Data.length>0&&id3Track.samples.push({pts:this.initPTS,dts:this.initPTS,data:id3Data}),pts=this.initPTS;offset<length;){if(this.canParse(data,offset)){var frame=this.appendFrame(track,data,offset);frame?(this.frameIndex++,pts=frame.sample.pts,lastDataIndex=offset+=frame.length):offset=length}else _demux_id3__WEBPACK_IMPORTED_MODULE_1__.canParse(data,offset)?(id3Data=_demux_id3__WEBPACK_IMPORTED_MODULE_1__.getID3Data(data,offset),id3Track.samples.push({pts:pts,dts:pts,data:id3Data}),lastDataIndex=offset+=id3Data.length):offset++;if(offset===length&&lastDataIndex!==length){var partialData=Object(_utils_typed_array__WEBPACK_IMPORTED_MODULE_4__.sliceUint8)(data,lastDataIndex);this.cachedData=this.cachedData?Object(_utils_mp4_tools__WEBPACK_IMPORTED_MODULE_3__.appendUint8Array)(this.cachedData,partialData):partialData}}return{audioTrack:track,avcTrack:Object(_dummy_demuxed_track__WEBPACK_IMPORTED_MODULE_2__.dummyTrack)(),id3Track:id3Track,textTrack:Object(_dummy_demuxed_track__WEBPACK_IMPORTED_MODULE_2__.dummyTrack)()}},_proto.demuxSampleAes=function(data,keyData,timeOffset){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},_proto.flush=function(timeOffset){var cachedData=this.cachedData;return cachedData&&(this.cachedData=null,this.demux(cachedData,0)),this.frameIndex=0,{audioTrack:this._audioTrack,avcTrack:Object(_dummy_demuxed_track__WEBPACK_IMPORTED_MODULE_2__.dummyTrack)(),id3Track:this._id3Track,textTrack:Object(_dummy_demuxed_track__WEBPACK_IMPORTED_MODULE_2__.dummyTrack)()}},_proto.destroy=function(){},BaseAudioDemuxer}(),initPTSFn=function(timestamp,timeOffset){return Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(timestamp)?90*timestamp:9e4*timeOffset};__webpack_exports__.default=BaseAudioDemuxer},"./src/demux/chunk-cache.ts":
/*!**********************************!*\
        !*** ./src/demux/chunk-cache.ts ***!
        \**********************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_581029__){"use strict";__nested_webpack_require_581029__.r(__webpack_exports__),__nested_webpack_require_581029__.d(__webpack_exports__,"default",function(){return ChunkCache});var ChunkCache=function(){function ChunkCache(){this.chunks=[],this.dataLength=0}var _proto=ChunkCache.prototype;return _proto.push=function(chunk){this.chunks.push(chunk),this.dataLength+=chunk.length},_proto.flush=function(){var result,chunks=this.chunks;return chunks.length?(result=1===chunks.length?chunks[0]:function(chunks,dataLength){for(var result=new Uint8Array(dataLength),offset=0,i=0;i<chunks.length;i++){var chunk=chunks[i];result.set(chunk,offset),offset+=chunk.length}return result}(chunks,this.dataLength),this.reset(),result):new Uint8Array(0)},_proto.reset=function(){this.chunks.length=0,this.dataLength=0},ChunkCache}()},"./src/demux/dummy-demuxed-track.ts":
/*!******************************************!*\
        !*** ./src/demux/dummy-demuxed-track.ts ***!
        \******************************************/
/*! exports provided: dummyTrack */
function(module,__webpack_exports__,__nested_webpack_require_582994__){"use strict";function dummyTrack(){return{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0}}__nested_webpack_require_582994__.r(__webpack_exports__),__nested_webpack_require_582994__.d(__webpack_exports__,"dummyTrack",function(){return dummyTrack})},"./src/demux/exp-golomb.ts":
/*!*********************************!*\
        !*** ./src/demux/exp-golomb.ts ***!
        \*********************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_583829__){"use strict";__nested_webpack_require_583829__.r(__webpack_exports__);var _utils_logger__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_583829__(
/*! ../utils/logger */
"./src/utils/logger.ts");__webpack_exports__.default=function(){function ExpGolomb(data){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=data,this.bytesAvailable=data.byteLength,this.word=0,this.bitsAvailable=0}var _proto=ExpGolomb.prototype;return _proto.loadWord=function(){var data=this.data,bytesAvailable=this.bytesAvailable,position=data.byteLength-bytesAvailable,workingBytes=new Uint8Array(4),availableBytes=Math.min(4,bytesAvailable);if(0===availableBytes)throw new Error("no bytes available");workingBytes.set(data.subarray(position,position+availableBytes)),this.word=new DataView(workingBytes.buffer).getUint32(0),this.bitsAvailable=8*availableBytes,this.bytesAvailable-=availableBytes},_proto.skipBits=function(count){var skipBytes;this.bitsAvailable>count?(this.word<<=count,this.bitsAvailable-=count):(count-=this.bitsAvailable,count-=(skipBytes=count>>3)>>3,this.bytesAvailable-=skipBytes,this.loadWord(),this.word<<=count,this.bitsAvailable-=count)},_proto.readBits=function(size){var bits=Math.min(this.bitsAvailable,size),valu=this.word>>>32-bits;return size>32&&_utils_logger__WEBPACK_IMPORTED_MODULE_0__.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=bits,this.bitsAvailable>0?this.word<<=bits:this.bytesAvailable>0&&this.loadWord(),(bits=size-bits)>0&&this.bitsAvailable?valu<<bits|this.readBits(bits):valu},_proto.skipLZ=function(){var leadingZeroCount;for(leadingZeroCount=0;leadingZeroCount<this.bitsAvailable;++leadingZeroCount)if(0!=(this.word&2147483648>>>leadingZeroCount))return this.word<<=leadingZeroCount,this.bitsAvailable-=leadingZeroCount,leadingZeroCount;return this.loadWord(),leadingZeroCount+this.skipLZ()},_proto.skipUEG=function(){this.skipBits(1+this.skipLZ())},_proto.skipEG=function(){this.skipBits(1+this.skipLZ())},_proto.readUEG=function(){var clz=this.skipLZ();return this.readBits(clz+1)-1},_proto.readEG=function(){var valu=this.readUEG();return 1&valu?1+valu>>>1:-1*(valu>>>1)},_proto.readBoolean=function(){return 1===this.readBits(1)},_proto.readUByte=function(){return this.readBits(8)},_proto.readUShort=function(){return this.readBits(16)},_proto.readUInt=function(){return this.readBits(32)},_proto.skipScalingList=function(count){for(var lastScale=8,nextScale=8,j=0;j<count;j++)0!==nextScale&&(nextScale=(lastScale+this.readEG()+256)%256),lastScale=0===nextScale?lastScale:nextScale},_proto.readSPS=function(){var numRefFramesInPicOrderCntCycle,scalingListCount,i,frameCropLeftOffset=0,frameCropRightOffset=0,frameCropTopOffset=0,frameCropBottomOffset=0,readUByte=this.readUByte.bind(this),readBits=this.readBits.bind(this),readUEG=this.readUEG.bind(this),readBoolean=this.readBoolean.bind(this),skipBits=this.skipBits.bind(this),skipEG=this.skipEG.bind(this),skipUEG=this.skipUEG.bind(this),skipScalingList=this.skipScalingList.bind(this);readUByte();var profileIdc=readUByte();if(readBits(5),skipBits(3),readUByte(),skipUEG(),100===profileIdc||110===profileIdc||122===profileIdc||244===profileIdc||44===profileIdc||83===profileIdc||86===profileIdc||118===profileIdc||128===profileIdc){var chromaFormatIdc=readUEG();if(3===chromaFormatIdc&&skipBits(1),skipUEG(),skipUEG(),skipBits(1),readBoolean())for(scalingListCount=3!==chromaFormatIdc?8:12,i=0;i<scalingListCount;i++)readBoolean()&&skipScalingList(i<6?16:64)}skipUEG();var picOrderCntType=readUEG();if(0===picOrderCntType)readUEG();else if(1===picOrderCntType)for(skipBits(1),skipEG(),skipEG(),numRefFramesInPicOrderCntCycle=readUEG(),i=0;i<numRefFramesInPicOrderCntCycle;i++)skipEG();skipUEG(),skipBits(1);var picWidthInMbsMinus1=readUEG(),picHeightInMapUnitsMinus1=readUEG(),frameMbsOnlyFlag=readBits(1);0===frameMbsOnlyFlag&&skipBits(1),skipBits(1),readBoolean()&&(frameCropLeftOffset=readUEG(),frameCropRightOffset=readUEG(),frameCropTopOffset=readUEG(),frameCropBottomOffset=readUEG());var pixelRatio=[1,1];if(readBoolean()&&readBoolean())switch(readUByte()){case 1:pixelRatio=[1,1];break;case 2:pixelRatio=[12,11];break;case 3:pixelRatio=[10,11];break;case 4:pixelRatio=[16,11];break;case 5:pixelRatio=[40,33];break;case 6:pixelRatio=[24,11];break;case 7:pixelRatio=[20,11];break;case 8:pixelRatio=[32,11];break;case 9:pixelRatio=[80,33];break;case 10:pixelRatio=[18,11];break;case 11:pixelRatio=[15,11];break;case 12:pixelRatio=[64,33];break;case 13:pixelRatio=[160,99];break;case 14:pixelRatio=[4,3];break;case 15:pixelRatio=[3,2];break;case 16:pixelRatio=[2,1];break;case 255:pixelRatio=[readUByte()<<8|readUByte(),readUByte()<<8|readUByte()]}return{width:Math.ceil(16*(picWidthInMbsMinus1+1)-2*frameCropLeftOffset-2*frameCropRightOffset),height:(2-frameMbsOnlyFlag)*(picHeightInMapUnitsMinus1+1)*16-(frameMbsOnlyFlag?2:4)*(frameCropTopOffset+frameCropBottomOffset),pixelRatio:pixelRatio}},_proto.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},ExpGolomb}()},"./src/demux/id3.ts":
/*!**************************!*\
        !*** ./src/demux/id3.ts ***!
        \**************************/
/*! exports provided: isHeader, isFooter, getID3Data, canParse, getTimeStamp, isTimeStampFrame, getID3Frames, decodeFrame, utf8ArrayToStr, testables */
function(module,__webpack_exports__,__nested_webpack_require_597227__){"use strict";__nested_webpack_require_597227__.r(__webpack_exports__),__nested_webpack_require_597227__.d(__webpack_exports__,"isHeader",function(){return isHeader}),__nested_webpack_require_597227__.d(__webpack_exports__,"isFooter",function(){return isFooter}),__nested_webpack_require_597227__.d(__webpack_exports__,"getID3Data",function(){return getID3Data}),__nested_webpack_require_597227__.d(__webpack_exports__,"canParse",function(){return canParse}),__nested_webpack_require_597227__.d(__webpack_exports__,"getTimeStamp",function(){return getTimeStamp}),__nested_webpack_require_597227__.d(__webpack_exports__,"isTimeStampFrame",function(){return isTimeStampFrame}),__nested_webpack_require_597227__.d(__webpack_exports__,"getID3Frames",function(){return getID3Frames}),__nested_webpack_require_597227__.d(__webpack_exports__,"decodeFrame",function(){return decodeFrame}),__nested_webpack_require_597227__.d(__webpack_exports__,"utf8ArrayToStr",function(){return utf8ArrayToStr}),__nested_webpack_require_597227__.d(__webpack_exports__,"testables",function(){return testables});var decoder,isHeader=function(data,offset){return offset+10<=data.length&&73===data[offset]&&68===data[offset+1]&&51===data[offset+2]&&data[offset+3]<255&&data[offset+4]<255&&data[offset+6]<128&&data[offset+7]<128&&data[offset+8]<128&&data[offset+9]<128},isFooter=function(data,offset){return offset+10<=data.length&&51===data[offset]&&68===data[offset+1]&&73===data[offset+2]&&data[offset+3]<255&&data[offset+4]<255&&data[offset+6]<128&&data[offset+7]<128&&data[offset+8]<128&&data[offset+9]<128},getID3Data=function(data,offset){for(var front=offset,length=0;isHeader(data,offset);)length+=10,length+=readSize(data,offset+6),isFooter(data,offset+10)&&(length+=10),offset+=length;if(length>0)return data.subarray(front,front+length)},readSize=function(data,offset){var size=0;return size=(127&data[offset])<<21,size|=(127&data[offset+1])<<14,(size|=(127&data[offset+2])<<7)|127&data[offset+3]},canParse=function(data,offset){return isHeader(data,offset)&&readSize(data,offset+6)+10<=data.length-offset},getTimeStamp=function(data){for(var frames=getID3Frames(data),i=0;i<frames.length;i++){var frame=frames[i];if(isTimeStampFrame(frame))return readTimeStamp(frame)}},isTimeStampFrame=function(frame){return frame&&"PRIV"===frame.key&&"com.apple.streaming.transportStreamTimestamp"===frame.info},getFrameData=function(data){var type=String.fromCharCode(data[0],data[1],data[2],data[3]),size=readSize(data,4);return{type:type,size:size,data:data.subarray(10,10+size)}},getID3Frames=function(id3Data){for(var offset=0,frames=[];isHeader(id3Data,offset);){for(var size=readSize(id3Data,offset+6),end=(offset+=10)+size;offset+8<end;){var frameData=getFrameData(id3Data.subarray(offset)),frame=decodeFrame(frameData);frame&&frames.push(frame),offset+=frameData.size+10}isFooter(id3Data,offset)&&(offset+=10)}return frames},decodeFrame=function(frame){return"PRIV"===frame.type?decodePrivFrame(frame):"W"===frame.type[0]?decodeURLFrame(frame):decodeTextFrame(frame)},decodePrivFrame=function(frame){if(!(frame.size<2)){var owner=utf8ArrayToStr(frame.data,!0),privateData=new Uint8Array(frame.data.subarray(owner.length+1));return{key:frame.type,info:owner,data:privateData.buffer}}},decodeTextFrame=function(frame){if(!(frame.size<2)){if("TXXX"===frame.type){var index=1,description=utf8ArrayToStr(frame.data.subarray(index),!0),value=utf8ArrayToStr(frame.data.subarray(index+=description.length+1));return{key:frame.type,info:description,data:value}}var text=utf8ArrayToStr(frame.data.subarray(1));return{key:frame.type,data:text}}},decodeURLFrame=function(frame){if("WXXX"===frame.type){if(frame.size<2)return;var index=1,description=utf8ArrayToStr(frame.data.subarray(index),!0),value=utf8ArrayToStr(frame.data.subarray(index+=description.length+1));return{key:frame.type,info:description,data:value}}var url=utf8ArrayToStr(frame.data);return{key:frame.type,data:url}},readTimeStamp=function(timeStampFrame){if(8===timeStampFrame.data.byteLength){var data=new Uint8Array(timeStampFrame.data),timestamp=(data[4]<<23)+(data[5]<<15)+(data[6]<<7)+data[7];return timestamp/=45,1&data[3]&&(timestamp+=47721858.84),Math.round(timestamp)}},utf8ArrayToStr=function(array,exitOnNull){void 0===exitOnNull&&(exitOnNull=!1);var decoder=getTextDecoder();if(decoder){var decoded=decoder.decode(array);if(exitOnNull){var idx=decoded.indexOf("\0");return-1!==idx?decoded.substring(0,idx):decoded}return decoded.replace(/\0/g,"")}for(var c,char2,char3,len=array.length,out="",i=0;i<len;){if(0===(c=array[i++])&&exitOnNull)return out;if(0!==c&&3!==c)switch(c>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:out+=String.fromCharCode(c);break;case 12:case 13:char2=array[i++],out+=String.fromCharCode((31&c)<<6|63&char2);break;case 14:char2=array[i++],char3=array[i++],out+=String.fromCharCode((15&c)<<12|(63&char2)<<6|(63&char3)<<0)}}return out},testables={decodeTextFrame:decodeTextFrame};function getTextDecoder(){return decoder||void 0===self.TextDecoder||(decoder=new self.TextDecoder("utf-8")),decoder}},"./src/demux/mp3demuxer.ts":
/*!*********************************!*\
        !*** ./src/demux/mp3demuxer.ts ***!
        \*********************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_611774__){"use strict";__nested_webpack_require_611774__.r(__webpack_exports__);var _base_audio_demuxer__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_611774__(
/*! ./base-audio-demuxer */
"./src/demux/base-audio-demuxer.ts"),_demux_id3__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_611774__(
/*! ../demux/id3 */
"./src/demux/id3.ts"),_utils_logger__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_611774__(
/*! ../utils/logger */
"./src/utils/logger.ts"),_mpegaudio__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_611774__(
/*! ./mpegaudio */
"./src/demux/mpegaudio.ts");function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}var MP3Demuxer=function(_BaseAudioDemuxer){var subClass,superClass;function MP3Demuxer(){return _BaseAudioDemuxer.apply(this,arguments)||this}superClass=_BaseAudioDemuxer,(subClass=MP3Demuxer).prototype=Object.create(superClass.prototype),subClass.prototype.constructor=subClass,_setPrototypeOf(subClass,superClass);var _proto=MP3Demuxer.prototype;return _proto.resetInitSegment=function(audioCodec,videoCodec,duration){_BaseAudioDemuxer.prototype.resetInitSegment.call(this,audioCodec,videoCodec,duration),this._audioTrack={container:"audio/mpeg",type:"audio",id:0,pid:-1,sequenceNumber:0,isAAC:!1,samples:[],manifestCodec:audioCodec,duration:duration,inputTimeScale:9e4,dropped:0}},MP3Demuxer.probe=function(data){if(!data)return!1;for(var offset=(_demux_id3__WEBPACK_IMPORTED_MODULE_1__.getID3Data(data,0)||[]).length,length=data.length;offset<length;offset++)if(_mpegaudio__WEBPACK_IMPORTED_MODULE_3__.probe(data,offset))return _utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.log("MPEG Audio sync word found !"),!0;return!1},_proto.canParse=function(data,offset){return _mpegaudio__WEBPACK_IMPORTED_MODULE_3__.canParse(data,offset)},_proto.appendFrame=function(track,data,offset){if(null!==this.initPTS)return _mpegaudio__WEBPACK_IMPORTED_MODULE_3__.appendFrame(track,data,offset,this.initPTS,this.frameIndex)},MP3Demuxer}(_base_audio_demuxer__WEBPACK_IMPORTED_MODULE_0__.default);MP3Demuxer.minProbeByteLength=4,__webpack_exports__.default=MP3Demuxer},"./src/demux/mp4demuxer.ts":
/*!*********************************!*\
        !*** ./src/demux/mp4demuxer.ts ***!
        \*********************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_616012__){"use strict";__nested_webpack_require_616012__.r(__webpack_exports__);var _utils_mp4_tools__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_616012__(
/*! ../utils/mp4-tools */
"./src/utils/mp4-tools.ts"),_dummy_demuxed_track__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_616012__(
/*! ./dummy-demuxed-track */
"./src/demux/dummy-demuxed-track.ts"),MP4Demuxer=function(){function MP4Demuxer(observer,config){this.remainderData=null,this.config=void 0,this.config=config}var _proto=MP4Demuxer.prototype;return _proto.resetTimeStamp=function(){},_proto.resetInitSegment=function(){},_proto.resetContiguity=function(){},MP4Demuxer.probe=function(data){return Object(_utils_mp4_tools__WEBPACK_IMPORTED_MODULE_0__.findBox)({data:data,start:0,end:Math.min(data.length,16384)},["moof"]).length>0},_proto.demux=function(data){var avcSamples=data,avcTrack=Object(_dummy_demuxed_track__WEBPACK_IMPORTED_MODULE_1__.dummyTrack)();if(this.config.progressive){this.remainderData&&(avcSamples=Object(_utils_mp4_tools__WEBPACK_IMPORTED_MODULE_0__.appendUint8Array)(this.remainderData,data));var segmentedData=Object(_utils_mp4_tools__WEBPACK_IMPORTED_MODULE_0__.segmentValidRange)(avcSamples);this.remainderData=segmentedData.remainder,avcTrack.samples=segmentedData.valid||new Uint8Array}else avcTrack.samples=avcSamples;return{audioTrack:Object(_dummy_demuxed_track__WEBPACK_IMPORTED_MODULE_1__.dummyTrack)(),avcTrack:avcTrack,id3Track:Object(_dummy_demuxed_track__WEBPACK_IMPORTED_MODULE_1__.dummyTrack)(),textTrack:Object(_dummy_demuxed_track__WEBPACK_IMPORTED_MODULE_1__.dummyTrack)()}},_proto.flush=function(){var avcTrack=Object(_dummy_demuxed_track__WEBPACK_IMPORTED_MODULE_1__.dummyTrack)();return avcTrack.samples=this.remainderData||new Uint8Array,this.remainderData=null,{audioTrack:Object(_dummy_demuxed_track__WEBPACK_IMPORTED_MODULE_1__.dummyTrack)(),avcTrack:avcTrack,id3Track:Object(_dummy_demuxed_track__WEBPACK_IMPORTED_MODULE_1__.dummyTrack)(),textTrack:Object(_dummy_demuxed_track__WEBPACK_IMPORTED_MODULE_1__.dummyTrack)()}},_proto.demuxSampleAes=function(data,keyData,timeOffset){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},_proto.destroy=function(){},MP4Demuxer}();MP4Demuxer.minProbeByteLength=1024,__webpack_exports__.default=MP4Demuxer},"./src/demux/mpegaudio.ts":
/*!********************************!*\
        !*** ./src/demux/mpegaudio.ts ***!
        \********************************/
/*! exports provided: appendFrame, parseHeader, isHeaderPattern, isHeader, canParse, probe */
function(module,__webpack_exports__,__nested_webpack_require_620498__){"use strict";__nested_webpack_require_620498__.r(__webpack_exports__),__nested_webpack_require_620498__.d(__webpack_exports__,"appendFrame",function(){return appendFrame}),__nested_webpack_require_620498__.d(__webpack_exports__,"parseHeader",function(){return parseHeader}),__nested_webpack_require_620498__.d(__webpack_exports__,"isHeaderPattern",function(){return isHeaderPattern}),__nested_webpack_require_620498__.d(__webpack_exports__,"isHeader",function(){return isHeader}),__nested_webpack_require_620498__.d(__webpack_exports__,"canParse",function(){return canParse}),__nested_webpack_require_620498__.d(__webpack_exports__,"probe",function(){return probe});var chromeVersion=null,BitratesMap=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot=[0,1,1,4];function appendFrame(track,data,offset,pts,frameIndex){if(!(offset+24>data.length)){var header=parseHeader(data,offset);if(header&&offset+header.frameLength<=data.length){var stamp=pts+frameIndex*(9e4*header.samplesPerFrame/header.sampleRate),sample={unit:data.subarray(offset,offset+header.frameLength),pts:stamp,dts:stamp};return track.config=[],track.channelCount=header.channelCount,track.samplerate=header.sampleRate,track.samples.push(sample),{sample:sample,length:header.frameLength,missing:0}}}}function parseHeader(data,offset){var mpegVersion=data[offset+1]>>3&3,mpegLayer=data[offset+1]>>1&3,bitRateIndex=data[offset+2]>>4&15,sampleRateIndex=data[offset+2]>>2&3;if(1!==mpegVersion&&0!==bitRateIndex&&15!==bitRateIndex&&3!==sampleRateIndex){var channelMode=data[offset+3]>>6,bitRate=1e3*BitratesMap[14*(3===mpegVersion?3-mpegLayer:3===mpegLayer?3:4)+bitRateIndex-1],sampleRate=SamplingRateMap[3*(3===mpegVersion?0:2===mpegVersion?1:2)+sampleRateIndex],channelCount=3===channelMode?1:2,sampleCoefficient=SamplesCoefficients[mpegVersion][mpegLayer],bytesInSlot=BytesInSlot[mpegLayer],samplesPerFrame=8*sampleCoefficient*bytesInSlot,frameLength=Math.floor(sampleCoefficient*bitRate/sampleRate+(data[offset+2]>>1&1))*bytesInSlot;if(null===chromeVersion){var result=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);chromeVersion=result?parseInt(result[1]):0}return!!chromeVersion&&chromeVersion<=87&&2===mpegLayer&&bitRate>=224e3&&0===channelMode&&(data[offset+3]=128|data[offset+3]),{sampleRate:sampleRate,channelCount:channelCount,frameLength:frameLength,samplesPerFrame:samplesPerFrame}}}function isHeaderPattern(data,offset){return 255===data[offset]&&224==(224&data[offset+1])&&0!=(6&data[offset+1])}function isHeader(data,offset){return offset+1<data.length&&isHeaderPattern(data,offset)}function canParse(data,offset){return isHeaderPattern(data,offset)&&4<=data.length-offset}function probe(data,offset){if(offset+1<data.length&&isHeaderPattern(data,offset)){var header=parseHeader(data,offset),frameLength=4;null!=header&&header.frameLength&&(frameLength=header.frameLength);var newOffset=offset+frameLength;return newOffset===data.length||isHeader(data,newOffset)}return!1}},"./src/demux/sample-aes.ts":
/*!*********************************!*\
        !*** ./src/demux/sample-aes.ts ***!
        \*********************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_627633__){"use strict";__nested_webpack_require_627633__.r(__webpack_exports__);var _crypt_decrypter__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_627633__(
/*! ../crypt/decrypter */
"./src/crypt/decrypter.ts"),_tsdemuxer__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_627633__(
/*! ./tsdemuxer */
"./src/demux/tsdemuxer.ts");__webpack_exports__.default=function(){function SampleAesDecrypter(observer,config,keyData){this.keyData=void 0,this.decrypter=void 0,this.keyData=keyData,this.decrypter=new _crypt_decrypter__WEBPACK_IMPORTED_MODULE_0__.default(observer,config,{removePKCS7Padding:!1})}var _proto=SampleAesDecrypter.prototype;return _proto.decryptBuffer=function(encryptedData,callback){this.decrypter.decrypt(encryptedData,this.keyData.key.buffer,this.keyData.iv.buffer,callback)},_proto.decryptAacSample=function(samples,sampleIndex,callback,sync){var curUnit=samples[sampleIndex].unit,encryptedData=curUnit.subarray(16,curUnit.length-curUnit.length%16),encryptedBuffer=encryptedData.buffer.slice(encryptedData.byteOffset,encryptedData.byteOffset+encryptedData.length),localthis=this;this.decryptBuffer(encryptedBuffer,function(decryptedBuffer){var decryptedData=new Uint8Array(decryptedBuffer);curUnit.set(decryptedData,16),sync||localthis.decryptAacSamples(samples,sampleIndex+1,callback)})},_proto.decryptAacSamples=function(samples,sampleIndex,callback){for(;;sampleIndex++){if(sampleIndex>=samples.length)return void callback();if(!(samples[sampleIndex].unit.length<32)){var sync=this.decrypter.isSync();if(this.decryptAacSample(samples,sampleIndex,callback,sync),!sync)return}}},_proto.getAvcEncryptedData=function(decodedData){for(var encryptedDataLen=16*Math.floor((decodedData.length-48)/160)+16,encryptedData=new Int8Array(encryptedDataLen),outputPos=0,inputPos=32;inputPos<=decodedData.length-16;inputPos+=160,outputPos+=16)encryptedData.set(decodedData.subarray(inputPos,inputPos+16),outputPos);return encryptedData},_proto.getAvcDecryptedUnit=function(decodedData,decryptedData){for(var uint8DecryptedData=new Uint8Array(decryptedData),inputPos=0,outputPos=32;outputPos<=decodedData.length-16;outputPos+=160,inputPos+=16)decodedData.set(uint8DecryptedData.subarray(inputPos,inputPos+16),outputPos);return decodedData},_proto.decryptAvcSample=function(samples,sampleIndex,unitIndex,callback,curUnit,sync){var decodedData=Object(_tsdemuxer__WEBPACK_IMPORTED_MODULE_1__.discardEPB)(curUnit.data),encryptedData=this.getAvcEncryptedData(decodedData),localthis=this;this.decryptBuffer(encryptedData.buffer,function(decryptedBuffer){curUnit.data=localthis.getAvcDecryptedUnit(decodedData,decryptedBuffer),sync||localthis.decryptAvcSamples(samples,sampleIndex,unitIndex+1,callback)})},_proto.decryptAvcSamples=function(samples,sampleIndex,unitIndex,callback){if(samples instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;sampleIndex++,unitIndex=0){if(sampleIndex>=samples.length)return void callback();for(var curUnits=samples[sampleIndex].units;!(unitIndex>=curUnits.length);unitIndex++){var curUnit=curUnits[unitIndex];if(!(curUnit.data.length<=48||1!==curUnit.type&&5!==curUnit.type)){var sync=this.decrypter.isSync();if(this.decryptAvcSample(samples,sampleIndex,unitIndex,callback,curUnit,sync),!sync)return}}}},SampleAesDecrypter}()},"./src/demux/transmuxer-interface.ts":
/*!*******************************************!*\
        !*** ./src/demux/transmuxer-interface.ts ***!
        \*******************************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_633581__){"use strict";__nested_webpack_require_633581__.r(__webpack_exports__),__nested_webpack_require_633581__.d(__webpack_exports__,"default",function(){return TransmuxerInterface});var webworkify_webpack__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_633581__(
/*! webworkify-webpack */
"./node_modules/webworkify-webpack/index.js"),_events__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_633581__(
/*! ../events */
"./src/events.ts"),_demux_transmuxer__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_633581__(
/*! ../demux/transmuxer */
"./src/demux/transmuxer.ts"),_utils_logger__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_633581__(
/*! ../utils/logger */
"./src/utils/logger.ts"),_errors__WEBPACK_IMPORTED_MODULE_4__=__nested_webpack_require_633581__(
/*! ../errors */
"./src/errors.ts"),_utils_mediasource_helper__WEBPACK_IMPORTED_MODULE_5__=__nested_webpack_require_633581__(
/*! ../utils/mediasource-helper */
"./src/utils/mediasource-helper.ts"),eventemitter3__WEBPACK_IMPORTED_MODULE_6__=__nested_webpack_require_633581__(
/*! eventemitter3 */
"./node_modules/eventemitter3/index.js"),MediaSource=Object(_utils_mediasource_helper__WEBPACK_IMPORTED_MODULE_5__.getMediaSource)()||{isTypeSupported:function(){return!1}},TransmuxerInterface=function(){function TransmuxerInterface(hls,id,onTransmuxComplete,onFlush){var _this=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.hls=hls,this.id=id,this.onTransmuxComplete=onTransmuxComplete,this.onFlush=onFlush;var config=hls.config,forwardMessage=function(ev,data){(data=data||{}).frag=_this.frag,data.id=_this.id,hls.trigger(ev,data)};this.observer=new eventemitter3__WEBPACK_IMPORTED_MODULE_6__.EventEmitter,this.observer.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.FRAG_DECRYPTED,forwardMessage),this.observer.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.ERROR,forwardMessage);var typeSupported={mp4:MediaSource.isTypeSupported("video/mp4"),mpeg:MediaSource.isTypeSupported("audio/mpeg"),mp3:MediaSource.isTypeSupported('audio/mp4; codecs="mp3"')},vendor=navigator.vendor;if(config.enableWorker&&"undefined"!=typeof Worker){var worker;_utils_logger__WEBPACK_IMPORTED_MODULE_3__.logger.log("demuxing in webworker");try{worker=this.worker=webworkify_webpack__WEBPACK_IMPORTED_MODULE_0__(
/*! ../demux/transmuxer-worker.ts */
"./src/demux/transmuxer-worker.ts"),this.onwmsg=this.onWorkerMessage.bind(this),worker.addEventListener("message",this.onwmsg),worker.onerror=function(event){hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_4__.ErrorTypes.OTHER_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_4__.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",error:new Error(event.message+"  ("+event.filename+":"+event.lineno+")")})},worker.postMessage({cmd:"init",typeSupported:typeSupported,vendor:vendor,id:id,config:JSON.stringify(config)})}catch(err){_utils_logger__WEBPACK_IMPORTED_MODULE_3__.logger.warn("Error in worker:",err),_utils_logger__WEBPACK_IMPORTED_MODULE_3__.logger.error("Error while initializing DemuxerWorker, fallback to inline"),worker&&self.URL.revokeObjectURL(worker.objectURL),this.transmuxer=new _demux_transmuxer__WEBPACK_IMPORTED_MODULE_2__.default(this.observer,typeSupported,config,vendor,id),this.worker=null}}else this.transmuxer=new _demux_transmuxer__WEBPACK_IMPORTED_MODULE_2__.default(this.observer,typeSupported,config,vendor,id)}var _proto=TransmuxerInterface.prototype;return _proto.destroy=function(){var w=this.worker;if(w)w.removeEventListener("message",this.onwmsg),w.terminate(),this.worker=null;else{var transmuxer=this.transmuxer;transmuxer&&(transmuxer.destroy(),this.transmuxer=null)}var observer=this.observer;observer&&observer.removeAllListeners(),this.observer=null},_proto.push=function(data,initSegmentData,audioCodec,videoCodec,frag,part,duration,accurateTimeOffset,chunkMeta,defaultInitPTS){var _this2=this;chunkMeta.transmuxing.start=self.performance.now();var transmuxer=this.transmuxer,worker=this.worker,timeOffset=part?part.start:frag.start,decryptdata=frag.decryptdata,lastFrag=this.frag,discontinuity=!(lastFrag&&frag.cc===lastFrag.cc),trackSwitch=!(lastFrag&&chunkMeta.level===lastFrag.level),snDiff=lastFrag?chunkMeta.sn-lastFrag.sn:-1,partDiff=this.part?chunkMeta.part-this.part.index:1,contiguous=!trackSwitch&&(1===snDiff||0===snDiff&&1===partDiff),now=self.performance.now();(trackSwitch||snDiff||0===frag.stats.parsing.start)&&(frag.stats.parsing.start=now),!part||!partDiff&&contiguous||(part.stats.parsing.start=now);var state=new _demux_transmuxer__WEBPACK_IMPORTED_MODULE_2__.TransmuxState(discontinuity,contiguous,accurateTimeOffset,trackSwitch,timeOffset);if(!contiguous||discontinuity){_utils_logger__WEBPACK_IMPORTED_MODULE_3__.logger.log("[transmuxer-interface, "+frag.type+"]: Starting new transmux session for sn: "+chunkMeta.sn+" p: "+chunkMeta.part+" level: "+chunkMeta.level+" id: "+chunkMeta.id+"\n        discontinuity: "+discontinuity+"\n        trackSwitch: "+trackSwitch+"\n        contiguous: "+contiguous+"\n        accurateTimeOffset: "+accurateTimeOffset+"\n        timeOffset: "+timeOffset);var config=new _demux_transmuxer__WEBPACK_IMPORTED_MODULE_2__.TransmuxConfig(audioCodec,videoCodec,initSegmentData,duration,defaultInitPTS);this.configureTransmuxer(config)}if(this.frag=frag,this.part=part,worker)worker.postMessage({cmd:"demux",data:data,decryptdata:decryptdata,chunkMeta:chunkMeta,state:state},data instanceof ArrayBuffer?[data]:[]);else if(transmuxer){var _transmuxResult=transmuxer.push(data,decryptdata,chunkMeta,state);Object(_demux_transmuxer__WEBPACK_IMPORTED_MODULE_2__.isPromise)(_transmuxResult)?_transmuxResult.then(function(data){_this2.handleTransmuxComplete(data)}):this.handleTransmuxComplete(_transmuxResult)}},_proto.flush=function(chunkMeta){var _this3=this;chunkMeta.transmuxing.start=self.performance.now();var transmuxer=this.transmuxer,worker=this.worker;if(worker)worker.postMessage({cmd:"flush",chunkMeta:chunkMeta});else if(transmuxer){var _transmuxResult2=transmuxer.flush(chunkMeta);Object(_demux_transmuxer__WEBPACK_IMPORTED_MODULE_2__.isPromise)(_transmuxResult2)?_transmuxResult2.then(function(data){_this3.handleFlushResult(data,chunkMeta)}):this.handleFlushResult(_transmuxResult2,chunkMeta)}},_proto.handleFlushResult=function(results,chunkMeta){var _this4=this;results.forEach(function(result){_this4.handleTransmuxComplete(result)}),this.onFlush(chunkMeta)},_proto.onWorkerMessage=function(ev){var data=ev.data,hls=this.hls;switch(data.event){case"init":self.URL.revokeObjectURL(this.worker.objectURL);break;case"transmuxComplete":this.handleTransmuxComplete(data.data);break;case"flush":this.onFlush(data.data);break;default:data.data=data.data||{},data.data.frag=this.frag,data.data.id=this.id,hls.trigger(data.event,data.data)}},_proto.configureTransmuxer=function(config){var worker=this.worker,transmuxer=this.transmuxer;worker?worker.postMessage({cmd:"configure",config:config}):transmuxer&&transmuxer.configure(config)},_proto.handleTransmuxComplete=function(result){result.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(result)},TransmuxerInterface}()},"./src/demux/transmuxer-worker.ts":
/*!****************************************!*\
        !*** ./src/demux/transmuxer-worker.ts ***!
        \****************************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_646686__){"use strict";__nested_webpack_require_646686__.r(__webpack_exports__),__nested_webpack_require_646686__.d(__webpack_exports__,"default",function(){return TransmuxerWorker});var _demux_transmuxer__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_646686__(
/*! ../demux/transmuxer */
"./src/demux/transmuxer.ts"),_events__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_646686__(
/*! ../events */
"./src/events.ts"),_utils_logger__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_646686__(
/*! ../utils/logger */
"./src/utils/logger.ts"),eventemitter3__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_646686__(
/*! eventemitter3 */
"./node_modules/eventemitter3/index.js");function TransmuxerWorker(self){var observer=new eventemitter3__WEBPACK_IMPORTED_MODULE_3__.EventEmitter,forwardMessage=function(ev,data){self.postMessage({event:ev,data:data})};observer.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.FRAG_DECRYPTED,forwardMessage),observer.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.ERROR,forwardMessage),self.addEventListener("message",function(ev){var data=ev.data;switch(data.cmd){case"init":var config=JSON.parse(data.config);self.transmuxer=new _demux_transmuxer__WEBPACK_IMPORTED_MODULE_0__.default(observer,data.typeSupported,config,data.vendor,data.id),Object(_utils_logger__WEBPACK_IMPORTED_MODULE_2__.enableLogs)(config.debug),forwardMessage("init",null);break;case"configure":self.transmuxer.configure(data.config);break;case"demux":var transmuxResult=self.transmuxer.push(data.data,data.decryptdata,data.chunkMeta,data.state);Object(_demux_transmuxer__WEBPACK_IMPORTED_MODULE_0__.isPromise)(transmuxResult)?transmuxResult.then(function(data){emitTransmuxComplete(self,data)}):emitTransmuxComplete(self,transmuxResult);break;case"flush":var id=data.chunkMeta,_transmuxResult=self.transmuxer.flush(id);Object(_demux_transmuxer__WEBPACK_IMPORTED_MODULE_0__.isPromise)(_transmuxResult)?_transmuxResult.then(function(results){handleFlushResult(self,results,id)}):handleFlushResult(self,_transmuxResult,id)}})}function emitTransmuxComplete(self,transmuxResult){if((remuxResult=transmuxResult.remuxResult).audio||remuxResult.video||remuxResult.text||remuxResult.id3||remuxResult.initSegment){var remuxResult,transferable=[],_transmuxResult$remux=transmuxResult.remuxResult,audio=_transmuxResult$remux.audio,video=_transmuxResult$remux.video;audio&&addToTransferable(transferable,audio),video&&addToTransferable(transferable,video),self.postMessage({event:"transmuxComplete",data:transmuxResult},transferable)}}function addToTransferable(transferable,track){track.data1&&transferable.push(track.data1.buffer),track.data2&&transferable.push(track.data2.buffer)}function handleFlushResult(self,results,chunkMeta){results.forEach(function(result){emitTransmuxComplete(self,result)}),self.postMessage({event:"flush",data:chunkMeta})}},"./src/demux/transmuxer.ts":
/*!*********************************!*\
        !*** ./src/demux/transmuxer.ts ***!
        \*********************************/
/*! exports provided: default, isPromise, TransmuxConfig, TransmuxState */
function(module,__webpack_exports__,__nested_webpack_require_652265__){"use strict";__nested_webpack_require_652265__.r(__webpack_exports__),__nested_webpack_require_652265__.d(__webpack_exports__,"default",function(){return Transmuxer}),__nested_webpack_require_652265__.d(__webpack_exports__,"isPromise",function(){return isPromise}),__nested_webpack_require_652265__.d(__webpack_exports__,"TransmuxConfig",function(){return TransmuxConfig}),__nested_webpack_require_652265__.d(__webpack_exports__,"TransmuxState",function(){return TransmuxState});var now,_events__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_652265__(
/*! ../events */
"./src/events.ts"),_errors__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_652265__(
/*! ../errors */
"./src/errors.ts"),_crypt_decrypter__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_652265__(
/*! ../crypt/decrypter */
"./src/crypt/decrypter.ts"),_demux_aacdemuxer__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_652265__(
/*! ../demux/aacdemuxer */
"./src/demux/aacdemuxer.ts"),_demux_mp4demuxer__WEBPACK_IMPORTED_MODULE_4__=__nested_webpack_require_652265__(
/*! ../demux/mp4demuxer */
"./src/demux/mp4demuxer.ts"),_demux_tsdemuxer__WEBPACK_IMPORTED_MODULE_5__=__nested_webpack_require_652265__(
/*! ../demux/tsdemuxer */
"./src/demux/tsdemuxer.ts"),_demux_mp3demuxer__WEBPACK_IMPORTED_MODULE_6__=__nested_webpack_require_652265__(
/*! ../demux/mp3demuxer */
"./src/demux/mp3demuxer.ts"),_remux_mp4_remuxer__WEBPACK_IMPORTED_MODULE_7__=__nested_webpack_require_652265__(
/*! ../remux/mp4-remuxer */
"./src/remux/mp4-remuxer.ts"),_remux_passthrough_remuxer__WEBPACK_IMPORTED_MODULE_8__=__nested_webpack_require_652265__(
/*! ../remux/passthrough-remuxer */
"./src/remux/passthrough-remuxer.ts"),_chunk_cache__WEBPACK_IMPORTED_MODULE_9__=__nested_webpack_require_652265__(
/*! ./chunk-cache */
"./src/demux/chunk-cache.ts"),_utils_mp4_tools__WEBPACK_IMPORTED_MODULE_10__=__nested_webpack_require_652265__(
/*! ../utils/mp4-tools */
"./src/utils/mp4-tools.ts"),_utils_logger__WEBPACK_IMPORTED_MODULE_11__=__nested_webpack_require_652265__(
/*! ../utils/logger */
"./src/utils/logger.ts");try{now=self.performance.now.bind(self.performance)}catch(err){_utils_logger__WEBPACK_IMPORTED_MODULE_11__.logger.debug("Unable to use Performance API on this environment"),now=self.Date.now}var muxConfig=[{demux:_demux_tsdemuxer__WEBPACK_IMPORTED_MODULE_5__.default,remux:_remux_mp4_remuxer__WEBPACK_IMPORTED_MODULE_7__.default},{demux:_demux_mp4demuxer__WEBPACK_IMPORTED_MODULE_4__.default,remux:_remux_passthrough_remuxer__WEBPACK_IMPORTED_MODULE_8__.default},{demux:_demux_aacdemuxer__WEBPACK_IMPORTED_MODULE_3__.default,remux:_remux_mp4_remuxer__WEBPACK_IMPORTED_MODULE_7__.default},{demux:_demux_mp3demuxer__WEBPACK_IMPORTED_MODULE_6__.default,remux:_remux_mp4_remuxer__WEBPACK_IMPORTED_MODULE_7__.default}],minProbeByteLength=1024;muxConfig.forEach(function(_ref){minProbeByteLength=Math.max(minProbeByteLength,_ref.demux.minProbeByteLength)});var Transmuxer=function(){function Transmuxer(observer,typeSupported,config,vendor,id){this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.cache=new _chunk_cache__WEBPACK_IMPORTED_MODULE_9__.default,this.observer=observer,this.typeSupported=typeSupported,this.config=config,this.vendor=vendor,this.id=id}var _proto=Transmuxer.prototype;return _proto.configure=function(transmuxConfig){this.transmuxConfig=transmuxConfig,this.decrypter&&this.decrypter.reset()},_proto.push=function(data,decryptdata,chunkMeta,state){var _this=this,stats=chunkMeta.transmuxing;stats.executeStart=now();var uintData=new Uint8Array(data),cache=this.cache,config=this.config,currentTransmuxState=this.currentTransmuxState,transmuxConfig=this.transmuxConfig;state&&(this.currentTransmuxState=state);var keyData=function(data,decryptData){var encryptionType=null;return data.byteLength>0&&null!=decryptData&&null!=decryptData.key&&null!==decryptData.iv&&null!=decryptData.method&&(encryptionType=decryptData),encryptionType}(uintData,decryptdata);if(keyData&&"AES-128"===keyData.method){var decrypter=this.getDecrypter();if(!config.enableSoftwareAES)return this.decryptionPromise=decrypter.webCryptoDecrypt(uintData,keyData.key.buffer,keyData.iv.buffer).then(function(decryptedData){var result=_this.push(decryptedData,null,chunkMeta);return _this.decryptionPromise=null,result}),this.decryptionPromise;var decryptedData=decrypter.softwareDecrypt(uintData,keyData.key.buffer,keyData.iv.buffer);if(!decryptedData)return stats.executeEnd=now(),emptyResult(chunkMeta);uintData=new Uint8Array(decryptedData)}var _ref2=state||currentTransmuxState,contiguous=_ref2.contiguous,discontinuity=_ref2.discontinuity,trackSwitch=_ref2.trackSwitch,accurateTimeOffset=_ref2.accurateTimeOffset,timeOffset=_ref2.timeOffset,defaultInitPts=transmuxConfig.defaultInitPts;if((discontinuity||trackSwitch)&&this.resetInitSegment(transmuxConfig.initSegmentData,transmuxConfig.audioCodec,transmuxConfig.videoCodec,transmuxConfig.duration),discontinuity&&this.resetInitialTimestamp(defaultInitPts),contiguous||this.resetContiguity(),this.needsProbing(uintData,discontinuity,trackSwitch)){if(cache.dataLength){var cachedData=cache.flush();uintData=Object(_utils_mp4_tools__WEBPACK_IMPORTED_MODULE_10__.appendUint8Array)(cachedData,uintData)}this.configureTransmuxer(uintData,transmuxConfig)}var result=this.transmux(uintData,keyData,timeOffset,accurateTimeOffset,chunkMeta),currentState=this.currentTransmuxState;return currentState.contiguous=!0,currentState.discontinuity=!1,currentState.trackSwitch=!1,stats.executeEnd=now(),result},_proto.flush=function(chunkMeta){var _this2=this,stats=chunkMeta.transmuxing;stats.executeStart=now();var decrypter=this.decrypter,cache=this.cache,currentTransmuxState=this.currentTransmuxState,decryptionPromise=this.decryptionPromise;if(decryptionPromise)return decryptionPromise.then(function(){return _this2.flush(chunkMeta)});var transmuxResults=[],timeOffset=currentTransmuxState.timeOffset;if(decrypter){var decryptedData=decrypter.flush();decryptedData&&transmuxResults.push(this.push(decryptedData,null,chunkMeta))}var bytesSeen=cache.dataLength;cache.reset();var demuxer=this.demuxer;if(!demuxer||!this.remuxer)return bytesSeen>=minProbeByteLength&&this.observer.emit(_events__WEBPACK_IMPORTED_MODULE_0__.Events.ERROR,_events__WEBPACK_IMPORTED_MODULE_0__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorTypes.MEDIA_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),stats.executeEnd=now(),[emptyResult(chunkMeta)];var demuxResultOrPromise=demuxer.flush(timeOffset);return isPromise(demuxResultOrPromise)?demuxResultOrPromise.then(function(demuxResult){return _this2.flushRemux(transmuxResults,demuxResult,chunkMeta),transmuxResults}):(this.flushRemux(transmuxResults,demuxResultOrPromise,chunkMeta),transmuxResults)},_proto.flushRemux=function(transmuxResults,demuxResult,chunkMeta){var audioTrack=demuxResult.audioTrack,avcTrack=demuxResult.avcTrack,id3Track=demuxResult.id3Track,textTrack=demuxResult.textTrack,_this$currentTransmux=this.currentTransmuxState,accurateTimeOffset=_this$currentTransmux.accurateTimeOffset,timeOffset=_this$currentTransmux.timeOffset;_utils_logger__WEBPACK_IMPORTED_MODULE_11__.logger.log("[transmuxer.ts]: Flushed fragment "+chunkMeta.sn+(chunkMeta.part>-1?" p: "+chunkMeta.part:"")+" of level "+chunkMeta.level);var remuxResult=this.remuxer.remux(audioTrack,avcTrack,id3Track,textTrack,timeOffset,accurateTimeOffset,!0,this.id);transmuxResults.push({remuxResult:remuxResult,chunkMeta:chunkMeta}),chunkMeta.transmuxing.executeEnd=now()},_proto.resetInitialTimestamp=function(defaultInitPts){var demuxer=this.demuxer,remuxer=this.remuxer;demuxer&&remuxer&&(demuxer.resetTimeStamp(defaultInitPts),remuxer.resetTimeStamp(defaultInitPts))},_proto.resetContiguity=function(){var demuxer=this.demuxer,remuxer=this.remuxer;demuxer&&remuxer&&(demuxer.resetContiguity(),remuxer.resetNextTimestamp())},_proto.resetInitSegment=function(initSegmentData,audioCodec,videoCodec,duration){var demuxer=this.demuxer,remuxer=this.remuxer;demuxer&&remuxer&&(demuxer.resetInitSegment(audioCodec,videoCodec,duration),remuxer.resetInitSegment(initSegmentData,audioCodec,videoCodec))},_proto.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},_proto.transmux=function(data,keyData,timeOffset,accurateTimeOffset,chunkMeta){return keyData&&"SAMPLE-AES"===keyData.method?this.transmuxSampleAes(data,keyData,timeOffset,accurateTimeOffset,chunkMeta):this.transmuxUnencrypted(data,timeOffset,accurateTimeOffset,chunkMeta)},_proto.transmuxUnencrypted=function(data,timeOffset,accurateTimeOffset,chunkMeta){var _demux=this.demuxer.demux(data,timeOffset,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(_demux.audioTrack,_demux.avcTrack,_demux.id3Track,_demux.textTrack,timeOffset,accurateTimeOffset,!1,this.id),chunkMeta:chunkMeta}},_proto.transmuxSampleAes=function(data,decryptData,timeOffset,accurateTimeOffset,chunkMeta){var _this3=this;return this.demuxer.demuxSampleAes(data,decryptData,timeOffset).then(function(demuxResult){return{remuxResult:_this3.remuxer.remux(demuxResult.audioTrack,demuxResult.avcTrack,demuxResult.id3Track,demuxResult.textTrack,timeOffset,accurateTimeOffset,!1,_this3.id),chunkMeta:chunkMeta}})},_proto.configureTransmuxer=function(data,transmuxConfig){for(var mux,config=this.config,observer=this.observer,typeSupported=this.typeSupported,vendor=this.vendor,audioCodec=transmuxConfig.audioCodec,defaultInitPts=transmuxConfig.defaultInitPts,duration=transmuxConfig.duration,initSegmentData=transmuxConfig.initSegmentData,videoCodec=transmuxConfig.videoCodec,i=0,len=muxConfig.length;i<len;i++)if(muxConfig[i].demux.probe(data)){mux=muxConfig[i];break}mux||(_utils_logger__WEBPACK_IMPORTED_MODULE_11__.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),mux={demux:_demux_mp4demuxer__WEBPACK_IMPORTED_MODULE_4__.default,remux:_remux_passthrough_remuxer__WEBPACK_IMPORTED_MODULE_8__.default});var demuxer=this.demuxer,remuxer=this.remuxer,Remuxer=mux.remux,Demuxer=mux.demux;remuxer&&remuxer instanceof Remuxer||(this.remuxer=new Remuxer(observer,config,typeSupported,vendor)),demuxer&&demuxer instanceof Demuxer||(this.demuxer=new Demuxer(observer,config,typeSupported),this.probe=Demuxer.probe),this.resetInitSegment(initSegmentData,audioCodec,videoCodec,duration),this.resetInitialTimestamp(defaultInitPts)},_proto.needsProbing=function(data,discontinuity,trackSwitch){return!this.demuxer||!this.remuxer||discontinuity||trackSwitch},_proto.getDecrypter=function(){var decrypter=this.decrypter;return decrypter||(decrypter=this.decrypter=new _crypt_decrypter__WEBPACK_IMPORTED_MODULE_2__.default(this.observer,this.config)),decrypter},Transmuxer}(),emptyResult=function(chunkMeta){return{remuxResult:{},chunkMeta:chunkMeta}};function isPromise(p){return"then"in p&&p.then instanceof Function}var TransmuxConfig=function(audioCodec,videoCodec,initSegmentData,duration,defaultInitPts){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=audioCodec,this.videoCodec=videoCodec,this.initSegmentData=initSegmentData,this.duration=duration,this.defaultInitPts=defaultInitPts},TransmuxState=function(discontinuity,contiguous,accurateTimeOffset,trackSwitch,timeOffset){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.discontinuity=discontinuity,this.contiguous=contiguous,this.accurateTimeOffset=accurateTimeOffset,this.trackSwitch=trackSwitch,this.timeOffset=timeOffset}},"./src/demux/tsdemuxer.ts":
/*!********************************!*\
        !*** ./src/demux/tsdemuxer.ts ***!
        \********************************/
/*! exports provided: discardEPB, default */
function(module,__webpack_exports__,__nested_webpack_require_673467__){"use strict";__nested_webpack_require_673467__.r(__webpack_exports__),__nested_webpack_require_673467__.d(__webpack_exports__,"discardEPB",function(){return discardEPB});var _adts__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_673467__(
/*! ./adts */
"./src/demux/adts.ts"),_mpegaudio__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_673467__(
/*! ./mpegaudio */
"./src/demux/mpegaudio.ts"),_exp_golomb__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_673467__(
/*! ./exp-golomb */
"./src/demux/exp-golomb.ts"),_id3__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_673467__(
/*! ./id3 */
"./src/demux/id3.ts"),_sample_aes__WEBPACK_IMPORTED_MODULE_4__=__nested_webpack_require_673467__(
/*! ./sample-aes */
"./src/demux/sample-aes.ts"),_events__WEBPACK_IMPORTED_MODULE_5__=__nested_webpack_require_673467__(
/*! ../events */
"./src/events.ts"),_utils_mp4_tools__WEBPACK_IMPORTED_MODULE_6__=__nested_webpack_require_673467__(
/*! ../utils/mp4-tools */
"./src/utils/mp4-tools.ts"),_utils_logger__WEBPACK_IMPORTED_MODULE_7__=__nested_webpack_require_673467__(
/*! ../utils/logger */
"./src/utils/logger.ts"),_errors__WEBPACK_IMPORTED_MODULE_8__=__nested_webpack_require_673467__(
/*! ../errors */
"./src/errors.ts"),RemuxerTrackIdConfig={video:1,audio:2,id3:3,text:4},TSDemuxer=function(){function TSDemuxer(observer,config,typeSupported){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this.aacLastPTS=null,this._initPTS=null,this._initDTS=null,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=observer,this.config=config,this.typeSupported=typeSupported}TSDemuxer.probe=function(data){var syncOffset=TSDemuxer.syncOffset(data);return!(syncOffset<0||(syncOffset&&_utils_logger__WEBPACK_IMPORTED_MODULE_7__.logger.warn("MPEG2-TS detected but first sync word found @ offset "+syncOffset+", junk ahead ?"),0))},TSDemuxer.syncOffset=function(data){for(var scanwindow=Math.min(1e3,data.length-564),i=0;i<scanwindow;){if(71===data[i]&&71===data[i+188]&&71===data[i+376])return i;i++}return-1},TSDemuxer.createTrack=function(type,duration){return{container:"video"===type||"audio"===type?"video/mp2t":void 0,type:type,id:RemuxerTrackIdConfig[type],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===type?duration:void 0}};var _proto=TSDemuxer.prototype;return _proto.resetInitSegment=function(audioCodec,videoCodec,duration){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=TSDemuxer.createTrack("video",duration),this._audioTrack=TSDemuxer.createTrack("audio",duration),this._id3Track=TSDemuxer.createTrack("id3",duration),this._txtTrack=TSDemuxer.createTrack("text",duration),this._audioTrack.isAAC=!0,this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=audioCodec,this.videoCodec=videoCodec,this._duration=duration},_proto.resetTimeStamp=function(){},_proto.resetContiguity=function(){var _audioTrack=this._audioTrack,_avcTrack=this._avcTrack,_id3Track=this._id3Track;_audioTrack&&(_audioTrack.pesData=null),_avcTrack&&(_avcTrack.pesData=null),_id3Track&&(_id3Track.pesData=null),this.aacOverFlow=null,this.aacLastPTS=null},_proto.demux=function(data,timeOffset,isSampleAes,flush){var pes;void 0===isSampleAes&&(isSampleAes=!1),void 0===flush&&(flush=!1),isSampleAes||(this.sampleAes=null);var avcTrack=this._avcTrack,audioTrack=this._audioTrack,id3Track=this._id3Track,avcId=avcTrack.pid,avcData=avcTrack.pesData,audioId=audioTrack.pid,id3Id=id3Track.pid,audioData=audioTrack.pesData,id3Data=id3Track.pesData,unknownPIDs=!1,pmtParsed=this.pmtParsed,pmtId=this._pmtId,len=data.length;if(this.remainderData&&(len=(data=Object(_utils_mp4_tools__WEBPACK_IMPORTED_MODULE_6__.appendUint8Array)(this.remainderData,data)).length,this.remainderData=null),len<188&&!flush)return this.remainderData=data,{audioTrack:audioTrack,avcTrack:avcTrack,id3Track:id3Track,textTrack:this._txtTrack};var syncOffset=Math.max(0,TSDemuxer.syncOffset(data));(len-=(len+syncOffset)%188)<data.byteLength&&!flush&&(this.remainderData=new Uint8Array(data.buffer,len,data.buffer.byteLength-len));for(var start=syncOffset;start<len;start+=188)if(71===data[start]){var stt=!!(64&data[start+1]),pid=((31&data[start+1])<<8)+data[start+2],offset=void 0;if((48&data[start+3])>>4>1){if((offset=start+5+data[start+4])===start+188)continue}else offset=start+4;switch(pid){case avcId:stt&&(avcData&&(pes=parsePES(avcData))&&this.parseAVCPES(pes,!1),avcData={data:[],size:0}),avcData&&(avcData.data.push(data.subarray(offset,start+188)),avcData.size+=start+188-offset);break;case audioId:stt&&(audioData&&(pes=parsePES(audioData))&&(audioTrack.isAAC?this.parseAACPES(pes):this.parseMPEGPES(pes)),audioData={data:[],size:0}),audioData&&(audioData.data.push(data.subarray(offset,start+188)),audioData.size+=start+188-offset);break;case id3Id:stt&&(id3Data&&(pes=parsePES(id3Data))&&this.parseID3PES(pes),id3Data={data:[],size:0}),id3Data&&(id3Data.data.push(data.subarray(offset,start+188)),id3Data.size+=start+188-offset);break;case 0:stt&&(offset+=data[offset]+1),pmtId=this._pmtId=parsePAT(data,offset);break;case pmtId:stt&&(offset+=data[offset]+1);var parsedPIDs=parsePMT(data,offset,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,isSampleAes);(avcId=parsedPIDs.avc)>0&&(avcTrack.pid=avcId),(audioId=parsedPIDs.audio)>0&&(audioTrack.pid=audioId,audioTrack.isAAC=parsedPIDs.isAAC),(id3Id=parsedPIDs.id3)>0&&(id3Track.pid=id3Id),unknownPIDs&&!pmtParsed&&(_utils_logger__WEBPACK_IMPORTED_MODULE_7__.logger.log("reparse from beginning"),unknownPIDs=!1,start=syncOffset-188),pmtParsed=this.pmtParsed=!0;break;case 17:case 8191:break;default:unknownPIDs=!0}}else this.observer.emit(_events__WEBPACK_IMPORTED_MODULE_5__.Events.ERROR,_events__WEBPACK_IMPORTED_MODULE_5__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_8__.ErrorTypes.MEDIA_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_8__.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});avcTrack.pesData=avcData,audioTrack.pesData=audioData,id3Track.pesData=id3Data;var demuxResult={audioTrack:audioTrack,avcTrack:avcTrack,id3Track:id3Track,textTrack:this._txtTrack};return flush&&this.extractRemainingSamples(demuxResult),demuxResult},_proto.flush=function(){var result,remainderData=this.remainderData;return this.remainderData=null,result=remainderData?this.demux(remainderData,-1,!1,!0):{audioTrack:this._audioTrack,avcTrack:this._avcTrack,textTrack:this._txtTrack,id3Track:this._id3Track},this.extractRemainingSamples(result),this.sampleAes?this.decrypt(result,this.sampleAes):result},_proto.extractRemainingSamples=function(demuxResult){var pes,audioTrack=demuxResult.audioTrack,avcTrack=demuxResult.avcTrack,id3Track=demuxResult.id3Track,avcData=avcTrack.pesData,audioData=audioTrack.pesData,id3Data=id3Track.pesData;avcData&&(pes=parsePES(avcData))?(this.parseAVCPES(pes,!0),avcTrack.pesData=null):avcTrack.pesData=avcData,audioData&&(pes=parsePES(audioData))?(audioTrack.isAAC?this.parseAACPES(pes):this.parseMPEGPES(pes),audioTrack.pesData=null):(null!=audioData&&audioData.size&&_utils_logger__WEBPACK_IMPORTED_MODULE_7__.logger.log("last AAC PES packet truncated,might overlap between fragments"),audioTrack.pesData=audioData),id3Data&&(pes=parsePES(id3Data))?(this.parseID3PES(pes),id3Track.pesData=null):id3Track.pesData=id3Data},_proto.demuxSampleAes=function(data,keyData,timeOffset){var demuxResult=this.demux(data,timeOffset,!0,!this.config.progressive),sampleAes=this.sampleAes=new _sample_aes__WEBPACK_IMPORTED_MODULE_4__.default(this.observer,this.config,keyData);return this.decrypt(demuxResult,sampleAes)},_proto.decrypt=function(demuxResult,sampleAes){return new Promise(function(resolve){var audioTrack=demuxResult.audioTrack,avcTrack=demuxResult.avcTrack;audioTrack.samples&&audioTrack.isAAC?sampleAes.decryptAacSamples(audioTrack.samples,0,function(){avcTrack.samples?sampleAes.decryptAvcSamples(avcTrack.samples,0,0,function(){resolve(demuxResult)}):resolve(demuxResult)}):avcTrack.samples&&sampleAes.decryptAvcSamples(avcTrack.samples,0,0,function(){resolve(demuxResult)})})},_proto.destroy=function(){this._initPTS=this._initDTS=null,this._duration=0},_proto.parseAVCPES=function(pes,last){var push,_this=this,track=this._avcTrack,units=this.parseAVCNALu(pes.data),avcSample=this.avcSample,spsfound=!1;pes.data=null,avcSample&&units.length&&!track.audFound&&(pushAccessUnit(avcSample,track),avcSample=this.avcSample=createAVCSample(!1,pes.pts,pes.dts,"")),units.forEach(function(unit){switch(unit.type){case 1:push=!0,avcSample||(avcSample=_this.avcSample=createAVCSample(!0,pes.pts,pes.dts,"")),avcSample.frame=!0;var data=unit.data;if(spsfound&&data.length>4){var sliceType=new _exp_golomb__WEBPACK_IMPORTED_MODULE_2__.default(data).readSliceType();2!==sliceType&&4!==sliceType&&7!==sliceType&&9!==sliceType||(avcSample.key=!0)}break;case 5:push=!0,avcSample||(avcSample=_this.avcSample=createAVCSample(!0,pes.pts,pes.dts,"")),avcSample.key=!0,avcSample.frame=!0;break;case 6:push=!0;var expGolombDecoder=new _exp_golomb__WEBPACK_IMPORTED_MODULE_2__.default(discardEPB(unit.data));expGolombDecoder.readUByte();for(var payloadType=0,payloadSize=0,endOfCaptions=!1,b=0;!endOfCaptions&&expGolombDecoder.bytesAvailable>1;){payloadType=0;do{payloadType+=b=expGolombDecoder.readUByte()}while(255===b);payloadSize=0;do{payloadSize+=b=expGolombDecoder.readUByte()}while(255===b);if(4===payloadType&&0!==expGolombDecoder.bytesAvailable){if(endOfCaptions=!0,181===expGolombDecoder.readUByte()&&49===expGolombDecoder.readUShort()&&1195456820===expGolombDecoder.readUInt()&&3===expGolombDecoder.readUByte()){for(var firstByte=expGolombDecoder.readUByte(),totalCCs=31&firstByte,byteArray=[firstByte,expGolombDecoder.readUByte()],i=0;i<totalCCs;i++)byteArray.push(expGolombDecoder.readUByte()),byteArray.push(expGolombDecoder.readUByte()),byteArray.push(expGolombDecoder.readUByte());insertSampleInOrder(_this._txtTrack.samples,{type:3,pts:pes.pts,bytes:byteArray})}}else if(5===payloadType&&0!==expGolombDecoder.bytesAvailable){if(endOfCaptions=!0,payloadSize>16){for(var uuidStrArray=[],_i=0;_i<16;_i++)uuidStrArray.push(expGolombDecoder.readUByte().toString(16)),3!==_i&&5!==_i&&7!==_i&&9!==_i||uuidStrArray.push("-");for(var length=payloadSize-16,userDataPayloadBytes=new Uint8Array(length),_i2=0;_i2<length;_i2++)userDataPayloadBytes[_i2]=expGolombDecoder.readUByte();insertSampleInOrder(_this._txtTrack.samples,{pts:pes.pts,payloadType:payloadType,uuid:uuidStrArray.join(""),userData:Object(_id3__WEBPACK_IMPORTED_MODULE_3__.utf8ArrayToStr)(userDataPayloadBytes),userDataBytes:userDataPayloadBytes})}}else if(payloadSize<expGolombDecoder.bytesAvailable)for(var _i3=0;_i3<payloadSize;_i3++)expGolombDecoder.readUByte()}break;case 7:if(push=!0,spsfound=!0,!track.sps){var config=new _exp_golomb__WEBPACK_IMPORTED_MODULE_2__.default(unit.data).readSPS();track.width=config.width,track.height=config.height,track.pixelRatio=config.pixelRatio,track.sps=[unit.data],track.duration=_this._duration;for(var codecarray=unit.data.subarray(1,4),codecstring="avc1.",_i4=0;_i4<3;_i4++){var h=codecarray[_i4].toString(16);h.length<2&&(h="0"+h),codecstring+=h}track.codec=codecstring}break;case 8:push=!0,track.pps||(track.pps=[unit.data]);break;case 9:push=!1,track.audFound=!0,avcSample&&pushAccessUnit(avcSample,track),avcSample=_this.avcSample=createAVCSample(!1,pes.pts,pes.dts,"");break;case 12:push=!1;break;default:push=!1,avcSample&&(avcSample.debug+="unknown NAL "+unit.type+" ")}avcSample&&push&&avcSample.units.push(unit)}),last&&avcSample&&(pushAccessUnit(avcSample,track),this.avcSample=null)},_proto.getLastNalUnit=function(){var _avcSample,lastUnit,avcSample=this.avcSample;if(!avcSample||0===avcSample.units.length){var samples=this._avcTrack.samples;avcSample=samples[samples.length-1]}if(null!==(_avcSample=avcSample)&&void 0!==_avcSample&&_avcSample.units){var units=avcSample.units;lastUnit=units[units.length-1]}return lastUnit},_proto.parseAVCNALu=function(array){var value,overflow,len=array.byteLength,track=this._avcTrack,state=track.naluState||0,lastState=state,units=[],i=0,lastUnitStart=-1,lastUnitType=0;for(-1===state&&(lastUnitStart=0,lastUnitType=31&array[0],state=0,i=1);i<len;)if(value=array[i++],state)if(1!==state)if(value)if(1===value){if(lastUnitStart>=0){var unit={data:array.subarray(lastUnitStart,i-state-1),type:lastUnitType};units.push(unit)}else{var lastUnit=this.getLastNalUnit();if(lastUnit&&(lastState&&i<=4-lastState&&lastUnit.state&&(lastUnit.data=lastUnit.data.subarray(0,lastUnit.data.byteLength-lastState)),(overflow=i-state-1)>0)){var tmp=new Uint8Array(lastUnit.data.byteLength+overflow);tmp.set(lastUnit.data,0),tmp.set(array.subarray(0,overflow),lastUnit.data.byteLength),lastUnit.data=tmp}}i<len?(lastUnitStart=i,lastUnitType=31&array[i],state=0):state=-1}else state=0;else state=3;else state=value?0:2;else state=value?0:1;if(lastUnitStart>=0&&state>=0){var _unit={data:array.subarray(lastUnitStart,len),type:lastUnitType,state:state};units.push(_unit)}if(0===units.length){var _lastUnit=this.getLastNalUnit();if(_lastUnit){var _tmp=new Uint8Array(_lastUnit.data.byteLength+array.byteLength);_tmp.set(_lastUnit.data,0),_tmp.set(array,_lastUnit.data.byteLength),_lastUnit.data=_tmp}}return track.naluState=state,units},_proto.parseAACPES=function(pes){var offset,len,reason,fatal,pts,startOffset=0,track=this._audioTrack,aacOverFlow=this.aacOverFlow,data=pes.data;if(aacOverFlow){this.aacOverFlow=null;var sampleLength=aacOverFlow.sample.unit.byteLength,frameMissingBytes=Math.min(aacOverFlow.missing,sampleLength),frameOverflowBytes=sampleLength-frameMissingBytes;aacOverFlow.sample.unit.set(data.subarray(0,frameMissingBytes),frameOverflowBytes),track.samples.push(aacOverFlow.sample),startOffset=aacOverFlow.missing}for(offset=startOffset,len=data.length;offset<len-1&&!_adts__WEBPACK_IMPORTED_MODULE_0__.isHeader(data,offset);offset++);if(offset===startOffset||(offset<len-1?(reason="AAC PES did not start with ADTS header,offset:"+offset,fatal=!1):(reason="no ADTS header found in AAC PES",fatal=!0),_utils_logger__WEBPACK_IMPORTED_MODULE_7__.logger.warn("parsing error:"+reason),this.observer.emit(_events__WEBPACK_IMPORTED_MODULE_5__.Events.ERROR,_events__WEBPACK_IMPORTED_MODULE_5__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_8__.ErrorTypes.MEDIA_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_8__.ErrorDetails.FRAG_PARSING_ERROR,fatal:fatal,reason:reason}),!fatal)){if(_adts__WEBPACK_IMPORTED_MODULE_0__.initTrackConfig(track,this.observer,data,offset,this.audioCodec),void 0!==pes.pts)pts=pes.pts;else{if(!aacOverFlow)return void _utils_logger__WEBPACK_IMPORTED_MODULE_7__.logger.warn("[tsdemuxer]: AAC PES unknown PTS");var frameDuration=_adts__WEBPACK_IMPORTED_MODULE_0__.getFrameDuration(track.samplerate);pts=aacOverFlow.sample.pts+frameDuration}for(var frameIndex=0;offset<len;){if(_adts__WEBPACK_IMPORTED_MODULE_0__.isHeader(data,offset)){if(offset+5<len){var frame=_adts__WEBPACK_IMPORTED_MODULE_0__.appendFrame(track,data,offset,pts,frameIndex);if(frame){if(!frame.missing){offset+=frame.length,frameIndex++;continue}this.aacOverFlow=frame}}break}offset++}}},_proto.parseMPEGPES=function(pes){var data=pes.data,length=data.length,frameIndex=0,offset=0,pts=pes.pts;if(void 0!==pts)for(;offset<length;)if(_mpegaudio__WEBPACK_IMPORTED_MODULE_1__.isHeader(data,offset)){var frame=_mpegaudio__WEBPACK_IMPORTED_MODULE_1__.appendFrame(this._audioTrack,data,offset,pts,frameIndex);if(!frame)break;offset+=frame.length,frameIndex++}else offset++;else _utils_logger__WEBPACK_IMPORTED_MODULE_7__.logger.warn("[tsdemuxer]: MPEG PES unknown PTS")},_proto.parseID3PES=function(pes){void 0!==pes.pts?this._id3Track.samples.push(pes):_utils_logger__WEBPACK_IMPORTED_MODULE_7__.logger.warn("[tsdemuxer]: ID3 PES unknown PTS")},TSDemuxer}();function createAVCSample(key,pts,dts,debug){return{key:key,frame:!1,pts:pts,dts:dts,units:[],debug:debug,length:0}}function parsePAT(data,offset){return(31&data[offset+10])<<8|data[offset+11]}function parsePMT(data,offset,mpegSupported,isSampleAes){var result={audio:-1,avc:-1,id3:-1,isAAC:!0},tableEnd=offset+3+((15&data[offset+1])<<8|data[offset+2])-4;for(offset+=12+((15&data[offset+10])<<8|data[offset+11]);offset<tableEnd;){var pid=(31&data[offset+1])<<8|data[offset+2];switch(data[offset]){case 207:if(!isSampleAes){_utils_logger__WEBPACK_IMPORTED_MODULE_7__.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:-1===result.audio&&(result.audio=pid);break;case 21:-1===result.id3&&(result.id3=pid);break;case 219:if(!isSampleAes){_utils_logger__WEBPACK_IMPORTED_MODULE_7__.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:-1===result.avc&&(result.avc=pid);break;case 3:case 4:mpegSupported?-1===result.audio&&(result.audio=pid,result.isAAC=!1):_utils_logger__WEBPACK_IMPORTED_MODULE_7__.logger.log("MPEG audio found, not supported in this browser");break;case 36:_utils_logger__WEBPACK_IMPORTED_MODULE_7__.logger.warn("Unsupported HEVC stream type found")}offset+=5+((15&data[offset+3])<<8|data[offset+4])}return result}function parsePES(stream){var frag,pesLen,pesHdrLen,pesPts,pesDts,i=0,data=stream.data;if(!stream||0===stream.size)return null;for(;data[0].length<19&&data.length>1;){var newData=new Uint8Array(data[0].length+data[1].length);newData.set(data[0]),newData.set(data[1],data[0].length),data[0]=newData,data.splice(1,1)}if(1===((frag=data[0])[0]<<16)+(frag[1]<<8)+frag[2]){if((pesLen=(frag[4]<<8)+frag[5])&&pesLen>stream.size-6)return null;var pesFlags=frag[7];192&pesFlags&&(pesPts=536870912*(14&frag[9])+4194304*(255&frag[10])+16384*(254&frag[11])+128*(255&frag[12])+(254&frag[13])/2,64&pesFlags?pesPts-(pesDts=536870912*(14&frag[14])+4194304*(255&frag[15])+16384*(254&frag[16])+128*(255&frag[17])+(254&frag[18])/2)>54e5&&(_utils_logger__WEBPACK_IMPORTED_MODULE_7__.logger.warn(Math.round((pesPts-pesDts)/9e4)+"s delta between PTS and DTS, align them"),pesPts=pesDts):pesDts=pesPts);var payloadStartOffset=(pesHdrLen=frag[8])+9;if(stream.size<=payloadStartOffset)return null;stream.size-=payloadStartOffset;for(var pesData=new Uint8Array(stream.size),j=0,dataLen=data.length;j<dataLen;j++){var len=(frag=data[j]).byteLength;if(payloadStartOffset){if(payloadStartOffset>len){payloadStartOffset-=len;continue}frag=frag.subarray(payloadStartOffset),len-=payloadStartOffset,payloadStartOffset=0}pesData.set(frag,i),i+=len}return pesLen&&(pesLen-=pesHdrLen+3),{data:pesData,pts:pesPts,dts:pesDts,len:pesLen}}return null}function pushAccessUnit(avcSample,avcTrack){if(avcSample.units.length&&avcSample.frame){if(void 0===avcSample.pts){var samples=avcTrack.samples,nbSamples=samples.length;if(!nbSamples)return void avcTrack.dropped++;var lastSample=samples[nbSamples-1];avcSample.pts=lastSample.pts,avcSample.dts=lastSample.dts}avcTrack.samples.push(avcSample)}avcSample.debug.length&&_utils_logger__WEBPACK_IMPORTED_MODULE_7__.logger.log(avcSample.pts+"/"+avcSample.dts+":"+avcSample.debug)}function insertSampleInOrder(arr,data){var len=arr.length;if(len>0){if(data.pts>=arr[len-1].pts)arr.push(data);else for(var pos=len-1;pos>=0;pos--)if(data.pts<arr[pos].pts){arr.splice(pos,0,data);break}}else arr.push(data)}function discardEPB(data){for(var length=data.byteLength,EPBPositions=[],i=1;i<length-2;)0===data[i]&&0===data[i+1]&&3===data[i+2]?(EPBPositions.push(i+2),i+=2):i++;if(0===EPBPositions.length)return data;var newLength=length-EPBPositions.length,newData=new Uint8Array(newLength),sourceIndex=0;for(i=0;i<newLength;sourceIndex++,i++)sourceIndex===EPBPositions[0]&&(sourceIndex++,EPBPositions.shift()),newData[i]=data[sourceIndex];return newData}TSDemuxer.minProbeByteLength=188,__webpack_exports__.default=TSDemuxer},"./src/errors.ts":
/*!***********************!*\
        !*** ./src/errors.ts ***!
        \***********************/
/*! exports provided: ErrorTypes, ErrorDetails */
function(module,__webpack_exports__,__nested_webpack_require_724323__){"use strict";__nested_webpack_require_724323__.r(__webpack_exports__),__nested_webpack_require_724323__.d(__webpack_exports__,"ErrorTypes",function(){return ErrorTypes}),__nested_webpack_require_724323__.d(__webpack_exports__,"ErrorDetails",function(){return ErrorDetails});var ErrorTypes=function(){return function(ErrorTypes){ErrorTypes.NETWORK_ERROR="networkError",ErrorTypes.MEDIA_ERROR="mediaError",ErrorTypes.KEY_SYSTEM_ERROR="keySystemError",ErrorTypes.MUX_ERROR="muxError",ErrorTypes.OTHER_ERROR="otherError"}(ErrorTypes||(ErrorTypes={})),ErrorTypes}(),ErrorDetails=function(){return function(ErrorDetails){ErrorDetails.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",ErrorDetails.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",ErrorDetails.KEY_SYSTEM_NO_SESSION="keySystemNoSession",ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",ErrorDetails.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",ErrorDetails.MANIFEST_LOAD_ERROR="manifestLoadError",ErrorDetails.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",ErrorDetails.MANIFEST_PARSING_ERROR="manifestParsingError",ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",ErrorDetails.LEVEL_EMPTY_ERROR="levelEmptyError",ErrorDetails.LEVEL_LOAD_ERROR="levelLoadError",ErrorDetails.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",ErrorDetails.LEVEL_SWITCH_ERROR="levelSwitchError",ErrorDetails.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",ErrorDetails.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",ErrorDetails.FRAG_LOAD_ERROR="fragLoadError",ErrorDetails.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",ErrorDetails.FRAG_DECRYPT_ERROR="fragDecryptError",ErrorDetails.FRAG_PARSING_ERROR="fragParsingError",ErrorDetails.REMUX_ALLOC_ERROR="remuxAllocError",ErrorDetails.KEY_LOAD_ERROR="keyLoadError",ErrorDetails.KEY_LOAD_TIMEOUT="keyLoadTimeOut",ErrorDetails.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",ErrorDetails.BUFFER_APPEND_ERROR="bufferAppendError",ErrorDetails.BUFFER_APPENDING_ERROR="bufferAppendingError",ErrorDetails.BUFFER_STALLED_ERROR="bufferStalledError",ErrorDetails.BUFFER_FULL_ERROR="bufferFullError",ErrorDetails.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",ErrorDetails.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",ErrorDetails.INTERNAL_EXCEPTION="internalException",ErrorDetails.INTERNAL_ABORTED="aborted",ErrorDetails.UNKNOWN="unknown"}(ErrorDetails||(ErrorDetails={})),ErrorDetails}()},"./src/events.ts":
/*!***********************!*\
        !*** ./src/events.ts ***!
        \***********************/
/*! exports provided: Events */
function(module,__webpack_exports__,__nested_webpack_require_728311__){"use strict";__nested_webpack_require_728311__.r(__webpack_exports__),__nested_webpack_require_728311__.d(__webpack_exports__,"Events",function(){return Events});var Events=function(){return function(Events){Events.MEDIA_ATTACHING="hlsMediaAttaching",Events.MEDIA_ATTACHED="hlsMediaAttached",Events.MEDIA_DETACHING="hlsMediaDetaching",Events.MEDIA_DETACHED="hlsMediaDetached",Events.BUFFER_RESET="hlsBufferReset",Events.BUFFER_CODECS="hlsBufferCodecs",Events.BUFFER_CREATED="hlsBufferCreated",Events.BUFFER_APPENDING="hlsBufferAppending",Events.BUFFER_APPENDED="hlsBufferAppended",Events.BUFFER_EOS="hlsBufferEos",Events.BUFFER_FLUSHING="hlsBufferFlushing",Events.BUFFER_FLUSHED="hlsBufferFlushed",Events.MANIFEST_LOADING="hlsManifestLoading",Events.MANIFEST_LOADED="hlsManifestLoaded",Events.MANIFEST_PARSED="hlsManifestParsed",Events.LEVEL_SWITCHING="hlsLevelSwitching",Events.LEVEL_SWITCHED="hlsLevelSwitched",Events.LEVEL_LOADING="hlsLevelLoading",Events.LEVEL_LOADED="hlsLevelLoaded",Events.LEVEL_UPDATED="hlsLevelUpdated",Events.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",Events.LEVELS_UPDATED="hlsLevelsUpdated",Events.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",Events.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",Events.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",Events.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",Events.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",Events.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",Events.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",Events.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",Events.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",Events.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",Events.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",Events.CUES_PARSED="hlsCuesParsed",Events.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",Events.INIT_PTS_FOUND="hlsInitPtsFound",Events.FRAG_LOADING="hlsFragLoading",Events.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",Events.FRAG_LOADED="hlsFragLoaded",Events.FRAG_DECRYPTED="hlsFragDecrypted",Events.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",Events.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",Events.FRAG_PARSING_METADATA="hlsFragParsingMetadata",Events.FRAG_PARSED="hlsFragParsed",Events.FRAG_BUFFERED="hlsFragBuffered",Events.FRAG_CHANGED="hlsFragChanged",Events.FPS_DROP="hlsFpsDrop",Events.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",Events.ERROR="hlsError",Events.DESTROYING="hlsDestroying",Events.KEY_LOADING="hlsKeyLoading",Events.KEY_LOADED="hlsKeyLoaded",Events.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",Events.BACK_BUFFER_REACHED="hlsBackBufferReached"}(Events||(Events={})),Events}()},"./src/hls.ts":
/*!********************!*\
        !*** ./src/hls.ts ***!
        \********************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_732444__){"use strict";__nested_webpack_require_732444__.r(__webpack_exports__),__nested_webpack_require_732444__.d(__webpack_exports__,"default",function(){return Hls});var url_toolkit__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_732444__(
/*! url-toolkit */
"./node_modules/url-toolkit/src/url-toolkit.js"),_loader_playlist_loader__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_732444__(
/*! ./loader/playlist-loader */
"./src/loader/playlist-loader.ts"),_loader_key_loader__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_732444__(
/*! ./loader/key-loader */
"./src/loader/key-loader.ts"),_controller_id3_track_controller__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_732444__(
/*! ./controller/id3-track-controller */
"./src/controller/id3-track-controller.ts"),_controller_latency_controller__WEBPACK_IMPORTED_MODULE_4__=__nested_webpack_require_732444__(
/*! ./controller/latency-controller */
"./src/controller/latency-controller.ts"),_controller_level_controller__WEBPACK_IMPORTED_MODULE_5__=__nested_webpack_require_732444__(
/*! ./controller/level-controller */
"./src/controller/level-controller.ts"),_controller_fragment_tracker__WEBPACK_IMPORTED_MODULE_6__=__nested_webpack_require_732444__(
/*! ./controller/fragment-tracker */
"./src/controller/fragment-tracker.ts"),_controller_stream_controller__WEBPACK_IMPORTED_MODULE_7__=__nested_webpack_require_732444__(
/*! ./controller/stream-controller */
"./src/controller/stream-controller.ts"),_is_supported__WEBPACK_IMPORTED_MODULE_8__=__nested_webpack_require_732444__(
/*! ./is-supported */
"./src/is-supported.ts"),_utils_logger__WEBPACK_IMPORTED_MODULE_9__=__nested_webpack_require_732444__(
/*! ./utils/logger */
"./src/utils/logger.ts"),_config__WEBPACK_IMPORTED_MODULE_10__=__nested_webpack_require_732444__(
/*! ./config */
"./src/config.ts"),eventemitter3__WEBPACK_IMPORTED_MODULE_11__=__nested_webpack_require_732444__(
/*! eventemitter3 */
"./node_modules/eventemitter3/index.js"),_events__WEBPACK_IMPORTED_MODULE_12__=__nested_webpack_require_732444__(
/*! ./events */
"./src/events.ts"),_errors__WEBPACK_IMPORTED_MODULE_13__=__nested_webpack_require_732444__(
/*! ./errors */
"./src/errors.ts");function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var Hls=function(){function Hls(userConfig){void 0===userConfig&&(userConfig={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new eventemitter3__WEBPACK_IMPORTED_MODULE_11__.EventEmitter,this._autoLevelCapping=void 0,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this._media=null,this.url=null;var config=this.config=Object(_config__WEBPACK_IMPORTED_MODULE_10__.mergeConfig)(Hls.DefaultConfig,userConfig);this.userConfig=userConfig,Object(_utils_logger__WEBPACK_IMPORTED_MODULE_9__.enableLogs)(config.debug),this._autoLevelCapping=-1,config.progressive&&Object(_config__WEBPACK_IMPORTED_MODULE_10__.enableStreamingMode)(config);var ConfigBufferController=config.bufferController,ConfigCapLevelController=config.capLevelController,ConfigFpsController=config.fpsController,abrController=this.abrController=new(0,config.abrController)(this),bufferController=this.bufferController=new ConfigBufferController(this),capLevelController=this.capLevelController=new ConfigCapLevelController(this),fpsController=new ConfigFpsController(this),playListLoader=new _loader_playlist_loader__WEBPACK_IMPORTED_MODULE_1__.default(this),keyLoader=new _loader_key_loader__WEBPACK_IMPORTED_MODULE_2__.default(this),id3TrackController=new _controller_id3_track_controller__WEBPACK_IMPORTED_MODULE_3__.default(this),levelController=this.levelController=new _controller_level_controller__WEBPACK_IMPORTED_MODULE_5__.default(this),fragmentTracker=new _controller_fragment_tracker__WEBPACK_IMPORTED_MODULE_6__.FragmentTracker(this),streamController=this.streamController=new _controller_stream_controller__WEBPACK_IMPORTED_MODULE_7__.default(this,fragmentTracker);capLevelController.setStreamController(streamController),fpsController.setStreamController(streamController);var networkControllers=[levelController,streamController];this.networkControllers=networkControllers;var coreComponents=[playListLoader,keyLoader,abrController,bufferController,capLevelController,fpsController,id3TrackController,fragmentTracker];this.audioTrackController=this.createController(config.audioTrackController,null,networkControllers),this.createController(config.audioStreamController,fragmentTracker,networkControllers),this.subtitleTrackController=this.createController(config.subtitleTrackController,null,networkControllers),this.createController(config.subtitleStreamController,fragmentTracker,networkControllers),this.createController(config.timelineController,null,coreComponents),this.emeController=this.createController(config.emeController,null,coreComponents),this.latencyController=this.createController(_controller_latency_controller__WEBPACK_IMPORTED_MODULE_4__.default,null,coreComponents),this.coreComponents=coreComponents}Hls.isSupported=function(){return Object(_is_supported__WEBPACK_IMPORTED_MODULE_8__.isSupported)()};var Constructor,protoProps,staticProps,_proto=Hls.prototype;return _proto.createController=function(ControllerClass,fragmentTracker,components){if(ControllerClass){var controllerInstance=fragmentTracker?new ControllerClass(this,fragmentTracker):new ControllerClass(this);return components&&components.push(controllerInstance),controllerInstance}return null},_proto.on=function(event,listener,context){void 0===context&&(context=this),this._emitter.on(event,listener,context)},_proto.once=function(event,listener,context){void 0===context&&(context=this),this._emitter.once(event,listener,context)},_proto.removeAllListeners=function(event){this._emitter.removeAllListeners(event)},_proto.off=function(event,listener,context,once){void 0===context&&(context=this),this._emitter.off(event,listener,context,once)},_proto.listeners=function(event){return this._emitter.listeners(event)},_proto.emit=function(event,name,eventObject){return this._emitter.emit(event,name,eventObject)},_proto.trigger=function(event,eventObject){if(this.config.debug)return this.emit(event,event,eventObject);try{return this.emit(event,event,eventObject)}catch(e){_utils_logger__WEBPACK_IMPORTED_MODULE_9__.logger.error("An internal error happened while handling event "+event+'. Error message: "'+e.message+'". Here is a stacktrace:',e),this.trigger(_events__WEBPACK_IMPORTED_MODULE_12__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_13__.ErrorTypes.OTHER_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_13__.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:event,error:e})}return!1},_proto.listenerCount=function(event){return this._emitter.listenerCount(event)},_proto.destroy=function(){_utils_logger__WEBPACK_IMPORTED_MODULE_9__.logger.log("destroy"),this.trigger(_events__WEBPACK_IMPORTED_MODULE_12__.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(function(component){return component.destroy()}),this.networkControllers.length=0,this.coreComponents.forEach(function(component){return component.destroy()}),this.coreComponents.length=0},_proto.attachMedia=function(media){_utils_logger__WEBPACK_IMPORTED_MODULE_9__.logger.log("attachMedia"),this._media=media,this.trigger(_events__WEBPACK_IMPORTED_MODULE_12__.Events.MEDIA_ATTACHING,{media:media})},_proto.detachMedia=function(){_utils_logger__WEBPACK_IMPORTED_MODULE_9__.logger.log("detachMedia"),this.trigger(_events__WEBPACK_IMPORTED_MODULE_12__.Events.MEDIA_DETACHING,void 0),this._media=null},_proto.loadSource=function(url){this.stopLoad();var media=this.media,loadedSource=this.url,loadingSource=this.url=url_toolkit__WEBPACK_IMPORTED_MODULE_0__.buildAbsoluteURL(self.location.href,url,{alwaysNormalize:!0});_utils_logger__WEBPACK_IMPORTED_MODULE_9__.logger.log("loadSource:"+loadingSource),media&&loadedSource&&loadedSource!==loadingSource&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(media)),this.trigger(_events__WEBPACK_IMPORTED_MODULE_12__.Events.MANIFEST_LOADING,{url:url})},_proto.startLoad=function(startPosition){void 0===startPosition&&(startPosition=-1),_utils_logger__WEBPACK_IMPORTED_MODULE_9__.logger.log("startLoad("+startPosition+")"),this.networkControllers.forEach(function(controller){controller.startLoad(startPosition)})},_proto.stopLoad=function(){_utils_logger__WEBPACK_IMPORTED_MODULE_9__.logger.log("stopLoad"),this.networkControllers.forEach(function(controller){controller.stopLoad()})},_proto.swapAudioCodec=function(){_utils_logger__WEBPACK_IMPORTED_MODULE_9__.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},_proto.recoverMediaError=function(){_utils_logger__WEBPACK_IMPORTED_MODULE_9__.logger.log("recoverMediaError");var media=this._media;this.detachMedia(),media&&this.attachMedia(media)},_proto.removeLevel=function(levelIndex,urlId){void 0===urlId&&(urlId=0),this.levelController.removeLevel(levelIndex,urlId)},Constructor=Hls,staticProps=[{key:"version",get:function(){return"1.0.11"}},{key:"Events",get:function(){return _events__WEBPACK_IMPORTED_MODULE_12__.Events}},{key:"ErrorTypes",get:function(){return _errors__WEBPACK_IMPORTED_MODULE_13__.ErrorTypes}},{key:"ErrorDetails",get:function(){return _errors__WEBPACK_IMPORTED_MODULE_13__.ErrorDetails}},{key:"DefaultConfig",get:function(){return Hls.defaultConfig?Hls.defaultConfig:_config__WEBPACK_IMPORTED_MODULE_10__.hlsDefaultConfig},set:function(defaultConfig){Hls.defaultConfig=defaultConfig}}],(protoProps=[{key:"levels",get:function(){return this.levelController.levels||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(newLevel){_utils_logger__WEBPACK_IMPORTED_MODULE_9__.logger.log("set currentLevel:"+newLevel),this.loadLevel=newLevel,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(newLevel){_utils_logger__WEBPACK_IMPORTED_MODULE_9__.logger.log("set nextLevel:"+newLevel),this.levelController.manualLevel=newLevel,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(newLevel){_utils_logger__WEBPACK_IMPORTED_MODULE_9__.logger.log("set loadLevel:"+newLevel),this.levelController.manualLevel=newLevel}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(level){this.levelController.nextLoadLevel=level}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(newLevel){_utils_logger__WEBPACK_IMPORTED_MODULE_9__.logger.log("set firstLevel:"+newLevel),this.levelController.firstLevel=newLevel}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(newLevel){_utils_logger__WEBPACK_IMPORTED_MODULE_9__.logger.log("set startLevel:"+newLevel),-1!==newLevel&&(newLevel=Math.max(newLevel,this.minAutoLevel)),this.levelController.startLevel=newLevel}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(shouldStartCapping){var newCapLevelToPlayerSize=!!shouldStartCapping;newCapLevelToPlayerSize!==this.config.capLevelToPlayerSize&&(newCapLevelToPlayerSize?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=newCapLevelToPlayerSize)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(newLevel){this._autoLevelCapping!==newLevel&&(_utils_logger__WEBPACK_IMPORTED_MODULE_9__.logger.log("set autoLevelCapping:"+newLevel),this._autoLevelCapping=newLevel)}},{key:"bandwidthEstimate",get:function(){var bwEstimator=this.abrController.bwEstimator;return bwEstimator?bwEstimator.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var levels=this.levels,minAutoBitrate=this.config.minAutoBitrate;if(!levels)return 0;for(var len=levels.length,i=0;i<len;i++)if(levels[i].maxBitrate>minAutoBitrate)return i;return 0}},{key:"maxAutoLevel",get:function(){var levels=this.levels,autoLevelCapping=this.autoLevelCapping;return-1===autoLevelCapping&&levels&&levels.length?levels.length-1:autoLevelCapping}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(nextLevel){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,nextLevel)}},{key:"audioTracks",get:function(){var audioTrackController=this.audioTrackController;return audioTrackController?audioTrackController.audioTracks:[]}},{key:"audioTrack",get:function(){var audioTrackController=this.audioTrackController;return audioTrackController?audioTrackController.audioTrack:-1},set:function(audioTrackId){var audioTrackController=this.audioTrackController;audioTrackController&&(audioTrackController.audioTrack=audioTrackId)}},{key:"subtitleTracks",get:function(){var subtitleTrackController=this.subtitleTrackController;return subtitleTrackController?subtitleTrackController.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var subtitleTrackController=this.subtitleTrackController;return subtitleTrackController?subtitleTrackController.subtitleTrack:-1},set:function(subtitleTrackId){var subtitleTrackController=this.subtitleTrackController;subtitleTrackController&&(subtitleTrackController.subtitleTrack=subtitleTrackId)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var subtitleTrackController=this.subtitleTrackController;return!!subtitleTrackController&&subtitleTrackController.subtitleDisplay},set:function(value){var subtitleTrackController=this.subtitleTrackController;subtitleTrackController&&(subtitleTrackController.subtitleDisplay=value)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(mode){this.config.lowLatencyMode=mode}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Hls}();Hls.defaultConfig=void 0},"./src/is-supported.ts":
/*!*****************************!*\
        !*** ./src/is-supported.ts ***!
        \*****************************/
/*! exports provided: isSupported, changeTypeSupported */
function(module,__webpack_exports__,__nested_webpack_require_767550__){"use strict";__nested_webpack_require_767550__.r(__webpack_exports__),__nested_webpack_require_767550__.d(__webpack_exports__,"isSupported",function(){return isSupported}),__nested_webpack_require_767550__.d(__webpack_exports__,"changeTypeSupported",function(){return changeTypeSupported});var _utils_mediasource_helper__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_767550__(
/*! ./utils/mediasource-helper */
"./src/utils/mediasource-helper.ts");function getSourceBuffer(){return self.SourceBuffer||self.WebKitSourceBuffer}function isSupported(){var mediaSource=Object(_utils_mediasource_helper__WEBPACK_IMPORTED_MODULE_0__.getMediaSource)();if(!mediaSource)return!1;var sourceBuffer=getSourceBuffer();return!(!mediaSource||"function"!=typeof mediaSource.isTypeSupported||!mediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')||sourceBuffer&&(!sourceBuffer.prototype||"function"!=typeof sourceBuffer.prototype.appendBuffer||"function"!=typeof sourceBuffer.prototype.remove))}function changeTypeSupported(){var _sourceBuffer$prototy,sourceBuffer=getSourceBuffer();return"function"==typeof(null==sourceBuffer||null===(_sourceBuffer$prototy=sourceBuffer.prototype)||void 0===_sourceBuffer$prototy?void 0:_sourceBuffer$prototy.changeType)}},"./src/loader/fragment-loader.ts":
/*!***************************************!*\
        !*** ./src/loader/fragment-loader.ts ***!
        \***************************************/
/*! exports provided: default, LoadError */
function(module,__webpack_exports__,__nested_webpack_require_769943__){"use strict";__nested_webpack_require_769943__.r(__webpack_exports__),__nested_webpack_require_769943__.d(__webpack_exports__,"default",function(){return FragmentLoader}),__nested_webpack_require_769943__.d(__webpack_exports__,"LoadError",function(){return LoadError});var _home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_769943__(
/*! ./src/polyfills/number */
"./src/polyfills/number.ts"),_errors__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_769943__(
/*! ../errors */
"./src/errors.ts");function _wrapNativeSuper(Class){var _cache="function"==typeof Map?new Map:void 0;return _wrapNativeSuper=function(Class){if(null===Class||-1===Function.toString.call(Class).indexOf("[native code]"))return Class;if("function"!=typeof Class)throw new TypeError("Super expression must either be null or a function");if(void 0!==_cache){if(_cache.has(Class))return _cache.get(Class);_cache.set(Class,Wrapper)}function Wrapper(){return _construct(Class,arguments,_getPrototypeOf(this).constructor)}return Wrapper.prototype=Object.create(Class.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(Wrapper,Class)},_wrapNativeSuper(Class)}function _construct(Parent,args,Class){return _construct=_isNativeReflectConstruct()?Reflect.construct:function(Parent,args,Class){var a=[null];a.push.apply(a,args);var instance=new(Function.bind.apply(Parent,a));return Class&&_setPrototypeOf(instance,Class.prototype),instance},_construct.apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}var MIN_CHUNK_SIZE=Math.pow(2,17),FragmentLoader=function(){function FragmentLoader(config){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=config}var _proto=FragmentLoader.prototype;return _proto.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},_proto.abort=function(){this.loader&&this.loader.abort()},_proto.load=function(frag,_onProgress){var _this=this,url=frag.url;if(!url)return Promise.reject(new LoadError({type:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorTypes.NETWORK_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:frag,networkDetails:null},"Fragment does not have a "+(url?"part list":"url")));this.abort();var config=this.config,FragmentILoader=config.fLoader,DefaultILoader=config.loader;return new Promise(function(resolve,reject){_this.loader&&_this.loader.destroy();var loader=_this.loader=frag.loader=FragmentILoader?new FragmentILoader(config):new DefaultILoader(config),loaderContext=createLoaderContext(frag),loaderConfig={timeout:config.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:config.fragLoadingMaxRetryTimeout,highWaterMark:MIN_CHUNK_SIZE};frag.stats=loader.stats,loader.load(loaderContext,loaderConfig,{onSuccess:function(response,stats,context,networkDetails){_this.resetLoader(frag,loader),resolve({frag:frag,part:null,payload:response.data,networkDetails:networkDetails})},onError:function(response,context,networkDetails){_this.resetLoader(frag,loader),reject(new LoadError({type:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorTypes.NETWORK_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:frag,response:response,networkDetails:networkDetails}))},onAbort:function(stats,context,networkDetails){_this.resetLoader(frag,loader),reject(new LoadError({type:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorTypes.NETWORK_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:frag,networkDetails:networkDetails}))},onTimeout:function(response,context,networkDetails){_this.resetLoader(frag,loader),reject(new LoadError({type:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorTypes.NETWORK_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:frag,networkDetails:networkDetails}))},onProgress:function(stats,context,data,networkDetails){_onProgress&&_onProgress({frag:frag,part:null,payload:data,networkDetails:networkDetails})}})})},_proto.loadPart=function(frag,part,onProgress){var _this2=this;this.abort();var config=this.config,FragmentILoader=config.fLoader,DefaultILoader=config.loader;return new Promise(function(resolve,reject){_this2.loader&&_this2.loader.destroy();var loader=_this2.loader=frag.loader=FragmentILoader?new FragmentILoader(config):new DefaultILoader(config),loaderContext=createLoaderContext(frag,part),loaderConfig={timeout:config.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:config.fragLoadingMaxRetryTimeout,highWaterMark:MIN_CHUNK_SIZE};part.stats=loader.stats,loader.load(loaderContext,loaderConfig,{onSuccess:function(response,stats,context,networkDetails){_this2.resetLoader(frag,loader),_this2.updateStatsFromPart(frag,part);var partLoadedData={frag:frag,part:part,payload:response.data,networkDetails:networkDetails};onProgress(partLoadedData),resolve(partLoadedData)},onError:function(response,context,networkDetails){_this2.resetLoader(frag,loader),reject(new LoadError({type:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorTypes.NETWORK_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:frag,part:part,response:response,networkDetails:networkDetails}))},onAbort:function(stats,context,networkDetails){frag.stats.aborted=part.stats.aborted,_this2.resetLoader(frag,loader),reject(new LoadError({type:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorTypes.NETWORK_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:frag,part:part,networkDetails:networkDetails}))},onTimeout:function(response,context,networkDetails){_this2.resetLoader(frag,loader),reject(new LoadError({type:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorTypes.NETWORK_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:frag,part:part,networkDetails:networkDetails}))}})})},_proto.updateStatsFromPart=function(frag,part){var fragStats=frag.stats,partStats=part.stats,partTotal=partStats.total;if(fragStats.loaded+=partStats.loaded,partTotal){var estTotalParts=Math.round(frag.duration/part.duration),estLoadedParts=Math.min(Math.round(fragStats.loaded/partTotal),estTotalParts),estRemainingBytes=(estTotalParts-estLoadedParts)*Math.round(fragStats.loaded/estLoadedParts);fragStats.total=fragStats.loaded+estRemainingBytes}else fragStats.total=Math.max(fragStats.loaded,fragStats.total);var fragLoading=fragStats.loading,partLoading=partStats.loading;fragLoading.start?fragLoading.first+=partLoading.first-partLoading.start:(fragLoading.start=partLoading.start,fragLoading.first=partLoading.first),fragLoading.end=partLoading.end},_proto.resetLoader=function(frag,loader){frag.loader=null,this.loader===loader&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),loader.destroy()},FragmentLoader}();function createLoaderContext(frag,part){void 0===part&&(part=null);var segment=part||frag,loaderContext={frag:frag,part:part,responseType:"arraybuffer",url:segment.url,rangeStart:0,rangeEnd:0},start=segment.byteRangeStartOffset,end=segment.byteRangeEndOffset;return Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(start)&&Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(end)&&(loaderContext.rangeStart=start,loaderContext.rangeEnd=end),loaderContext}var LoadError=function(_Error){var subClass,superClass;function LoadError(data){for(var _this3,_len=arguments.length,params=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)params[_key-1]=arguments[_key];return(_this3=_Error.call.apply(_Error,[this].concat(params))||this).data=void 0,_this3.data=data,_this3}return superClass=_Error,(subClass=LoadError).prototype=Object.create(superClass.prototype),subClass.prototype.constructor=subClass,_setPrototypeOf(subClass,superClass),LoadError}(_wrapNativeSuper(Error))},"./src/loader/fragment.ts":
/*!********************************!*\
        !*** ./src/loader/fragment.ts ***!
        \********************************/
/*! exports provided: ElementaryStreamTypes, BaseSegment, Fragment, Part */
function(module,__webpack_exports__,__nested_webpack_require_785292__){"use strict";__nested_webpack_require_785292__.r(__webpack_exports__),__nested_webpack_require_785292__.d(__webpack_exports__,"ElementaryStreamTypes",function(){return ElementaryStreamTypes}),__nested_webpack_require_785292__.d(__webpack_exports__,"BaseSegment",function(){return BaseSegment}),__nested_webpack_require_785292__.d(__webpack_exports__,"Fragment",function(){return Fragment}),__nested_webpack_require_785292__.d(__webpack_exports__,"Part",function(){return Part});var _home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_785292__(
/*! ./src/polyfills/number */
"./src/polyfills/number.ts"),url_toolkit__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_785292__(
/*! url-toolkit */
"./node_modules/url-toolkit/src/url-toolkit.js"),_utils_logger__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_785292__(
/*! ../utils/logger */
"./src/utils/logger.ts"),_level_key__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_785292__(
/*! ./level-key */
"./src/loader/level-key.ts"),_load_stats__WEBPACK_IMPORTED_MODULE_4__=__nested_webpack_require_785292__(
/*! ./load-stats */
"./src/loader/load-stats.ts");function _inheritsLoose(subClass,superClass){subClass.prototype=Object.create(superClass.prototype),subClass.prototype.constructor=subClass,_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}var ElementaryStreamTypes=function(){return function(ElementaryStreamTypes){ElementaryStreamTypes.AUDIO="audio",ElementaryStreamTypes.VIDEO="video",ElementaryStreamTypes.AUDIOVIDEO="audiovideo"}(ElementaryStreamTypes||(ElementaryStreamTypes={})),ElementaryStreamTypes}(),BaseSegment=function(){function BaseSegment(baseurl){var _this$elementaryStrea;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=((_this$elementaryStrea={})[ElementaryStreamTypes.AUDIO]=null,_this$elementaryStrea[ElementaryStreamTypes.VIDEO]=null,_this$elementaryStrea[ElementaryStreamTypes.AUDIOVIDEO]=null,_this$elementaryStrea),this.baseurl=baseurl}return BaseSegment.prototype.setByteRange=function(value,previous){var params=value.split("@",2),byteRange=[];byteRange[0]=1===params.length?previous?previous.byteRangeEndOffset:0:parseInt(params[1]),byteRange[1]=parseInt(params[0])+byteRange[0],this._byteRange=byteRange},_createClass(BaseSegment,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Object(url_toolkit__WEBPACK_IMPORTED_MODULE_1__.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(value){this._url=value}}]),BaseSegment}(),Fragment=function(_BaseSegment){function Fragment(type,baseurl){var _this;return(_this=_BaseSegment.call(this,baseurl)||this)._decryptdata=null,_this.rawProgramDateTime=null,_this.programDateTime=null,_this.tagList=[],_this.duration=0,_this.sn=0,_this.levelkey=void 0,_this.type=void 0,_this.loader=null,_this.level=-1,_this.cc=0,_this.startPTS=void 0,_this.endPTS=void 0,_this.appendedPTS=void 0,_this.startDTS=void 0,_this.endDTS=void 0,_this.start=0,_this.deltaPTS=void 0,_this.maxStartPTS=void 0,_this.minEndPTS=void 0,_this.stats=new _load_stats__WEBPACK_IMPORTED_MODULE_4__.LoadStats,_this.urlId=0,_this.data=void 0,_this.bitrateTest=!1,_this.title=null,_this.initSegment=null,_this.type=type,_this}_inheritsLoose(Fragment,_BaseSegment);var _proto2=Fragment.prototype;return _proto2.createInitializationVector=function(segmentNumber){for(var uint8View=new Uint8Array(16),i=12;i<16;i++)uint8View[i]=segmentNumber>>8*(15-i)&255;return uint8View},_proto2.setDecryptDataFromLevelKey=function(levelkey,segmentNumber){var decryptdata=levelkey;return"AES-128"===(null==levelkey?void 0:levelkey.method)&&levelkey.uri&&!levelkey.iv&&((decryptdata=_level_key__WEBPACK_IMPORTED_MODULE_3__.LevelKey.fromURI(levelkey.uri)).method=levelkey.method,decryptdata.iv=this.createInitializationVector(segmentNumber),decryptdata.keyFormat="identity"),decryptdata},_proto2.setElementaryStreamInfo=function(type,startPTS,endPTS,startDTS,endDTS,partial){void 0===partial&&(partial=!1);var elementaryStreams=this.elementaryStreams,info=elementaryStreams[type];info?(info.startPTS=Math.min(info.startPTS,startPTS),info.endPTS=Math.max(info.endPTS,endPTS),info.startDTS=Math.min(info.startDTS,startDTS),info.endDTS=Math.max(info.endDTS,endDTS)):elementaryStreams[type]={startPTS:startPTS,endPTS:endPTS,startDTS:startDTS,endDTS:endDTS,partial:partial}},_proto2.clearElementaryStreamInfo=function(){var elementaryStreams=this.elementaryStreams;elementaryStreams[ElementaryStreamTypes.AUDIO]=null,elementaryStreams[ElementaryStreamTypes.VIDEO]=null,elementaryStreams[ElementaryStreamTypes.AUDIOVIDEO]=null},_createClass(Fragment,[{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var sn=this.sn;"number"!=typeof sn&&(this.levelkey&&"AES-128"===this.levelkey.method&&!this.levelkey.iv&&_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),sn=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,sn)}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(null===this.programDateTime)return null;if(!Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(this.programDateTime))return null;var duration=Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+1e3*duration}},{key:"encrypted",get:function(){var _this$decryptdata;return!(null===(_this$decryptdata=this.decryptdata)||void 0===_this$decryptdata||!_this$decryptdata.keyFormat||!this.decryptdata.uri)}}]),Fragment}(BaseSegment),Part=function(_BaseSegment2){function Part(partAttrs,frag,baseurl,index,previous){var _this2;(_this2=_BaseSegment2.call(this,baseurl)||this).fragOffset=0,_this2.duration=0,_this2.gap=!1,_this2.independent=!1,_this2.relurl=void 0,_this2.fragment=void 0,_this2.index=void 0,_this2.stats=new _load_stats__WEBPACK_IMPORTED_MODULE_4__.LoadStats,_this2.duration=partAttrs.decimalFloatingPoint("DURATION"),_this2.gap=partAttrs.bool("GAP"),_this2.independent=partAttrs.bool("INDEPENDENT"),_this2.relurl=partAttrs.enumeratedString("URI"),_this2.fragment=frag,_this2.index=index;var byteRange=partAttrs.enumeratedString("BYTERANGE");return byteRange&&_this2.setByteRange(byteRange,previous),previous&&(_this2.fragOffset=previous.fragOffset+previous.duration),_this2}return _inheritsLoose(Part,_BaseSegment2),_createClass(Part,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var elementaryStreams=this.elementaryStreams;return!!(elementaryStreams.audio||elementaryStreams.video||elementaryStreams.audiovideo)}}]),Part}(BaseSegment)},"./src/loader/key-loader.ts":
/*!**********************************!*\
        !*** ./src/loader/key-loader.ts ***!
        \**********************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_802246__){"use strict";__nested_webpack_require_802246__.r(__webpack_exports__),__nested_webpack_require_802246__.d(__webpack_exports__,"default",function(){return KeyLoader});var _events__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_802246__(
/*! ../events */
"./src/events.ts"),_errors__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_802246__(
/*! ../errors */
"./src/errors.ts"),_utils_logger__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_802246__(
/*! ../utils/logger */
"./src/utils/logger.ts"),KeyLoader=function(){function KeyLoader(hls){this.hls=void 0,this.loaders={},this.decryptkey=null,this.decrypturl=null,this.hls=hls,this._registerListeners()}var _proto=KeyLoader.prototype;return _proto._registerListeners=function(){this.hls.on(_events__WEBPACK_IMPORTED_MODULE_0__.Events.KEY_LOADING,this.onKeyLoading,this)},_proto._unregisterListeners=function(){this.hls.off(_events__WEBPACK_IMPORTED_MODULE_0__.Events.KEY_LOADING,this.onKeyLoading)},_proto.destroy=function(){for(var loaderName in this._unregisterListeners(),this.loaders){var loader=this.loaders[loaderName];loader&&loader.destroy()}this.loaders={}},_proto.onKeyLoading=function(event,data){var frag=data.frag,type=frag.type,loader=this.loaders[type];if(frag.decryptdata){var uri=frag.decryptdata.uri;if(uri!==this.decrypturl||null===this.decryptkey){var config=this.hls.config;if(loader&&(_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.warn("abort previous key loader for type:"+type),loader.abort()),!uri)return void _utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.warn("key uri is falsy");var fragLoader=frag.loader=this.loaders[type]=new(0,config.loader)(config);this.decrypturl=uri,this.decryptkey=null;var loaderContext={url:uri,frag:frag,responseType:"arraybuffer"},loaderConfig={timeout:config.fragLoadingTimeOut,maxRetry:0,retryDelay:config.fragLoadingRetryDelay,maxRetryDelay:config.fragLoadingMaxRetryTimeout,highWaterMark:0},loaderCallbacks={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};fragLoader.load(loaderContext,loaderConfig,loaderCallbacks)}else this.decryptkey&&(frag.decryptdata.key=this.decryptkey,this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_0__.Events.KEY_LOADED,{frag:frag}))}else _utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.warn("Missing decryption data on fragment in onKeyLoading")},_proto.loadsuccess=function(response,stats,context){var frag=context.frag;frag.decryptdata?(this.decryptkey=frag.decryptdata.key=new Uint8Array(response.data),frag.loader=null,delete this.loaders[frag.type],this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_0__.Events.KEY_LOADED,{frag:frag})):_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error("after key load, decryptdata unset")},_proto.loaderror=function(response,context){var frag=context.frag,loader=frag.loader;loader&&loader.abort(),delete this.loaders[frag.type],this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_0__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorTypes.NETWORK_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:frag,response:response})},_proto.loadtimeout=function(stats,context){var frag=context.frag,loader=frag.loader;loader&&loader.abort(),delete this.loaders[frag.type],this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_0__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorTypes.NETWORK_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:frag})},KeyLoader}()},"./src/loader/level-details.ts":
/*!*************************************!*\
        !*** ./src/loader/level-details.ts ***!
        \*************************************/
/*! exports provided: LevelDetails */
function(module,__webpack_exports__,__nested_webpack_require_808946__){"use strict";__nested_webpack_require_808946__.r(__webpack_exports__),__nested_webpack_require_808946__.d(__webpack_exports__,"LevelDetails",function(){return LevelDetails});var _home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_808946__(
/*! ./src/polyfills/number */
"./src/polyfills/number.ts");function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var LevelDetails=function(){function LevelDetails(baseUrl){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.fragments=[],this.url=baseUrl}var Constructor,protoProps;return LevelDetails.prototype.reloaded=function(previous){if(!previous)return this.advanced=!0,void(this.updated=!0);var partSnDiff=this.lastPartSn-previous.lastPartSn,partIndexDiff=this.lastPartIndex-previous.lastPartIndex;this.updated=this.endSN!==previous.endSN||!!partIndexDiff||!!partSnDiff,this.advanced=this.endSN>previous.endSN||partSnDiff>0||0===partSnDiff&&partIndexDiff>0,this.misses=this.updated||this.advanced?Math.floor(.6*previous.misses):previous.misses+1,this.availabilityDelay=previous.availabilityDelay},Constructor=LevelDetails,(protoProps=[{key:"hasProgramDateTime",get:function(){return!!this.fragments.length&&Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime)}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||10}},{key:"drift",get:function(){var runTime=this.driftEndTime-this.driftStartTime;return runTime>0?1e3*(this.driftEnd-this.driftStart)/runTime:1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var _this$partList;return null!==(_this$partList=this.partList)&&void 0!==_this$partList&&_this$partList.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var _this$fragments;return null!==(_this$fragments=this.fragments)&&void 0!==_this$fragments&&_this$fragments.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var _this$partList2;return null!==(_this$partList2=this.partList)&&void 0!==_this$partList2&&_this$partList2.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var _this$partList3;return null!==(_this$partList3=this.partList)&&void 0!==_this$partList3&&_this$partList3.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}])&&_defineProperties(Constructor.prototype,protoProps),LevelDetails}()},"./src/loader/level-key.ts":
/*!*********************************!*\
        !*** ./src/loader/level-key.ts ***!
        \*********************************/
/*! exports provided: LevelKey */
function(module,__webpack_exports__,__nested_webpack_require_815941__){"use strict";__nested_webpack_require_815941__.r(__webpack_exports__),__nested_webpack_require_815941__.d(__webpack_exports__,"LevelKey",function(){return LevelKey});var url_toolkit__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_815941__(
/*! url-toolkit */
"./node_modules/url-toolkit/src/url-toolkit.js");function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var LevelKey=function(){function LevelKey(absoluteOrBaseURI,relativeURL){this._uri=null,this.method=null,this.keyFormat=null,this.keyFormatVersions=null,this.keyID=null,this.key=null,this.iv=null,this._uri=relativeURL?Object(url_toolkit__WEBPACK_IMPORTED_MODULE_0__.buildAbsoluteURL)(absoluteOrBaseURI,relativeURL,{alwaysNormalize:!0}):absoluteOrBaseURI}var Constructor,protoProps;return LevelKey.fromURL=function(baseUrl,relativeUrl){return new LevelKey(baseUrl,relativeUrl)},LevelKey.fromURI=function(uri){return new LevelKey(uri)},Constructor=LevelKey,(protoProps=[{key:"uri",get:function(){return this._uri}}])&&_defineProperties(Constructor.prototype,protoProps),LevelKey}()},"./src/loader/load-stats.ts":
/*!**********************************!*\
        !*** ./src/loader/load-stats.ts ***!
        \**********************************/
/*! exports provided: LoadStats */
function(module,__webpack_exports__,__nested_webpack_require_818659__){"use strict";__nested_webpack_require_818659__.r(__webpack_exports__),__nested_webpack_require_818659__.d(__webpack_exports__,"LoadStats",function(){return LoadStats});var LoadStats=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},"./src/loader/m3u8-parser.ts":
/*!***********************************!*\
        !*** ./src/loader/m3u8-parser.ts ***!
        \***********************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_819770__){"use strict";__nested_webpack_require_819770__.r(__webpack_exports__),__nested_webpack_require_819770__.d(__webpack_exports__,"default",function(){return M3U8Parser});var _home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_819770__(
/*! ./src/polyfills/number */
"./src/polyfills/number.ts"),url_toolkit__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_819770__(
/*! url-toolkit */
"./node_modules/url-toolkit/src/url-toolkit.js"),_fragment__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_819770__(
/*! ./fragment */
"./src/loader/fragment.ts"),_level_details__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_819770__(
/*! ./level-details */
"./src/loader/level-details.ts"),_level_key__WEBPACK_IMPORTED_MODULE_4__=__nested_webpack_require_819770__(
/*! ./level-key */
"./src/loader/level-key.ts"),_utils_attr_list__WEBPACK_IMPORTED_MODULE_5__=__nested_webpack_require_819770__(
/*! ../utils/attr-list */
"./src/utils/attr-list.ts"),_utils_logger__WEBPACK_IMPORTED_MODULE_6__=__nested_webpack_require_819770__(
/*! ../utils/logger */
"./src/utils/logger.ts"),_utils_codecs__WEBPACK_IMPORTED_MODULE_7__=__nested_webpack_require_819770__(
/*! ../utils/codecs */
"./src/utils/codecs.ts"),MASTER_PLAYLIST_REGEX=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+/g,MASTER_PLAYLIST_MEDIA_REGEX=/#EXT-X-MEDIA:(.*)/g,LEVEL_PLAYLIST_REGEX_FAST=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),LEVEL_PLAYLIST_REGEX_SLOW=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(PLAYLIST-TYPE):(.+)/.source,/#EXT-X-(MEDIA-SEQUENCE): *(\d+)/.source,/#EXT-X-(SKIP):(.+)/.source,/#EXT-X-(TARGETDURATION): *(\d+)/.source,/#EXT-X-(KEY):(.+)/.source,/#EXT-X-(START):(.+)/.source,/#EXT-X-(ENDLIST)/.source,/#EXT-X-(DISCONTINUITY-SEQ)UENCE: *(\d+)/.source,/#EXT-X-(DIS)CONTINUITY/.source,/#EXT-X-(VERSION):(\d+)/.source,/#EXT-X-(MAP):(.+)/.source,/#EXT-X-(SERVER-CONTROL):(.+)/.source,/#EXT-X-(PART-INF):(.+)/.source,/#EXT-X-(GAP)/.source,/#EXT-X-(BITRATE):\s*(\d+)/.source,/#EXT-X-(PART):(.+)/.source,/#EXT-X-(PRELOAD-HINT):(.+)/.source,/#EXT-X-(RENDITION-REPORT):(.+)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),MP4_REGEX_SUFFIX=/\.(mp4|m4s|m4v|m4a)$/i,M3U8Parser=function(){function M3U8Parser(){}return M3U8Parser.findGroup=function(groups,mediaGroupId){for(var i=0;i<groups.length;i++){var group=groups[i];if(group.id===mediaGroupId)return group}},M3U8Parser.convertAVC1ToAVCOTI=function(codec){var avcdata=codec.split(".");if(avcdata.length>2){var result=avcdata.shift()+".";return(result+=parseInt(avcdata.shift()).toString(16))+("000"+parseInt(avcdata.shift()).toString(16)).substr(-4)}return codec},M3U8Parser.resolve=function(url,baseUrl){return url_toolkit__WEBPACK_IMPORTED_MODULE_1__.buildAbsoluteURL(baseUrl,url,{alwaysNormalize:!0})},M3U8Parser.parseMasterPlaylist=function(string,baseurl){var result,levels=[],sessionData={},hasSessionData=!1;for(MASTER_PLAYLIST_REGEX.lastIndex=0;null!=(result=MASTER_PLAYLIST_REGEX.exec(string));)if(result[1]){var attrs=new _utils_attr_list__WEBPACK_IMPORTED_MODULE_5__.AttrList(result[1]),level={attrs:attrs,bitrate:attrs.decimalInteger("AVERAGE-BANDWIDTH")||attrs.decimalInteger("BANDWIDTH"),name:attrs.NAME,url:M3U8Parser.resolve(result[2],baseurl)},resolution=attrs.decimalResolution("RESOLUTION");resolution&&(level.width=resolution.width,level.height=resolution.height),setCodecs((attrs.CODECS||"").split(/[ ,]+/).filter(function(c){return c}),level),level.videoCodec&&-1!==level.videoCodec.indexOf("avc1")&&(level.videoCodec=M3U8Parser.convertAVC1ToAVCOTI(level.videoCodec)),levels.push(level)}else if(result[3]){var sessionAttrs=new _utils_attr_list__WEBPACK_IMPORTED_MODULE_5__.AttrList(result[3]);sessionAttrs["DATA-ID"]&&(hasSessionData=!0,sessionData[sessionAttrs["DATA-ID"]]=sessionAttrs)}return{levels:levels,sessionData:hasSessionData?sessionData:null}},M3U8Parser.parseMasterPlaylistMedia=function(string,baseurl,type,groups){var result;void 0===groups&&(groups=[]);var medias=[],id=0;for(MASTER_PLAYLIST_MEDIA_REGEX.lastIndex=0;null!==(result=MASTER_PLAYLIST_MEDIA_REGEX.exec(string));){var attrs=new _utils_attr_list__WEBPACK_IMPORTED_MODULE_5__.AttrList(result[1]);if(attrs.TYPE===type){var media={attrs:attrs,bitrate:0,id:id++,groupId:attrs["GROUP-ID"],instreamId:attrs["INSTREAM-ID"],name:attrs.NAME||attrs.LANGUAGE||"",type:type,default:attrs.bool("DEFAULT"),autoselect:attrs.bool("AUTOSELECT"),forced:attrs.bool("FORCED"),lang:attrs.LANGUAGE,url:attrs.URI?M3U8Parser.resolve(attrs.URI,baseurl):""};if(groups.length){var groupCodec=M3U8Parser.findGroup(groups,media.groupId)||groups[0];assignCodec(media,groupCodec,"audioCodec"),assignCodec(media,groupCodec,"textCodec")}medias.push(media)}}return medias},M3U8Parser.parseLevelPlaylist=function(string,baseurl,id,type,levelUrlId){var result,i,levelkey,level=new _level_details__WEBPACK_IMPORTED_MODULE_3__.LevelDetails(baseurl),fragments=level.fragments,currentInitSegment=null,currentSN=0,currentPart=0,totalduration=0,discontinuityCounter=0,prevFrag=null,frag=new _fragment__WEBPACK_IMPORTED_MODULE_2__.Fragment(type,baseurl),firstPdtIndex=-1,createNextFrag=!1;for(LEVEL_PLAYLIST_REGEX_FAST.lastIndex=0,level.m3u8=string;null!==(result=LEVEL_PLAYLIST_REGEX_FAST.exec(string));){createNextFrag&&(createNextFrag=!1,(frag=new _fragment__WEBPACK_IMPORTED_MODULE_2__.Fragment(type,baseurl)).start=totalduration,frag.sn=currentSN,frag.cc=discontinuityCounter,frag.level=id,currentInitSegment&&(frag.initSegment=currentInitSegment,frag.rawProgramDateTime=currentInitSegment.rawProgramDateTime));var duration=result[1];if(duration){frag.duration=parseFloat(duration);var title=(" "+result[2]).slice(1);frag.title=title||null,frag.tagList.push(title?["INF",duration,title]:["INF",duration])}else if(result[3])Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(frag.duration)&&(frag.start=totalduration,levelkey&&(frag.levelkey=levelkey),frag.sn=currentSN,frag.level=id,frag.cc=discontinuityCounter,frag.urlId=levelUrlId,fragments.push(frag),frag.relurl=(" "+result[3]).slice(1),assignProgramDateTime(frag,prevFrag),prevFrag=frag,totalduration+=frag.duration,currentSN++,currentPart=0,createNextFrag=!0);else if(result[4]){var data=(" "+result[4]).slice(1);prevFrag?frag.setByteRange(data,prevFrag):frag.setByteRange(data)}else if(result[5])frag.rawProgramDateTime=(" "+result[5]).slice(1),frag.tagList.push(["PROGRAM-DATE-TIME",frag.rawProgramDateTime]),-1===firstPdtIndex&&(firstPdtIndex=fragments.length);else{if(!(result=result[0].match(LEVEL_PLAYLIST_REGEX_SLOW))){_utils_logger__WEBPACK_IMPORTED_MODULE_6__.logger.warn("No matches on slow regex match for level playlist!");continue}for(i=1;i<result.length&&void 0===result[i];i++);var tag=(" "+result[i]).slice(1),value1=(" "+result[i+1]).slice(1),value2=result[i+2]?(" "+result[i+2]).slice(1):"";switch(tag){case"PLAYLIST-TYPE":level.type=value1.toUpperCase();break;case"MEDIA-SEQUENCE":currentSN=level.startSN=parseInt(value1);break;case"SKIP":var skipAttrs=new _utils_attr_list__WEBPACK_IMPORTED_MODULE_5__.AttrList(value1),skippedSegments=skipAttrs.decimalInteger("SKIPPED-SEGMENTS");if(Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(skippedSegments)){level.skippedSegments=skippedSegments;for(var _i=skippedSegments;_i--;)fragments.unshift(null);currentSN+=skippedSegments}var recentlyRemovedDateranges=skipAttrs.enumeratedString("RECENTLY-REMOVED-DATERANGES");recentlyRemovedDateranges&&(level.recentlyRemovedDateranges=recentlyRemovedDateranges.split("\t"));break;case"TARGETDURATION":level.targetduration=parseFloat(value1);break;case"VERSION":level.version=parseInt(value1);break;case"EXTM3U":break;case"ENDLIST":level.live=!1;break;case"#":(value1||value2)&&frag.tagList.push(value2?[value1,value2]:[value1]);break;case"DIS":discontinuityCounter++;case"GAP":frag.tagList.push([tag]);break;case"BITRATE":frag.tagList.push([tag,value1]);break;case"DISCONTINUITY-SEQ":discontinuityCounter=parseInt(value1);break;case"KEY":var _keyAttrs$enumeratedS,keyAttrs=new _utils_attr_list__WEBPACK_IMPORTED_MODULE_5__.AttrList(value1),decryptmethod=keyAttrs.enumeratedString("METHOD"),decrypturi=keyAttrs.URI,decryptiv=keyAttrs.hexadecimalInteger("IV"),decryptkeyformatversions=keyAttrs.enumeratedString("KEYFORMATVERSIONS"),decryptkeyid=keyAttrs.enumeratedString("KEYID"),decryptkeyformat=null!=(_keyAttrs$enumeratedS=keyAttrs.enumeratedString("KEYFORMAT"))?_keyAttrs$enumeratedS:"identity";if(["com.apple.streamingkeydelivery","com.microsoft.playready","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine"].indexOf(decryptkeyformat)>-1){_utils_logger__WEBPACK_IMPORTED_MODULE_6__.logger.warn("Keyformat "+decryptkeyformat+" is not supported from the manifest");continue}if("identity"!==decryptkeyformat)continue;decryptmethod&&(levelkey=_level_key__WEBPACK_IMPORTED_MODULE_4__.LevelKey.fromURL(baseurl,decrypturi),decrypturi&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(decryptmethod)>=0&&(levelkey.method=decryptmethod,levelkey.keyFormat=decryptkeyformat,decryptkeyid&&(levelkey.keyID=decryptkeyid),decryptkeyformatversions&&(levelkey.keyFormatVersions=decryptkeyformatversions),levelkey.iv=decryptiv));break;case"START":var startTimeOffset=new _utils_attr_list__WEBPACK_IMPORTED_MODULE_5__.AttrList(value1).decimalFloatingPoint("TIME-OFFSET");Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(startTimeOffset)&&(level.startTimeOffset=startTimeOffset);break;case"MAP":var mapAttrs=new _utils_attr_list__WEBPACK_IMPORTED_MODULE_5__.AttrList(value1);frag.relurl=mapAttrs.URI,mapAttrs.BYTERANGE&&frag.setByteRange(mapAttrs.BYTERANGE),frag.level=id,frag.sn="initSegment",levelkey&&(frag.levelkey=levelkey),frag.initSegment=null,currentInitSegment=frag,createNextFrag=!0;break;case"SERVER-CONTROL":var serverControlAttrs=new _utils_attr_list__WEBPACK_IMPORTED_MODULE_5__.AttrList(value1);level.canBlockReload=serverControlAttrs.bool("CAN-BLOCK-RELOAD"),level.canSkipUntil=serverControlAttrs.optionalFloat("CAN-SKIP-UNTIL",0),level.canSkipDateRanges=level.canSkipUntil>0&&serverControlAttrs.bool("CAN-SKIP-DATERANGES"),level.partHoldBack=serverControlAttrs.optionalFloat("PART-HOLD-BACK",0),level.holdBack=serverControlAttrs.optionalFloat("HOLD-BACK",0);break;case"PART-INF":var partInfAttrs=new _utils_attr_list__WEBPACK_IMPORTED_MODULE_5__.AttrList(value1);level.partTarget=partInfAttrs.decimalFloatingPoint("PART-TARGET");break;case"PART":var partList=level.partList;partList||(partList=level.partList=[]);var previousFragmentPart=currentPart>0?partList[partList.length-1]:void 0,index=currentPart++,part=new _fragment__WEBPACK_IMPORTED_MODULE_2__.Part(new _utils_attr_list__WEBPACK_IMPORTED_MODULE_5__.AttrList(value1),frag,baseurl,index,previousFragmentPart);partList.push(part),frag.duration+=part.duration;break;case"PRELOAD-HINT":var preloadHintAttrs=new _utils_attr_list__WEBPACK_IMPORTED_MODULE_5__.AttrList(value1);level.preloadHint=preloadHintAttrs;break;case"RENDITION-REPORT":var renditionReportAttrs=new _utils_attr_list__WEBPACK_IMPORTED_MODULE_5__.AttrList(value1);level.renditionReports=level.renditionReports||[],level.renditionReports.push(renditionReportAttrs);break;default:_utils_logger__WEBPACK_IMPORTED_MODULE_6__.logger.warn("line parsed but not handled: "+result)}}}prevFrag&&!prevFrag.relurl?(fragments.pop(),totalduration-=prevFrag.duration,level.partList&&(level.fragmentHint=prevFrag)):level.partList&&(assignProgramDateTime(frag,prevFrag),frag.cc=discontinuityCounter,level.fragmentHint=frag);var fragmentLength=fragments.length,firstFragment=fragments[0],lastFragment=fragments[fragmentLength-1];if((totalduration+=level.skippedSegments*level.targetduration)>0&&fragmentLength&&lastFragment){level.averagetargetduration=totalduration/fragmentLength;var lastSn=lastFragment.sn;level.endSN="initSegment"!==lastSn?lastSn:0,firstFragment&&(level.startCC=firstFragment.cc,firstFragment.initSegment||level.fragments.every(function(frag){return frag.relurl&&MP4_REGEX_SUFFIX.test(null!=(_URLToolkit$parseURL$=null===(_URLToolkit$parseURL=url_toolkit__WEBPACK_IMPORTED_MODULE_1__.parseURL(frag.relurl))||void 0===_URLToolkit$parseURL?void 0:_URLToolkit$parseURL.path)?_URLToolkit$parseURL$:"");var _URLToolkit$parseURL$,_URLToolkit$parseURL})&&(_utils_logger__WEBPACK_IMPORTED_MODULE_6__.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(frag=new _fragment__WEBPACK_IMPORTED_MODULE_2__.Fragment(type,baseurl)).relurl=lastFragment.relurl,frag.level=id,frag.sn="initSegment",firstFragment.initSegment=frag,level.needSidxRanges=!0))}else level.endSN=0,level.startCC=0;return level.fragmentHint&&(totalduration+=level.fragmentHint.duration),level.totalduration=totalduration,level.endCC=discontinuityCounter,firstPdtIndex>0&&function(fragments,firstPdtIndex){for(var fragPrev=fragments[firstPdtIndex],i=firstPdtIndex;i--;){var frag=fragments[i];if(!frag)return;frag.programDateTime=fragPrev.programDateTime-1e3*frag.duration,fragPrev=frag}}(fragments,firstPdtIndex),level},M3U8Parser}();function setCodecs(codecs,level){["video","audio","text"].forEach(function(type){var filtered=codecs.filter(function(codec){return Object(_utils_codecs__WEBPACK_IMPORTED_MODULE_7__.isCodecType)(codec,type)});if(filtered.length){var preferred=filtered.filter(function(codec){return 0===codec.lastIndexOf("avc1",0)||0===codec.lastIndexOf("mp4a",0)});level[type+"Codec"]=preferred.length>0?preferred[0]:filtered[0],codecs=codecs.filter(function(codec){return-1===filtered.indexOf(codec)})}}),level.unknownCodecs=codecs}function assignCodec(media,groupItem,codecProperty){var codecValue=groupItem[codecProperty];codecValue&&(media[codecProperty]=codecValue)}function assignProgramDateTime(frag,prevFrag){frag.rawProgramDateTime?frag.programDateTime=Date.parse(frag.rawProgramDateTime):null!=prevFrag&&prevFrag.programDateTime&&(frag.programDateTime=prevFrag.endProgramDateTime),Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(frag.programDateTime)||(frag.programDateTime=null,frag.rawProgramDateTime=null)}},"./src/loader/playlist-loader.ts":
/*!***************************************!*\
        !*** ./src/loader/playlist-loader.ts ***!
        \***************************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_848176__){"use strict";__nested_webpack_require_848176__.r(__webpack_exports__);var _home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_848176__(
/*! ./src/polyfills/number */
"./src/polyfills/number.ts"),_events__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_848176__(
/*! ../events */
"./src/events.ts"),_errors__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_848176__(
/*! ../errors */
"./src/errors.ts"),_utils_logger__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_848176__(
/*! ../utils/logger */
"./src/utils/logger.ts"),_utils_mp4_tools__WEBPACK_IMPORTED_MODULE_4__=__nested_webpack_require_848176__(
/*! ../utils/mp4-tools */
"./src/utils/mp4-tools.ts"),_m3u8_parser__WEBPACK_IMPORTED_MODULE_5__=__nested_webpack_require_848176__(
/*! ./m3u8-parser */
"./src/loader/m3u8-parser.ts"),_types_loader__WEBPACK_IMPORTED_MODULE_6__=__nested_webpack_require_848176__(
/*! ../types/loader */
"./src/types/loader.ts"),_utils_attr_list__WEBPACK_IMPORTED_MODULE_7__=__nested_webpack_require_848176__(
/*! ../utils/attr-list */
"./src/utils/attr-list.ts");function getResponseUrl(response,context){var url=response.url;return void 0!==url&&0!==url.indexOf("data:")||(url=context.url),url}__webpack_exports__.default=function(){function PlaylistLoader(hls){this.hls=void 0,this.loaders=Object.create(null),this.hls=hls,this.registerListeners()}var _proto=PlaylistLoader.prototype;return _proto.registerListeners=function(){var hls=this.hls;hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.LEVEL_LOADING,this.onLevelLoading,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),hls.on(_events__WEBPACK_IMPORTED_MODULE_1__.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},_proto.unregisterListeners=function(){var hls=this.hls;hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.LEVEL_LOADING,this.onLevelLoading,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),hls.off(_events__WEBPACK_IMPORTED_MODULE_1__.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},_proto.createInternalLoader=function(context){var config=this.hls.config,loader=new(config.pLoader||config.loader)(config);return context.loader=loader,this.loaders[context.type]=loader,loader},_proto.getInternalLoader=function(context){return this.loaders[context.type]},_proto.resetInternalLoader=function(contextType){this.loaders[contextType]&&delete this.loaders[contextType]},_proto.destroyInternalLoaders=function(){for(var contextType in this.loaders){var loader=this.loaders[contextType];loader&&loader.destroy(),this.resetInternalLoader(contextType)}},_proto.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},_proto.onManifestLoading=function(event,data){this.load({id:null,groupId:null,level:0,responseType:"text",type:_types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistContextType.MANIFEST,url:data.url,deliveryDirectives:null})},_proto.onLevelLoading=function(event,data){this.load({id:data.id,groupId:null,level:data.level,responseType:"text",type:_types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistContextType.LEVEL,url:data.url,deliveryDirectives:data.deliveryDirectives})},_proto.onAudioTrackLoading=function(event,data){this.load({id:data.id,groupId:data.groupId,level:null,responseType:"text",type:_types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistContextType.AUDIO_TRACK,url:data.url,deliveryDirectives:data.deliveryDirectives})},_proto.onSubtitleTrackLoading=function(event,data){this.load({id:data.id,groupId:data.groupId,level:null,responseType:"text",type:_types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistContextType.SUBTITLE_TRACK,url:data.url,deliveryDirectives:data.deliveryDirectives})},_proto.load=function(context){var _context$deliveryDire,maxRetry,timeout,retryDelay,maxRetryDelay,levelDetails,config=this.hls.config,loader=this.getInternalLoader(context);if(loader){var loaderContext=loader.context;if(loaderContext&&loaderContext.url===context.url)return void _utils_logger__WEBPACK_IMPORTED_MODULE_3__.logger.trace("[playlist-loader]: playlist request ongoing");_utils_logger__WEBPACK_IMPORTED_MODULE_3__.logger.log("[playlist-loader]: aborting previous loader for type: "+context.type),loader.abort()}switch(context.type){case _types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistContextType.MANIFEST:maxRetry=config.manifestLoadingMaxRetry,timeout=config.manifestLoadingTimeOut,retryDelay=config.manifestLoadingRetryDelay,maxRetryDelay=config.manifestLoadingMaxRetryTimeout;break;case _types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistContextType.LEVEL:case _types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistContextType.AUDIO_TRACK:case _types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistContextType.SUBTITLE_TRACK:maxRetry=0,timeout=config.levelLoadingTimeOut;break;default:maxRetry=config.levelLoadingMaxRetry,timeout=config.levelLoadingTimeOut,retryDelay=config.levelLoadingRetryDelay,maxRetryDelay=config.levelLoadingMaxRetryTimeout}if(loader=this.createInternalLoader(context),null!==(_context$deliveryDire=context.deliveryDirectives)&&void 0!==_context$deliveryDire&&_context$deliveryDire.part&&(context.type===_types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistContextType.LEVEL&&null!==context.level?levelDetails=this.hls.levels[context.level].details:context.type===_types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistContextType.AUDIO_TRACK&&null!==context.id?levelDetails=this.hls.audioTracks[context.id].details:context.type===_types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistContextType.SUBTITLE_TRACK&&null!==context.id&&(levelDetails=this.hls.subtitleTracks[context.id].details),levelDetails)){var partTarget=levelDetails.partTarget,targetDuration=levelDetails.targetduration;partTarget&&targetDuration&&(timeout=Math.min(1e3*Math.max(3*partTarget,.8*targetDuration),timeout))}var loaderConfig={timeout:timeout,maxRetry:maxRetry,retryDelay:retryDelay,maxRetryDelay:maxRetryDelay,highWaterMark:0},loaderCallbacks={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};loader.load(context,loaderConfig,loaderCallbacks)},_proto.loadsuccess=function(response,stats,context,networkDetails){if(void 0===networkDetails&&(networkDetails=null),context.isSidxRequest)return this.handleSidxRequest(response,context),void this.handlePlaylistLoaded(response,stats,context,networkDetails);this.resetInternalLoader(context.type);var string=response.data;0===string.indexOf("#EXTM3U")?(stats.parsing.start=performance.now(),string.indexOf("#EXTINF:")>0||string.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(response,stats,context,networkDetails):this.handleMasterPlaylist(response,stats,context,networkDetails)):this.handleManifestParsingError(response,context,"no EXTM3U delimiter",networkDetails)},_proto.loaderror=function(response,context,networkDetails){void 0===networkDetails&&(networkDetails=null),this.handleNetworkError(context,networkDetails,!1,response)},_proto.loadtimeout=function(stats,context,networkDetails){void 0===networkDetails&&(networkDetails=null),this.handleNetworkError(context,networkDetails,!0)},_proto.handleMasterPlaylist=function(response,stats,context,networkDetails){var hls=this.hls,string=response.data,url=getResponseUrl(response,context),_M3U8Parser$parseMast=_m3u8_parser__WEBPACK_IMPORTED_MODULE_5__.default.parseMasterPlaylist(string,url),levels=_M3U8Parser$parseMast.levels,sessionData=_M3U8Parser$parseMast.sessionData;if(levels.length){var audioGroups=levels.map(function(level){return{id:level.attrs.AUDIO,audioCodec:level.audioCodec}}),subtitleGroups=levels.map(function(level){return{id:level.attrs.SUBTITLES,textCodec:level.textCodec}}),audioTracks=_m3u8_parser__WEBPACK_IMPORTED_MODULE_5__.default.parseMasterPlaylistMedia(string,url,"AUDIO",audioGroups),subtitles=_m3u8_parser__WEBPACK_IMPORTED_MODULE_5__.default.parseMasterPlaylistMedia(string,url,"SUBTITLES",subtitleGroups),captions=_m3u8_parser__WEBPACK_IMPORTED_MODULE_5__.default.parseMasterPlaylistMedia(string,url,"CLOSED-CAPTIONS");audioTracks.length&&(audioTracks.some(function(audioTrack){return!audioTrack.url})||!levels[0].audioCodec||levels[0].attrs.AUDIO||(_utils_logger__WEBPACK_IMPORTED_MODULE_3__.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),audioTracks.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new _utils_attr_list__WEBPACK_IMPORTED_MODULE_7__.AttrList({}),bitrate:0,url:""}))),hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.MANIFEST_LOADED,{levels:levels,audioTracks:audioTracks,subtitles:subtitles,captions:captions,url:url,stats:stats,networkDetails:networkDetails,sessionData:sessionData})}else this.handleManifestParsingError(response,context,"no level found in manifest",networkDetails)},_proto.handleTrackOrLevelPlaylist=function(response,stats,context,networkDetails){var hls=this.hls,id=context.id,level=context.level,type=context.type,url=getResponseUrl(response,context),levelUrlId=Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(id)?id:0,levelId=Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(level)?level:levelUrlId,levelType=function(context){switch(context.type){case _types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistContextType.AUDIO_TRACK:return _types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistLevelType.AUDIO;case _types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistContextType.SUBTITLE_TRACK:return _types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistLevelType.SUBTITLE;default:return _types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistLevelType.MAIN}}(context),levelDetails=_m3u8_parser__WEBPACK_IMPORTED_MODULE_5__.default.parseLevelPlaylist(response.data,url,levelId,levelType,levelUrlId);if(levelDetails.fragments.length){if(type===_types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistContextType.MANIFEST){var singleLevel={attrs:new _utils_attr_list__WEBPACK_IMPORTED_MODULE_7__.AttrList({}),bitrate:0,details:levelDetails,name:"",url:url};hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.MANIFEST_LOADED,{levels:[singleLevel],audioTracks:[],url:url,stats:stats,networkDetails:networkDetails,sessionData:null})}if(stats.parsing.end=performance.now(),levelDetails.needSidxRanges){var _levelDetails$fragmen,sidxUrl=null===(_levelDetails$fragmen=levelDetails.fragments[0].initSegment)||void 0===_levelDetails$fragmen?void 0:_levelDetails$fragmen.url;this.load({url:sidxUrl,isSidxRequest:!0,type:type,level:level,levelDetails:levelDetails,id:id,groupId:null,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer",deliveryDirectives:null})}else context.levelDetails=levelDetails,this.handlePlaylistLoaded(response,stats,context,networkDetails)}else hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_2__.ErrorTypes.NETWORK_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_2__.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:url,reason:"no fragments found in level",level:"number"==typeof context.level?context.level:void 0})},_proto.handleSidxRequest=function(response,context){var sidxInfo=Object(_utils_mp4_tools__WEBPACK_IMPORTED_MODULE_4__.parseSegmentIndex)(new Uint8Array(response.data));if(sidxInfo){var levelDetails=context.levelDetails;sidxInfo.references.forEach(function(segmentRef,index){var segRefInfo=segmentRef.info,frag=levelDetails.fragments[index];0===frag.byteRange.length&&frag.setByteRange(String(1+segRefInfo.end-segRefInfo.start)+"@"+String(segRefInfo.start)),frag.initSegment&&frag.initSegment.setByteRange(String(sidxInfo.moovEndOffset)+"@0")})}},_proto.handleManifestParsingError=function(response,context,reason,networkDetails){this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_2__.ErrorTypes.NETWORK_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_2__.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:context.type===_types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistContextType.MANIFEST,url:response.url,reason:reason,response:response,context:context,networkDetails:networkDetails})},_proto.handleNetworkError=function(context,networkDetails,timeout,response){void 0===timeout&&(timeout=!1),_utils_logger__WEBPACK_IMPORTED_MODULE_3__.logger.warn("[playlist-loader]: A network "+(timeout?"timeout":"error")+" occurred while loading "+context.type+" level: "+context.level+" id: "+context.id+' group-id: "'+context.groupId+'"');var details=_errors__WEBPACK_IMPORTED_MODULE_2__.ErrorDetails.UNKNOWN,fatal=!1,loader=this.getInternalLoader(context);switch(context.type){case _types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistContextType.MANIFEST:details=timeout?_errors__WEBPACK_IMPORTED_MODULE_2__.ErrorDetails.MANIFEST_LOAD_TIMEOUT:_errors__WEBPACK_IMPORTED_MODULE_2__.ErrorDetails.MANIFEST_LOAD_ERROR,fatal=!0;break;case _types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistContextType.LEVEL:details=timeout?_errors__WEBPACK_IMPORTED_MODULE_2__.ErrorDetails.LEVEL_LOAD_TIMEOUT:_errors__WEBPACK_IMPORTED_MODULE_2__.ErrorDetails.LEVEL_LOAD_ERROR,fatal=!1;break;case _types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistContextType.AUDIO_TRACK:details=timeout?_errors__WEBPACK_IMPORTED_MODULE_2__.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:_errors__WEBPACK_IMPORTED_MODULE_2__.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal=!1;break;case _types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistContextType.SUBTITLE_TRACK:details=timeout?_errors__WEBPACK_IMPORTED_MODULE_2__.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:_errors__WEBPACK_IMPORTED_MODULE_2__.ErrorDetails.SUBTITLE_LOAD_ERROR,fatal=!1}loader&&this.resetInternalLoader(context.type);var errorData={type:_errors__WEBPACK_IMPORTED_MODULE_2__.ErrorTypes.NETWORK_ERROR,details:details,fatal:fatal,url:context.url,loader:loader,context:context,networkDetails:networkDetails};response&&(errorData.response=response),this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.ERROR,errorData)},_proto.handlePlaylistLoaded=function(response,stats,context,networkDetails){var type=context.type,level=context.level,id=context.id,groupId=context.groupId,loader=context.loader,levelDetails=context.levelDetails,deliveryDirectives=context.deliveryDirectives;if(null!=levelDetails&&levelDetails.targetduration){if(loader)switch(levelDetails.live&&(loader.getCacheAge&&(levelDetails.ageHeader=loader.getCacheAge()||0),loader.getCacheAge&&!isNaN(levelDetails.ageHeader)||(levelDetails.ageHeader=0)),type){case _types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistContextType.MANIFEST:case _types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistContextType.LEVEL:this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.LEVEL_LOADED,{details:levelDetails,level:level||0,id:id||0,stats:stats,networkDetails:networkDetails,deliveryDirectives:deliveryDirectives});break;case _types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.AUDIO_TRACK_LOADED,{details:levelDetails,id:id||0,groupId:groupId||"",stats:stats,networkDetails:networkDetails,deliveryDirectives:deliveryDirectives});break;case _types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(_events__WEBPACK_IMPORTED_MODULE_1__.Events.SUBTITLE_TRACK_LOADED,{details:levelDetails,id:id||0,groupId:groupId||"",stats:stats,networkDetails:networkDetails,deliveryDirectives:deliveryDirectives})}}else this.handleManifestParsingError(response,context,"invalid target duration",networkDetails)},PlaylistLoader}()},"./src/polyfills/number.ts":
/*!*********************************!*\
        !*** ./src/polyfills/number.ts ***!
        \*********************************/
/*! exports provided: isFiniteNumber, MAX_SAFE_INTEGER */
function(module,__webpack_exports__,__nested_webpack_require_876853__){"use strict";__nested_webpack_require_876853__.r(__webpack_exports__),__nested_webpack_require_876853__.d(__webpack_exports__,"isFiniteNumber",function(){return isFiniteNumber}),__nested_webpack_require_876853__.d(__webpack_exports__,"MAX_SAFE_INTEGER",function(){return MAX_SAFE_INTEGER});var isFiniteNumber=Number.isFinite||function(value){return"number"==typeof value&&isFinite(value)},MAX_SAFE_INTEGER=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/remux/aac-helper.ts":
/*!*********************************!*\
        !*** ./src/remux/aac-helper.ts ***!
        \*********************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_877834__){"use strict";__nested_webpack_require_877834__.r(__webpack_exports__),__webpack_exports__.default=function(){function AAC(){}return AAC.getSilentFrame=function(codec,channelCount){if("mp4a.40.2"===codec){if(1===channelCount)return new Uint8Array([0,200,0,128,35,128]);if(2===channelCount)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===channelCount)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===channelCount)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===channelCount)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===channelCount)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===channelCount)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===channelCount)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===channelCount)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}},AAC}()},"./src/remux/mp4-generator.ts":
/*!************************************!*\
        !*** ./src/remux/mp4-generator.ts ***!
        \************************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_881802__){"use strict";__nested_webpack_require_881802__.r(__webpack_exports__);var UINT32_MAX=Math.pow(2,32)-1,MP4=function(){function MP4(){}return MP4.init=function(){var i;for(i in MP4.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]})MP4.types.hasOwnProperty(i)&&(MP4.types[i]=[i.charCodeAt(0),i.charCodeAt(1),i.charCodeAt(2),i.charCodeAt(3)]);var videoHdlr=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),audioHdlr=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);MP4.HDLR_TYPES={video:videoHdlr,audio:audioHdlr};var dref=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),stco=new Uint8Array([0,0,0,0,0,0,0,0]);MP4.STTS=MP4.STSC=MP4.STCO=stco,MP4.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),MP4.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),MP4.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),MP4.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var majorBrand=new Uint8Array([105,115,111,109]),avc1Brand=new Uint8Array([97,118,99,49]),minorVersion=new Uint8Array([0,0,0,1]);MP4.FTYP=MP4.box(MP4.types.ftyp,majorBrand,minorVersion,majorBrand,avc1Brand),MP4.DINF=MP4.box(MP4.types.dinf,MP4.box(MP4.types.dref,dref))},MP4.box=function(type){for(var size=8,_len=arguments.length,payload=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)payload[_key-1]=arguments[_key];for(var i=payload.length,len=i;i--;)size+=payload[i].byteLength;var result=new Uint8Array(size);for(result[0]=size>>24&255,result[1]=size>>16&255,result[2]=size>>8&255,result[3]=255&size,result.set(type,4),i=0,size=8;i<len;i++)result.set(payload[i],size),size+=payload[i].byteLength;return result},MP4.hdlr=function(type){return MP4.box(MP4.types.hdlr,MP4.HDLR_TYPES[type])},MP4.mdat=function(data){return MP4.box(MP4.types.mdat,data)},MP4.mdhd=function(timescale,duration){duration*=timescale;var upperWordDuration=Math.floor(duration/(UINT32_MAX+1)),lowerWordDuration=Math.floor(duration%(UINT32_MAX+1));return MP4.box(MP4.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,timescale>>24&255,timescale>>16&255,timescale>>8&255,255&timescale,upperWordDuration>>24,upperWordDuration>>16&255,upperWordDuration>>8&255,255&upperWordDuration,lowerWordDuration>>24,lowerWordDuration>>16&255,lowerWordDuration>>8&255,255&lowerWordDuration,85,196,0,0]))},MP4.mdia=function(track){return MP4.box(MP4.types.mdia,MP4.mdhd(track.timescale,track.duration),MP4.hdlr(track.type),MP4.minf(track))},MP4.mfhd=function(sequenceNumber){return MP4.box(MP4.types.mfhd,new Uint8Array([0,0,0,0,sequenceNumber>>24,sequenceNumber>>16&255,sequenceNumber>>8&255,255&sequenceNumber]))},MP4.minf=function(track){return MP4.box(MP4.types.minf,"audio"===track.type?MP4.box(MP4.types.smhd,MP4.SMHD):MP4.box(MP4.types.vmhd,MP4.VMHD),MP4.DINF,MP4.stbl(track))},MP4.moof=function(sn,baseMediaDecodeTime,track){return MP4.box(MP4.types.moof,MP4.mfhd(sn),MP4.traf(track,baseMediaDecodeTime))},MP4.moov=function(tracks){for(var i=tracks.length,boxes=[];i--;)boxes[i]=MP4.trak(tracks[i]);return MP4.box.apply(null,[MP4.types.moov,MP4.mvhd(tracks[0].timescale,tracks[0].duration)].concat(boxes).concat(MP4.mvex(tracks)))},MP4.mvex=function(tracks){for(var i=tracks.length,boxes=[];i--;)boxes[i]=MP4.trex(tracks[i]);return MP4.box.apply(null,[MP4.types.mvex].concat(boxes))},MP4.mvhd=function(timescale,duration){duration*=timescale;var upperWordDuration=Math.floor(duration/(UINT32_MAX+1)),lowerWordDuration=Math.floor(duration%(UINT32_MAX+1)),bytes=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,timescale>>24&255,timescale>>16&255,timescale>>8&255,255&timescale,upperWordDuration>>24,upperWordDuration>>16&255,upperWordDuration>>8&255,255&upperWordDuration,lowerWordDuration>>24,lowerWordDuration>>16&255,lowerWordDuration>>8&255,255&lowerWordDuration,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return MP4.box(MP4.types.mvhd,bytes)},MP4.sdtp=function(track){var i,flags,samples=track.samples||[],bytes=new Uint8Array(4+samples.length);for(i=0;i<samples.length;i++)bytes[i+4]=(flags=samples[i].flags).dependsOn<<4|flags.isDependedOn<<2|flags.hasRedundancy;return MP4.box(MP4.types.sdtp,bytes)},MP4.stbl=function(track){return MP4.box(MP4.types.stbl,MP4.stsd(track),MP4.box(MP4.types.stts,MP4.STTS),MP4.box(MP4.types.stsc,MP4.STSC),MP4.box(MP4.types.stsz,MP4.STSZ),MP4.box(MP4.types.stco,MP4.STCO))},MP4.avc1=function(track){var i,data,len,sps=[],pps=[];for(i=0;i<track.sps.length;i++)sps.push((len=(data=track.sps[i]).byteLength)>>>8&255),sps.push(255&len),sps=sps.concat(Array.prototype.slice.call(data));for(i=0;i<track.pps.length;i++)pps.push((len=(data=track.pps[i]).byteLength)>>>8&255),pps.push(255&len),pps=pps.concat(Array.prototype.slice.call(data));var avcc=MP4.box(MP4.types.avcC,new Uint8Array([1,sps[3],sps[4],sps[5],255,224|track.sps.length].concat(sps).concat([track.pps.length]).concat(pps))),width=track.width,height=track.height,hSpacing=track.pixelRatio[0],vSpacing=track.pixelRatio[1];return MP4.box(MP4.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,width>>8&255,255&width,height>>8&255,255&height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),avcc,MP4.box(MP4.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),MP4.box(MP4.types.pasp,new Uint8Array([hSpacing>>24,hSpacing>>16&255,hSpacing>>8&255,255&hSpacing,vSpacing>>24,vSpacing>>16&255,vSpacing>>8&255,255&vSpacing])))},MP4.esds=function(track){var configlen=track.config.length;return new Uint8Array([0,0,0,0,3,23+configlen,0,1,0,4,15+configlen,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([configlen]).concat(track.config).concat([6,1,2]))},MP4.mp4a=function(track){var samplerate=track.samplerate;return MP4.box(MP4.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,track.channelCount,0,16,0,0,0,0,samplerate>>8&255,255&samplerate,0,0]),MP4.box(MP4.types.esds,MP4.esds(track)))},MP4.mp3=function(track){var samplerate=track.samplerate;return MP4.box(MP4.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,track.channelCount,0,16,0,0,0,0,samplerate>>8&255,255&samplerate,0,0]))},MP4.stsd=function(track){return MP4.box(MP4.types.stsd,MP4.STSD,"audio"===track.type?track.isAAC||"mp3"!==track.codec?MP4.mp4a(track):MP4.mp3(track):MP4.avc1(track))},MP4.tkhd=function(track){var id=track.id,duration=track.duration*track.timescale,width=track.width,height=track.height,upperWordDuration=Math.floor(duration/(UINT32_MAX+1)),lowerWordDuration=Math.floor(duration%(UINT32_MAX+1));return MP4.box(MP4.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,id>>24&255,id>>16&255,id>>8&255,255&id,0,0,0,0,upperWordDuration>>24,upperWordDuration>>16&255,upperWordDuration>>8&255,255&upperWordDuration,lowerWordDuration>>24,lowerWordDuration>>16&255,lowerWordDuration>>8&255,255&lowerWordDuration,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,width>>8&255,255&width,0,0,height>>8&255,255&height,0,0]))},MP4.traf=function(track,baseMediaDecodeTime){var sampleDependencyTable=MP4.sdtp(track),id=track.id,upperWordBaseMediaDecodeTime=Math.floor(baseMediaDecodeTime/(UINT32_MAX+1)),lowerWordBaseMediaDecodeTime=Math.floor(baseMediaDecodeTime%(UINT32_MAX+1));return MP4.box(MP4.types.traf,MP4.box(MP4.types.tfhd,new Uint8Array([0,0,0,0,id>>24,id>>16&255,id>>8&255,255&id])),MP4.box(MP4.types.tfdt,new Uint8Array([1,0,0,0,upperWordBaseMediaDecodeTime>>24,upperWordBaseMediaDecodeTime>>16&255,upperWordBaseMediaDecodeTime>>8&255,255&upperWordBaseMediaDecodeTime,lowerWordBaseMediaDecodeTime>>24,lowerWordBaseMediaDecodeTime>>16&255,lowerWordBaseMediaDecodeTime>>8&255,255&lowerWordBaseMediaDecodeTime])),MP4.trun(track,sampleDependencyTable.length+16+20+8+16+8+8),sampleDependencyTable)},MP4.trak=function(track){return track.duration=track.duration||4294967295,MP4.box(MP4.types.trak,MP4.tkhd(track),MP4.mdia(track))},MP4.trex=function(track){var id=track.id;return MP4.box(MP4.types.trex,new Uint8Array([0,0,0,0,id>>24,id>>16&255,id>>8&255,255&id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},MP4.trun=function(track,offset){var i,sample,duration,size,flags,cts,samples=track.samples||[],len=samples.length,arraylen=12+16*len,array=new Uint8Array(arraylen);for(array.set([0,0,15,1,len>>>24&255,len>>>16&255,len>>>8&255,255&len,(offset+=8+arraylen)>>>24&255,offset>>>16&255,offset>>>8&255,255&offset],0),i=0;i<len;i++)array.set([(duration=(sample=samples[i]).duration)>>>24&255,duration>>>16&255,duration>>>8&255,255&duration,(size=sample.size)>>>24&255,size>>>16&255,size>>>8&255,255&size,(flags=sample.flags).isLeading<<2|flags.dependsOn,flags.isDependedOn<<6|flags.hasRedundancy<<4|flags.paddingValue<<1|flags.isNonSync,61440&flags.degradPrio,15&flags.degradPrio,(cts=sample.cts)>>>24&255,cts>>>16&255,cts>>>8&255,255&cts],12+16*i);return MP4.box(MP4.types.trun,array)},MP4.initSegment=function(tracks){MP4.types||MP4.init();var movie=MP4.moov(tracks),result=new Uint8Array(MP4.FTYP.byteLength+movie.byteLength);return result.set(MP4.FTYP),result.set(movie,MP4.FTYP.byteLength),result},MP4}();MP4.types=void 0,MP4.HDLR_TYPES=void 0,MP4.STTS=void 0,MP4.STSC=void 0,MP4.STCO=void 0,MP4.STSZ=void 0,MP4.VMHD=void 0,MP4.SMHD=void 0,MP4.STSD=void 0,MP4.FTYP=void 0,MP4.DINF=void 0,__webpack_exports__.default=MP4},"./src/remux/mp4-remuxer.ts":
/*!**********************************!*\
        !*** ./src/remux/mp4-remuxer.ts ***!
        \**********************************/
/*! exports provided: default, normalizePts */
function(module,__webpack_exports__,__nested_webpack_require_904423__){"use strict";__nested_webpack_require_904423__.r(__webpack_exports__),__nested_webpack_require_904423__.d(__webpack_exports__,"default",function(){return MP4Remuxer}),__nested_webpack_require_904423__.d(__webpack_exports__,"normalizePts",function(){return normalizePts});var _home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_904423__(
/*! ./src/polyfills/number */
"./src/polyfills/number.ts"),_aac_helper__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_904423__(
/*! ./aac-helper */
"./src/remux/aac-helper.ts"),_mp4_generator__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_904423__(
/*! ./mp4-generator */
"./src/remux/mp4-generator.ts"),_events__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_904423__(
/*! ../events */
"./src/events.ts"),_errors__WEBPACK_IMPORTED_MODULE_4__=__nested_webpack_require_904423__(
/*! ../errors */
"./src/errors.ts"),_utils_logger__WEBPACK_IMPORTED_MODULE_5__=__nested_webpack_require_904423__(
/*! ../utils/logger */
"./src/utils/logger.ts"),_types_loader__WEBPACK_IMPORTED_MODULE_6__=__nested_webpack_require_904423__(
/*! ../types/loader */
"./src/types/loader.ts"),_utils_timescale_conversion__WEBPACK_IMPORTED_MODULE_7__=__nested_webpack_require_904423__(
/*! ../utils/timescale-conversion */
"./src/utils/timescale-conversion.ts");function _extends(){return _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}var chromeVersion=null,safariWebkitVersion=null,requiresPositiveDts=!1,MP4Remuxer=function(){function MP4Remuxer(observer,config,typeSupported,vendor){if(void 0===vendor&&(vendor=""),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=observer,this.config=config,this.typeSupported=typeSupported,this.ISGenerated=!1,null===chromeVersion){var result=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);chromeVersion=result?parseInt(result[1]):0}if(null===safariWebkitVersion){var _result=navigator.userAgent.match(/Safari\/(\d+)/i);safariWebkitVersion=_result?parseInt(_result[1]):0}requiresPositiveDts=!!chromeVersion&&chromeVersion<75||!!safariWebkitVersion&&safariWebkitVersion<600}var _proto=MP4Remuxer.prototype;return _proto.destroy=function(){},_proto.resetTimeStamp=function(defaultTimeStamp){_utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=defaultTimeStamp},_proto.resetNextTimestamp=function(){_utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},_proto.resetInitSegment=function(){_utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},_proto.getVideoStartPts=function(videoSamples){var rolloverDetected=!1,startPTS=videoSamples.reduce(function(minPTS,sample){var delta=sample.pts-minPTS;return delta<-4294967296?(rolloverDetected=!0,normalizePts(minPTS,sample.pts)):delta>0?minPTS:sample.pts},videoSamples[0].pts);return rolloverDetected&&_utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.debug("PTS rollover detected"),startPTS},_proto.remux=function(audioTrack,videoTrack,id3Track,textTrack,timeOffset,accurateTimeOffset,flush,playlistType){var video,audio,initSegment,text,id3,independent,audioTimeOffset=timeOffset,videoTimeOffset=timeOffset,hasVideo=videoTrack.pid>-1,length=videoTrack.samples.length,enoughAudioSamples=audioTrack.samples.length>0,enoughVideoSamples=length>1;if((!(audioTrack.pid>-1)||enoughAudioSamples)&&(!hasVideo||enoughVideoSamples)||this.ISGenerated||flush){this.ISGenerated||(initSegment=this.generateIS(audioTrack,videoTrack,timeOffset));var isVideoContiguous=this.isVideoContiguous,firstKeyFrameIndex=-1;if(enoughVideoSamples&&(firstKeyFrameIndex=function(samples){for(var i=0;i<samples.length;i++)if(samples[i].key)return i;return-1}(videoTrack.samples),!isVideoContiguous&&this.config.forceKeyFrameOnDiscontinuity))if(independent=!0,firstKeyFrameIndex>0){_utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.warn("[mp4-remuxer]: Dropped "+firstKeyFrameIndex+" out of "+length+" video samples due to a missing keyframe");var startPTS=this.getVideoStartPts(videoTrack.samples);videoTrack.samples=videoTrack.samples.slice(firstKeyFrameIndex),videoTrack.dropped+=firstKeyFrameIndex,videoTimeOffset+=(videoTrack.samples[0].pts-startPTS)/(videoTrack.timescale||9e4)}else-1===firstKeyFrameIndex&&(_utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.warn("[mp4-remuxer]: No keyframe found out of "+length+" video samples"),independent=!1);if(this.ISGenerated){if(enoughAudioSamples&&enoughVideoSamples){var _startPTS=this.getVideoStartPts(videoTrack.samples),audiovideoTimestampDelta=(normalizePts(audioTrack.samples[0].pts,_startPTS)-_startPTS)/videoTrack.inputTimeScale;audioTimeOffset+=Math.max(0,audiovideoTimestampDelta),videoTimeOffset+=Math.max(0,-audiovideoTimestampDelta)}if(enoughAudioSamples){if(audioTrack.samplerate||(_utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),initSegment=this.generateIS(audioTrack,videoTrack,timeOffset)),audio=this.remuxAudio(audioTrack,audioTimeOffset,this.isAudioContiguous,accurateTimeOffset,hasVideo||enoughVideoSamples||playlistType===_types_loader__WEBPACK_IMPORTED_MODULE_6__.PlaylistLevelType.AUDIO?videoTimeOffset:void 0),enoughVideoSamples){var audioTrackLength=audio?audio.endPTS-audio.startPTS:0;videoTrack.inputTimeScale||(_utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),initSegment=this.generateIS(audioTrack,videoTrack,timeOffset)),video=this.remuxVideo(videoTrack,videoTimeOffset,isVideoContiguous,audioTrackLength)}}else enoughVideoSamples&&(video=this.remuxVideo(videoTrack,videoTimeOffset,isVideoContiguous,0));video&&(video.firstKeyFrame=firstKeyFrameIndex,video.independent=-1!==firstKeyFrameIndex)}}return this.ISGenerated&&(id3Track.samples.length&&(id3=this.remuxID3(id3Track,timeOffset)),textTrack.samples.length&&(text=this.remuxText(textTrack,timeOffset))),{audio:audio,video:video,initSegment:initSegment,independent:independent,text:text,id3:id3}},_proto.generateIS=function(audioTrack,videoTrack,timeOffset){var initPTS,initDTS,timescale,audioSamples=audioTrack.samples,videoSamples=videoTrack.samples,typeSupported=this.typeSupported,tracks={},computePTSDTS=!Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(this._initPTS),container="audio/mp4";if(computePTSDTS&&(initPTS=initDTS=1/0),audioTrack.config&&audioSamples.length&&(audioTrack.timescale=audioTrack.samplerate,audioTrack.isAAC||(typeSupported.mpeg?(container="audio/mpeg",audioTrack.codec=""):typeSupported.mp3&&(audioTrack.codec="mp3")),tracks.audio={id:"audio",container:container,codec:audioTrack.codec,initSegment:!audioTrack.isAAC&&typeSupported.mpeg?new Uint8Array(0):_mp4_generator__WEBPACK_IMPORTED_MODULE_2__.default.initSegment([audioTrack]),metadata:{channelCount:audioTrack.channelCount}},computePTSDTS&&(timescale=audioTrack.inputTimeScale,initPTS=initDTS=audioSamples[0].pts-Math.round(timescale*timeOffset))),videoTrack.sps&&videoTrack.pps&&videoSamples.length&&(videoTrack.timescale=videoTrack.inputTimeScale,tracks.video={id:"main",container:"video/mp4",codec:videoTrack.codec,initSegment:_mp4_generator__WEBPACK_IMPORTED_MODULE_2__.default.initSegment([videoTrack]),metadata:{width:videoTrack.width,height:videoTrack.height}},computePTSDTS)){timescale=videoTrack.inputTimeScale;var startPTS=this.getVideoStartPts(videoSamples),startOffset=Math.round(timescale*timeOffset);initDTS=Math.min(initDTS,normalizePts(videoSamples[0].dts,startPTS)-startOffset),initPTS=Math.min(initPTS,startPTS-startOffset)}if(Object.keys(tracks).length)return this.ISGenerated=!0,computePTSDTS&&(this._initPTS=initPTS,this._initDTS=initDTS),{tracks:tracks,initPTS:initPTS,timescale:timescale}},_proto.remuxVideo=function(track,timeOffset,contiguous,audioTrackLength){var mp4SampleDuration,firstDTS,lastDTS,timeScale=track.inputTimeScale,inputSamples=track.samples,outputSamples=[],nbSamples=inputSamples.length,initPTS=this._initPTS,nextAvcDts=this.nextAvcDts,offset=8,minPTS=Number.POSITIVE_INFINITY,maxPTS=Number.NEGATIVE_INFINITY,ptsDtsShift=0,sortSamples=!1;contiguous&&null!==nextAvcDts||(nextAvcDts=timeOffset*timeScale-(inputSamples[0].pts-normalizePts(inputSamples[0].dts,inputSamples[0].pts)));for(var i=0;i<nbSamples;i++){var sample=inputSamples[i];sample.pts=normalizePts(sample.pts-initPTS,nextAvcDts),sample.dts=normalizePts(sample.dts-initPTS,nextAvcDts),sample.dts>sample.pts&&(ptsDtsShift=Math.max(Math.min(ptsDtsShift,sample.pts-sample.dts),-18e3)),sample.dts<inputSamples[i>0?i-1:i].dts&&(sortSamples=!0)}sortSamples&&inputSamples.sort(function(a,b){return a.dts-b.dts||a.pts-b.pts}),firstDTS=inputSamples[0].dts,lastDTS=inputSamples[inputSamples.length-1].dts;var averageSampleDuration=Math.round((lastDTS-firstDTS)/(nbSamples-1));if(ptsDtsShift<0){if(ptsDtsShift<-2*averageSampleDuration){_utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+Object(_utils_timescale_conversion__WEBPACK_IMPORTED_MODULE_7__.toMsFromMpegTsClock)(-averageSampleDuration,!0)+" ms");for(var lastDts=ptsDtsShift,_i=0;_i<nbSamples;_i++)inputSamples[_i].dts=lastDts=Math.max(lastDts,inputSamples[_i].pts-averageSampleDuration),inputSamples[_i].pts=Math.max(lastDts,inputSamples[_i].pts)}else{_utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Object(_utils_timescale_conversion__WEBPACK_IMPORTED_MODULE_7__.toMsFromMpegTsClock)(ptsDtsShift,!0)+" ms to overcome this issue");for(var _i2=0;_i2<nbSamples;_i2++)inputSamples[_i2].dts=inputSamples[_i2].dts+ptsDtsShift}firstDTS=inputSamples[0].dts}if(contiguous){var delta=firstDTS-nextAvcDts,foundHole=delta>averageSampleDuration;if(foundHole||delta<-1){_utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.warn(foundHole?"AVC: "+Object(_utils_timescale_conversion__WEBPACK_IMPORTED_MODULE_7__.toMsFromMpegTsClock)(delta,!0)+" ms ("+delta+"dts) hole between fragments detected, filling it":"AVC: "+Object(_utils_timescale_conversion__WEBPACK_IMPORTED_MODULE_7__.toMsFromMpegTsClock)(-delta,!0)+" ms ("+delta+"dts) overlapping between fragments detected");var firstPTS=inputSamples[0].pts-delta;inputSamples[0].dts=firstDTS=nextAvcDts,inputSamples[0].pts=firstPTS,_utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.log("Video: First PTS/DTS adjusted: "+Object(_utils_timescale_conversion__WEBPACK_IMPORTED_MODULE_7__.toMsFromMpegTsClock)(firstPTS,!0)+"/"+Object(_utils_timescale_conversion__WEBPACK_IMPORTED_MODULE_7__.toMsFromMpegTsClock)(firstDTS,!0)+", delta: "+Object(_utils_timescale_conversion__WEBPACK_IMPORTED_MODULE_7__.toMsFromMpegTsClock)(delta,!0)+" ms")}}requiresPositiveDts&&(firstDTS=Math.max(0,firstDTS));for(var nbNalu=0,naluLen=0,_i3=0;_i3<nbSamples;_i3++){for(var _sample=inputSamples[_i3],units=_sample.units,nbUnits=units.length,sampleLen=0,j=0;j<nbUnits;j++)sampleLen+=units[j].data.length;naluLen+=sampleLen,nbNalu+=nbUnits,_sample.length=sampleLen,_sample.dts=Math.max(_sample.dts,firstDTS),_sample.pts=Math.max(_sample.pts,_sample.dts,0),minPTS=Math.min(_sample.pts,minPTS),maxPTS=Math.max(_sample.pts,maxPTS)}lastDTS=inputSamples[nbSamples-1].dts;var mdat,mdatSize=naluLen+4*nbNalu+8;try{mdat=new Uint8Array(mdatSize)}catch(err){return void this.observer.emit(_events__WEBPACK_IMPORTED_MODULE_3__.Events.ERROR,_events__WEBPACK_IMPORTED_MODULE_3__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_4__.ErrorTypes.MUX_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_4__.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:mdatSize,reason:"fail allocating video mdat "+mdatSize})}var view=new DataView(mdat.buffer);view.setUint32(0,mdatSize),mdat.set(_mp4_generator__WEBPACK_IMPORTED_MODULE_2__.default.types.mdat,4);for(var _i4=0;_i4<nbSamples;_i4++){for(var avcSample=inputSamples[_i4],avcSampleUnits=avcSample.units,mp4SampleLength=0,_j=0,_nbUnits=avcSampleUnits.length;_j<_nbUnits;_j++){var unit=avcSampleUnits[_j],unitData=unit.data,unitDataLen=unit.data.byteLength;view.setUint32(offset,unitDataLen),mdat.set(unitData,offset+=4),offset+=unitDataLen,mp4SampleLength+=4+unitDataLen}if(_i4<nbSamples-1)mp4SampleDuration=inputSamples[_i4+1].dts-avcSample.dts;else{var config=this.config,lastFrameDuration=avcSample.dts-inputSamples[_i4>0?_i4-1:_i4].dts;if(config.stretchShortVideoTrack&&null!==this.nextAudioPts){var gapTolerance=Math.floor(config.maxBufferHole*timeScale),deltaToFrameEnd=(audioTrackLength?minPTS+audioTrackLength*timeScale:this.nextAudioPts)-avcSample.pts;deltaToFrameEnd>gapTolerance?((mp4SampleDuration=deltaToFrameEnd-lastFrameDuration)<0&&(mp4SampleDuration=lastFrameDuration),_utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.log("[mp4-remuxer]: It is approximately "+deltaToFrameEnd/90+" ms to the next segment; using duration "+mp4SampleDuration/90+" ms for the last video frame.")):mp4SampleDuration=lastFrameDuration}else mp4SampleDuration=lastFrameDuration}var compositionTimeOffset=Math.round(avcSample.pts-avcSample.dts);outputSamples.push(new Mp4Sample(avcSample.key,mp4SampleDuration,mp4SampleLength,compositionTimeOffset))}if(outputSamples.length&&chromeVersion&&chromeVersion<70){var flags=outputSamples[0].flags;flags.dependsOn=2,flags.isNonSync=0}console.assert(void 0!==mp4SampleDuration,"mp4SampleDuration must be computed"),this.nextAvcDts=nextAvcDts=lastDTS+mp4SampleDuration,this.isVideoContiguous=!0;var data={data1:_mp4_generator__WEBPACK_IMPORTED_MODULE_2__.default.moof(track.sequenceNumber++,firstDTS,_extends({},track,{samples:outputSamples})),data2:mdat,startPTS:minPTS/timeScale,endPTS:(maxPTS+mp4SampleDuration)/timeScale,startDTS:firstDTS/timeScale,endDTS:nextAvcDts/timeScale,type:"video",hasAudio:!1,hasVideo:!0,nb:outputSamples.length,dropped:track.dropped};return track.samples=[],track.dropped=0,console.assert(mdat.length,"MDAT length must not be zero"),data},_proto.remuxAudio=function(track,timeOffset,contiguous,accurateTimeOffset,videoTimeOffset){var inputTimeScale=track.inputTimeScale,scaleFactor=inputTimeScale/(track.samplerate?track.samplerate:inputTimeScale),mp4SampleDuration=track.isAAC?1024:1152,inputSampleDuration=mp4SampleDuration*scaleFactor,initPTS=this._initPTS,rawMPEG=!track.isAAC&&this.typeSupported.mpeg,outputSamples=[],inputSamples=track.samples,offset=rawMPEG?0:8,nextAudioPts=this.nextAudioPts||-1,timeOffsetMpegTS=timeOffset*inputTimeScale;if(this.isAudioContiguous=contiguous=contiguous||inputSamples.length&&nextAudioPts>0&&(accurateTimeOffset&&Math.abs(timeOffsetMpegTS-nextAudioPts)<9e3||Math.abs(normalizePts(inputSamples[0].pts-initPTS,timeOffsetMpegTS)-nextAudioPts)<20*inputSampleDuration),inputSamples.forEach(function(sample){sample.pts=normalizePts(sample.pts-initPTS,timeOffsetMpegTS)}),!contiguous||nextAudioPts<0){if(inputSamples=inputSamples.filter(function(sample){return sample.pts>=0}),!inputSamples.length)return;nextAudioPts=0===videoTimeOffset?0:accurateTimeOffset?Math.max(0,timeOffsetMpegTS):inputSamples[0].pts}if(track.isAAC)for(var alignedWithVideo=void 0!==videoTimeOffset,maxAudioFramesDrift=this.config.maxAudioFramesDrift,i=0,nextPts=nextAudioPts;i<inputSamples.length;i++){var sample=inputSamples[i],pts=sample.pts,delta=pts-nextPts,duration=Math.abs(1e3*delta/inputTimeScale);if(delta<=-maxAudioFramesDrift*inputSampleDuration&&alignedWithVideo)0===i&&(_utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.warn("Audio frame @ "+(pts/inputTimeScale).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*delta/inputTimeScale)+" ms."),this.nextAudioPts=nextAudioPts=nextPts=pts);else if(delta>=maxAudioFramesDrift*inputSampleDuration&&duration<1e4&&alignedWithVideo){var missing=Math.round(delta/inputSampleDuration);(nextPts=pts-missing*inputSampleDuration)<0&&(missing--,nextPts+=inputSampleDuration),0===i&&(this.nextAudioPts=nextAudioPts=nextPts),_utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.warn("[mp4-remuxer]: Injecting "+missing+" audio frame @ "+(nextPts/inputTimeScale).toFixed(3)+"s due to "+Math.round(1e3*delta/inputTimeScale)+" ms gap.");for(var j=0;j<missing;j++){var newStamp=Math.max(nextPts,0),fillFrame=_aac_helper__WEBPACK_IMPORTED_MODULE_1__.default.getSilentFrame(track.manifestCodec||track.codec,track.channelCount);fillFrame||(_utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),fillFrame=sample.unit.subarray()),inputSamples.splice(i,0,{unit:fillFrame,pts:newStamp}),nextPts+=inputSampleDuration,i++}}sample.pts=nextPts,nextPts+=inputSampleDuration}for(var mdat,firstPTS=null,lastPTS=null,mdatSize=0,sampleLength=inputSamples.length;sampleLength--;)mdatSize+=inputSamples[sampleLength].unit.byteLength;for(var _j2=0,_nbSamples=inputSamples.length;_j2<_nbSamples;_j2++){var audioSample=inputSamples[_j2],unit=audioSample.unit,_pts=audioSample.pts;if(null!==lastPTS)outputSamples[_j2-1].duration=Math.round((_pts-lastPTS)/scaleFactor);else{if(contiguous&&track.isAAC&&(_pts=nextAudioPts),firstPTS=_pts,!(mdatSize>0))return;mdatSize+=offset;try{mdat=new Uint8Array(mdatSize)}catch(err){return void this.observer.emit(_events__WEBPACK_IMPORTED_MODULE_3__.Events.ERROR,_events__WEBPACK_IMPORTED_MODULE_3__.Events.ERROR,{type:_errors__WEBPACK_IMPORTED_MODULE_4__.ErrorTypes.MUX_ERROR,details:_errors__WEBPACK_IMPORTED_MODULE_4__.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:mdatSize,reason:"fail allocating audio mdat "+mdatSize})}rawMPEG||(new DataView(mdat.buffer).setUint32(0,mdatSize),mdat.set(_mp4_generator__WEBPACK_IMPORTED_MODULE_2__.default.types.mdat,4))}mdat.set(unit,offset);var unitLen=unit.byteLength;offset+=unitLen,outputSamples.push(new Mp4Sample(!0,mp4SampleDuration,unitLen,0)),lastPTS=_pts}var nbSamples=outputSamples.length;if(nbSamples){this.nextAudioPts=nextAudioPts=lastPTS+scaleFactor*outputSamples[outputSamples.length-1].duration;var moof=rawMPEG?new Uint8Array(0):_mp4_generator__WEBPACK_IMPORTED_MODULE_2__.default.moof(track.sequenceNumber++,firstPTS/scaleFactor,_extends({},track,{samples:outputSamples}));track.samples=[];var start=firstPTS/inputTimeScale,end=nextAudioPts/inputTimeScale,audioData={data1:moof,data2:mdat,startPTS:start,endPTS:end,startDTS:start,endDTS:end,type:"audio",hasAudio:!0,hasVideo:!1,nb:nbSamples};return this.isAudioContiguous=!0,console.assert(mdat.length,"MDAT length must not be zero"),audioData}},_proto.remuxEmptyAudio=function(track,timeOffset,contiguous,videoData){var inputTimeScale=track.inputTimeScale,nextAudioPts=this.nextAudioPts,startDTS=(null!==nextAudioPts?nextAudioPts:videoData.startDTS*inputTimeScale)+this._initDTS,frameDuration=inputTimeScale/(track.samplerate?track.samplerate:inputTimeScale)*1024,nbSamples=Math.ceil((videoData.endDTS*inputTimeScale+this._initDTS-startDTS)/frameDuration),silentFrame=_aac_helper__WEBPACK_IMPORTED_MODULE_1__.default.getSilentFrame(track.manifestCodec||track.codec,track.channelCount);if(_utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.warn("[mp4-remuxer]: remux empty Audio"),silentFrame){for(var samples=[],i=0;i<nbSamples;i++){var stamp=startDTS+i*frameDuration;samples.push({unit:silentFrame,pts:stamp,dts:stamp})}return track.samples=samples,this.remuxAudio(track,timeOffset,contiguous,!1)}_utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec")},_proto.remuxID3=function(track,timeOffset){var length=track.samples.length;if(length){for(var inputTimeScale=track.inputTimeScale,initPTS=this._initPTS,initDTS=this._initDTS,index=0;index<length;index++){var sample=track.samples[index];sample.pts=normalizePts(sample.pts-initPTS,timeOffset*inputTimeScale)/inputTimeScale,sample.dts=normalizePts(sample.dts-initDTS,timeOffset*inputTimeScale)/inputTimeScale}var samples=track.samples;return track.samples=[],{samples:samples}}},_proto.remuxText=function(track,timeOffset){var length=track.samples.length;if(length){for(var inputTimeScale=track.inputTimeScale,initPTS=this._initPTS,index=0;index<length;index++){var sample=track.samples[index];sample.pts=normalizePts(sample.pts-initPTS,timeOffset*inputTimeScale)/inputTimeScale}track.samples.sort(function(a,b){return a.pts-b.pts});var samples=track.samples;return track.samples=[],{samples:samples}}},MP4Remuxer}();function normalizePts(value,reference){var offset;if(null===reference)return value;for(offset=reference<value?-8589934592:8589934592;Math.abs(value-reference)>4294967296;)value+=offset;return value}var Mp4Sample=function(isKeyframe,duration,size,cts){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=duration,this.size=size,this.cts=cts,this.flags=new Mp4SampleFlags(isKeyframe)},Mp4SampleFlags=function(isKeyframe){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=isKeyframe?2:1,this.isNonSync=isKeyframe?0:1}},"./src/remux/passthrough-remuxer.ts":
/*!******************************************!*\
        !*** ./src/remux/passthrough-remuxer.ts ***!
        \******************************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_950328__){"use strict";__nested_webpack_require_950328__.r(__webpack_exports__);var _home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_950328__(
/*! ./src/polyfills/number */
"./src/polyfills/number.ts"),_utils_mp4_tools__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_950328__(
/*! ../utils/mp4-tools */
"./src/utils/mp4-tools.ts"),_loader_fragment__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_950328__(
/*! ../loader/fragment */
"./src/loader/fragment.ts"),_utils_logger__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_950328__(
/*! ../utils/logger */
"./src/utils/logger.ts"),PassThroughRemuxer=function(){function PassThroughRemuxer(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndDTS=null}var _proto=PassThroughRemuxer.prototype;return _proto.destroy=function(){},_proto.resetTimeStamp=function(defaultInitPTS){this.initPTS=defaultInitPTS,this.lastEndDTS=null},_proto.resetNextTimestamp=function(){this.lastEndDTS=null},_proto.resetInitSegment=function(initSegment,audioCodec,videoCodec){this.audioCodec=audioCodec,this.videoCodec=videoCodec,this.generateInitSegment(initSegment),this.emitInitSegment=!0},_proto.generateInitSegment=function(initSegment){var audioCodec=this.audioCodec,videoCodec=this.videoCodec;if(!initSegment||!initSegment.byteLength)return this.initTracks=void 0,void(this.initData=void 0);var initData=this.initData=Object(_utils_mp4_tools__WEBPACK_IMPORTED_MODULE_1__.parseInitSegment)(initSegment);audioCodec||(audioCodec=getParsedTrackCodec(initData.audio,_loader_fragment__WEBPACK_IMPORTED_MODULE_2__.ElementaryStreamTypes.AUDIO)),videoCodec||(videoCodec=getParsedTrackCodec(initData.video,_loader_fragment__WEBPACK_IMPORTED_MODULE_2__.ElementaryStreamTypes.VIDEO));var tracks={};initData.audio&&initData.video?tracks.audiovideo={container:"video/mp4",codec:audioCodec+","+videoCodec,initSegment:initSegment,id:"main"}:initData.audio?tracks.audio={container:"audio/mp4",codec:audioCodec,initSegment:initSegment,id:"audio"}:initData.video?tracks.video={container:"video/mp4",codec:videoCodec,initSegment:initSegment,id:"main"}:_utils_logger__WEBPACK_IMPORTED_MODULE_3__.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=tracks},_proto.remux=function(audioTrack,videoTrack,id3Track,textTrack,timeOffset){var initPTS=this.initPTS,lastEndDTS=this.lastEndDTS,result={audio:void 0,video:void 0,text:textTrack,id3:id3Track,initSegment:void 0};Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(lastEndDTS)||(lastEndDTS=this.lastEndDTS=timeOffset||0);var data=videoTrack.samples;if(!data||!data.length)return result;var initSegment={initPTS:void 0,timescale:1},initData=this.initData;if(initData&&initData.length||(this.generateInitSegment(data),initData=this.initData),!initData||!initData.length)return _utils_logger__WEBPACK_IMPORTED_MODULE_3__.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),result;this.emitInitSegment&&(initSegment.tracks=this.initTracks,this.emitInitSegment=!1),Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(initPTS)||(this.initPTS=initSegment.initPTS=initPTS=computeInitPTS(initData,data,lastEndDTS));var duration=Object(_utils_mp4_tools__WEBPACK_IMPORTED_MODULE_1__.getDuration)(data,initData),startDTS=lastEndDTS,endDTS=duration+startDTS;Object(_utils_mp4_tools__WEBPACK_IMPORTED_MODULE_1__.offsetStartDTS)(initData,data,initPTS),duration>0?this.lastEndDTS=endDTS:(_utils_logger__WEBPACK_IMPORTED_MODULE_3__.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var hasAudio=!!initData.audio,hasVideo=!!initData.video,type="";hasAudio&&(type+="audio"),hasVideo&&(type+="video");var track={data1:data,startPTS:startDTS,startDTS:startDTS,endPTS:endDTS,endDTS:endDTS,type:type,hasAudio:hasAudio,hasVideo:hasVideo,nb:1,dropped:0};return result.audio="audio"===track.type?track:void 0,result.video="audio"!==track.type?track:void 0,result.text=textTrack,result.id3=id3Track,result.initSegment=initSegment,result},PassThroughRemuxer}(),computeInitPTS=function(initData,data,timeOffset){return Object(_utils_mp4_tools__WEBPACK_IMPORTED_MODULE_1__.getStartDTS)(initData,data)-timeOffset};function getParsedTrackCodec(track,type){var parsedCodec=null==track?void 0:track.codec;return parsedCodec&&parsedCodec.length>4?parsedCodec:"hvc1"===parsedCodec?"hvc1.1.c.L120.90":"av01"===parsedCodec?"av01.0.04M.08":"avc1"===parsedCodec||type===_loader_fragment__WEBPACK_IMPORTED_MODULE_2__.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}__webpack_exports__.default=PassThroughRemuxer},"./src/task-loop.ts":
/*!**************************!*\
        !*** ./src/task-loop.ts ***!
        \**************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_959503__){"use strict";__nested_webpack_require_959503__.r(__webpack_exports__),__nested_webpack_require_959503__.d(__webpack_exports__,"default",function(){return TaskLoop});var TaskLoop=function(){function TaskLoop(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var _proto=TaskLoop.prototype;return _proto.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},_proto.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},_proto.onHandlerDestroyed=function(){},_proto.hasInterval=function(){return!!this._tickInterval},_proto.hasNextTick=function(){return!!this._tickTimer},_proto.setInterval=function(millis){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,millis),!0)},_proto.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},_proto.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},_proto.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},_proto.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},_proto.doTick=function(){},TaskLoop}()},"./src/types/level.ts":
/*!****************************!*\
        !*** ./src/types/level.ts ***!
        \****************************/
/*! exports provided: HlsSkip, getSkipValue, HlsUrlParameters, Level */
function(module,__webpack_exports__,__nested_webpack_require_965493__){"use strict";function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}__nested_webpack_require_965493__.r(__webpack_exports__),__nested_webpack_require_965493__.d(__webpack_exports__,"HlsSkip",function(){return HlsSkip}),__nested_webpack_require_965493__.d(__webpack_exports__,"getSkipValue",function(){return getSkipValue}),__nested_webpack_require_965493__.d(__webpack_exports__,"HlsUrlParameters",function(){return HlsUrlParameters}),__nested_webpack_require_965493__.d(__webpack_exports__,"Level",function(){return Level});var HlsSkip=function(){return function(HlsSkip){HlsSkip.No="",HlsSkip.Yes="YES",HlsSkip.v2="v2"}(HlsSkip||(HlsSkip={})),HlsSkip}();function getSkipValue(details,msn){var canSkipUntil=details.canSkipUntil;return canSkipUntil&&(void 0!==msn?msn-details.endSN:0)<canSkipUntil?details.canSkipDateRanges?HlsSkip.v2:HlsSkip.Yes:HlsSkip.No}var HlsUrlParameters=function(){function HlsUrlParameters(msn,part,skip){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=msn,this.part=part,this.skip=skip}return HlsUrlParameters.prototype.addDirectives=function(uri){var url=new self.URL(uri);return void 0!==this.msn&&url.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&url.searchParams.set("_HLS_part",this.part.toString()),this.skip&&url.searchParams.set("_HLS_skip",this.skip),url.toString()},HlsUrlParameters}(),Level=function(){function Level(data){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[data.url],this.attrs=data.attrs,this.bitrate=data.bitrate,data.details&&(this.details=data.details),this.id=data.id||0,this.name=data.name,this.width=data.width||0,this.height=data.height||0,this.audioCodec=data.audioCodec,this.videoCodec=data.videoCodec,this.unknownCodecs=data.unknownCodecs,this.codecSet=[data.videoCodec,data.audioCodec].filter(function(c){return c}).join(",").replace(/\.[^.,]+/g,"")}var Constructor,protoProps;return Constructor=Level,(protoProps=[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(value){var newValue=value%this.url.length;this._urlId!==newValue&&(this.details=void 0,this._urlId=newValue)}}])&&_defineProperties(Constructor.prototype,protoProps),Level}()},"./src/types/loader.ts":
/*!*****************************!*\
        !*** ./src/types/loader.ts ***!
        \*****************************/
/*! exports provided: PlaylistContextType, PlaylistLevelType */
function(module,__webpack_exports__,__nested_webpack_require_971096__){"use strict";__nested_webpack_require_971096__.r(__webpack_exports__),__nested_webpack_require_971096__.d(__webpack_exports__,"PlaylistContextType",function(){return PlaylistContextType}),__nested_webpack_require_971096__.d(__webpack_exports__,"PlaylistLevelType",function(){return PlaylistLevelType});var PlaylistContextType=function(){return function(PlaylistContextType){PlaylistContextType.MANIFEST="manifest",PlaylistContextType.LEVEL="level",PlaylistContextType.AUDIO_TRACK="audioTrack",PlaylistContextType.SUBTITLE_TRACK="subtitleTrack"}(PlaylistContextType||(PlaylistContextType={})),PlaylistContextType}(),PlaylistLevelType=function(){return function(PlaylistLevelType){PlaylistLevelType.MAIN="main",PlaylistLevelType.AUDIO="audio",PlaylistLevelType.SUBTITLE="subtitle"}(PlaylistLevelType||(PlaylistLevelType={})),PlaylistLevelType}()},"./src/types/transmuxer.ts":
/*!*********************************!*\
        !*** ./src/types/transmuxer.ts ***!
        \*********************************/
/*! exports provided: ChunkMetadata */
function(module,__webpack_exports__,__nested_webpack_require_972712__){"use strict";__nested_webpack_require_972712__.r(__webpack_exports__),__nested_webpack_require_972712__.d(__webpack_exports__,"ChunkMetadata",function(){return ChunkMetadata});var ChunkMetadata=function(level,sn,id,size,part,partial){void 0===size&&(size=0),void 0===part&&(part=-1),void 0===partial&&(partial=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=level,this.sn=sn,this.id=id,this.size=size,this.part=part,this.partial=partial}},"./src/utils/attr-list.ts":
/*!********************************!*\
        !*** ./src/utils/attr-list.ts ***!
        \********************************/
/*! exports provided: AttrList */
function(module,__webpack_exports__,__nested_webpack_require_974385__){"use strict";__nested_webpack_require_974385__.r(__webpack_exports__),__nested_webpack_require_974385__.d(__webpack_exports__,"AttrList",function(){return AttrList});var DECIMAL_RESOLUTION_REGEX=/^(\d+)x(\d+)$/,ATTR_LIST_REGEX=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,AttrList=function(){function AttrList(attrs){for(var attr in"string"==typeof attrs&&(attrs=AttrList.parseAttrList(attrs)),attrs)attrs.hasOwnProperty(attr)&&(this[attr]=attrs[attr])}var _proto=AttrList.prototype;return _proto.decimalInteger=function(attrName){var intValue=parseInt(this[attrName],10);return intValue>Number.MAX_SAFE_INTEGER?1/0:intValue},_proto.hexadecimalInteger=function(attrName){if(this[attrName]){var stringValue=(this[attrName]||"0x").slice(2);stringValue=(1&stringValue.length?"0":"")+stringValue;for(var value=new Uint8Array(stringValue.length/2),i=0;i<stringValue.length/2;i++)value[i]=parseInt(stringValue.slice(2*i,2*i+2),16);return value}return null},_proto.hexadecimalIntegerAsNumber=function(attrName){var intValue=parseInt(this[attrName],16);return intValue>Number.MAX_SAFE_INTEGER?1/0:intValue},_proto.decimalFloatingPoint=function(attrName){return parseFloat(this[attrName])},_proto.optionalFloat=function(attrName,defaultValue){var value=this[attrName];return value?parseFloat(value):defaultValue},_proto.enumeratedString=function(attrName){return this[attrName]},_proto.bool=function(attrName){return"YES"===this[attrName]},_proto.decimalResolution=function(attrName){var res=DECIMAL_RESOLUTION_REGEX.exec(this[attrName]);if(null!==res)return{width:parseInt(res[1],10),height:parseInt(res[2],10)}},AttrList.parseAttrList=function(input){var match,attrs={};for(ATTR_LIST_REGEX.lastIndex=0;null!==(match=ATTR_LIST_REGEX.exec(input));){var value=match[2];0===value.indexOf('"')&&value.lastIndexOf('"')===value.length-1&&(value=value.slice(1,-1)),attrs[match[1]]=value}return attrs},AttrList}()},"./src/utils/binary-search.ts":
/*!************************************!*\
        !*** ./src/utils/binary-search.ts ***!
        \************************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_978373__){"use strict";__nested_webpack_require_978373__.r(__webpack_exports__),__webpack_exports__.default={search:function(list,comparisonFn){for(var minIndex=0,maxIndex=list.length-1,currentIndex=null,currentElement=null;minIndex<=maxIndex;){var comparisonResult=comparisonFn(currentElement=list[currentIndex=(minIndex+maxIndex)/2|0]);if(comparisonResult>0)minIndex=currentIndex+1;else{if(!(comparisonResult<0))return currentElement;maxIndex=currentIndex-1}}return null}}},"./src/utils/buffer-helper.ts":
/*!************************************!*\
        !*** ./src/utils/buffer-helper.ts ***!
        \************************************/
/*! exports provided: BufferHelper */
function(module,__webpack_exports__,__nested_webpack_require_980518__){"use strict";__nested_webpack_require_980518__.r(__webpack_exports__),__nested_webpack_require_980518__.d(__webpack_exports__,"BufferHelper",function(){return BufferHelper});var _logger__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_980518__(
/*! ./logger */
"./src/utils/logger.ts"),noopBuffered={length:0,start:function(){return 0},end:function(){return 0}},BufferHelper=function(){function BufferHelper(){}return BufferHelper.isBuffered=function(media,position){try{if(media)for(var buffered=BufferHelper.getBuffered(media),i=0;i<buffered.length;i++)if(position>=buffered.start(i)&&position<=buffered.end(i))return!0}catch(error){}return!1},BufferHelper.bufferInfo=function(media,pos,maxHoleDuration){try{if(media){var i,vbuffered=BufferHelper.getBuffered(media),buffered=[];for(i=0;i<vbuffered.length;i++)buffered.push({start:vbuffered.start(i),end:vbuffered.end(i)});return this.bufferedInfo(buffered,pos,maxHoleDuration)}}catch(error){}return{len:0,start:pos,end:pos,nextStart:void 0}},BufferHelper.bufferedInfo=function(buffered,pos,maxHoleDuration){pos=Math.max(0,pos),buffered.sort(function(a,b){return a.start-b.start||b.end-a.end});var buffered2=[];if(maxHoleDuration)for(var i=0;i<buffered.length;i++){var buf2len=buffered2.length;if(buf2len){var buf2end=buffered2[buf2len-1].end;buffered[i].start-buf2end<maxHoleDuration?buffered[i].end>buf2end&&(buffered2[buf2len-1].end=buffered[i].end):buffered2.push(buffered[i])}else buffered2.push(buffered[i])}else buffered2=buffered;for(var bufferStartNext,bufferLen=0,bufferStart=pos,bufferEnd=pos,_i=0;_i<buffered2.length;_i++){var start=buffered2[_i].start,end=buffered2[_i].end;if(pos+maxHoleDuration>=start&&pos<end)bufferStart=start,bufferLen=(bufferEnd=end)-pos;else if(pos+maxHoleDuration<start){bufferStartNext=start;break}}return{len:bufferLen,start:bufferStart||0,end:bufferEnd||0,nextStart:bufferStartNext}},BufferHelper.getBuffered=function(media){try{return media.buffered}catch(e){return _logger__WEBPACK_IMPORTED_MODULE_0__.logger.log("failed to get media.buffered",e),noopBuffered}},BufferHelper}()},"./src/utils/cea-608-parser.ts":
/*!*************************************!*\
        !*** ./src/utils/cea-608-parser.ts ***!
        \*************************************/
/*! exports provided: Row, CaptionScreen, default */
function(module,__webpack_exports__,__nested_webpack_require_987485__){"use strict";__nested_webpack_require_987485__.r(__webpack_exports__),__nested_webpack_require_987485__.d(__webpack_exports__,"Row",function(){return Row}),__nested_webpack_require_987485__.d(__webpack_exports__,"CaptionScreen",function(){return CaptionScreen});var _utils_logger__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_987485__(
/*! ../utils/logger */
"./src/utils/logger.ts"),specialCea608CharsCodes={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},getCharForByte=function(_byte){var charCode=_byte;return specialCea608CharsCodes.hasOwnProperty(_byte)&&(charCode=specialCea608CharsCodes[_byte]),String.fromCharCode(charCode)},rowsLowCh1={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},rowsHighCh1={17:2,18:4,21:6,22:8,23:10,19:13,20:15},rowsLowCh2={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},rowsHighCh2={25:2,26:4,29:6,30:8,31:10,27:13,28:15},backgroundColors=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],VerboseLevel=function(){return function(VerboseLevel){VerboseLevel[VerboseLevel.ERROR=0]="ERROR",VerboseLevel[VerboseLevel.TEXT=1]="TEXT",VerboseLevel[VerboseLevel.WARNING=2]="WARNING",VerboseLevel[VerboseLevel.INFO=2]="INFO",VerboseLevel[VerboseLevel.DEBUG=3]="DEBUG",VerboseLevel[VerboseLevel.DATA=3]="DATA"}(VerboseLevel||(VerboseLevel={})),VerboseLevel}(),CaptionsLogger=function(){function CaptionsLogger(){this.time=null,this.verboseLevel=VerboseLevel.ERROR}return CaptionsLogger.prototype.log=function(severity,msg){this.verboseLevel>=severity&&_utils_logger__WEBPACK_IMPORTED_MODULE_0__.logger.log(this.time+" ["+severity+"] "+msg)},CaptionsLogger}(),numArrayToHexArray=function(numArray){for(var hexArray=[],j=0;j<numArray.length;j++)hexArray.push(numArray[j].toString(16));return hexArray},PenState=function(){function PenState(foreground,underline,italics,background,flash){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=foreground||"white",this.underline=underline||!1,this.italics=italics||!1,this.background=background||"black",this.flash=flash||!1}var _proto2=PenState.prototype;return _proto2.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},_proto2.setStyles=function(styles){for(var attribs=["foreground","underline","italics","background","flash"],i=0;i<attribs.length;i++){var style=attribs[i];styles.hasOwnProperty(style)&&(this[style]=styles[style])}},_proto2.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},_proto2.equals=function(other){return this.foreground===other.foreground&&this.underline===other.underline&&this.italics===other.italics&&this.background===other.background&&this.flash===other.flash},_proto2.copy=function(newPenState){this.foreground=newPenState.foreground,this.underline=newPenState.underline,this.italics=newPenState.italics,this.background=newPenState.background,this.flash=newPenState.flash},_proto2.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},PenState}(),StyledUnicodeChar=function(){function StyledUnicodeChar(uchar,foreground,underline,italics,background,flash){this.uchar=void 0,this.penState=void 0,this.uchar=uchar||" ",this.penState=new PenState(foreground,underline,italics,background,flash)}var _proto3=StyledUnicodeChar.prototype;return _proto3.reset=function(){this.uchar=" ",this.penState.reset()},_proto3.setChar=function(uchar,newPenState){this.uchar=uchar,this.penState.copy(newPenState)},_proto3.setPenState=function(newPenState){this.penState.copy(newPenState)},_proto3.equals=function(other){return this.uchar===other.uchar&&this.penState.equals(other.penState)},_proto3.copy=function(newChar){this.uchar=newChar.uchar,this.penState.copy(newChar.penState)},_proto3.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},StyledUnicodeChar}(),Row=function(){function Row(logger){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var i=0;i<100;i++)this.chars.push(new StyledUnicodeChar);this.logger=logger,this.pos=0,this.currPenState=new PenState}var _proto4=Row.prototype;return _proto4.equals=function(other){for(var equal=!0,i=0;i<100;i++)if(!this.chars[i].equals(other.chars[i])){equal=!1;break}return equal},_proto4.copy=function(other){for(var i=0;i<100;i++)this.chars[i].copy(other.chars[i])},_proto4.isEmpty=function(){for(var empty=!0,i=0;i<100;i++)if(!this.chars[i].isEmpty()){empty=!1;break}return empty},_proto4.setCursor=function(absPos){this.pos!==absPos&&(this.pos=absPos),this.pos<0?(this.logger.log(VerboseLevel.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>100&&(this.logger.log(VerboseLevel.DEBUG,"Too large cursor position "+this.pos),this.pos=100)},_proto4.moveCursor=function(relPos){var newPos=this.pos+relPos;if(relPos>1)for(var i=this.pos+1;i<newPos+1;i++)this.chars[i].setPenState(this.currPenState);this.setCursor(newPos)},_proto4.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},_proto4.insertChar=function(_byte2){_byte2>=144&&this.backSpace();var _char=getCharForByte(_byte2);this.pos>=100?this.logger.log(VerboseLevel.ERROR,"Cannot insert "+_byte2.toString(16)+" ("+_char+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(_char,this.currPenState),this.moveCursor(1))},_proto4.clearFromPos=function(startPos){var i;for(i=startPos;i<100;i++)this.chars[i].reset()},_proto4.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},_proto4.clearToEndOfRow=function(){this.clearFromPos(this.pos)},_proto4.getTextString=function(){for(var chars=[],empty=!0,i=0;i<100;i++){var _char2=this.chars[i].uchar;" "!==_char2&&(empty=!1),chars.push(_char2)}return empty?"":chars.join("")},_proto4.setPenStyles=function(styles){this.currPenState.setStyles(styles),this.chars[this.pos].setPenState(this.currPenState)},Row}(),CaptionScreen=function(){function CaptionScreen(logger){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var i=0;i<15;i++)this.rows.push(new Row(logger));this.logger=logger,this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var _proto5=CaptionScreen.prototype;return _proto5.reset=function(){for(var i=0;i<15;i++)this.rows[i].clear();this.currRow=14},_proto5.equals=function(other){for(var equal=!0,i=0;i<15;i++)if(!this.rows[i].equals(other.rows[i])){equal=!1;break}return equal},_proto5.copy=function(other){for(var i=0;i<15;i++)this.rows[i].copy(other.rows[i])},_proto5.isEmpty=function(){for(var empty=!0,i=0;i<15;i++)if(!this.rows[i].isEmpty()){empty=!1;break}return empty},_proto5.backSpace=function(){this.rows[this.currRow].backSpace()},_proto5.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},_proto5.insertChar=function(_char3){this.rows[this.currRow].insertChar(_char3)},_proto5.setPen=function(styles){this.rows[this.currRow].setPenStyles(styles)},_proto5.moveCursor=function(relPos){this.rows[this.currRow].moveCursor(relPos)},_proto5.setCursor=function(absPos){this.logger.log(VerboseLevel.INFO,"setCursor: "+absPos),this.rows[this.currRow].setCursor(absPos)},_proto5.setPAC=function(pacData){this.logger.log(VerboseLevel.INFO,"pacData = "+JSON.stringify(pacData));var newRow=pacData.row-1;if(this.nrRollUpRows&&newRow<this.nrRollUpRows-1&&(newRow=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==newRow){for(var i=0;i<15;i++)this.rows[i].clear();var topRowIndex=this.currRow+1-this.nrRollUpRows,lastOutputScreen=this.lastOutputScreen;if(lastOutputScreen){var prevLineTime=lastOutputScreen.rows[topRowIndex].cueStartTime,time=this.logger.time;if(prevLineTime&&null!==time&&prevLineTime<time)for(var _i=0;_i<this.nrRollUpRows;_i++)this.rows[newRow-this.nrRollUpRows+_i+1].copy(lastOutputScreen.rows[topRowIndex+_i])}}this.currRow=newRow;var row=this.rows[this.currRow];if(null!==pacData.indent){var prevPos=Math.max(pacData.indent-1,0);row.setCursor(pacData.indent),pacData.color=row.chars[prevPos].penState.foreground}this.setPen({foreground:pacData.color,underline:pacData.underline,italics:pacData.italics,background:"black",flash:!1})},_proto5.setBkgData=function(bkgData){this.logger.log(VerboseLevel.INFO,"bkgData = "+JSON.stringify(bkgData)),this.backSpace(),this.setPen(bkgData),this.insertChar(32)},_proto5.setRollUpRows=function(nrRows){this.nrRollUpRows=nrRows},_proto5.rollUp=function(){if(null!==this.nrRollUpRows){this.logger.log(VerboseLevel.TEXT,this.getDisplayText());var topRow=this.rows.splice(this.currRow+1-this.nrRollUpRows,1)[0];topRow.clear(),this.rows.splice(this.currRow,0,topRow),this.logger.log(VerboseLevel.INFO,"Rolling up")}else this.logger.log(VerboseLevel.DEBUG,"roll_up but nrRollUpRows not set yet")},_proto5.getDisplayText=function(asOneRow){asOneRow=asOneRow||!1;for(var displayText=[],text="",i=0;i<15;i++){var rowText=this.rows[i].getTextString();rowText&&displayText.push(asOneRow?"Row "+(i+1)+": '"+rowText+"'":rowText.trim())}return displayText.length>0&&(text=asOneRow?"["+displayText.join(" | ")+"]":displayText.join("\n")),text},_proto5.getTextAndFormat=function(){return this.rows},CaptionScreen}(),Cea608Channel=function(){function Cea608Channel(channelNumber,outputFilter,logger){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=channelNumber,this.outputFilter=outputFilter,this.mode=null,this.verbose=0,this.displayedMemory=new CaptionScreen(logger),this.nonDisplayedMemory=new CaptionScreen(logger),this.lastOutputScreen=new CaptionScreen(logger),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=logger}var _proto6=Cea608Channel.prototype;return _proto6.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},_proto6.getHandler=function(){return this.outputFilter},_proto6.setHandler=function(newHandler){this.outputFilter=newHandler},_proto6.setPAC=function(pacData){this.writeScreen.setPAC(pacData)},_proto6.setBkgData=function(bkgData){this.writeScreen.setBkgData(bkgData)},_proto6.setMode=function(newMode){newMode!==this.mode&&(this.mode=newMode,this.logger.log(VerboseLevel.INFO,"MODE="+newMode),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=newMode)},_proto6.insertChars=function(chars){for(var i=0;i<chars.length;i++)this.writeScreen.insertChar(chars[i]);this.logger.log(VerboseLevel.INFO,(this.writeScreen===this.displayedMemory?"DISP":"NON_DISP")+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(VerboseLevel.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},_proto6.ccRCL=function(){this.logger.log(VerboseLevel.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},_proto6.ccBS=function(){this.logger.log(VerboseLevel.INFO,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},_proto6.ccAOF=function(){},_proto6.ccAON=function(){},_proto6.ccDER=function(){this.logger.log(VerboseLevel.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},_proto6.ccRU=function(nrRows){this.logger.log(VerboseLevel.INFO,"RU("+nrRows+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(nrRows)},_proto6.ccFON=function(){this.logger.log(VerboseLevel.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},_proto6.ccRDC=function(){this.logger.log(VerboseLevel.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},_proto6.ccTR=function(){this.logger.log(VerboseLevel.INFO,"TR"),this.setMode("MODE_TEXT")},_proto6.ccRTD=function(){this.logger.log(VerboseLevel.INFO,"RTD"),this.setMode("MODE_TEXT")},_proto6.ccEDM=function(){this.logger.log(VerboseLevel.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},_proto6.ccCR=function(){this.logger.log(VerboseLevel.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},_proto6.ccENM=function(){this.logger.log(VerboseLevel.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},_proto6.ccEOC=function(){if(this.logger.log(VerboseLevel.INFO,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var tmp=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=tmp,this.writeScreen=this.nonDisplayedMemory,this.logger.log(VerboseLevel.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},_proto6.ccTO=function(nrCols){this.logger.log(VerboseLevel.INFO,"TO("+nrCols+") - Tab Offset"),this.writeScreen.moveCursor(nrCols)},_proto6.ccMIDROW=function(secondByte){var styles={flash:!1};if(styles.underline=secondByte%2==1,styles.italics=secondByte>=46,styles.italics)styles.foreground="white";else{var colorIndex=Math.floor(secondByte/2)-16;styles.foreground=["white","green","blue","cyan","red","yellow","magenta"][colorIndex]}this.logger.log(VerboseLevel.INFO,"MIDROW: "+JSON.stringify(styles)),this.writeScreen.setPen(styles)},_proto6.outputDataUpdate=function(dispatch){void 0===dispatch&&(dispatch=!1);var time=this.logger.time;null!==time&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,time,this.lastOutputScreen),dispatch&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:time):this.cueStartTime=time,this.lastOutputScreen.copy(this.displayedMemory))},_proto6.cueSplitAtTime=function(t){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory),this.cueStartTime=t))},Cea608Channel}();function setLastCmd(a,b,cmdHistory){cmdHistory.a=a,cmdHistory.b=b}function hasCmdRepeated(a,b,cmdHistory){return cmdHistory.a===a&&cmdHistory.b===b}__webpack_exports__.default=function(){function Cea608Parser(field,out1,out2){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var logger=new CaptionsLogger;this.channels=[null,new Cea608Channel(field,out1,logger),new Cea608Channel(field+1,out2,logger)],this.cmdHistory={a:null,b:null},this.logger=logger}var _proto7=Cea608Parser.prototype;return _proto7.getHandler=function(channel){return this.channels[channel].getHandler()},_proto7.setHandler=function(channel,newHandler){this.channels[channel].setHandler(newHandler)},_proto7.addData=function(time,byteList){var cmdFound,a,b,charsFound=!1;this.logger.time=time;for(var i=0;i<byteList.length;i+=2)if(b=127&byteList[i+1],0!=(a=127&byteList[i])||0!==b){if(this.logger.log(VerboseLevel.DATA,"["+numArrayToHexArray([byteList[i],byteList[i+1]])+"] -> ("+numArrayToHexArray([a,b])+")"),(cmdFound=this.parseCmd(a,b))||(cmdFound=this.parseMidrow(a,b)),cmdFound||(cmdFound=this.parsePAC(a,b)),cmdFound||(cmdFound=this.parseBackgroundAttributes(a,b)),!cmdFound&&(charsFound=this.parseChars(a,b))){var currChNr=this.currentChannel;currChNr&&currChNr>0?this.channels[currChNr].insertChars(charsFound):this.logger.log(VerboseLevel.WARNING,"No channel found yet. TEXT-MODE?")}cmdFound||charsFound||this.logger.log(VerboseLevel.WARNING,"Couldn't parse cleaned data "+numArrayToHexArray([a,b])+" orig: "+numArrayToHexArray([byteList[i],byteList[i+1]]))}},_proto7.parseCmd=function(a,b){var cmdHistory=this.cmdHistory;if(!((20===a||28===a||21===a||29===a)&&b>=32&&b<=47||(23===a||31===a)&&b>=33&&b<=35))return!1;if(hasCmdRepeated(a,b,cmdHistory))return setLastCmd(null,null,cmdHistory),this.logger.log(VerboseLevel.DEBUG,"Repeated command ("+numArrayToHexArray([a,b])+") is dropped"),!0;var chNr=20===a||21===a||23===a?1:2,channel=this.channels[chNr];return 20===a||21===a||28===a||29===a?32===b?channel.ccRCL():33===b?channel.ccBS():34===b?channel.ccAOF():35===b?channel.ccAON():36===b?channel.ccDER():37===b?channel.ccRU(2):38===b?channel.ccRU(3):39===b?channel.ccRU(4):40===b?channel.ccFON():41===b?channel.ccRDC():42===b?channel.ccTR():43===b?channel.ccRTD():44===b?channel.ccEDM():45===b?channel.ccCR():46===b?channel.ccENM():47===b&&channel.ccEOC():channel.ccTO(b-32),setLastCmd(a,b,cmdHistory),this.currentChannel=chNr,!0},_proto7.parseMidrow=function(a,b){var chNr=0;if((17===a||25===a)&&b>=32&&b<=47){if((chNr=17===a?1:2)!==this.currentChannel)return this.logger.log(VerboseLevel.ERROR,"Mismatch channel in midrow parsing"),!1;var channel=this.channels[chNr];return!!channel&&(channel.ccMIDROW(b),this.logger.log(VerboseLevel.DEBUG,"MIDROW ("+numArrayToHexArray([a,b])+")"),!0)}return!1},_proto7.parsePAC=function(a,b){var cmdHistory=this.cmdHistory;if(!((a>=17&&a<=23||a>=25&&a<=31)&&b>=64&&b<=127||(16===a||24===a)&&b>=64&&b<=95))return!1;if(hasCmdRepeated(a,b,cmdHistory))return setLastCmd(null,null,cmdHistory),!0;var chNr=a<=23?1:2,channel=this.channels[chNr];return!!channel&&(channel.setPAC(this.interpretPAC(b>=64&&b<=95?1===chNr?rowsLowCh1[a]:rowsLowCh2[a]:1===chNr?rowsHighCh1[a]:rowsHighCh2[a],b)),setLastCmd(a,b,cmdHistory),this.currentChannel=chNr,!0)},_proto7.interpretPAC=function(row,_byte3){var pacIndex,pacData={color:null,italics:!1,indent:null,underline:!1,row:row};return pacData.underline=1==(1&(pacIndex=_byte3>95?_byte3-96:_byte3-64)),pacIndex<=13?pacData.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(pacIndex/2)]:pacIndex<=15?(pacData.italics=!0,pacData.color="white"):pacData.indent=4*Math.floor((pacIndex-16)/2),pacData},_proto7.parseChars=function(a,b){var channelNr,oneCode,charCodes=null,charCode1=null;if(a>=25?(channelNr=2,charCode1=a-8):(channelNr=1,charCode1=a),charCode1>=17&&charCode1<=19?(this.logger.log(VerboseLevel.INFO,"Special char '"+getCharForByte(oneCode=17===charCode1?b+80:18===charCode1?b+112:b+144)+"' in channel "+channelNr),charCodes=[oneCode]):a>=32&&a<=127&&(charCodes=0===b?[a]:[a,b]),charCodes){var hexCodes=numArrayToHexArray(charCodes);this.logger.log(VerboseLevel.DEBUG,"Char codes =  "+hexCodes.join(",")),setLastCmd(a,b,this.cmdHistory)}return charCodes},_proto7.parseBackgroundAttributes=function(a,b){var index;if(!((16===a||24===a)&&b>=32&&b<=47||(23===a||31===a)&&b>=45&&b<=47))return!1;var bkgData={};return 16===a||24===a?(index=Math.floor((b-32)/2),bkgData.background=backgroundColors[index],b%2==1&&(bkgData.background=bkgData.background+"_semi")):45===b?bkgData.background="transparent":(bkgData.foreground="black",47===b&&(bkgData.underline=!0)),this.channels[a<=23?1:2].setBkgData(bkgData),setLastCmd(a,b,this.cmdHistory),!0},_proto7.reset=function(){for(var i=0;i<Object.keys(this.channels).length;i++){var channel=this.channels[i];channel&&channel.reset()}this.cmdHistory={a:null,b:null}},_proto7.cueSplitAtTime=function(t){for(var i=0;i<this.channels.length;i++){var channel=this.channels[i];channel&&channel.cueSplitAtTime(t)}},Cea608Parser}()},"./src/utils/codecs.ts":
/*!*****************************!*\
        !*** ./src/utils/codecs.ts ***!
        \*****************************/
/*! exports provided: isCodecType, isCodecSupportedInMp4 */
function(module,__webpack_exports__,__nested_webpack_require_1037325__){"use strict";__nested_webpack_require_1037325__.r(__webpack_exports__),__nested_webpack_require_1037325__.d(__webpack_exports__,"isCodecType",function(){return isCodecType}),__nested_webpack_require_1037325__.d(__webpack_exports__,"isCodecSupportedInMp4",function(){return isCodecSupportedInMp4});var sampleEntryCodesISO={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function isCodecType(codec,type){var typeCodes=sampleEntryCodesISO[type];return!!typeCodes&&!0===typeCodes[codec.slice(0,4)]}function isCodecSupportedInMp4(codec,type){return MediaSource.isTypeSupported((type||"video")+'/mp4;codecs="'+codec+'"')}},"./src/utils/cues.ts":
/*!***************************!*\
        !*** ./src/utils/cues.ts ***!
        \***************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_1040037__){"use strict";__nested_webpack_require_1040037__.r(__webpack_exports__);var _vttparser__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_1040037__(
/*! ./vttparser */
"./src/utils/vttparser.ts"),_webvtt_parser__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_1040037__(
/*! ./webvtt-parser */
"./src/utils/webvtt-parser.ts"),_texttrack_utils__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_1040037__(
/*! ./texttrack-utils */
"./src/utils/texttrack-utils.ts"),WHITESPACE_CHAR=/\s/;__webpack_exports__.default={newCue:function(track,startTime,endTime,captionScreen){for(var row,cue,indenting,indent,text,result=[],Cue=self.VTTCue||self.TextTrackCue,r=0;r<captionScreen.rows.length;r++)if(indenting=!0,indent=0,text="",!(row=captionScreen.rows[r]).isEmpty()){for(var c=0;c<row.chars.length;c++)WHITESPACE_CHAR.test(row.chars[c].uchar)&&indenting?indent++:(text+=row.chars[c].uchar,indenting=!1);row.cueStartTime=startTime,startTime===endTime&&(endTime+=1e-4),indent>=16?indent--:indent++;var cueText=Object(_vttparser__WEBPACK_IMPORTED_MODULE_0__.fixLineBreaks)(text.trim()),id=Object(_webvtt_parser__WEBPACK_IMPORTED_MODULE_1__.generateCueId)(startTime,endTime,cueText);track&&track.cues&&track.cues.getCueById(id)||((cue=new Cue(startTime,endTime,cueText)).id=id,cue.line=r+1,cue.align="left",cue.position=10+Math.min(80,10*Math.floor(8*indent/32)),result.push(cue))}return track&&result.length&&(result.sort(function(cueA,cueB){return"auto"===cueA.line||"auto"===cueB.line?0:cueA.line>8&&cueB.line>8?cueB.line-cueA.line:cueA.line-cueB.line}),result.forEach(function(cue){return Object(_texttrack_utils__WEBPACK_IMPORTED_MODULE_2__.addCueToTrack)(track,cue)})),result}}},"./src/utils/discontinuities.ts":
/*!**************************************!*\
        !*** ./src/utils/discontinuities.ts ***!
        \**************************************/
/*! exports provided: findFirstFragWithCC, shouldAlignOnDiscontinuities, findDiscontinuousReferenceFrag, adjustSlidingStart, alignStream, alignPDT, alignFragmentByPDTDelta, alignMediaPlaylistByPDT */
function(module,__webpack_exports__,__nested_webpack_require_1044435__){"use strict";__nested_webpack_require_1044435__.r(__webpack_exports__),__nested_webpack_require_1044435__.d(__webpack_exports__,"findFirstFragWithCC",function(){return findFirstFragWithCC}),__nested_webpack_require_1044435__.d(__webpack_exports__,"shouldAlignOnDiscontinuities",function(){return shouldAlignOnDiscontinuities}),__nested_webpack_require_1044435__.d(__webpack_exports__,"findDiscontinuousReferenceFrag",function(){return findDiscontinuousReferenceFrag}),__nested_webpack_require_1044435__.d(__webpack_exports__,"adjustSlidingStart",function(){return adjustSlidingStart}),__nested_webpack_require_1044435__.d(__webpack_exports__,"alignStream",function(){return alignStream}),__nested_webpack_require_1044435__.d(__webpack_exports__,"alignPDT",function(){return alignPDT}),__nested_webpack_require_1044435__.d(__webpack_exports__,"alignFragmentByPDTDelta",function(){return alignFragmentByPDTDelta}),__nested_webpack_require_1044435__.d(__webpack_exports__,"alignMediaPlaylistByPDT",function(){return alignMediaPlaylistByPDT});var _home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_1044435__(
/*! ./src/polyfills/number */
"./src/polyfills/number.ts"),_logger__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_1044435__(
/*! ./logger */
"./src/utils/logger.ts"),_controller_level_helper__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_1044435__(
/*! ../controller/level-helper */
"./src/controller/level-helper.ts");function findFirstFragWithCC(fragments,cc){for(var firstFrag=null,i=0,len=fragments.length;i<len;i++){var currentFrag=fragments[i];if(currentFrag&&currentFrag.cc===cc){firstFrag=currentFrag;break}}return firstFrag}function shouldAlignOnDiscontinuities(lastFrag,lastLevel,details){return!(!lastLevel.details||!(details.endCC>details.startCC||lastFrag&&lastFrag.cc<details.startCC))}function findDiscontinuousReferenceFrag(prevDetails,curDetails){var prevFrags=prevDetails.fragments,curFrags=curDetails.fragments;if(curFrags.length&&prevFrags.length){var prevStartFrag=findFirstFragWithCC(prevFrags,curFrags[0].cc);if(prevStartFrag&&(!prevStartFrag||prevStartFrag.startPTS))return prevStartFrag;_logger__WEBPACK_IMPORTED_MODULE_1__.logger.log("No frag in previous level to align on")}else _logger__WEBPACK_IMPORTED_MODULE_1__.logger.log("No fragments to align")}function adjustFragmentStart(frag,sliding){if(frag){var start=frag.start+sliding;frag.start=frag.startPTS=start,frag.endPTS=start+frag.duration}}function adjustSlidingStart(sliding,details){for(var fragments=details.fragments,i=0,len=fragments.length;i<len;i++)adjustFragmentStart(fragments[i],sliding);details.fragmentHint&&adjustFragmentStart(details.fragmentHint,sliding),details.alignedSliding=!0}function alignStream(lastFrag,lastLevel,details){lastLevel&&(function(lastFrag,details,lastLevel){if(shouldAlignOnDiscontinuities(lastFrag,lastLevel,details)){var referenceFrag=findDiscontinuousReferenceFrag(lastLevel.details,details);referenceFrag&&Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(referenceFrag.start)&&(_logger__WEBPACK_IMPORTED_MODULE_1__.logger.log("Adjusting PTS using last level due to CC increase within current level "+details.url),adjustSlidingStart(referenceFrag.start,details))}}(lastFrag,details,lastLevel),!details.alignedSliding&&lastLevel.details&&alignPDT(details,lastLevel.details),details.alignedSliding||!lastLevel.details||details.skippedSegments||Object(_controller_level_helper__WEBPACK_IMPORTED_MODULE_2__.adjustSliding)(lastLevel.details,details))}function alignPDT(details,lastDetails){if(lastDetails.fragments.length&&details.hasProgramDateTime&&lastDetails.hasProgramDateTime){var lastPDT=lastDetails.fragments[0].programDateTime,newPDT=details.fragments[0].programDateTime,sliding=(newPDT-lastPDT)/1e3+lastDetails.fragments[0].start;sliding&&Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(sliding)&&(_logger__WEBPACK_IMPORTED_MODULE_1__.logger.log("Adjusting PTS using programDateTime delta "+(newPDT-lastPDT)+"ms, sliding:"+sliding.toFixed(3)+" "+details.url+" "),adjustSlidingStart(sliding,details))}}function alignFragmentByPDTDelta(frag,delta){var programDateTime=frag.programDateTime;if(programDateTime){var start=(programDateTime-delta)/1e3;frag.start=frag.startPTS=start,frag.endPTS=start+frag.duration}}function alignMediaPlaylistByPDT(details,refDetails){if(refDetails.fragments.length&&details.hasProgramDateTime&&refDetails.hasProgramDateTime){var delta=refDetails.fragments[0].programDateTime-1e3*refDetails.fragments[0].start;details.fragments.forEach(function(frag){alignFragmentByPDTDelta(frag,delta)}),details.fragmentHint&&alignFragmentByPDTDelta(details.fragmentHint,delta),details.alignedSliding=!0}}},"./src/utils/ewma-bandwidth-estimator.ts":
/*!***********************************************!*\
        !*** ./src/utils/ewma-bandwidth-estimator.ts ***!
        \***********************************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_1056368__){"use strict";__nested_webpack_require_1056368__.r(__webpack_exports__);var _utils_ewma__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_1056368__(
/*! ../utils/ewma */
"./src/utils/ewma.ts");__webpack_exports__.default=function(){function EwmaBandWidthEstimator(slow,fast,defaultEstimate){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=defaultEstimate,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new _utils_ewma__WEBPACK_IMPORTED_MODULE_0__.default(slow),this.fast_=new _utils_ewma__WEBPACK_IMPORTED_MODULE_0__.default(fast)}var _proto=EwmaBandWidthEstimator.prototype;return _proto.update=function(slow,fast){var slow_=this.slow_,fast_=this.fast_;this.slow_.halfLife!==slow&&(this.slow_=new _utils_ewma__WEBPACK_IMPORTED_MODULE_0__.default(slow,slow_.getEstimate(),slow_.getTotalWeight())),this.fast_.halfLife!==fast&&(this.fast_=new _utils_ewma__WEBPACK_IMPORTED_MODULE_0__.default(fast,fast_.getEstimate(),fast_.getTotalWeight()))},_proto.sample=function(durationMs,numBytes){var durationS=(durationMs=Math.max(durationMs,this.minDelayMs_))/1e3,bandwidthInBps=8*numBytes/durationS;this.fast_.sample(durationS,bandwidthInBps),this.slow_.sample(durationS,bandwidthInBps)},_proto.canEstimate=function(){var fast=this.fast_;return fast&&fast.getTotalWeight()>=this.minWeight_},_proto.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},_proto.destroy=function(){},EwmaBandWidthEstimator}()},"./src/utils/ewma.ts":
/*!***************************!*\
        !*** ./src/utils/ewma.ts ***!
        \***************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_1059902__){"use strict";__nested_webpack_require_1059902__.r(__webpack_exports__),__webpack_exports__.default=function(){function EWMA(halfLife,estimate,weight){void 0===estimate&&(estimate=0),void 0===weight&&(weight=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=halfLife,this.alpha_=halfLife?Math.exp(Math.log(.5)/halfLife):0,this.estimate_=estimate,this.totalWeight_=weight}var _proto=EWMA.prototype;return _proto.sample=function(weight,value){var adjAlpha=Math.pow(this.alpha_,weight);this.estimate_=value*(1-adjAlpha)+adjAlpha*this.estimate_,this.totalWeight_+=weight},_proto.getTotalWeight=function(){return this.totalWeight_},_proto.getEstimate=function(){if(this.alpha_){var zeroFactor=1-Math.pow(this.alpha_,this.totalWeight_);if(zeroFactor)return this.estimate_/zeroFactor}return this.estimate_},EWMA}()},"./src/utils/fetch-loader.ts":
/*!***********************************!*\
        !*** ./src/utils/fetch-loader.ts ***!
        \***********************************/
/*! exports provided: fetchSupported, default */
function(module,__webpack_exports__,__nested_webpack_require_1062200__){"use strict";__nested_webpack_require_1062200__.r(__webpack_exports__),__nested_webpack_require_1062200__.d(__webpack_exports__,"fetchSupported",function(){return fetchSupported});var _home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_1062200__(
/*! ./src/polyfills/number */
"./src/polyfills/number.ts"),_loader_load_stats__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_1062200__(
/*! ../loader/load-stats */
"./src/loader/load-stats.ts"),_demux_chunk_cache__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_1062200__(
/*! ../demux/chunk-cache */
"./src/demux/chunk-cache.ts");function _wrapNativeSuper(Class){var _cache="function"==typeof Map?new Map:void 0;return _wrapNativeSuper=function(Class){if(null===Class||-1===Function.toString.call(Class).indexOf("[native code]"))return Class;if("function"!=typeof Class)throw new TypeError("Super expression must either be null or a function");if(void 0!==_cache){if(_cache.has(Class))return _cache.get(Class);_cache.set(Class,Wrapper)}function Wrapper(){return _construct(Class,arguments,_getPrototypeOf(this).constructor)}return Wrapper.prototype=Object.create(Class.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(Wrapper,Class)},_wrapNativeSuper(Class)}function _construct(Parent,args,Class){return _construct=_isNativeReflectConstruct()?Reflect.construct:function(Parent,args,Class){var a=[null];a.push.apply(a,args);var instance=new(Function.bind.apply(Parent,a));return Class&&_setPrototypeOf(instance,Class.prototype),instance},_construct.apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}function fetchSupported(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(e){}return!1}var FetchLoader=function(){function FetchLoader(config){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=config.fetchSetup||getRequest,this.controller=new self.AbortController,this.stats=new _loader_load_stats__WEBPACK_IMPORTED_MODULE_1__.LoadStats}var _proto=FetchLoader.prototype;return _proto.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},_proto.abortInternal=function(){var response=this.response;response&&response.ok||(this.stats.aborted=!0,this.controller.abort())},_proto.abort=function(){var _this$callbacks;this.abortInternal(),null!==(_this$callbacks=this.callbacks)&&void 0!==_this$callbacks&&_this$callbacks.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},_proto.load=function(context,config,callbacks){var _this=this,stats=this.stats;if(stats.loading.start)throw new Error("Loader can only be used once.");stats.loading.start=self.performance.now();var initParams=function(context,signal){var initParams={method:"GET",mode:"cors",credentials:"same-origin",signal:signal};return context.rangeEnd&&(initParams.headers=new self.Headers({Range:"bytes="+context.rangeStart+"-"+String(context.rangeEnd-1)})),initParams}(context,this.controller.signal),onProgress=callbacks.onProgress,isArrayBuffer="arraybuffer"===context.responseType,LENGTH=isArrayBuffer?"byteLength":"length";this.context=context,this.config=config,this.callbacks=callbacks,this.request=this.fetchSetup(context,initParams),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(function(){_this.abortInternal(),callbacks.onTimeout(stats,context,_this.response)},config.timeout),self.fetch(this.request).then(function(response){if(_this.response=_this.loader=response,!response.ok)throw new FetchError(response.statusText||"fetch, bad network response",response.status,response);return stats.loading.first=Math.max(self.performance.now(),stats.loading.start),stats.total=parseInt(response.headers.get("Content-Length")||"0"),onProgress&&Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(config.highWaterMark)?_this.loadProgressively(response,stats,context,config.highWaterMark,onProgress):isArrayBuffer?response.arrayBuffer():response.text()}).then(function(responseData){var response=_this.response;self.clearTimeout(_this.requestTimeout),stats.loading.end=Math.max(self.performance.now(),stats.loading.first),stats.loaded=stats.total=responseData[LENGTH];var loaderResponse={url:response.url,data:responseData};onProgress&&!Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(config.highWaterMark)&&onProgress(stats,context,responseData,response),callbacks.onSuccess(loaderResponse,stats,context,response)}).catch(function(error){self.clearTimeout(_this.requestTimeout),stats.aborted||callbacks.onError({code:error.code||0,text:error.message},context,error.details)})},_proto.getCacheAge=function(){var result=null;if(this.response){var ageHeader=this.response.headers.get("age");result=ageHeader?parseFloat(ageHeader):null}return result},_proto.loadProgressively=function(response,stats,context,highWaterMark,onProgress){void 0===highWaterMark&&(highWaterMark=0);var chunkCache=new _demux_chunk_cache__WEBPACK_IMPORTED_MODULE_2__.default,reader=response.body.getReader();return function pump(){return reader.read().then(function(data){if(data.done)return chunkCache.dataLength&&onProgress(stats,context,chunkCache.flush(),response),Promise.resolve(new ArrayBuffer(0));var chunk=data.value,len=chunk.length;return stats.loaded+=len,len<highWaterMark||chunkCache.dataLength?(chunkCache.push(chunk),chunkCache.dataLength>=highWaterMark&&onProgress(stats,context,chunkCache.flush(),response)):onProgress(stats,context,chunk,response),pump()}).catch(function(){return Promise.reject()})}()},FetchLoader}();function getRequest(context,initParams){return new self.Request(context.url,initParams)}var FetchError=function(_Error){var subClass,superClass;function FetchError(message,code,details){var _this2;return(_this2=_Error.call(this,message)||this).code=void 0,_this2.details=void 0,_this2.code=code,_this2.details=details,_this2}return superClass=_Error,(subClass=FetchError).prototype=Object.create(superClass.prototype),subClass.prototype.constructor=subClass,_setPrototypeOf(subClass,superClass),FetchError}(_wrapNativeSuper(Error));__webpack_exports__.default=FetchLoader},"./src/utils/imsc1-ttml-parser.ts":
/*!****************************************!*\
        !*** ./src/utils/imsc1-ttml-parser.ts ***!
        \****************************************/
/*! exports provided: IMSC1_CODEC, parseIMSC1 */
function(module,__webpack_exports__,__nested_webpack_require_1074856__){"use strict";__nested_webpack_require_1074856__.r(__webpack_exports__),__nested_webpack_require_1074856__.d(__webpack_exports__,"IMSC1_CODEC",function(){return IMSC1_CODEC}),__nested_webpack_require_1074856__.d(__webpack_exports__,"parseIMSC1",function(){return parseIMSC1});var _mp4_tools__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_1074856__(
/*! ./mp4-tools */
"./src/utils/mp4-tools.ts"),_vttparser__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_1074856__(
/*! ./vttparser */
"./src/utils/vttparser.ts"),_vttcue__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_1074856__(
/*! ./vttcue */
"./src/utils/vttcue.ts"),_demux_id3__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_1074856__(
/*! ../demux/id3 */
"./src/demux/id3.ts"),_timescale_conversion__WEBPACK_IMPORTED_MODULE_4__=__nested_webpack_require_1074856__(
/*! ./timescale-conversion */
"./src/utils/timescale-conversion.ts"),_webvtt_parser__WEBPACK_IMPORTED_MODULE_5__=__nested_webpack_require_1074856__(
/*! ./webvtt-parser */
"./src/utils/webvtt-parser.ts");function _extends(){return _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}var IMSC1_CODEC="stpp.ttml.im1t",HMSF_REGEX=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,TIME_UNIT_REGEX=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,textAlignToLineAlign={left:"start",center:"center",right:"end",start:"start",end:"end"};function parseIMSC1(payload,initPTS,timescale,callBack,errorCallBack){var results=Object(_mp4_tools__WEBPACK_IMPORTED_MODULE_0__.findBox)(new Uint8Array(payload),["mdat"]);if(0!==results.length){var mdat=results[0],ttml=Object(_demux_id3__WEBPACK_IMPORTED_MODULE_3__.utf8ArrayToStr)(new Uint8Array(payload,mdat.start,mdat.end-mdat.start)),syncTime=Object(_timescale_conversion__WEBPACK_IMPORTED_MODULE_4__.toTimescaleFromScale)(initPTS,1,timescale);try{callBack(function(ttml,syncTime){var tt=(new DOMParser).parseFromString(ttml,"text/xml").getElementsByTagName("tt")[0];if(!tt)throw new Error("Invalid ttml");var defaultRateInfo={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},rateInfo=Object.keys(defaultRateInfo).reduce(function(result,key){return result[key]=tt.getAttribute("ttp:"+key)||defaultRateInfo[key],result},{}),trim="preserve"!==tt.getAttribute("xml:space"),styleElements=collectionToDictionary(getElementCollection(tt,"styling","style")),regionElements=collectionToDictionary(getElementCollection(tt,"layout","region")),cueElements=getElementCollection(tt,"body","[begin]");return[].map.call(cueElements,function(cueElement){var cueText=getTextContent(cueElement,trim);if(!cueText||!cueElement.hasAttribute("begin"))return null;var startTime=parseTtmlTime(cueElement.getAttribute("begin"),rateInfo),duration=parseTtmlTime(cueElement.getAttribute("dur"),rateInfo),endTime=parseTtmlTime(cueElement.getAttribute("end"),rateInfo);if(null===startTime)throw timestampParsingError(cueElement);if(null===endTime){if(null===duration)throw timestampParsingError(cueElement);endTime=startTime+duration}var cue=new _vttcue__WEBPACK_IMPORTED_MODULE_2__.default(startTime-syncTime,endTime-syncTime,cueText);cue.id=Object(_webvtt_parser__WEBPACK_IMPORTED_MODULE_5__.generateCueId)(cue.startTime,cue.endTime,cue.text);var region=regionElements[cueElement.getAttribute("region")],style=styleElements[cueElement.getAttribute("style")];cue.position=10,cue.size=80;var styles=function(region,style){var ttsNs="http://www.w3.org/ns/ttml#styling";return["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"].reduce(function(styles,name){var value=getAttributeNS(style,ttsNs,name)||getAttributeNS(region,ttsNs,name);return value&&(styles[name]=value),styles},{})}(region,style),textAlign=styles.textAlign;if(textAlign){var lineAlign=textAlignToLineAlign[textAlign];lineAlign&&(cue.lineAlign=lineAlign),cue.align=textAlign}return _extends(cue,styles),cue}).filter(function(cue){return null!==cue})}(ttml,syncTime))}catch(error){errorCallBack(error)}}else errorCallBack(new Error("Could not parse IMSC1 mdat"))}function getElementCollection(fromElement,parentName,childName){var parent=fromElement.getElementsByTagName(parentName)[0];return parent?[].slice.call(parent.querySelectorAll(childName)):[]}function collectionToDictionary(elementsWithId){return elementsWithId.reduce(function(dict,element){var id=element.getAttribute("xml:id");return id&&(dict[id]=element),dict},{})}function getTextContent(element,trim){return[].slice.call(element.childNodes).reduce(function(str,node,i){var _node$childNodes;return"br"===node.nodeName&&i?str+"\n":null!==(_node$childNodes=node.childNodes)&&void 0!==_node$childNodes&&_node$childNodes.length?getTextContent(node,trim):trim?str+node.textContent.trim().replace(/\s+/g," "):str+node.textContent},"")}function getAttributeNS(element,ns,name){return element.hasAttributeNS(ns,name)?element.getAttributeNS(ns,name):null}function timestampParsingError(node){return new Error("Could not parse ttml timestamp "+node)}function parseTtmlTime(timeAttributeValue,rateInfo){if(!timeAttributeValue)return null;var seconds=Object(_vttparser__WEBPACK_IMPORTED_MODULE_1__.parseTimeStamp)(timeAttributeValue);return null===seconds&&(HMSF_REGEX.test(timeAttributeValue)?seconds=function(timeAttributeValue,rateInfo){var m=HMSF_REGEX.exec(timeAttributeValue);return 3600*(0|m[1])+60*(0|m[2])+(0|m[3])+((0|m[4])+(0|m[5])/rateInfo.subFrameRate)/rateInfo.frameRate}(timeAttributeValue,rateInfo):TIME_UNIT_REGEX.test(timeAttributeValue)&&(seconds=function(timeAttributeValue,rateInfo){var m=TIME_UNIT_REGEX.exec(timeAttributeValue),value=Number(m[1]);switch(m[2]){case"h":return 3600*value;case"m":return 60*value;case"ms":return 1e3*value;case"f":return value/rateInfo.frameRate;case"t":return value/rateInfo.tickRate}return value}(timeAttributeValue,rateInfo))),seconds}},"./src/utils/logger.ts":
/*!*****************************!*\
        !*** ./src/utils/logger.ts ***!
        \*****************************/
/*! exports provided: enableLogs, logger */
function(module,__webpack_exports__,__nested_webpack_require_1085115__){"use strict";__nested_webpack_require_1085115__.r(__webpack_exports__),__nested_webpack_require_1085115__.d(__webpack_exports__,"enableLogs",function(){return enableLogs}),__nested_webpack_require_1085115__.d(__webpack_exports__,"logger",function(){return logger});var noop=function(){},fakeLogger={trace:noop,debug:noop,log:noop,warn:noop,info:noop,error:noop},exportedLogger=fakeLogger;function consolePrintFn(type){var func=self.console[type];return func?func.bind(self.console,"["+type+"] >"):noop}function enableLogs(debugConfig){if(self.console&&!0===debugConfig||"object"==typeof debugConfig){!function(debugConfig){for(var _len=arguments.length,functions=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)functions[_key-1]=arguments[_key];functions.forEach(function(type){exportedLogger[type]=debugConfig[type]?debugConfig[type].bind(debugConfig):consolePrintFn(type)})}(debugConfig,"debug","log","info","warn","error");try{exportedLogger.log()}catch(e){exportedLogger=fakeLogger}}else exportedLogger=fakeLogger}var logger=fakeLogger},"./src/utils/mediakeys-helper.ts":
/*!***************************************!*\
        !*** ./src/utils/mediakeys-helper.ts ***!
        \***************************************/
/*! exports provided: KeySystems, requestMediaKeySystemAccess */
function(module,__webpack_exports__,__nested_webpack_require_1087903__){"use strict";__nested_webpack_require_1087903__.r(__webpack_exports__),__nested_webpack_require_1087903__.d(__webpack_exports__,"KeySystems",function(){return KeySystems}),__nested_webpack_require_1087903__.d(__webpack_exports__,"requestMediaKeySystemAccess",function(){return requestMediaKeySystemAccess});var KeySystems=function(){return function(KeySystems){KeySystems.WIDEVINE="com.widevine.alpha",KeySystems.PLAYREADY="com.microsoft.playready"}(KeySystems||(KeySystems={})),KeySystems}(),requestMediaKeySystemAccess="undefined"!=typeof self&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null},"./src/utils/mediasource-helper.ts":
/*!*****************************************!*\
        !*** ./src/utils/mediasource-helper.ts ***!
        \*****************************************/
/*! exports provided: getMediaSource */
function(module,__webpack_exports__,__nested_webpack_require_1089478__){"use strict";function getMediaSource(){return self.MediaSource||self.WebKitMediaSource}__nested_webpack_require_1089478__.r(__webpack_exports__),__nested_webpack_require_1089478__.d(__webpack_exports__,"getMediaSource",function(){return getMediaSource})},"./src/utils/mp4-tools.ts":
/*!********************************!*\
        !*** ./src/utils/mp4-tools.ts ***!
        \********************************/
/*! exports provided: bin2str, readUint16, readUint32, writeUint32, findBox, parseSegmentIndex, parseInitSegment, getStartDTS, getDuration, computeRawDurationFromSamples, offsetStartDTS, segmentValidRange, appendUint8Array */
function(module,__webpack_exports__,__nested_webpack_require_1090419__){"use strict";__nested_webpack_require_1090419__.r(__webpack_exports__),__nested_webpack_require_1090419__.d(__webpack_exports__,"bin2str",function(){return bin2str}),__nested_webpack_require_1090419__.d(__webpack_exports__,"readUint16",function(){return readUint16}),__nested_webpack_require_1090419__.d(__webpack_exports__,"readUint32",function(){return readUint32}),__nested_webpack_require_1090419__.d(__webpack_exports__,"writeUint32",function(){return writeUint32}),__nested_webpack_require_1090419__.d(__webpack_exports__,"findBox",function(){return findBox}),__nested_webpack_require_1090419__.d(__webpack_exports__,"parseSegmentIndex",function(){return parseSegmentIndex}),__nested_webpack_require_1090419__.d(__webpack_exports__,"parseInitSegment",function(){return parseInitSegment}),__nested_webpack_require_1090419__.d(__webpack_exports__,"getStartDTS",function(){return getStartDTS}),__nested_webpack_require_1090419__.d(__webpack_exports__,"getDuration",function(){return getDuration}),__nested_webpack_require_1090419__.d(__webpack_exports__,"computeRawDurationFromSamples",function(){return computeRawDurationFromSamples}),__nested_webpack_require_1090419__.d(__webpack_exports__,"offsetStartDTS",function(){return offsetStartDTS}),__nested_webpack_require_1090419__.d(__webpack_exports__,"segmentValidRange",function(){return segmentValidRange}),__nested_webpack_require_1090419__.d(__webpack_exports__,"appendUint8Array",function(){return appendUint8Array});var _typed_array__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_1090419__(
/*! ./typed-array */
"./src/utils/typed-array.ts"),_loader_fragment__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_1090419__(
/*! ../loader/fragment */
"./src/loader/fragment.ts"),UINT32_MAX=Math.pow(2,32)-1,push=[].push;function bin2str(data){return String.fromCharCode.apply(null,data)}function readUint16(buffer,offset){"data"in buffer&&(offset+=buffer.start,buffer=buffer.data);var val=buffer[offset]<<8|buffer[offset+1];return val<0?65536+val:val}function readUint32(buffer,offset){"data"in buffer&&(offset+=buffer.start,buffer=buffer.data);var val=buffer[offset]<<24|buffer[offset+1]<<16|buffer[offset+2]<<8|buffer[offset+3];return val<0?4294967296+val:val}function writeUint32(buffer,offset,value){"data"in buffer&&(offset+=buffer.start,buffer=buffer.data),buffer[offset]=value>>24,buffer[offset+1]=value>>16&255,buffer[offset+2]=value>>8&255,buffer[offset+3]=255&value}function findBox(input,path){var data,start,end,results=[];if(!path.length)return results;"data"in input?(data=input.data,start=input.start,end=input.end):(start=0,end=(data=input).byteLength);for(var i=start;i<end;){var size=readUint32(data,i),endbox=size>1?i+size:end;if(bin2str(data.subarray(i+4,i+8))===path[0])if(1===path.length)results.push({data:data,start:i+8,end:endbox});else{var subresults=findBox({data:data,start:i+8,end:endbox},path.slice(1));subresults.length&&push.apply(results,subresults)}i=endbox}return results}function parseSegmentIndex(initSegment){var moov=findBox(initSegment,["moov"])[0],moovEndOffset=moov?moov.end:null,sidxBox=findBox(initSegment,["sidx"]);if(!sidxBox||!sidxBox[0])return null;var references=[],sidx=sidxBox[0],version=sidx.data[0],index=0===version?8:16,timescale=readUint32(sidx,index);index+=4,index+=0===version?8:16;var startByte=sidx.end+0,referencesCount=readUint16(sidx,index+=2);index+=2;for(var i=0;i<referencesCount;i++){var referenceIndex=index,referenceInfo=readUint32(sidx,referenceIndex);referenceIndex+=4;var referenceSize=2147483647&referenceInfo;if(1==(2147483648&referenceInfo)>>>31)return console.warn("SIDX has hierarchical references (not supported)"),null;var subsegmentDuration=readUint32(sidx,referenceIndex);referenceIndex+=4,references.push({referenceSize:referenceSize,subsegmentDuration:subsegmentDuration,info:{duration:subsegmentDuration/timescale,start:startByte,end:startByte+referenceSize-1}}),startByte+=referenceSize,index=referenceIndex+=4}return{earliestPresentationTime:0,timescale:timescale,version:version,referencesCount:referencesCount,references:references,moovEndOffset:moovEndOffset}}function parseInitSegment(initSegment){for(var result=[],traks=findBox(initSegment,["moov","trak"]),i=0;i<traks.length;i++){var trak=traks[i],tkhd=findBox(trak,["tkhd"])[0];if(tkhd){var version=tkhd.data[tkhd.start],_index=0===version?12:20,trackId=readUint32(tkhd,_index),mdhd=findBox(trak,["mdia","mdhd"])[0];if(mdhd){var timescale=readUint32(mdhd,_index=0===(version=mdhd.data[mdhd.start])?12:20),hdlr=findBox(trak,["mdia","hdlr"])[0];if(hdlr){var hdlrType=bin2str(hdlr.data.subarray(hdlr.start+8,hdlr.start+12)),type={soun:_loader_fragment__WEBPACK_IMPORTED_MODULE_1__.ElementaryStreamTypes.AUDIO,vide:_loader_fragment__WEBPACK_IMPORTED_MODULE_1__.ElementaryStreamTypes.VIDEO}[hdlrType];if(type){var stsd=findBox(trak,["mdia","minf","stbl","stsd"])[0],codec=void 0;stsd&&(codec=bin2str(stsd.data.subarray(stsd.start+12,stsd.start+16))),result[trackId]={timescale:timescale,type:type},result[type]={timescale:timescale,id:trackId,codec:codec}}}}}}return findBox(initSegment,["moov","mvex","trex"]).forEach(function(trex){var trackId=readUint32(trex,4),track=result[trackId];track&&(track.default={duration:readUint32(trex,12),flags:readUint32(trex,20)})}),result}function getStartDTS(initData,fmp4){return findBox(fmp4,["moof","traf"]).reduce(function(result,traf){var tfdt=findBox(traf,["tfdt"])[0],version=tfdt.data[tfdt.start],start=findBox(traf,["tfhd"]).reduce(function(result,tfhd){var id=readUint32(tfhd,4),track=initData[id];if(track){var baseTime=readUint32(tfdt,4);1===version&&(baseTime*=Math.pow(2,32),baseTime+=readUint32(tfdt,8));var startTime=baseTime/(track.timescale||9e4);if(isFinite(startTime)&&(null===result||startTime<result))return startTime}return result},null);return null!==start&&isFinite(start)&&(null===result||start<result)?start:result},null)||0}function getDuration(data,initData){for(var rawDuration=0,videoDuration=0,audioDuration=0,trafs=findBox(data,["moof","traf"]),i=0;i<trafs.length;i++){var traf=trafs[i],tfhd=findBox(traf,["tfhd"])[0],track=initData[readUint32(tfhd,4)];if(track){var trackDefault=track.default,tfhdFlags=readUint32(tfhd,0)|(null==trackDefault?void 0:trackDefault.flags),sampleDuration=null==trackDefault?void 0:trackDefault.duration;8&tfhdFlags&&(sampleDuration=readUint32(tfhd,2&tfhdFlags?12:8));for(var timescale=track.timescale||9e4,truns=findBox(traf,["trun"]),j=0;j<truns.length;j++)rawDuration=sampleDuration?sampleDuration*readUint32(truns[j],4):computeRawDurationFromSamples(truns[j]),track.type===_loader_fragment__WEBPACK_IMPORTED_MODULE_1__.ElementaryStreamTypes.VIDEO?videoDuration+=rawDuration/timescale:track.type===_loader_fragment__WEBPACK_IMPORTED_MODULE_1__.ElementaryStreamTypes.AUDIO&&(audioDuration+=rawDuration/timescale)}}if(0===videoDuration&&0===audioDuration){var sidx=parseSegmentIndex(data);if(null!=sidx&&sidx.references)return sidx.references.reduce(function(dur,ref){return dur+ref.info.duration||0},0)}return videoDuration||audioDuration}function computeRawDurationFromSamples(trun){var flags=readUint32(trun,0),offset=8;1&flags&&(offset+=4),4&flags&&(offset+=4);for(var duration=0,sampleCount=readUint32(trun,4),i=0;i<sampleCount;i++)256&flags&&(duration+=readUint32(trun,offset),offset+=4),512&flags&&(offset+=4),1024&flags&&(offset+=4),2048&flags&&(offset+=4);return duration}function offsetStartDTS(initData,fmp4,timeOffset){findBox(fmp4,["moof","traf"]).forEach(function(traf){findBox(traf,["tfhd"]).forEach(function(tfhd){var id=readUint32(tfhd,4),track=initData[id];if(track){var timescale=track.timescale||9e4;findBox(traf,["tfdt"]).forEach(function(tfdt){var version=tfdt.data[tfdt.start],baseMediaDecodeTime=readUint32(tfdt,4);if(0===version)writeUint32(tfdt,4,baseMediaDecodeTime-timeOffset*timescale);else{baseMediaDecodeTime*=Math.pow(2,32),baseMediaDecodeTime+=readUint32(tfdt,8),baseMediaDecodeTime-=timeOffset*timescale,baseMediaDecodeTime=Math.max(baseMediaDecodeTime,0);var upper=Math.floor(baseMediaDecodeTime/(UINT32_MAX+1)),lower=Math.floor(baseMediaDecodeTime%(UINT32_MAX+1));writeUint32(tfdt,4,upper),writeUint32(tfdt,8,lower)}})}})})}function segmentValidRange(data){var segmentedRange={valid:null,remainder:null},moofs=findBox(data,["moof"]);if(!moofs)return segmentedRange;if(moofs.length<2)return segmentedRange.remainder=data,segmentedRange;var last=moofs[moofs.length-1];return segmentedRange.valid=Object(_typed_array__WEBPACK_IMPORTED_MODULE_0__.sliceUint8)(data,0,last.start-8),segmentedRange.remainder=Object(_typed_array__WEBPACK_IMPORTED_MODULE_0__.sliceUint8)(data,last.start-8),segmentedRange}function appendUint8Array(data1,data2){var temp=new Uint8Array(data1.length+data2.length);return temp.set(data1),temp.set(data2,data1.length),temp}},"./src/utils/output-filter.ts":
/*!************************************!*\
        !*** ./src/utils/output-filter.ts ***!
        \************************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_1112675__){"use strict";__nested_webpack_require_1112675__.r(__webpack_exports__),__nested_webpack_require_1112675__.d(__webpack_exports__,"default",function(){return OutputFilter});var OutputFilter=function(){function OutputFilter(timelineController,trackName){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=timelineController,this.trackName=trackName}var _proto=OutputFilter.prototype;return _proto.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},_proto.newCue=function(startTime,endTime,screen){(null===this.startTime||this.startTime>startTime)&&(this.startTime=startTime),this.endTime=endTime,this.screen=screen,this.timelineController.createCaptionsTrack(this.trackName)},_proto.reset=function(){this.cueRanges=[]},OutputFilter}()},"./src/utils/texttrack-utils.ts":
/*!**************************************!*\
        !*** ./src/utils/texttrack-utils.ts ***!
        \**************************************/
/*! exports provided: sendAddTrackEvent, addCueToTrack, clearCurrentCues, removeCuesInRange, getCuesInRange */
function(module,__webpack_exports__,__nested_webpack_require_1114653__){"use strict";__nested_webpack_require_1114653__.r(__webpack_exports__),__nested_webpack_require_1114653__.d(__webpack_exports__,"sendAddTrackEvent",function(){return sendAddTrackEvent}),__nested_webpack_require_1114653__.d(__webpack_exports__,"addCueToTrack",function(){return addCueToTrack}),__nested_webpack_require_1114653__.d(__webpack_exports__,"clearCurrentCues",function(){return clearCurrentCues}),__nested_webpack_require_1114653__.d(__webpack_exports__,"removeCuesInRange",function(){return removeCuesInRange}),__nested_webpack_require_1114653__.d(__webpack_exports__,"getCuesInRange",function(){return getCuesInRange});var _logger__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_1114653__(
/*! ./logger */
"./src/utils/logger.ts");function sendAddTrackEvent(track,videoEl){var event;try{event=new Event("addtrack")}catch(err){(event=document.createEvent("Event")).initEvent("addtrack",!1,!1)}event.track=track,videoEl.dispatchEvent(event)}function addCueToTrack(track,cue){var mode=track.mode;if("disabled"===mode&&(track.mode="hidden"),track.cues&&!track.cues.getCueById(cue.id))try{if(track.addCue(cue),!track.cues.getCueById(cue.id))throw new Error("addCue is failed for: "+cue)}catch(err){_logger__WEBPACK_IMPORTED_MODULE_0__.logger.debug("[texttrack-utils]: "+err);var textTrackCue=new self.TextTrackCue(cue.startTime,cue.endTime,cue.text);textTrackCue.id=cue.id,track.addCue(textTrackCue)}"disabled"===mode&&(track.mode=mode)}function clearCurrentCues(track){var mode=track.mode;if("disabled"===mode&&(track.mode="hidden"),track.cues)for(var i=track.cues.length;i--;)track.removeCue(track.cues[i]);"disabled"===mode&&(track.mode=mode)}function removeCuesInRange(track,start,end){var mode=track.mode;if("disabled"===mode&&(track.mode="hidden"),track.cues&&track.cues.length>0)for(var cues=getCuesInRange(track.cues,start,end),i=0;i<cues.length;i++)track.removeCue(cues[i]);"disabled"===mode&&(track.mode=mode)}function getCuesInRange(cues,start,end){var cuesFound=[],firstCueInRange=function(cues,time){if(time<cues[0].startTime)return 0;var len=cues.length-1;if(time>cues[len].endTime)return-1;for(var left=0,right=len;left<=right;){var mid=Math.floor((right+left)/2);if(time<cues[mid].startTime)right=mid-1;else{if(!(time>cues[mid].startTime&&left<len))return mid;left=mid+1}}return cues[left].startTime-time<time-cues[right].startTime?left:right}(cues,start);if(firstCueInRange>-1)for(var i=firstCueInRange,len=cues.length;i<len;i++){var cue=cues[i];if(cue.startTime>=start&&cue.endTime<=end)cuesFound.push(cue);else if(cue.startTime>end)return cuesFound}return cuesFound}},"./src/utils/time-ranges.ts":
/*!**********************************!*\
        !*** ./src/utils/time-ranges.ts ***!
        \**********************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_1120382__){"use strict";__nested_webpack_require_1120382__.r(__webpack_exports__),__webpack_exports__.default={toString:function(r){for(var log="",len=r.length,i=0;i<len;i++)log+="["+r.start(i).toFixed(3)+","+r.end(i).toFixed(3)+"]";return log}}},"./src/utils/timescale-conversion.ts":
/*!*******************************************!*\
        !*** ./src/utils/timescale-conversion.ts ***!
        \*******************************************/
/*! exports provided: toTimescaleFromBase, toTimescaleFromScale, toMsFromMpegTsClock, toMpegTsClockFromTimescale */
function(module,__webpack_exports__,__nested_webpack_require_1121411__){"use strict";function toTimescaleFromBase(value,destScale,srcBase,round){void 0===srcBase&&(srcBase=1),void 0===round&&(round=!1);var result=value*destScale*srcBase;return round?Math.round(result):result}function toTimescaleFromScale(value,destScale,srcScale,round){return void 0===srcScale&&(srcScale=1),void 0===round&&(round=!1),toTimescaleFromBase(value,destScale,1/srcScale,round)}function toMsFromMpegTsClock(value,round){return void 0===round&&(round=!1),toTimescaleFromBase(value,1e3,1/9e4,round)}function toMpegTsClockFromTimescale(value,srcScale){return void 0===srcScale&&(srcScale=1),toTimescaleFromBase(value,9e4,1/srcScale)}__nested_webpack_require_1121411__.r(__webpack_exports__),__nested_webpack_require_1121411__.d(__webpack_exports__,"toTimescaleFromBase",function(){return toTimescaleFromBase}),__nested_webpack_require_1121411__.d(__webpack_exports__,"toTimescaleFromScale",function(){return toTimescaleFromScale}),__nested_webpack_require_1121411__.d(__webpack_exports__,"toMsFromMpegTsClock",function(){return toMsFromMpegTsClock}),__nested_webpack_require_1121411__.d(__webpack_exports__,"toMpegTsClockFromTimescale",function(){return toMpegTsClockFromTimescale})},"./src/utils/typed-array.ts":
/*!**********************************!*\
        !*** ./src/utils/typed-array.ts ***!
        \**********************************/
/*! exports provided: sliceUint8 */
function(module,__webpack_exports__,__nested_webpack_require_1123771__){"use strict";function sliceUint8(array,start,end){return Uint8Array.prototype.slice?array.slice(start,end):new Uint8Array(Array.prototype.slice.call(array,start,end))}__nested_webpack_require_1123771__.r(__webpack_exports__),__nested_webpack_require_1123771__.d(__webpack_exports__,"sliceUint8",function(){return sliceUint8})},"./src/utils/vttcue.ts":
/*!*****************************!*\
        !*** ./src/utils/vttcue.ts ***!
        \*****************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_1124708__){"use strict";__nested_webpack_require_1124708__.r(__webpack_exports__),__webpack_exports__.default=function(){if("undefined"!=typeof self&&self.VTTCue)return self.VTTCue;var AllowedDirections=["","lr","rl"],AllowedAlignments=["start","middle","end","left","right"];function isAllowedValue(allowed,value){if("string"!=typeof value)return!1;if(!Array.isArray(allowed))return!1;var lcValue=value.toLowerCase();return!!~allowed.indexOf(lcValue)&&lcValue}function findAlignSetting(value){return isAllowedValue(AllowedAlignments,value)}function extend(obj){for(var _len=arguments.length,rest=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)rest[_key-1]=arguments[_key];for(var i=1;i<arguments.length;i++){var cobj=arguments[i];for(var p in cobj)obj[p]=cobj[p]}return obj}function VTTCue(startTime,endTime,text){var cue=this,baseObj={enumerable:!0};cue.hasBeenReset=!1;var _id="",_pauseOnExit=!1,_startTime=startTime,_endTime=endTime,_text=text,_region=null,_vertical="",_snapToLines=!0,_line="auto",_lineAlign="start",_position=50,_positionAlign="middle",_size=50,_align="middle";Object.defineProperty(cue,"id",extend({},baseObj,{get:function(){return _id},set:function(value){_id=""+value}})),Object.defineProperty(cue,"pauseOnExit",extend({},baseObj,{get:function(){return _pauseOnExit},set:function(value){_pauseOnExit=!!value}})),Object.defineProperty(cue,"startTime",extend({},baseObj,{get:function(){return _startTime},set:function(value){if("number"!=typeof value)throw new TypeError("Start time must be set to a number.");_startTime=value,this.hasBeenReset=!0}})),Object.defineProperty(cue,"endTime",extend({},baseObj,{get:function(){return _endTime},set:function(value){if("number"!=typeof value)throw new TypeError("End time must be set to a number.");_endTime=value,this.hasBeenReset=!0}})),Object.defineProperty(cue,"text",extend({},baseObj,{get:function(){return _text},set:function(value){_text=""+value,this.hasBeenReset=!0}})),Object.defineProperty(cue,"region",extend({},baseObj,{get:function(){return _region},set:function(value){_region=value,this.hasBeenReset=!0}})),Object.defineProperty(cue,"vertical",extend({},baseObj,{get:function(){return _vertical},set:function(value){var setting=function(value){return isAllowedValue(AllowedDirections,value)}(value);if(!1===setting)throw new SyntaxError("An invalid or illegal string was specified.");_vertical=setting,this.hasBeenReset=!0}})),Object.defineProperty(cue,"snapToLines",extend({},baseObj,{get:function(){return _snapToLines},set:function(value){_snapToLines=!!value,this.hasBeenReset=!0}})),Object.defineProperty(cue,"line",extend({},baseObj,{get:function(){return _line},set:function(value){if("number"!=typeof value&&"auto"!==value)throw new SyntaxError("An invalid number or illegal string was specified.");_line=value,this.hasBeenReset=!0}})),Object.defineProperty(cue,"lineAlign",extend({},baseObj,{get:function(){return _lineAlign},set:function(value){var setting=findAlignSetting(value);if(!setting)throw new SyntaxError("An invalid or illegal string was specified.");_lineAlign=setting,this.hasBeenReset=!0}})),Object.defineProperty(cue,"position",extend({},baseObj,{get:function(){return _position},set:function(value){if(value<0||value>100)throw new Error("Position must be between 0 and 100.");_position=value,this.hasBeenReset=!0}})),Object.defineProperty(cue,"positionAlign",extend({},baseObj,{get:function(){return _positionAlign},set:function(value){var setting=findAlignSetting(value);if(!setting)throw new SyntaxError("An invalid or illegal string was specified.");_positionAlign=setting,this.hasBeenReset=!0}})),Object.defineProperty(cue,"size",extend({},baseObj,{get:function(){return _size},set:function(value){if(value<0||value>100)throw new Error("Size must be between 0 and 100.");_size=value,this.hasBeenReset=!0}})),Object.defineProperty(cue,"align",extend({},baseObj,{get:function(){return _align},set:function(value){var setting=findAlignSetting(value);if(!setting)throw new SyntaxError("An invalid or illegal string was specified.");_align=setting,this.hasBeenReset=!0}})),cue.displayState=void 0}return VTTCue.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},VTTCue}()},"./src/utils/vttparser.ts":
/*!********************************!*\
        !*** ./src/utils/vttparser.ts ***!
        \********************************/
/*! exports provided: parseTimeStamp, fixLineBreaks, VTTParser */
function(module,__webpack_exports__,__nested_webpack_require_1135230__){"use strict";__nested_webpack_require_1135230__.r(__webpack_exports__),__nested_webpack_require_1135230__.d(__webpack_exports__,"parseTimeStamp",function(){return parseTimeStamp}),__nested_webpack_require_1135230__.d(__webpack_exports__,"fixLineBreaks",function(){return fixLineBreaks}),__nested_webpack_require_1135230__.d(__webpack_exports__,"VTTParser",function(){return VTTParser});var _vttcue__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_1135230__(
/*! ./vttcue */
"./src/utils/vttcue.ts"),StringDecoder=function(){function StringDecoder(){}return StringDecoder.prototype.decode=function(data,options){if(!data)return"";if("string"!=typeof data)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(data))},StringDecoder}();function parseTimeStamp(input){function computeSeconds(h,m,s,f){return 3600*(0|h)+60*(0|m)+(0|s)+parseFloat(f||0)}var m=input.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return m?parseFloat(m[2])>59?computeSeconds(m[2],m[3],0,m[4]):computeSeconds(m[1],m[2],m[3],m[4]):null}var Settings=function(){function Settings(){this.values=Object.create(null)}var _proto2=Settings.prototype;return _proto2.set=function(k,v){this.get(k)||""===v||(this.values[k]=v)},_proto2.get=function(k,dflt,defaultKey){return defaultKey?this.has(k)?this.values[k]:dflt[defaultKey]:this.has(k)?this.values[k]:dflt},_proto2.has=function(k){return k in this.values},_proto2.alt=function(k,v,a){for(var n=0;n<a.length;++n)if(v===a[n]){this.set(k,v);break}},_proto2.integer=function(k,v){/^-?\d+$/.test(v)&&this.set(k,parseInt(v,10))},_proto2.percent=function(k,v){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(v)){var percent=parseFloat(v);if(percent>=0&&percent<=100)return this.set(k,percent),!0}return!1},Settings}();function parseOptions(input,callback,keyValueDelim,groupDelim){var groups=groupDelim?input.split(groupDelim):[input];for(var i in groups)if("string"==typeof groups[i]){var kv=groups[i].split(keyValueDelim);2===kv.length&&callback(kv[0],kv[1])}}var defaults=new _vttcue__WEBPACK_IMPORTED_MODULE_0__.default(0,0,""),center="middle"===defaults.align?"middle":"center";function parseCue(input,cue,regionList){var oInput=input;function consumeTimeStamp(){var ts=parseTimeStamp(input);if(null===ts)throw new Error("Malformed timestamp: "+oInput);return input=input.replace(/^[^\sa-zA-Z-]+/,""),ts}function skipWhitespace(){input=input.replace(/^\s+/,"")}if(skipWhitespace(),cue.startTime=consumeTimeStamp(),skipWhitespace(),"--\x3e"!==input.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+oInput);input=input.substr(3),skipWhitespace(),cue.endTime=consumeTimeStamp(),skipWhitespace(),function(input,cue){var settings=new Settings;parseOptions(input,function(k,v){var vals;switch(k){case"region":for(var i=regionList.length-1;i>=0;i--)if(regionList[i].id===v){settings.set(k,regionList[i].region);break}break;case"vertical":settings.alt(k,v,["rl","lr"]);break;case"line":vals=v.split(","),settings.integer(k,vals[0]),settings.percent(k,vals[0])&&settings.set("snapToLines",!1),settings.alt(k,vals[0],["auto"]),2===vals.length&&settings.alt("lineAlign",vals[1],["start",center,"end"]);break;case"position":vals=v.split(","),settings.percent(k,vals[0]),2===vals.length&&settings.alt("positionAlign",vals[1],["start",center,"end","line-left","line-right","auto"]);break;case"size":settings.percent(k,v);break;case"align":settings.alt(k,v,["start",center,"end","left","right"])}},/:/,/\s/),cue.region=settings.get("region",null),cue.vertical=settings.get("vertical","");var line=settings.get("line","auto");"auto"===line&&-1===defaults.line&&(line=-1),cue.line=line,cue.lineAlign=settings.get("lineAlign","start"),cue.snapToLines=settings.get("snapToLines",!0),cue.size=settings.get("size",100),cue.align=settings.get("align",center);var position=settings.get("position","auto");"auto"===position&&50===defaults.position&&(position="start"===cue.align||"left"===cue.align?0:"end"===cue.align||"right"===cue.align?100:50),cue.position=position}(input,cue)}function fixLineBreaks(input){return input.replace(/<br(?: \/)?>/gi,"\n")}var VTTParser=function(){function VTTParser(){this.state="INITIAL",this.buffer="",this.decoder=new StringDecoder,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var _proto3=VTTParser.prototype;return _proto3.parse=function(data){var _this=this;function collectNextLine(){var buffer=_this.buffer,pos=0;for(buffer=fixLineBreaks(buffer);pos<buffer.length&&"\r"!==buffer[pos]&&"\n"!==buffer[pos];)++pos;var line=buffer.substr(0,pos);return"\r"===buffer[pos]&&++pos,"\n"===buffer[pos]&&++pos,_this.buffer=buffer.substr(pos),line}data&&(_this.buffer+=_this.decoder.decode(data,{stream:!0}));try{var line="";if("INITIAL"===_this.state){if(!/\r\n|\n/.test(_this.buffer))return this;var m=(line=collectNextLine()).match(/^(\xef\xbb\xbf)?WEBVTT([ \t].*)?$/);if(!m||!m[0])throw new Error("Malformed WebVTT signature.");_this.state="HEADER"}for(var alreadyCollectedLine=!1;_this.buffer;){if(!/\r\n|\n/.test(_this.buffer))return this;switch(alreadyCollectedLine?alreadyCollectedLine=!1:line=collectNextLine(),_this.state){case"HEADER":/:/.test(line)?parseOptions(line,function(k,v){},/:/):line||(_this.state="ID");continue;case"NOTE":line||(_this.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(line)){_this.state="NOTE";break}if(!line)continue;if(_this.cue=new _vttcue__WEBPACK_IMPORTED_MODULE_0__.default(0,0,""),_this.state="CUE",-1===line.indexOf("--\x3e")){_this.cue.id=line;continue}case"CUE":if(!_this.cue){_this.state="BADCUE";continue}try{parseCue(line,_this.cue,_this.regionList)}catch(e){_this.cue=null,_this.state="BADCUE";continue}_this.state="CUETEXT";continue;case"CUETEXT":var hasSubstring=-1!==line.indexOf("--\x3e");if(!line||hasSubstring&&(alreadyCollectedLine=!0)){_this.oncue&&_this.cue&&_this.oncue(_this.cue),_this.cue=null,_this.state="ID";continue}if(null===_this.cue)continue;_this.cue.text&&(_this.cue.text+="\n"),_this.cue.text+=line;continue;case"BADCUE":line||(_this.state="ID")}}}catch(e){"CUETEXT"===_this.state&&_this.cue&&_this.oncue&&_this.oncue(_this.cue),_this.cue=null,_this.state="INITIAL"===_this.state?"BADWEBVTT":"BADCUE"}return this},_proto3.flush=function(){try{if((this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state||"BADWEBVTT"===this.state)throw new Error("Malformed WebVTT signature.")}catch(e){this.onparsingerror&&this.onparsingerror(e)}return this.onflush&&this.onflush(),this},VTTParser}()},"./src/utils/webvtt-parser.ts":
/*!************************************!*\
        !*** ./src/utils/webvtt-parser.ts ***!
        \************************************/
/*! exports provided: generateCueId, parseWebVTT */
function(module,__webpack_exports__,__nested_webpack_require_1153379__){"use strict";__nested_webpack_require_1153379__.r(__webpack_exports__),__nested_webpack_require_1153379__.d(__webpack_exports__,"generateCueId",function(){return generateCueId}),__nested_webpack_require_1153379__.d(__webpack_exports__,"parseWebVTT",function(){return parseWebVTT});var _home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_1153379__(
/*! ./src/polyfills/number */
"./src/polyfills/number.ts"),_vttparser__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_1153379__(
/*! ./vttparser */
"./src/utils/vttparser.ts"),_demux_id3__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_1153379__(
/*! ../demux/id3 */
"./src/demux/id3.ts"),_timescale_conversion__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_1153379__(
/*! ./timescale-conversion */
"./src/utils/timescale-conversion.ts"),_remux_mp4_remuxer__WEBPACK_IMPORTED_MODULE_4__=__nested_webpack_require_1153379__(
/*! ../remux/mp4-remuxer */
"./src/remux/mp4-remuxer.ts"),LINEBREAKS=/\r\n|\n\r|\n|\r/g,startsWith=function(inputString,searchString,position){return void 0===position&&(position=0),inputString.substr(position,searchString.length)===searchString},hash=function(text){for(var hash=5381,i=text.length;i;)hash=33*hash^text.charCodeAt(--i);return(hash>>>0).toString()};function generateCueId(startTime,endTime,text){return hash(startTime.toString())+hash(endTime.toString())+hash(text)}function parseWebVTT(vttByteArray,initPTS,timescale,vttCCs,cc,timeOffset,callBack,errorCallBack){var parsingError,parser=new _vttparser__WEBPACK_IMPORTED_MODULE_1__.VTTParser,vttLines=Object(_demux_id3__WEBPACK_IMPORTED_MODULE_2__.utf8ArrayToStr)(new Uint8Array(vttByteArray)).trim().replace(LINEBREAKS,"\n").split("\n"),cues=[],initPTS90Hz=Object(_timescale_conversion__WEBPACK_IMPORTED_MODULE_3__.toMpegTsClockFromTimescale)(initPTS,timescale),cueTime="00:00.000",timestampMapMPEGTS=0,timestampMapLOCAL=0,inHeader=!0,timestampMap=!1;parser.oncue=function(cue){var currCC=vttCCs[cc],cueOffset=vttCCs.ccOffset,webVttMpegTsMapOffset=(timestampMapMPEGTS-initPTS90Hz)/9e4;if(null!=currCC&&currCC.new&&(void 0!==timestampMapLOCAL?cueOffset=vttCCs.ccOffset=currCC.start:function(vttCCs,cc,presentationTime){var currCC=vttCCs[cc],prevCC=vttCCs[currCC.prevCC];if(!prevCC||!prevCC.new&&currCC.new)return vttCCs.ccOffset=vttCCs.presentationOffset=currCC.start,void(currCC.new=!1);for(;null!==(_prevCC=prevCC)&&void 0!==_prevCC&&_prevCC.new;){var _prevCC;vttCCs.ccOffset+=currCC.start-prevCC.start,currCC.new=!1,prevCC=vttCCs[(currCC=prevCC).prevCC]}vttCCs.presentationOffset=presentationTime}(vttCCs,cc,webVttMpegTsMapOffset)),webVttMpegTsMapOffset&&(cueOffset=webVttMpegTsMapOffset-vttCCs.presentationOffset),timestampMap){var duration=cue.endTime-cue.startTime,startTime=Object(_remux_mp4_remuxer__WEBPACK_IMPORTED_MODULE_4__.normalizePts)(9e4*(cue.startTime+cueOffset-timestampMapLOCAL),9e4*timeOffset)/9e4;cue.startTime=startTime,cue.endTime=startTime+duration}var text=cue.text.trim();cue.text=decodeURIComponent(encodeURIComponent(text)),cue.id||(cue.id=generateCueId(cue.startTime,cue.endTime,text)),cue.endTime>0&&cues.push(cue)},parser.onparsingerror=function(error){parsingError=error},parser.onflush=function(){parsingError?errorCallBack(parsingError):callBack(cues)},vttLines.forEach(function(line){if(inHeader){if(startsWith(line,"X-TIMESTAMP-MAP=")){inHeader=!1,timestampMap=!0,line.substr(16).split(",").forEach(function(timestamp){startsWith(timestamp,"LOCAL:")?cueTime=timestamp.substr(6):startsWith(timestamp,"MPEGTS:")&&(timestampMapMPEGTS=parseInt(timestamp.substr(7)))});try{timestampMapLOCAL=function(timeString){var ts=parseInt(timeString.substr(-3)),secs=parseInt(timeString.substr(-6,2)),mins=parseInt(timeString.substr(-9,2)),hours=timeString.length>9?parseInt(timeString.substr(0,timeString.indexOf(":"))):0;if(!(Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(ts)&&Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(secs)&&Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(mins)&&Object(_home_runner_work_hls_js_hls_js_src_polyfills_number__WEBPACK_IMPORTED_MODULE_0__.isFiniteNumber)(hours)))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+timeString);return ts+=1e3*secs,(ts+=6e4*mins)+36e5*hours}(cueTime)/1e3}catch(error){timestampMap=!1,parsingError=error}return}""===line&&(inHeader=!1)}parser.parse(line+"\n")}),parser.flush()}},"./src/utils/xhr-loader.ts":
/*!*********************************!*\
        !*** ./src/utils/xhr-loader.ts ***!
        \*********************************/
/*! exports provided: default */
function(module,__webpack_exports__,__nested_webpack_require_1162501__){"use strict";__nested_webpack_require_1162501__.r(__webpack_exports__);var _utils_logger__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_1162501__(
/*! ../utils/logger */
"./src/utils/logger.ts"),_loader_load_stats__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_1162501__(
/*! ../loader/load-stats */
"./src/loader/load-stats.ts"),AGE_HEADER_LINE_REGEX=/^age:\s*[\d.]+\s*$/m;__webpack_exports__.default=function(){function XhrLoader(config){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=config?config.xhrSetup:null,this.stats=new _loader_load_stats__WEBPACK_IMPORTED_MODULE_1__.LoadStats,this.retryDelay=0}var _proto=XhrLoader.prototype;return _proto.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},_proto.abortInternal=function(){var loader=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),loader&&(loader.onreadystatechange=null,loader.onprogress=null,4!==loader.readyState&&(this.stats.aborted=!0,loader.abort()))},_proto.abort=function(){var _this$callbacks;this.abortInternal(),null!==(_this$callbacks=this.callbacks)&&void 0!==_this$callbacks&&_this$callbacks.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},_proto.load=function(context,config,callbacks){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=context,this.config=config,this.callbacks=callbacks,this.retryDelay=config.retryDelay,this.loadInternal()},_proto.loadInternal=function(){var config=this.config,context=this.context;if(config){var xhr=this.loader=new self.XMLHttpRequest,stats=this.stats;stats.loading.first=0,stats.loaded=0;var xhrSetup=this.xhrSetup;try{if(xhrSetup)try{xhrSetup(xhr,context.url)}catch(e){xhr.open("GET",context.url,!0),xhrSetup(xhr,context.url)}xhr.readyState||xhr.open("GET",context.url,!0)}catch(e){return void this.callbacks.onError({code:xhr.status,text:e.message},context,xhr)}context.rangeEnd&&xhr.setRequestHeader("Range","bytes="+context.rangeStart+"-"+(context.rangeEnd-1)),xhr.onreadystatechange=this.readystatechange.bind(this),xhr.onprogress=this.loadprogress.bind(this),xhr.responseType=context.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),config.timeout),xhr.send()}},_proto.readystatechange=function(){var context=this.context,xhr=this.loader,stats=this.stats;if(context&&xhr){var readyState=xhr.readyState,config=this.config;if(!stats.aborted&&readyState>=2)if(self.clearTimeout(this.requestTimeout),0===stats.loading.first&&(stats.loading.first=Math.max(self.performance.now(),stats.loading.start)),4===readyState){xhr.onreadystatechange=null,xhr.onprogress=null;var status=xhr.status;if(status>=200&&status<300){var data,len;if(stats.loading.end=Math.max(self.performance.now(),stats.loading.first),len="arraybuffer"===context.responseType?(data=xhr.response).byteLength:(data=xhr.responseText).length,stats.loaded=stats.total=len,!this.callbacks)return;var onProgress=this.callbacks.onProgress;if(onProgress&&onProgress(stats,context,data,xhr),!this.callbacks)return;this.callbacks.onSuccess({url:xhr.responseURL,data:data},stats,context,xhr)}else stats.retry>=config.maxRetry||status>=400&&status<499?(_utils_logger__WEBPACK_IMPORTED_MODULE_0__.logger.error(status+" while loading "+context.url),this.callbacks.onError({code:status,text:xhr.statusText},context,xhr)):(_utils_logger__WEBPACK_IMPORTED_MODULE_0__.logger.warn(status+" while loading "+context.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,config.maxRetryDelay),stats.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),config.timeout)}},_proto.loadtimeout=function(){_utils_logger__WEBPACK_IMPORTED_MODULE_0__.logger.warn("timeout while loading "+this.context.url);var callbacks=this.callbacks;callbacks&&(this.abortInternal(),callbacks.onTimeout(this.stats,this.context,this.loader))},_proto.loadprogress=function(event){var stats=this.stats;stats.loaded=event.loaded,event.lengthComputable&&(stats.total=event.total)},_proto.getCacheAge=function(){var result=null;if(this.loader&&AGE_HEADER_LINE_REGEX.test(this.loader.getAllResponseHeaders())){var ageHeader=this.loader.getResponseHeader("age");result=ageHeader?parseFloat(ageHeader):null}return result},XhrLoader}()}}).default},module.exports=factory())},51208:(__unused_webpack_module,exports)=>{
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,nBits=-7,i=isLE?nBytes-1:0,d=isLE?-1:1,s=buffer[offset+i];for(i+=d,e=s&(1<<-nBits)-1,s>>=-nBits,nBits+=eLen;nBits>0;e=256*e+buffer[offset+i],i+=d,nBits-=8);for(m=e&(1<<-nBits)-1,e>>=-nBits,nBits+=mLen;nBits>0;m=256*m+buffer[offset+i],i+=d,nBits-=8);if(0===e)e=1-eBias;else{if(e===eMax)return m?NaN:1/0*(s?-1:1);m+=Math.pow(2,mLen),e-=eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)},exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=23===mLen?Math.pow(2,-24)-Math.pow(2,-77):0,i=isLE?0:nBytes-1,d=isLE?1:-1,s=value<0||0===value&&1/value<0?1:0;for(value=Math.abs(value),isNaN(value)||value===1/0?(m=isNaN(value)?1:0,e=eMax):(e=Math.floor(Math.log(value)/Math.LN2),value*(c=Math.pow(2,-e))<1&&(e--,c*=2),(value+=e+eBias>=1?rt/c:rt*Math.pow(2,1-eBias))*c>=2&&(e++,c/=2),e+eBias>=eMax?(m=0,e=eMax):e+eBias>=1?(m=(value*c-1)*Math.pow(2,mLen),e+=eBias):(m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen),e=0));mLen>=8;buffer[offset+i]=255&m,i+=d,m/=256,mLen-=8);for(e=e<<mLen|m,eLen+=mLen;eLen>0;buffer[offset+i]=255&e,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=128*s}},50985:module=>{module.exports=function(fn){if(!fn)return!1;var string=toString.call(fn);return"[object Function]"===string||"function"==typeof fn&&"[object RegExp]"!==string||"undefined"!=typeof window&&(fn===window.setTimeout||fn===window.alert||fn===window.confirm||fn===window.prompt)};var toString=Object.prototype.toString},16444:(module,exports)=>{function keyCode(searchInput){if(searchInput&&"object"==typeof searchInput){var hasKeyCode=searchInput.which||searchInput.keyCode||searchInput.charCode;hasKeyCode&&(searchInput=hasKeyCode)}if("number"==typeof searchInput)return names[searchInput];var foundNamedKey,search=String(searchInput);return(foundNamedKey=codes[search.toLowerCase()])?foundNamedKey:(foundNamedKey=aliases[search.toLowerCase()])||(1===search.length?search.charCodeAt(0):void 0)}keyCode.isEventKey=function(event,nameOrCode){if(event&&"object"==typeof event){var keyCode=event.which||event.keyCode||event.charCode;if(null==keyCode)return!1;if("string"==typeof nameOrCode){var foundNamedKey;if(foundNamedKey=codes[nameOrCode.toLowerCase()])return foundNamedKey===keyCode;if(foundNamedKey=aliases[nameOrCode.toLowerCase()])return foundNamedKey===keyCode}else if("number"==typeof nameOrCode)return nameOrCode===keyCode;return!1}};var codes=(exports=module.exports=keyCode).code=exports.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},aliases=exports.aliases={windows:91,"\u21e7":16,"\u2325":18,"\u2303":17,"\u2318":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};
/*!
 * Programatically add the following
 */
for(i=97;i<123;i++)codes[String.fromCharCode(i)]=i-32;for(var i=48;i<58;i++)codes[i-48]=i;for(i=1;i<13;i++)codes["f"+i]=i+111;for(i=0;i<10;i++)codes["numpad "+i]=i+96;var names=exports.names=exports.title={};for(i in codes)names[codes[i]]=i;for(var alias in aliases)codes[alias]=aliases[alias]},3132:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */module=__webpack_require__.nmd(module),function(){var FUNC_ERROR_TEXT="Expected a function",PLACEHOLDER="__lodash_placeholder__",wrapFlags=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],argsTag="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",reEmptyStringLeading=/\b__p \+= '';/g,reEmptyStringMiddle=/\b(__p \+=) '' \+/g,reEmptyStringTrailing=/(__e\(.*?\)|\b__t\)) \+\n'';/g,reEscapedHtml=/&(?:amp|lt|gt|quot|#39);/g,reUnescapedHtml=/[&<>"']/g,reHasEscapedHtml=RegExp(reEscapedHtml.source),reHasUnescapedHtml=RegExp(reUnescapedHtml.source),reEscape=/<%-([\s\S]+?)%>/g,reEvaluate=/<%([\s\S]+?)%>/g,reInterpolate=/<%=([\s\S]+?)%>/g,reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/,rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reHasRegExpChar=RegExp(reRegExpChar.source),reTrimStart=/^\s+/,reWhitespace=/\s/,reWrapComment=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,reWrapDetails=/\{\n\/\* \[wrapped with (.+)\] \*/,reSplitDetails=/,? & /,reAsciiWord=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,reForbiddenIdentifierChars=/[()=,{}\[\]\/\s]/,reEscapeChar=/\\(\\)?/g,reEsTemplate=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,reFlags=/\w*$/,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsHostCtor=/^\[object .+?Constructor\]$/,reIsOctal=/^0o[0-7]+$/i,reIsUint=/^(?:0|[1-9]\d*)$/,reLatin=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,reNoMatch=/($^)/,reUnescapedString=/['\n\r\u2028\u2029\\]/g,rsComboRange="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",rsBreakRange="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",rsBreak="["+rsBreakRange+"]",rsCombo="["+rsComboRange+"]",rsDigits="\\d+",rsLower="[a-z\\xdf-\\xf6\\xf8-\\xff]",rsMisc="[^\\ud800-\\udfff"+rsBreakRange+rsDigits+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",rsFitz="\\ud83c[\\udffb-\\udfff]",rsNonAstral="[^\\ud800-\\udfff]",rsRegional="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair="[\\ud800-\\udbff][\\udc00-\\udfff]",rsUpper="[A-Z\\xc0-\\xd6\\xd8-\\xde]",rsMiscLower="(?:"+rsLower+"|"+rsMisc+")",rsMiscUpper="(?:"+rsUpper+"|"+rsMisc+")",reOptMod="(?:"+rsCombo+"|"+rsFitz+")?",rsSeq="[\\ufe0e\\ufe0f]?"+reOptMod+"(?:\\u200d(?:"+[rsNonAstral,rsRegional,rsSurrPair].join("|")+")[\\ufe0e\\ufe0f]?"+reOptMod+")*",rsEmoji="(?:"+["[\\u2700-\\u27bf]",rsRegional,rsSurrPair].join("|")+")"+rsSeq,rsSymbol="(?:"+[rsNonAstral+rsCombo+"?",rsCombo,rsRegional,rsSurrPair,"[\\ud800-\\udfff]"].join("|")+")",reApos=RegExp("['\u2019]","g"),reComboMark=RegExp(rsCombo,"g"),reUnicode=RegExp(rsFitz+"(?="+rsFitz+")|"+rsSymbol+rsSeq,"g"),reUnicodeWord=RegExp([rsUpper+"?"+rsLower+"+(?:['\u2019](?:d|ll|m|re|s|t|ve))?(?="+[rsBreak,rsUpper,"$"].join("|")+")",rsMiscUpper+"+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?(?="+[rsBreak,rsUpper+rsMiscLower,"$"].join("|")+")",rsUpper+"?"+rsMiscLower+"+(?:['\u2019](?:d|ll|m|re|s|t|ve))?",rsUpper+"+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",rsDigits,rsEmoji].join("|"),"g"),reHasUnicode=RegExp("[\\u200d\\ud800-\\udfff"+rsComboRange+"\\ufe0e\\ufe0f]"),reHasUnicodeWord=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,contextProps=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],templateCounter=-1,typedArrayTags={};typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags["[object Uint8ClampedArray]"]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0,typedArrayTags[argsTag]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dataViewTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=!1;var cloneableTags={};cloneableTags[argsTag]=cloneableTags[arrayTag]=cloneableTags[arrayBufferTag]=cloneableTags[dataViewTag]=cloneableTags[boolTag]=cloneableTags[dateTag]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag]=cloneableTags[numberTag]=cloneableTags[objectTag]=cloneableTags[regexpTag]=cloneableTags[setTag]=cloneableTags[stringTag]=cloneableTags[symbolTag]=cloneableTags[uint8Tag]=cloneableTags["[object Uint8ClampedArray]"]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0,cloneableTags[errorTag]=cloneableTags[funcTag]=cloneableTags[weakMapTag]=!1;var stringEscapes={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},freeParseFloat=parseFloat,freeParseInt=parseInt,freeGlobal="object"==typeof global&&global&&global.Object===Object&&global,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),freeExports=exports&&!exports.nodeType&&exports,freeModule=freeExports&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,freeProcess=moduleExports&&freeGlobal.process,nodeUtil=function(){try{return freeModule&&freeModule.require&&freeModule.require("util").types||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(e){}}(),nodeIsArrayBuffer=nodeUtil&&nodeUtil.isArrayBuffer,nodeIsDate=nodeUtil&&nodeUtil.isDate,nodeIsMap=nodeUtil&&nodeUtil.isMap,nodeIsRegExp=nodeUtil&&nodeUtil.isRegExp,nodeIsSet=nodeUtil&&nodeUtil.isSet,nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray;function apply(func,thisArg,args){switch(args.length){case 0:return func.call(thisArg);case 1:return func.call(thisArg,args[0]);case 2:return func.call(thisArg,args[0],args[1]);case 3:return func.call(thisArg,args[0],args[1],args[2])}return func.apply(thisArg,args)}function arrayAggregator(array,setter,iteratee,accumulator){for(var index=-1,length=null==array?0:array.length;++index<length;){var value=array[index];setter(accumulator,value,iteratee(value),array)}return accumulator}function arrayEach(array,iteratee){for(var index=-1,length=null==array?0:array.length;++index<length&&!1!==iteratee(array[index],index,array););return array}function arrayEachRight(array,iteratee){for(var length=null==array?0:array.length;length--&&!1!==iteratee(array[length],length,array););return array}function arrayEvery(array,predicate){for(var index=-1,length=null==array?0:array.length;++index<length;)if(!predicate(array[index],index,array))return!1;return!0}function arrayFilter(array,predicate){for(var index=-1,length=null==array?0:array.length,resIndex=0,result=[];++index<length;){var value=array[index];predicate(value,index,array)&&(result[resIndex++]=value)}return result}function arrayIncludes(array,value){return!(null==array||!array.length)&&baseIndexOf(array,value,0)>-1}function arrayIncludesWith(array,value,comparator){for(var index=-1,length=null==array?0:array.length;++index<length;)if(comparator(value,array[index]))return!0;return!1}function arrayMap(array,iteratee){for(var index=-1,length=null==array?0:array.length,result=Array(length);++index<length;)result[index]=iteratee(array[index],index,array);return result}function arrayPush(array,values){for(var index=-1,length=values.length,offset=array.length;++index<length;)array[offset+index]=values[index];return array}function arrayReduce(array,iteratee,accumulator,initAccum){var index=-1,length=null==array?0:array.length;for(initAccum&&length&&(accumulator=array[++index]);++index<length;)accumulator=iteratee(accumulator,array[index],index,array);return accumulator}function arrayReduceRight(array,iteratee,accumulator,initAccum){var length=null==array?0:array.length;for(initAccum&&length&&(accumulator=array[--length]);length--;)accumulator=iteratee(accumulator,array[length],length,array);return accumulator}function arraySome(array,predicate){for(var index=-1,length=null==array?0:array.length;++index<length;)if(predicate(array[index],index,array))return!0;return!1}var asciiSize=baseProperty("length");function baseFindKey(collection,predicate,eachFunc){var result;return eachFunc(collection,function(value,key,collection){if(predicate(value,key,collection))return result=key,!1}),result}function baseFindIndex(array,predicate,fromIndex,fromRight){for(var length=array.length,index=fromIndex+(fromRight?1:-1);fromRight?index--:++index<length;)if(predicate(array[index],index,array))return index;return-1}function baseIndexOf(array,value,fromIndex){return value==value?function(array,value,fromIndex){for(var index=fromIndex-1,length=array.length;++index<length;)if(array[index]===value)return index;return-1}(array,value,fromIndex):baseFindIndex(array,baseIsNaN,fromIndex)}function baseIndexOfWith(array,value,fromIndex,comparator){for(var index=fromIndex-1,length=array.length;++index<length;)if(comparator(array[index],value))return index;return-1}function baseIsNaN(value){return value!=value}function baseMean(array,iteratee){var length=null==array?0:array.length;return length?baseSum(array,iteratee)/length:NaN}function baseProperty(key){return function(object){return null==object?void 0:object[key]}}function basePropertyOf(object){return function(key){return null==object?void 0:object[key]}}function baseReduce(collection,iteratee,accumulator,initAccum,eachFunc){return eachFunc(collection,function(value,index,collection){accumulator=initAccum?(initAccum=!1,value):iteratee(accumulator,value,index,collection)}),accumulator}function baseSum(array,iteratee){for(var result,index=-1,length=array.length;++index<length;){var current=iteratee(array[index]);void 0!==current&&(result=void 0===result?current:result+current)}return result}function baseTimes(n,iteratee){for(var index=-1,result=Array(n);++index<n;)result[index]=iteratee(index);return result}function baseTrim(string){return string?string.slice(0,trimmedEndIndex(string)+1).replace(reTrimStart,""):string}function baseUnary(func){return function(value){return func(value)}}function baseValues(object,props){return arrayMap(props,function(key){return object[key]})}function cacheHas(cache,key){return cache.has(key)}function charsStartIndex(strSymbols,chrSymbols){for(var index=-1,length=strSymbols.length;++index<length&&baseIndexOf(chrSymbols,strSymbols[index],0)>-1;);return index}function charsEndIndex(strSymbols,chrSymbols){for(var index=strSymbols.length;index--&&baseIndexOf(chrSymbols,strSymbols[index],0)>-1;);return index}function countHolders(array,placeholder){for(var length=array.length,result=0;length--;)array[length]===placeholder&&++result;return result}var deburrLetter=basePropertyOf({"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\xc7":"C","\xe7":"c","\xd0":"D","\xf0":"d","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\xd1":"N","\xf1":"n","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O","\xd8":"O","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\xdd":"Y","\xfd":"y","\xff":"y","\xc6":"Ae","\xe6":"ae","\xde":"Th","\xfe":"th","\xdf":"ss","\u0100":"A","\u0102":"A","\u0104":"A","\u0101":"a","\u0103":"a","\u0105":"a","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\u010e":"D","\u0110":"D","\u010f":"d","\u0111":"d","\u0112":"E","\u0114":"E","\u0116":"E","\u0118":"E","\u011a":"E","\u0113":"e","\u0115":"e","\u0117":"e","\u0119":"e","\u011b":"e","\u011c":"G","\u011e":"G","\u0120":"G","\u0122":"G","\u011d":"g","\u011f":"g","\u0121":"g","\u0123":"g","\u0124":"H","\u0126":"H","\u0125":"h","\u0127":"h","\u0128":"I","\u012a":"I","\u012c":"I","\u012e":"I","\u0130":"I","\u0129":"i","\u012b":"i","\u012d":"i","\u012f":"i","\u0131":"i","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u0138":"k","\u0139":"L","\u013b":"L","\u013d":"L","\u013f":"L","\u0141":"L","\u013a":"l","\u013c":"l","\u013e":"l","\u0140":"l","\u0142":"l","\u0143":"N","\u0145":"N","\u0147":"N","\u014a":"N","\u0144":"n","\u0146":"n","\u0148":"n","\u014b":"n","\u014c":"O","\u014e":"O","\u0150":"O","\u014d":"o","\u014f":"o","\u0151":"o","\u0154":"R","\u0156":"R","\u0158":"R","\u0155":"r","\u0157":"r","\u0159":"r","\u015a":"S","\u015c":"S","\u015e":"S","\u0160":"S","\u015b":"s","\u015d":"s","\u015f":"s","\u0161":"s","\u0162":"T","\u0164":"T","\u0166":"T","\u0163":"t","\u0165":"t","\u0167":"t","\u0168":"U","\u016a":"U","\u016c":"U","\u016e":"U","\u0170":"U","\u0172":"U","\u0169":"u","\u016b":"u","\u016d":"u","\u016f":"u","\u0171":"u","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017b":"Z","\u017d":"Z","\u017a":"z","\u017c":"z","\u017e":"z","\u0132":"IJ","\u0133":"ij","\u0152":"Oe","\u0153":"oe","\u0149":"'n","\u017f":"s"}),escapeHtmlChar=basePropertyOf({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function escapeStringChar(chr){return"\\"+stringEscapes[chr]}function hasUnicode(string){return reHasUnicode.test(string)}function mapToArray(map){var index=-1,result=Array(map.size);return map.forEach(function(value,key){result[++index]=[key,value]}),result}function overArg(func,transform){return function(arg){return func(transform(arg))}}function replaceHolders(array,placeholder){for(var index=-1,length=array.length,resIndex=0,result=[];++index<length;){var value=array[index];value!==placeholder&&value!==PLACEHOLDER||(array[index]=PLACEHOLDER,result[resIndex++]=index)}return result}function setToArray(set){var index=-1,result=Array(set.size);return set.forEach(function(value){result[++index]=value}),result}function setToPairs(set){var index=-1,result=Array(set.size);return set.forEach(function(value){result[++index]=[value,value]}),result}function stringSize(string){return hasUnicode(string)?function(string){for(var result=reUnicode.lastIndex=0;reUnicode.test(string);)++result;return result}(string):asciiSize(string)}function stringToArray(string){return hasUnicode(string)?function(string){return string.match(reUnicode)||[]}(string):function(string){return string.split("")}(string)}function trimmedEndIndex(string){for(var index=string.length;index--&&reWhitespace.test(string.charAt(index)););return index}var unescapeHtmlChar=basePropertyOf({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),_=function runInContext(context){var uid,Array=(context=null==context?root:_.defaults(root.Object(),context,_.pick(root,contextProps))).Array,Date=context.Date,Error=context.Error,Function=context.Function,Math=context.Math,Object=context.Object,RegExp=context.RegExp,String=context.String,TypeError=context.TypeError,arrayProto=Array.prototype,objectProto=Object.prototype,coreJsData=context["__core-js_shared__"],funcToString=Function.prototype.toString,hasOwnProperty=objectProto.hasOwnProperty,idCounter=0,maskSrcKey=(uid=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||""))?"Symbol(src)_1."+uid:"",nativeObjectToString=objectProto.toString,objectCtorString=funcToString.call(Object),oldDash=root._,reIsNative=RegExp("^"+funcToString.call(hasOwnProperty).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Buffer=moduleExports?context.Buffer:void 0,Symbol=context.Symbol,Uint8Array=context.Uint8Array,allocUnsafe=Buffer?Buffer.allocUnsafe:void 0,getPrototype=overArg(Object.getPrototypeOf,Object),objectCreate=Object.create,propertyIsEnumerable=objectProto.propertyIsEnumerable,splice=arrayProto.splice,spreadableSymbol=Symbol?Symbol.isConcatSpreadable:void 0,symIterator=Symbol?Symbol.iterator:void 0,symToStringTag=Symbol?Symbol.toStringTag:void 0,defineProperty=function(){try{var func=getNative(Object,"defineProperty");return func({},"",{}),func}catch(e){}}(),ctxClearTimeout=context.clearTimeout!==root.clearTimeout&&context.clearTimeout,ctxNow=Date&&Date.now!==root.Date.now&&Date.now,ctxSetTimeout=context.setTimeout!==root.setTimeout&&context.setTimeout,nativeCeil=Math.ceil,nativeFloor=Math.floor,nativeGetSymbols=Object.getOwnPropertySymbols,nativeIsBuffer=Buffer?Buffer.isBuffer:void 0,nativeIsFinite=context.isFinite,nativeJoin=arrayProto.join,nativeKeys=overArg(Object.keys,Object),nativeMax=Math.max,nativeMin=Math.min,nativeNow=Date.now,nativeParseInt=context.parseInt,nativeRandom=Math.random,nativeReverse=arrayProto.reverse,DataView=getNative(context,"DataView"),Map=getNative(context,"Map"),Promise=getNative(context,"Promise"),Set=getNative(context,"Set"),WeakMap=getNative(context,"WeakMap"),nativeCreate=getNative(Object,"create"),metaMap=WeakMap&&new WeakMap,realNames={},dataViewCtorString=toSource(DataView),mapCtorString=toSource(Map),promiseCtorString=toSource(Promise),setCtorString=toSource(Set),weakMapCtorString=toSource(WeakMap),symbolProto=Symbol?Symbol.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0,symbolToString=symbolProto?symbolProto.toString:void 0;function lodash(value){if(isObjectLike(value)&&!isArray(value)&&!(value instanceof LazyWrapper)){if(value instanceof LodashWrapper)return value;if(hasOwnProperty.call(value,"__wrapped__"))return wrapperClone(value)}return new LodashWrapper(value)}var baseCreate=function(){function object(){}return function(proto){if(!isObject(proto))return{};if(objectCreate)return objectCreate(proto);object.prototype=proto;var result=new object;return object.prototype=void 0,result}}();function baseLodash(){}function LodashWrapper(value,chainAll){this.__wrapped__=value,this.__actions__=[],this.__chain__=!!chainAll,this.__index__=0,this.__values__=void 0}function LazyWrapper(value){this.__wrapped__=value,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Hash(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}function ListCache(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}function MapCache(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}function SetCache(values){var index=-1,length=null==values?0:values.length;for(this.__data__=new MapCache;++index<length;)this.add(values[index])}function Stack(entries){var data=this.__data__=new ListCache(entries);this.size=data.size}function arrayLikeKeys(value,inherited){var isArr=isArray(value),isArg=!isArr&&isArguments(value),isBuff=!isArr&&!isArg&&isBuffer(value),isType=!isArr&&!isArg&&!isBuff&&isTypedArray(value),skipIndexes=isArr||isArg||isBuff||isType,result=skipIndexes?baseTimes(value.length,String):[],length=result.length;for(var key in value)!inherited&&!hasOwnProperty.call(value,key)||skipIndexes&&("length"==key||isBuff&&("offset"==key||"parent"==key)||isType&&("buffer"==key||"byteLength"==key||"byteOffset"==key)||isIndex(key,length))||result.push(key);return result}function arraySample(array){var length=array.length;return length?array[baseRandom(0,length-1)]:void 0}function arraySampleSize(array,n){return shuffleSelf(copyArray(array),baseClamp(n,0,array.length))}function arrayShuffle(array){return shuffleSelf(copyArray(array))}function assignMergeValue(object,key,value){(void 0!==value&&!eq(object[key],value)||void 0===value&&!(key in object))&&baseAssignValue(object,key,value)}function assignValue(object,key,value){var objValue=object[key];hasOwnProperty.call(object,key)&&eq(objValue,value)&&(void 0!==value||key in object)||baseAssignValue(object,key,value)}function assocIndexOf(array,key){for(var length=array.length;length--;)if(eq(array[length][0],key))return length;return-1}function baseAggregator(collection,setter,iteratee,accumulator){return baseEach(collection,function(value,key,collection){setter(accumulator,value,iteratee(value),collection)}),accumulator}function baseAssign(object,source){return object&&copyObject(source,keys(source),object)}function baseAssignValue(object,key,value){"__proto__"==key&&defineProperty?defineProperty(object,key,{configurable:!0,enumerable:!0,value:value,writable:!0}):object[key]=value}function baseAt(object,paths){for(var index=-1,length=paths.length,result=Array(length),skip=null==object;++index<length;)result[index]=skip?void 0:get(object,paths[index]);return result}function baseClamp(number,lower,upper){return number==number&&(void 0!==upper&&(number=number<=upper?number:upper),void 0!==lower&&(number=number>=lower?number:lower)),number}function baseClone(value,bitmask,customizer,key,object,stack){var result,isDeep=1&bitmask,isFlat=2&bitmask,isFull=4&bitmask;if(customizer&&(result=object?customizer(value,key,object,stack):customizer(value)),void 0!==result)return result;if(!isObject(value))return value;var isArr=isArray(value);if(isArr){if(result=function(array){var length=array.length,result=new array.constructor(length);return length&&"string"==typeof array[0]&&hasOwnProperty.call(array,"index")&&(result.index=array.index,result.input=array.input),result}(value),!isDeep)return copyArray(value,result)}else{var tag=getTag(value),isFunc=tag==funcTag||tag==genTag;if(isBuffer(value))return cloneBuffer(value,isDeep);if(tag==objectTag||tag==argsTag||isFunc&&!object){if(result=isFlat||isFunc?{}:initCloneObject(value),!isDeep)return isFlat?function(source,object){return copyObject(source,getSymbolsIn(source),object)}(value,function(object,source){return object&&copyObject(source,keysIn(source),object)}(result,value)):function(source,object){return copyObject(source,getSymbols(source),object)}(value,baseAssign(result,value))}else{if(!cloneableTags[tag])return object?value:{};result=function(object,tag,isDeep){var Ctor=object.constructor;switch(tag){case arrayBufferTag:return cloneArrayBuffer(object);case boolTag:case dateTag:return new Ctor(+object);case dataViewTag:return function(dataView,isDeep){var buffer=isDeep?cloneArrayBuffer(dataView.buffer):dataView.buffer;return new dataView.constructor(buffer,dataView.byteOffset,dataView.byteLength)}(object,isDeep);case float32Tag:case float64Tag:case int8Tag:case int16Tag:case int32Tag:case uint8Tag:case"[object Uint8ClampedArray]":case uint16Tag:case uint32Tag:return cloneTypedArray(object,isDeep);case mapTag:case setTag:return new Ctor;case numberTag:case stringTag:return new Ctor(object);case regexpTag:return function(regexp){var result=new regexp.constructor(regexp.source,reFlags.exec(regexp));return result.lastIndex=regexp.lastIndex,result}(object);case symbolTag:return symbolValueOf?Object(symbolValueOf.call(object)):{}}}(value,tag,isDeep)}}stack||(stack=new Stack);var stacked=stack.get(value);if(stacked)return stacked;stack.set(value,result),isSet(value)?value.forEach(function(subValue){result.add(baseClone(subValue,bitmask,customizer,subValue,value,stack))}):isMap(value)&&value.forEach(function(subValue,key){result.set(key,baseClone(subValue,bitmask,customizer,key,value,stack))});var props=isArr?void 0:(isFull?isFlat?getAllKeysIn:getAllKeys:isFlat?keysIn:keys)(value);return arrayEach(props||value,function(subValue,key){props&&(subValue=value[key=subValue]),assignValue(result,key,baseClone(subValue,bitmask,customizer,key,value,stack))}),result}function baseConformsTo(object,source,props){var length=props.length;if(null==object)return!length;for(object=Object(object);length--;){var key=props[length],value=object[key];if(void 0===value&&!(key in object)||!(0,source[key])(value))return!1}return!0}function baseDelay(func,wait,args){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return setTimeout(function(){func.apply(void 0,args)},wait)}function baseDifference(array,values,iteratee,comparator){var index=-1,includes=arrayIncludes,isCommon=!0,length=array.length,result=[],valuesLength=values.length;if(!length)return result;iteratee&&(values=arrayMap(values,baseUnary(iteratee))),comparator?(includes=arrayIncludesWith,isCommon=!1):values.length>=200&&(includes=cacheHas,isCommon=!1,values=new SetCache(values));outer:for(;++index<length;){var value=array[index],computed=null==iteratee?value:iteratee(value);if(value=comparator||0!==value?value:0,isCommon&&computed==computed){for(var valuesIndex=valuesLength;valuesIndex--;)if(values[valuesIndex]===computed)continue outer;result.push(value)}else includes(values,computed,comparator)||result.push(value)}return result}lodash.templateSettings={escape:reEscape,evaluate:reEvaluate,interpolate:reInterpolate,variable:"",imports:{_:lodash}},(lodash.prototype=baseLodash.prototype).constructor=lodash,(LodashWrapper.prototype=baseCreate(baseLodash.prototype)).constructor=LodashWrapper,(LazyWrapper.prototype=baseCreate(baseLodash.prototype)).constructor=LazyWrapper,Hash.prototype.clear=function(){this.__data__=nativeCreate?nativeCreate(null):{},this.size=0},Hash.prototype.delete=function(key){var result=this.has(key)&&delete this.__data__[key];return this.size-=result?1:0,result},Hash.prototype.get=function(key){var data=this.__data__;if(nativeCreate){var result=data[key];return"__lodash_hash_undefined__"===result?void 0:result}return hasOwnProperty.call(data,key)?data[key]:void 0},Hash.prototype.has=function(key){var data=this.__data__;return nativeCreate?void 0!==data[key]:hasOwnProperty.call(data,key)},Hash.prototype.set=function(key,value){var data=this.__data__;return this.size+=this.has(key)?0:1,data[key]=nativeCreate&&void 0===value?"__lodash_hash_undefined__":value,this},ListCache.prototype.clear=function(){this.__data__=[],this.size=0},ListCache.prototype.delete=function(key){var data=this.__data__,index=assocIndexOf(data,key);return!(index<0||(index==data.length-1?data.pop():splice.call(data,index,1),--this.size,0))},ListCache.prototype.get=function(key){var data=this.__data__,index=assocIndexOf(data,key);return index<0?void 0:data[index][1]},ListCache.prototype.has=function(key){return assocIndexOf(this.__data__,key)>-1},ListCache.prototype.set=function(key,value){var data=this.__data__,index=assocIndexOf(data,key);return index<0?(++this.size,data.push([key,value])):data[index][1]=value,this},MapCache.prototype.clear=function(){this.size=0,this.__data__={hash:new Hash,map:new(Map||ListCache),string:new Hash}},MapCache.prototype.delete=function(key){var result=getMapData(this,key).delete(key);return this.size-=result?1:0,result},MapCache.prototype.get=function(key){return getMapData(this,key).get(key)},MapCache.prototype.has=function(key){return getMapData(this,key).has(key)},MapCache.prototype.set=function(key,value){var data=getMapData(this,key),size=data.size;return data.set(key,value),this.size+=data.size==size?0:1,this},SetCache.prototype.add=SetCache.prototype.push=function(value){return this.__data__.set(value,"__lodash_hash_undefined__"),this},SetCache.prototype.has=function(value){return this.__data__.has(value)},Stack.prototype.clear=function(){this.__data__=new ListCache,this.size=0},Stack.prototype.delete=function(key){var data=this.__data__,result=data.delete(key);return this.size=data.size,result},Stack.prototype.get=function(key){return this.__data__.get(key)},Stack.prototype.has=function(key){return this.__data__.has(key)},Stack.prototype.set=function(key,value){var data=this.__data__;if(data instanceof ListCache){var pairs=data.__data__;if(!Map||pairs.length<199)return pairs.push([key,value]),this.size=++data.size,this;data=this.__data__=new MapCache(pairs)}return data.set(key,value),this.size=data.size,this};var baseEach=createBaseEach(baseForOwn),baseEachRight=createBaseEach(baseForOwnRight,!0);function baseEvery(collection,predicate){var result=!0;return baseEach(collection,function(value,index,collection){return result=!!predicate(value,index,collection)}),result}function baseExtremum(array,iteratee,comparator){for(var index=-1,length=array.length;++index<length;){var value=array[index],current=iteratee(value);if(null!=current&&(void 0===computed?current==current&&!isSymbol(current):comparator(current,computed)))var computed=current,result=value}return result}function baseFilter(collection,predicate){var result=[];return baseEach(collection,function(value,index,collection){predicate(value,index,collection)&&result.push(value)}),result}function baseFlatten(array,depth,predicate,isStrict,result){var index=-1,length=array.length;for(predicate||(predicate=isFlattenable),result||(result=[]);++index<length;){var value=array[index];depth>0&&predicate(value)?depth>1?baseFlatten(value,depth-1,predicate,isStrict,result):arrayPush(result,value):isStrict||(result[result.length]=value)}return result}var baseFor=createBaseFor(),baseForRight=createBaseFor(!0);function baseForOwn(object,iteratee){return object&&baseFor(object,iteratee,keys)}function baseForOwnRight(object,iteratee){return object&&baseForRight(object,iteratee,keys)}function baseFunctions(object,props){return arrayFilter(props,function(key){return isFunction(object[key])})}function baseGet(object,path){for(var index=0,length=(path=castPath(path,object)).length;null!=object&&index<length;)object=object[toKey(path[index++])];return index&&index==length?object:void 0}function baseGetAllKeys(object,keysFunc,symbolsFunc){var result=keysFunc(object);return isArray(object)?result:arrayPush(result,symbolsFunc(object))}function baseGetTag(value){return null==value?void 0===value?"[object Undefined]":"[object Null]":symToStringTag&&symToStringTag in Object(value)?function(value){var isOwn=hasOwnProperty.call(value,symToStringTag),tag=value[symToStringTag];try{value[symToStringTag]=void 0;var unmasked=!0}catch(e){}var result=nativeObjectToString.call(value);return unmasked&&(isOwn?value[symToStringTag]=tag:delete value[symToStringTag]),result}(value):function(value){return nativeObjectToString.call(value)}(value)}function baseGt(value,other){return value>other}function baseHas(object,key){return null!=object&&hasOwnProperty.call(object,key)}function baseHasIn(object,key){return null!=object&&key in Object(object)}function baseIntersection(arrays,iteratee,comparator){for(var includes=comparator?arrayIncludesWith:arrayIncludes,length=arrays[0].length,othLength=arrays.length,othIndex=othLength,caches=Array(othLength),maxLength=1/0,result=[];othIndex--;){var array=arrays[othIndex];othIndex&&iteratee&&(array=arrayMap(array,baseUnary(iteratee))),maxLength=nativeMin(array.length,maxLength),caches[othIndex]=!comparator&&(iteratee||length>=120&&array.length>=120)?new SetCache(othIndex&&array):void 0}array=arrays[0];var index=-1,seen=caches[0];outer:for(;++index<length&&result.length<maxLength;){var value=array[index],computed=iteratee?iteratee(value):value;if(value=comparator||0!==value?value:0,!(seen?cacheHas(seen,computed):includes(result,computed,comparator))){for(othIndex=othLength;--othIndex;){var cache=caches[othIndex];if(!(cache?cacheHas(cache,computed):includes(arrays[othIndex],computed,comparator)))continue outer}seen&&seen.push(computed),result.push(value)}}return result}function baseInvoke(object,path,args){var func=null==(object=parent(object,path=castPath(path,object)))?object:object[toKey(last(path))];return null==func?void 0:apply(func,object,args)}function baseIsArguments(value){return isObjectLike(value)&&baseGetTag(value)==argsTag}function baseIsEqual(value,other,bitmask,customizer,stack){return value===other||(null==value||null==other||!isObjectLike(value)&&!isObjectLike(other)?value!=value&&other!=other:function(object,other,bitmask,customizer,equalFunc,stack){var objIsArr=isArray(object),othIsArr=isArray(other),objTag=objIsArr?arrayTag:getTag(object),othTag=othIsArr?arrayTag:getTag(other),objIsObj=(objTag=objTag==argsTag?objectTag:objTag)==objectTag,othIsObj=(othTag=othTag==argsTag?objectTag:othTag)==objectTag,isSameTag=objTag==othTag;if(isSameTag&&isBuffer(object)){if(!isBuffer(other))return!1;objIsArr=!0,objIsObj=!1}if(isSameTag&&!objIsObj)return stack||(stack=new Stack),objIsArr||isTypedArray(object)?equalArrays(object,other,bitmask,customizer,equalFunc,stack):function(object,other,tag,bitmask,customizer,equalFunc,stack){switch(tag){case dataViewTag:if(object.byteLength!=other.byteLength||object.byteOffset!=other.byteOffset)return!1;object=object.buffer,other=other.buffer;case arrayBufferTag:return!(object.byteLength!=other.byteLength||!equalFunc(new Uint8Array(object),new Uint8Array(other)));case boolTag:case dateTag:case numberTag:return eq(+object,+other);case errorTag:return object.name==other.name&&object.message==other.message;case regexpTag:case stringTag:return object==other+"";case mapTag:var convert=mapToArray;case setTag:if(convert||(convert=setToArray),object.size!=other.size&&!(1&bitmask))return!1;var stacked=stack.get(object);if(stacked)return stacked==other;bitmask|=2,stack.set(object,other);var result=equalArrays(convert(object),convert(other),bitmask,customizer,equalFunc,stack);return stack.delete(object),result;case symbolTag:if(symbolValueOf)return symbolValueOf.call(object)==symbolValueOf.call(other)}return!1}(object,other,objTag,bitmask,customizer,equalFunc,stack);if(!(1&bitmask)){var objIsWrapped=objIsObj&&hasOwnProperty.call(object,"__wrapped__"),othIsWrapped=othIsObj&&hasOwnProperty.call(other,"__wrapped__");if(objIsWrapped||othIsWrapped){var objUnwrapped=objIsWrapped?object.value():object,othUnwrapped=othIsWrapped?other.value():other;return stack||(stack=new Stack),equalFunc(objUnwrapped,othUnwrapped,bitmask,customizer,stack)}}return!!isSameTag&&(stack||(stack=new Stack),function(object,other,bitmask,customizer,equalFunc,stack){var isPartial=1&bitmask,objProps=getAllKeys(object),objLength=objProps.length;if(objLength!=getAllKeys(other).length&&!isPartial)return!1;for(var index=objLength;index--;){var key=objProps[index];if(!(isPartial?key in other:hasOwnProperty.call(other,key)))return!1}var objStacked=stack.get(object),othStacked=stack.get(other);if(objStacked&&othStacked)return objStacked==other&&othStacked==object;var result=!0;stack.set(object,other),stack.set(other,object);for(var skipCtor=isPartial;++index<objLength;){var objValue=object[key=objProps[index]],othValue=other[key];if(customizer)var compared=isPartial?customizer(othValue,objValue,key,other,object,stack):customizer(objValue,othValue,key,object,other,stack);if(!(void 0===compared?objValue===othValue||equalFunc(objValue,othValue,bitmask,customizer,stack):compared)){result=!1;break}skipCtor||(skipCtor="constructor"==key)}if(result&&!skipCtor){var objCtor=object.constructor,othCtor=other.constructor;objCtor==othCtor||!("constructor"in object)||!("constructor"in other)||"function"==typeof objCtor&&objCtor instanceof objCtor&&"function"==typeof othCtor&&othCtor instanceof othCtor||(result=!1)}return stack.delete(object),stack.delete(other),result}(object,other,bitmask,customizer,equalFunc,stack))}(value,other,bitmask,customizer,baseIsEqual,stack))}function baseIsMatch(object,source,matchData,customizer){var index=matchData.length,length=index,noCustomizer=!customizer;if(null==object)return!length;for(object=Object(object);index--;){var data=matchData[index];if(noCustomizer&&data[2]?data[1]!==object[data[0]]:!(data[0]in object))return!1}for(;++index<length;){var key=(data=matchData[index])[0],objValue=object[key],srcValue=data[1];if(noCustomizer&&data[2]){if(void 0===objValue&&!(key in object))return!1}else{var stack=new Stack;if(customizer)var result=customizer(objValue,srcValue,key,object,source,stack);if(!(void 0===result?baseIsEqual(srcValue,objValue,3,customizer,stack):result))return!1}}return!0}function baseIsNative(value){return!(!isObject(value)||(func=value,maskSrcKey&&maskSrcKey in func))&&(isFunction(value)?reIsNative:reIsHostCtor).test(toSource(value));var func}function baseIteratee(value){return"function"==typeof value?value:null==value?identity:"object"==typeof value?isArray(value)?baseMatchesProperty(value[0],value[1]):baseMatches(value):property(value)}function baseKeys(object){if(!isPrototype(object))return nativeKeys(object);var result=[];for(var key in Object(object))hasOwnProperty.call(object,key)&&"constructor"!=key&&result.push(key);return result}function baseLt(value,other){return value<other}function baseMap(collection,iteratee){var index=-1,result=isArrayLike(collection)?Array(collection.length):[];return baseEach(collection,function(value,key,collection){result[++index]=iteratee(value,key,collection)}),result}function baseMatches(source){var matchData=getMatchData(source);return 1==matchData.length&&matchData[0][2]?matchesStrictComparable(matchData[0][0],matchData[0][1]):function(object){return object===source||baseIsMatch(object,source,matchData)}}function baseMatchesProperty(path,srcValue){return isKey(path)&&isStrictComparable(srcValue)?matchesStrictComparable(toKey(path),srcValue):function(object){var objValue=get(object,path);return void 0===objValue&&objValue===srcValue?hasIn(object,path):baseIsEqual(srcValue,objValue,3)}}function baseMerge(object,source,srcIndex,customizer,stack){object!==source&&baseFor(source,function(srcValue,key){if(stack||(stack=new Stack),isObject(srcValue))!function(object,source,key,srcIndex,mergeFunc,customizer,stack){var objValue=safeGet(object,key),srcValue=safeGet(source,key),stacked=stack.get(srcValue);if(stacked)assignMergeValue(object,key,stacked);else{var newValue=customizer?customizer(objValue,srcValue,key+"",object,source,stack):void 0,isCommon=void 0===newValue;if(isCommon){var isArr=isArray(srcValue),isBuff=!isArr&&isBuffer(srcValue),isTyped=!isArr&&!isBuff&&isTypedArray(srcValue);newValue=srcValue,isArr||isBuff||isTyped?isArray(objValue)?newValue=objValue:isArrayLikeObject(objValue)?newValue=copyArray(objValue):isBuff?(isCommon=!1,newValue=cloneBuffer(srcValue,!0)):isTyped?(isCommon=!1,newValue=cloneTypedArray(srcValue,!0)):newValue=[]:isPlainObject(srcValue)||isArguments(srcValue)?(newValue=objValue,isArguments(objValue)?newValue=toPlainObject(objValue):isObject(objValue)&&!isFunction(objValue)||(newValue=initCloneObject(srcValue))):isCommon=!1}isCommon&&(stack.set(srcValue,newValue),mergeFunc(newValue,srcValue,srcIndex,customizer,stack),stack.delete(srcValue)),assignMergeValue(object,key,newValue)}}(object,source,key,srcIndex,baseMerge,customizer,stack);else{var newValue=customizer?customizer(safeGet(object,key),srcValue,key+"",object,source,stack):void 0;void 0===newValue&&(newValue=srcValue),assignMergeValue(object,key,newValue)}},keysIn)}function baseNth(array,n){var length=array.length;if(length)return isIndex(n+=n<0?length:0,length)?array[n]:void 0}function baseOrderBy(collection,iteratees,orders){iteratees=iteratees.length?arrayMap(iteratees,function(iteratee){return isArray(iteratee)?function(value){return baseGet(value,1===iteratee.length?iteratee[0]:iteratee)}:iteratee}):[identity];var index=-1;iteratees=arrayMap(iteratees,baseUnary(getIteratee()));var result=baseMap(collection,function(value,key,collection){var criteria=arrayMap(iteratees,function(iteratee){return iteratee(value)});return{criteria:criteria,index:++index,value:value}});return function(array,comparer){var length=array.length;for(array.sort(function(object,other){return function(object,other,orders){for(var index=-1,objCriteria=object.criteria,othCriteria=other.criteria,length=objCriteria.length,ordersLength=orders.length;++index<length;){var result=compareAscending(objCriteria[index],othCriteria[index]);if(result)return index>=ordersLength?result:result*("desc"==orders[index]?-1:1)}return object.index-other.index}(object,other,orders)});length--;)array[length]=array[length].value;return array}(result)}function basePickBy(object,paths,predicate){for(var index=-1,length=paths.length,result={};++index<length;){var path=paths[index],value=baseGet(object,path);predicate(value,path)&&baseSet(result,castPath(path,object),value)}return result}function basePullAll(array,values,iteratee,comparator){var indexOf=comparator?baseIndexOfWith:baseIndexOf,index=-1,length=values.length,seen=array;for(array===values&&(values=copyArray(values)),iteratee&&(seen=arrayMap(array,baseUnary(iteratee)));++index<length;)for(var fromIndex=0,value=values[index],computed=iteratee?iteratee(value):value;(fromIndex=indexOf(seen,computed,fromIndex,comparator))>-1;)seen!==array&&splice.call(seen,fromIndex,1),splice.call(array,fromIndex,1);return array}function basePullAt(array,indexes){for(var length=array?indexes.length:0,lastIndex=length-1;length--;){var index=indexes[length];if(length==lastIndex||index!==previous){var previous=index;isIndex(index)?splice.call(array,index,1):baseUnset(array,index)}}return array}function baseRandom(lower,upper){return lower+nativeFloor(nativeRandom()*(upper-lower+1))}function baseRepeat(string,n){var result="";if(!string||n<1||n>9007199254740991)return result;do{n%2&&(result+=string),(n=nativeFloor(n/2))&&(string+=string)}while(n);return result}function baseRest(func,start){return setToString(overRest(func,start,identity),func+"")}function baseSample(collection){return arraySample(values(collection))}function baseSampleSize(collection,n){var array=values(collection);return shuffleSelf(array,baseClamp(n,0,array.length))}function baseSet(object,path,value,customizer){if(!isObject(object))return object;for(var index=-1,length=(path=castPath(path,object)).length,lastIndex=length-1,nested=object;null!=nested&&++index<length;){var key=toKey(path[index]),newValue=value;if("__proto__"===key||"constructor"===key||"prototype"===key)return object;if(index!=lastIndex){var objValue=nested[key];void 0===(newValue=customizer?customizer(objValue,key,nested):void 0)&&(newValue=isObject(objValue)?objValue:isIndex(path[index+1])?[]:{})}assignValue(nested,key,newValue),nested=nested[key]}return object}var baseSetData=metaMap?function(func,data){return metaMap.set(func,data),func}:identity,baseSetToString=defineProperty?function(func,string){return defineProperty(func,"toString",{configurable:!0,enumerable:!1,value:constant(string),writable:!0})}:identity;function baseShuffle(collection){return shuffleSelf(values(collection))}function baseSlice(array,start,end){var index=-1,length=array.length;start<0&&(start=-start>length?0:length+start),(end=end>length?length:end)<0&&(end+=length),length=start>end?0:end-start>>>0,start>>>=0;for(var result=Array(length);++index<length;)result[index]=array[index+start];return result}function baseSome(collection,predicate){var result;return baseEach(collection,function(value,index,collection){return!(result=predicate(value,index,collection))}),!!result}function baseSortedIndex(array,value,retHighest){var low=0,high=null==array?low:array.length;if("number"==typeof value&&value==value&&high<=2147483647){for(;low<high;){var mid=low+high>>>1,computed=array[mid];null!==computed&&!isSymbol(computed)&&(retHighest?computed<=value:computed<value)?low=mid+1:high=mid}return high}return baseSortedIndexBy(array,value,identity,retHighest)}function baseSortedIndexBy(array,value,iteratee,retHighest){var low=0,high=null==array?0:array.length;if(0===high)return 0;for(var valIsNaN=(value=iteratee(value))!=value,valIsNull=null===value,valIsSymbol=isSymbol(value),valIsUndefined=void 0===value;low<high;){var mid=nativeFloor((low+high)/2),computed=iteratee(array[mid]),othIsDefined=void 0!==computed,othIsNull=null===computed,othIsReflexive=computed==computed,othIsSymbol=isSymbol(computed);if(valIsNaN)var setLow=retHighest||othIsReflexive;else setLow=valIsUndefined?othIsReflexive&&(retHighest||othIsDefined):valIsNull?othIsReflexive&&othIsDefined&&(retHighest||!othIsNull):valIsSymbol?othIsReflexive&&othIsDefined&&!othIsNull&&(retHighest||!othIsSymbol):!othIsNull&&!othIsSymbol&&(retHighest?computed<=value:computed<value);setLow?low=mid+1:high=mid}return nativeMin(high,4294967294)}function baseSortedUniq(array,iteratee){for(var index=-1,length=array.length,resIndex=0,result=[];++index<length;){var value=array[index],computed=iteratee?iteratee(value):value;if(!index||!eq(computed,seen)){var seen=computed;result[resIndex++]=0===value?0:value}}return result}function baseToNumber(value){return"number"==typeof value?value:isSymbol(value)?NaN:+value}function baseToString(value){if("string"==typeof value)return value;if(isArray(value))return arrayMap(value,baseToString)+"";if(isSymbol(value))return symbolToString?symbolToString.call(value):"";var result=value+"";return"0"==result&&1/value==-1/0?"-0":result}function baseUniq(array,iteratee,comparator){var index=-1,includes=arrayIncludes,length=array.length,isCommon=!0,result=[],seen=result;if(comparator)isCommon=!1,includes=arrayIncludesWith;else if(length>=200){var set=iteratee?null:createSet(array);if(set)return setToArray(set);isCommon=!1,includes=cacheHas,seen=new SetCache}else seen=iteratee?[]:result;outer:for(;++index<length;){var value=array[index],computed=iteratee?iteratee(value):value;if(value=comparator||0!==value?value:0,isCommon&&computed==computed){for(var seenIndex=seen.length;seenIndex--;)if(seen[seenIndex]===computed)continue outer;iteratee&&seen.push(computed),result.push(value)}else includes(seen,computed,comparator)||(seen!==result&&seen.push(computed),result.push(value))}return result}function baseUnset(object,path){return null==(object=parent(object,path=castPath(path,object)))||delete object[toKey(last(path))]}function baseUpdate(object,path,updater,customizer){return baseSet(object,path,updater(baseGet(object,path)),customizer)}function baseWhile(array,predicate,isDrop,fromRight){for(var length=array.length,index=fromRight?length:-1;(fromRight?index--:++index<length)&&predicate(array[index],index,array););return isDrop?baseSlice(array,fromRight?0:index,fromRight?index+1:length):baseSlice(array,fromRight?index+1:0,fromRight?length:index)}function baseWrapperValue(value,actions){var result=value;return result instanceof LazyWrapper&&(result=result.value()),arrayReduce(actions,function(result,action){return action.func.apply(action.thisArg,arrayPush([result],action.args))},result)}function baseXor(arrays,iteratee,comparator){var length=arrays.length;if(length<2)return length?baseUniq(arrays[0]):[];for(var index=-1,result=Array(length);++index<length;)for(var array=arrays[index],othIndex=-1;++othIndex<length;)othIndex!=index&&(result[index]=baseDifference(result[index]||array,arrays[othIndex],iteratee,comparator));return baseUniq(baseFlatten(result,1),iteratee,comparator)}function baseZipObject(props,values,assignFunc){for(var index=-1,length=props.length,valsLength=values.length,result={};++index<length;)assignFunc(result,props[index],index<valsLength?values[index]:void 0);return result}function castArrayLikeObject(value){return isArrayLikeObject(value)?value:[]}function castFunction(value){return"function"==typeof value?value:identity}function castPath(value,object){return isArray(value)?value:isKey(value,object)?[value]:stringToPath(toString(value))}var castRest=baseRest;function castSlice(array,start,end){var length=array.length;return end=void 0===end?length:end,!start&&end>=length?array:baseSlice(array,start,end)}var clearTimeout=ctxClearTimeout||function(id){return root.clearTimeout(id)};function cloneBuffer(buffer,isDeep){if(isDeep)return buffer.slice();var length=buffer.length,result=allocUnsafe?allocUnsafe(length):new buffer.constructor(length);return buffer.copy(result),result}function cloneArrayBuffer(arrayBuffer){var result=new arrayBuffer.constructor(arrayBuffer.byteLength);return new Uint8Array(result).set(new Uint8Array(arrayBuffer)),result}function cloneTypedArray(typedArray,isDeep){var buffer=isDeep?cloneArrayBuffer(typedArray.buffer):typedArray.buffer;return new typedArray.constructor(buffer,typedArray.byteOffset,typedArray.length)}function compareAscending(value,other){if(value!==other){var valIsDefined=void 0!==value,valIsNull=null===value,valIsReflexive=value==value,valIsSymbol=isSymbol(value),othIsDefined=void 0!==other,othIsNull=null===other,othIsReflexive=other==other,othIsSymbol=isSymbol(other);if(!othIsNull&&!othIsSymbol&&!valIsSymbol&&value>other||valIsSymbol&&othIsDefined&&othIsReflexive&&!othIsNull&&!othIsSymbol||valIsNull&&othIsDefined&&othIsReflexive||!valIsDefined&&othIsReflexive||!valIsReflexive)return 1;if(!valIsNull&&!valIsSymbol&&!othIsSymbol&&value<other||othIsSymbol&&valIsDefined&&valIsReflexive&&!valIsNull&&!valIsSymbol||othIsNull&&valIsDefined&&valIsReflexive||!othIsDefined&&valIsReflexive||!othIsReflexive)return-1}return 0}function composeArgs(args,partials,holders,isCurried){for(var argsIndex=-1,argsLength=args.length,holdersLength=holders.length,leftIndex=-1,leftLength=partials.length,rangeLength=nativeMax(argsLength-holdersLength,0),result=Array(leftLength+rangeLength),isUncurried=!isCurried;++leftIndex<leftLength;)result[leftIndex]=partials[leftIndex];for(;++argsIndex<holdersLength;)(isUncurried||argsIndex<argsLength)&&(result[holders[argsIndex]]=args[argsIndex]);for(;rangeLength--;)result[leftIndex++]=args[argsIndex++];return result}function composeArgsRight(args,partials,holders,isCurried){for(var argsIndex=-1,argsLength=args.length,holdersIndex=-1,holdersLength=holders.length,rightIndex=-1,rightLength=partials.length,rangeLength=nativeMax(argsLength-holdersLength,0),result=Array(rangeLength+rightLength),isUncurried=!isCurried;++argsIndex<rangeLength;)result[argsIndex]=args[argsIndex];for(var offset=argsIndex;++rightIndex<rightLength;)result[offset+rightIndex]=partials[rightIndex];for(;++holdersIndex<holdersLength;)(isUncurried||argsIndex<argsLength)&&(result[offset+holders[holdersIndex]]=args[argsIndex++]);return result}function copyArray(source,array){var index=-1,length=source.length;for(array||(array=Array(length));++index<length;)array[index]=source[index];return array}function copyObject(source,props,object,customizer){var isNew=!object;object||(object={});for(var index=-1,length=props.length;++index<length;){var key=props[index],newValue=customizer?customizer(object[key],source[key],key,object,source):void 0;void 0===newValue&&(newValue=source[key]),isNew?baseAssignValue(object,key,newValue):assignValue(object,key,newValue)}return object}function createAggregator(setter,initializer){return function(collection,iteratee){var func=isArray(collection)?arrayAggregator:baseAggregator,accumulator=initializer?initializer():{};return func(collection,setter,getIteratee(iteratee,2),accumulator)}}function createAssigner(assigner){return baseRest(function(object,sources){var index=-1,length=sources.length,customizer=length>1?sources[length-1]:void 0,guard=length>2?sources[2]:void 0;for(customizer=assigner.length>3&&"function"==typeof customizer?(length--,customizer):void 0,guard&&isIterateeCall(sources[0],sources[1],guard)&&(customizer=length<3?void 0:customizer,length=1),object=Object(object);++index<length;){var source=sources[index];source&&assigner(object,source,index,customizer)}return object})}function createBaseEach(eachFunc,fromRight){return function(collection,iteratee){if(null==collection)return collection;if(!isArrayLike(collection))return eachFunc(collection,iteratee);for(var length=collection.length,index=fromRight?length:-1,iterable=Object(collection);(fromRight?index--:++index<length)&&!1!==iteratee(iterable[index],index,iterable););return collection}}function createBaseFor(fromRight){return function(object,iteratee,keysFunc){for(var index=-1,iterable=Object(object),props=keysFunc(object),length=props.length;length--;){var key=props[fromRight?length:++index];if(!1===iteratee(iterable[key],key,iterable))break}return object}}function createCaseFirst(methodName){return function(string){var strSymbols=hasUnicode(string=toString(string))?stringToArray(string):void 0,chr=strSymbols?strSymbols[0]:string.charAt(0),trailing=strSymbols?castSlice(strSymbols,1).join(""):string.slice(1);return chr[methodName]()+trailing}}function createCompounder(callback){return function(string){return arrayReduce(words(deburr(string).replace(reApos,"")),callback,"")}}function createCtor(Ctor){return function(){var args=arguments;switch(args.length){case 0:return new Ctor;case 1:return new Ctor(args[0]);case 2:return new Ctor(args[0],args[1]);case 3:return new Ctor(args[0],args[1],args[2]);case 4:return new Ctor(args[0],args[1],args[2],args[3]);case 5:return new Ctor(args[0],args[1],args[2],args[3],args[4]);case 6:return new Ctor(args[0],args[1],args[2],args[3],args[4],args[5]);case 7:return new Ctor(args[0],args[1],args[2],args[3],args[4],args[5],args[6])}var thisBinding=baseCreate(Ctor.prototype),result=Ctor.apply(thisBinding,args);return isObject(result)?result:thisBinding}}function createFind(findIndexFunc){return function(collection,predicate,fromIndex){var iterable=Object(collection);if(!isArrayLike(collection)){var iteratee=getIteratee(predicate,3);collection=keys(collection),predicate=function(key){return iteratee(iterable[key],key,iterable)}}var index=findIndexFunc(collection,predicate,fromIndex);return index>-1?iterable[iteratee?collection[index]:index]:void 0}}function createFlow(fromRight){return flatRest(function(funcs){var length=funcs.length,index=length,prereq=LodashWrapper.prototype.thru;for(fromRight&&funcs.reverse();index--;){var func=funcs[index];if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);if(prereq&&!wrapper&&"wrapper"==getFuncName(func))var wrapper=new LodashWrapper([],!0)}for(index=wrapper?index:length;++index<length;){var funcName=getFuncName(func=funcs[index]),data="wrapper"==funcName?getData(func):void 0;wrapper=data&&isLaziable(data[0])&&424==data[1]&&!data[4].length&&1==data[9]?wrapper[getFuncName(data[0])].apply(wrapper,data[3]):1==func.length&&isLaziable(func)?wrapper[funcName]():wrapper.thru(func)}return function(){var args=arguments,value=args[0];if(wrapper&&1==args.length&&isArray(value))return wrapper.plant(value).value();for(var index=0,result=length?funcs[index].apply(this,args):value;++index<length;)result=funcs[index].call(this,result);return result}})}function createHybrid(func,bitmask,thisArg,partials,holders,partialsRight,holdersRight,argPos,ary,arity){var isAry=128&bitmask,isBind=1&bitmask,isBindKey=2&bitmask,isCurried=24&bitmask,isFlip=512&bitmask,Ctor=isBindKey?void 0:createCtor(func);return function wrapper(){for(var length=arguments.length,args=Array(length),index=length;index--;)args[index]=arguments[index];if(isCurried)var placeholder=getHolder(wrapper),holdersCount=countHolders(args,placeholder);if(partials&&(args=composeArgs(args,partials,holders,isCurried)),partialsRight&&(args=composeArgsRight(args,partialsRight,holdersRight,isCurried)),length-=holdersCount,isCurried&&length<arity){var newHolders=replaceHolders(args,placeholder);return createRecurry(func,bitmask,createHybrid,wrapper.placeholder,thisArg,args,newHolders,argPos,ary,arity-length)}var thisBinding=isBind?thisArg:this,fn=isBindKey?thisBinding[func]:func;return length=args.length,argPos?args=reorder(args,argPos):isFlip&&length>1&&args.reverse(),isAry&&ary<length&&(args.length=ary),this&&this!==root&&this instanceof wrapper&&(fn=Ctor||createCtor(fn)),fn.apply(thisBinding,args)}}function createInverter(setter,toIteratee){return function(object,iteratee){return function(object,setter,iteratee,accumulator){return baseForOwn(object,function(value,key,object){setter(accumulator,iteratee(value),key,object)}),accumulator}(object,setter,toIteratee(iteratee),{})}}function createMathOperation(operator,defaultValue){return function(value,other){var result;if(void 0===value&&void 0===other)return defaultValue;if(void 0!==value&&(result=value),void 0!==other){if(void 0===result)return other;"string"==typeof value||"string"==typeof other?(value=baseToString(value),other=baseToString(other)):(value=baseToNumber(value),other=baseToNumber(other)),result=operator(value,other)}return result}}function createOver(arrayFunc){return flatRest(function(iteratees){return iteratees=arrayMap(iteratees,baseUnary(getIteratee())),baseRest(function(args){var thisArg=this;return arrayFunc(iteratees,function(iteratee){return apply(iteratee,thisArg,args)})})})}function createPadding(length,chars){var charsLength=(chars=void 0===chars?" ":baseToString(chars)).length;if(charsLength<2)return charsLength?baseRepeat(chars,length):chars;var result=baseRepeat(chars,nativeCeil(length/stringSize(chars)));return hasUnicode(chars)?castSlice(stringToArray(result),0,length).join(""):result.slice(0,length)}function createRange(fromRight){return function(start,end,step){return step&&"number"!=typeof step&&isIterateeCall(start,end,step)&&(end=step=void 0),start=toFinite(start),void 0===end?(end=start,start=0):end=toFinite(end),function(start,end,step,fromRight){for(var index=-1,length=nativeMax(nativeCeil((end-start)/(step||1)),0),result=Array(length);length--;)result[fromRight?length:++index]=start,start+=step;return result}(start,end,step=void 0===step?start<end?1:-1:toFinite(step),fromRight)}}function createRelationalOperation(operator){return function(value,other){return"string"==typeof value&&"string"==typeof other||(value=toNumber(value),other=toNumber(other)),operator(value,other)}}function createRecurry(func,bitmask,wrapFunc,placeholder,thisArg,partials,holders,argPos,ary,arity){var isCurry=8&bitmask;bitmask|=isCurry?32:64,4&(bitmask&=~(isCurry?64:32))||(bitmask&=-4);var newData=[func,bitmask,thisArg,isCurry?partials:void 0,isCurry?holders:void 0,isCurry?void 0:partials,isCurry?void 0:holders,argPos,ary,arity],result=wrapFunc.apply(void 0,newData);return isLaziable(func)&&setData(result,newData),result.placeholder=placeholder,setWrapToString(result,func,bitmask)}function createRound(methodName){var func=Math[methodName];return function(number,precision){if(number=toNumber(number),(precision=null==precision?0:nativeMin(toInteger(precision),292))&&nativeIsFinite(number)){var pair=(toString(number)+"e").split("e");return+((pair=(toString(func(pair[0]+"e"+(+pair[1]+precision)))+"e").split("e"))[0]+"e"+(+pair[1]-precision))}return func(number)}}var createSet=Set&&1/setToArray(new Set([,-0]))[1]==1/0?function(values){return new Set(values)}:noop;function createToPairs(keysFunc){return function(object){var tag=getTag(object);return tag==mapTag?mapToArray(object):tag==setTag?setToPairs(object):function(object,props){return arrayMap(props,function(key){return[key,object[key]]})}(object,keysFunc(object))}}function createWrap(func,bitmask,thisArg,partials,holders,argPos,ary,arity){var isBindKey=2&bitmask;if(!isBindKey&&"function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);var length=partials?partials.length:0;if(length||(bitmask&=-97,partials=holders=void 0),ary=void 0===ary?ary:nativeMax(toInteger(ary),0),arity=void 0===arity?arity:toInteger(arity),length-=holders?holders.length:0,64&bitmask){var partialsRight=partials,holdersRight=holders;partials=holders=void 0}var data=isBindKey?void 0:getData(func),newData=[func,bitmask,thisArg,partials,holders,partialsRight,holdersRight,argPos,ary,arity];if(data&&function(data,source){var bitmask=data[1],srcBitmask=source[1],newBitmask=bitmask|srcBitmask;if(!(newBitmask<131||(128==srcBitmask&&8==bitmask||128==srcBitmask&&256==bitmask&&data[7].length<=source[8]||384==srcBitmask&&source[7].length<=source[8]&&8==bitmask)))return data;1&srcBitmask&&(data[2]=source[2],newBitmask|=1&bitmask?0:4);var value=source[3];if(value){var partials=data[3];data[3]=partials?composeArgs(partials,value,source[4]):value,data[4]=partials?replaceHolders(data[3],PLACEHOLDER):source[4]}(value=source[5])&&(data[5]=(partials=data[5])?composeArgsRight(partials,value,source[6]):value,data[6]=partials?replaceHolders(data[5],PLACEHOLDER):source[6]),(value=source[7])&&(data[7]=value),128&srcBitmask&&(data[8]=null==data[8]?source[8]:nativeMin(data[8],source[8])),null==data[9]&&(data[9]=source[9]),data[0]=source[0],data[1]=newBitmask}(newData,data),func=newData[0],bitmask=newData[1],thisArg=newData[2],partials=newData[3],holders=newData[4],!(arity=newData[9]=void 0===newData[9]?isBindKey?0:func.length:nativeMax(newData[9]-length,0))&&24&bitmask&&(bitmask&=-25),bitmask&&1!=bitmask)result=8==bitmask||16==bitmask?function(func,bitmask,arity){var Ctor=createCtor(func);return function wrapper(){for(var length=arguments.length,args=Array(length),index=length,placeholder=getHolder(wrapper);index--;)args[index]=arguments[index];var holders=length<3&&args[0]!==placeholder&&args[length-1]!==placeholder?[]:replaceHolders(args,placeholder);return(length-=holders.length)<arity?createRecurry(func,bitmask,createHybrid,wrapper.placeholder,void 0,args,holders,void 0,void 0,arity-length):apply(this&&this!==root&&this instanceof wrapper?Ctor:func,this,args)}}(func,bitmask,arity):32!=bitmask&&33!=bitmask||holders.length?createHybrid.apply(void 0,newData):function(func,bitmask,thisArg,partials){var isBind=1&bitmask,Ctor=createCtor(func);return function wrapper(){for(var argsIndex=-1,argsLength=arguments.length,leftIndex=-1,leftLength=partials.length,args=Array(leftLength+argsLength),fn=this&&this!==root&&this instanceof wrapper?Ctor:func;++leftIndex<leftLength;)args[leftIndex]=partials[leftIndex];for(;argsLength--;)args[leftIndex++]=arguments[++argsIndex];return apply(fn,isBind?thisArg:this,args)}}(func,bitmask,thisArg,partials);else var result=function(func,bitmask,thisArg){var isBind=1&bitmask,Ctor=createCtor(func);return function wrapper(){return(this&&this!==root&&this instanceof wrapper?Ctor:func).apply(isBind?thisArg:this,arguments)}}(func,bitmask,thisArg);return setWrapToString((data?baseSetData:setData)(result,newData),func,bitmask)}function customDefaultsAssignIn(objValue,srcValue,key,object){return void 0===objValue||eq(objValue,objectProto[key])&&!hasOwnProperty.call(object,key)?srcValue:objValue}function customDefaultsMerge(objValue,srcValue,key,object,source,stack){return isObject(objValue)&&isObject(srcValue)&&(stack.set(srcValue,objValue),baseMerge(objValue,srcValue,void 0,customDefaultsMerge,stack),stack.delete(srcValue)),objValue}function customOmitClone(value){return isPlainObject(value)?void 0:value}function equalArrays(array,other,bitmask,customizer,equalFunc,stack){var isPartial=1&bitmask,arrLength=array.length,othLength=other.length;if(arrLength!=othLength&&!(isPartial&&othLength>arrLength))return!1;var arrStacked=stack.get(array),othStacked=stack.get(other);if(arrStacked&&othStacked)return arrStacked==other&&othStacked==array;var index=-1,result=!0,seen=2&bitmask?new SetCache:void 0;for(stack.set(array,other),stack.set(other,array);++index<arrLength;){var arrValue=array[index],othValue=other[index];if(customizer)var compared=isPartial?customizer(othValue,arrValue,index,other,array,stack):customizer(arrValue,othValue,index,array,other,stack);if(void 0!==compared){if(compared)continue;result=!1;break}if(seen){if(!arraySome(other,function(othValue,othIndex){if(!cacheHas(seen,othIndex)&&(arrValue===othValue||equalFunc(arrValue,othValue,bitmask,customizer,stack)))return seen.push(othIndex)})){result=!1;break}}else if(arrValue!==othValue&&!equalFunc(arrValue,othValue,bitmask,customizer,stack)){result=!1;break}}return stack.delete(array),stack.delete(other),result}function flatRest(func){return setToString(overRest(func,void 0,flatten),func+"")}function getAllKeys(object){return baseGetAllKeys(object,keys,getSymbols)}function getAllKeysIn(object){return baseGetAllKeys(object,keysIn,getSymbolsIn)}var getData=metaMap?function(func){return metaMap.get(func)}:noop;function getFuncName(func){for(var result=func.name+"",array=realNames[result],length=hasOwnProperty.call(realNames,result)?array.length:0;length--;){var data=array[length],otherFunc=data.func;if(null==otherFunc||otherFunc==func)return data.name}return result}function getHolder(func){return(hasOwnProperty.call(lodash,"placeholder")?lodash:func).placeholder}function getIteratee(){var result=lodash.iteratee||iteratee;return result=result===iteratee?baseIteratee:result,arguments.length?result(arguments[0],arguments[1]):result}function getMapData(map,key){var value,type,data=map.__data__;return("string"==(type=typeof(value=key))||"number"==type||"symbol"==type||"boolean"==type?"__proto__"!==value:null===value)?data["string"==typeof key?"string":"hash"]:data.map}function getMatchData(object){for(var result=keys(object),length=result.length;length--;){var key=result[length],value=object[key];result[length]=[key,value,isStrictComparable(value)]}return result}function getNative(object,key){var value=function(object,key){return null==object?void 0:object[key]}(object,key);return baseIsNative(value)?value:void 0}var getSymbols=nativeGetSymbols?function(object){return null==object?[]:(object=Object(object),arrayFilter(nativeGetSymbols(object),function(symbol){return propertyIsEnumerable.call(object,symbol)}))}:stubArray,getSymbolsIn=nativeGetSymbols?function(object){for(var result=[];object;)arrayPush(result,getSymbols(object)),object=getPrototype(object);return result}:stubArray,getTag=baseGetTag;function hasPath(object,path,hasFunc){for(var index=-1,length=(path=castPath(path,object)).length,result=!1;++index<length;){var key=toKey(path[index]);if(!(result=null!=object&&hasFunc(object,key)))break;object=object[key]}return result||++index!=length?result:!!(length=null==object?0:object.length)&&isLength(length)&&isIndex(key,length)&&(isArray(object)||isArguments(object))}function initCloneObject(object){return"function"!=typeof object.constructor||isPrototype(object)?{}:baseCreate(getPrototype(object))}function isFlattenable(value){return isArray(value)||isArguments(value)||!!(spreadableSymbol&&value&&value[spreadableSymbol])}function isIndex(value,length){var type=typeof value;return!!(length=null==length?9007199254740991:length)&&("number"==type||"symbol"!=type&&reIsUint.test(value))&&value>-1&&value%1==0&&value<length}function isIterateeCall(value,index,object){if(!isObject(object))return!1;var type=typeof index;return!!("number"==type?isArrayLike(object)&&isIndex(index,object.length):"string"==type&&index in object)&&eq(object[index],value)}function isKey(value,object){if(isArray(value))return!1;var type=typeof value;return!("number"!=type&&"symbol"!=type&&"boolean"!=type&&null!=value&&!isSymbol(value))||reIsPlainProp.test(value)||!reIsDeepProp.test(value)||null!=object&&value in Object(object)}function isLaziable(func){var funcName=getFuncName(func),other=lodash[funcName];if("function"!=typeof other||!(funcName in LazyWrapper.prototype))return!1;if(func===other)return!0;var data=getData(other);return!!data&&func===data[0]}(DataView&&getTag(new DataView(new ArrayBuffer(1)))!=dataViewTag||Map&&getTag(new Map)!=mapTag||Promise&&"[object Promise]"!=getTag(Promise.resolve())||Set&&getTag(new Set)!=setTag||WeakMap&&getTag(new WeakMap)!=weakMapTag)&&(getTag=function(value){var result=baseGetTag(value),Ctor=result==objectTag?value.constructor:void 0,ctorString=Ctor?toSource(Ctor):"";if(ctorString)switch(ctorString){case dataViewCtorString:return dataViewTag;case mapCtorString:return mapTag;case promiseCtorString:return"[object Promise]";case setCtorString:return setTag;case weakMapCtorString:return weakMapTag}return result});var isMaskable=coreJsData?isFunction:stubFalse;function isPrototype(value){var Ctor=value&&value.constructor;return value===("function"==typeof Ctor&&Ctor.prototype||objectProto)}function isStrictComparable(value){return value==value&&!isObject(value)}function matchesStrictComparable(key,srcValue){return function(object){return null!=object&&object[key]===srcValue&&(void 0!==srcValue||key in Object(object))}}function overRest(func,start,transform){return start=nativeMax(void 0===start?func.length-1:start,0),function(){for(var args=arguments,index=-1,length=nativeMax(args.length-start,0),array=Array(length);++index<length;)array[index]=args[start+index];index=-1;for(var otherArgs=Array(start+1);++index<start;)otherArgs[index]=args[index];return otherArgs[start]=transform(array),apply(func,this,otherArgs)}}function parent(object,path){return path.length<2?object:baseGet(object,baseSlice(path,0,-1))}function reorder(array,indexes){for(var arrLength=array.length,length=nativeMin(indexes.length,arrLength),oldArray=copyArray(array);length--;){var index=indexes[length];array[length]=isIndex(index,arrLength)?oldArray[index]:void 0}return array}function safeGet(object,key){if(("constructor"!==key||"function"!=typeof object[key])&&"__proto__"!=key)return object[key]}var setData=shortOut(baseSetData),setTimeout=ctxSetTimeout||function(func,wait){return root.setTimeout(func,wait)},setToString=shortOut(baseSetToString);function setWrapToString(wrapper,reference,bitmask){var source=reference+"";return setToString(wrapper,function(source,details){var length=details.length;if(!length)return source;var lastIndex=length-1;return details[lastIndex]=(length>1?"& ":"")+details[lastIndex],details=details.join(length>2?", ":" "),source.replace(reWrapComment,"{\n/* [wrapped with "+details+"] */\n")}(source,function(details,bitmask){return arrayEach(wrapFlags,function(pair){var value="_."+pair[0];bitmask&pair[1]&&!arrayIncludes(details,value)&&details.push(value)}),details.sort()}(function(source){var match=source.match(reWrapDetails);return match?match[1].split(reSplitDetails):[]}(source),bitmask)))}function shortOut(func){var count=0,lastCalled=0;return function(){var stamp=nativeNow(),remaining=16-(stamp-lastCalled);if(lastCalled=stamp,remaining>0){if(++count>=800)return arguments[0]}else count=0;return func.apply(void 0,arguments)}}function shuffleSelf(array,size){var index=-1,length=array.length,lastIndex=length-1;for(size=void 0===size?length:size;++index<size;){var rand=baseRandom(index,lastIndex),value=array[rand];array[rand]=array[index],array[index]=value}return array.length=size,array}var result,cache,stringToPath=(result=memoize(function(string){var result=[];return 46===string.charCodeAt(0)&&result.push(""),string.replace(rePropName,function(match,number,quote,subString){result.push(quote?subString.replace(reEscapeChar,"$1"):number||match)}),result},function(key){return 500===cache.size&&cache.clear(),key}),cache=result.cache,result);function toKey(value){if("string"==typeof value||isSymbol(value))return value;var result=value+"";return"0"==result&&1/value==-1/0?"-0":result}function toSource(func){if(null!=func){try{return funcToString.call(func)}catch(e){}try{return func+""}catch(e){}}return""}function wrapperClone(wrapper){if(wrapper instanceof LazyWrapper)return wrapper.clone();var result=new LodashWrapper(wrapper.__wrapped__,wrapper.__chain__);return result.__actions__=copyArray(wrapper.__actions__),result.__index__=wrapper.__index__,result.__values__=wrapper.__values__,result}var difference=baseRest(function(array,values){return isArrayLikeObject(array)?baseDifference(array,baseFlatten(values,1,isArrayLikeObject,!0)):[]}),differenceBy=baseRest(function(array,values){var iteratee=last(values);return isArrayLikeObject(iteratee)&&(iteratee=void 0),isArrayLikeObject(array)?baseDifference(array,baseFlatten(values,1,isArrayLikeObject,!0),getIteratee(iteratee,2)):[]}),differenceWith=baseRest(function(array,values){var comparator=last(values);return isArrayLikeObject(comparator)&&(comparator=void 0),isArrayLikeObject(array)?baseDifference(array,baseFlatten(values,1,isArrayLikeObject,!0),void 0,comparator):[]});function findIndex(array,predicate,fromIndex){var length=null==array?0:array.length;if(!length)return-1;var index=null==fromIndex?0:toInteger(fromIndex);return index<0&&(index=nativeMax(length+index,0)),baseFindIndex(array,getIteratee(predicate,3),index)}function findLastIndex(array,predicate,fromIndex){var length=null==array?0:array.length;if(!length)return-1;var index=length-1;return void 0!==fromIndex&&(index=toInteger(fromIndex),index=fromIndex<0?nativeMax(length+index,0):nativeMin(index,length-1)),baseFindIndex(array,getIteratee(predicate,3),index,!0)}function flatten(array){return null!=array&&array.length?baseFlatten(array,1):[]}function head(array){return array&&array.length?array[0]:void 0}var intersection=baseRest(function(arrays){var mapped=arrayMap(arrays,castArrayLikeObject);return mapped.length&&mapped[0]===arrays[0]?baseIntersection(mapped):[]}),intersectionBy=baseRest(function(arrays){var iteratee=last(arrays),mapped=arrayMap(arrays,castArrayLikeObject);return iteratee===last(mapped)?iteratee=void 0:mapped.pop(),mapped.length&&mapped[0]===arrays[0]?baseIntersection(mapped,getIteratee(iteratee,2)):[]}),intersectionWith=baseRest(function(arrays){var comparator=last(arrays),mapped=arrayMap(arrays,castArrayLikeObject);return(comparator="function"==typeof comparator?comparator:void 0)&&mapped.pop(),mapped.length&&mapped[0]===arrays[0]?baseIntersection(mapped,void 0,comparator):[]});function last(array){var length=null==array?0:array.length;return length?array[length-1]:void 0}var pull=baseRest(pullAll);function pullAll(array,values){return array&&array.length&&values&&values.length?basePullAll(array,values):array}var pullAt=flatRest(function(array,indexes){var length=null==array?0:array.length,result=baseAt(array,indexes);return basePullAt(array,arrayMap(indexes,function(index){return isIndex(index,length)?+index:index}).sort(compareAscending)),result});function reverse(array){return null==array?array:nativeReverse.call(array)}var union=baseRest(function(arrays){return baseUniq(baseFlatten(arrays,1,isArrayLikeObject,!0))}),unionBy=baseRest(function(arrays){var iteratee=last(arrays);return isArrayLikeObject(iteratee)&&(iteratee=void 0),baseUniq(baseFlatten(arrays,1,isArrayLikeObject,!0),getIteratee(iteratee,2))}),unionWith=baseRest(function(arrays){var comparator=last(arrays);return comparator="function"==typeof comparator?comparator:void 0,baseUniq(baseFlatten(arrays,1,isArrayLikeObject,!0),void 0,comparator)});function unzip(array){if(!array||!array.length)return[];var length=0;return array=arrayFilter(array,function(group){if(isArrayLikeObject(group))return length=nativeMax(group.length,length),!0}),baseTimes(length,function(index){return arrayMap(array,baseProperty(index))})}function unzipWith(array,iteratee){if(!array||!array.length)return[];var result=unzip(array);return null==iteratee?result:arrayMap(result,function(group){return apply(iteratee,void 0,group)})}var without=baseRest(function(array,values){return isArrayLikeObject(array)?baseDifference(array,values):[]}),xor=baseRest(function(arrays){return baseXor(arrayFilter(arrays,isArrayLikeObject))}),xorBy=baseRest(function(arrays){var iteratee=last(arrays);return isArrayLikeObject(iteratee)&&(iteratee=void 0),baseXor(arrayFilter(arrays,isArrayLikeObject),getIteratee(iteratee,2))}),xorWith=baseRest(function(arrays){var comparator=last(arrays);return comparator="function"==typeof comparator?comparator:void 0,baseXor(arrayFilter(arrays,isArrayLikeObject),void 0,comparator)}),zip=baseRest(unzip),zipWith=baseRest(function(arrays){var length=arrays.length,iteratee=length>1?arrays[length-1]:void 0;return iteratee="function"==typeof iteratee?(arrays.pop(),iteratee):void 0,unzipWith(arrays,iteratee)});function chain(value){var result=lodash(value);return result.__chain__=!0,result}function thru(value,interceptor){return interceptor(value)}var wrapperAt=flatRest(function(paths){var length=paths.length,start=length?paths[0]:0,value=this.__wrapped__,interceptor=function(object){return baseAt(object,paths)};return!(length>1||this.__actions__.length)&&value instanceof LazyWrapper&&isIndex(start)?((value=value.slice(start,+start+(length?1:0))).__actions__.push({func:thru,args:[interceptor],thisArg:void 0}),new LodashWrapper(value,this.__chain__).thru(function(array){return length&&!array.length&&array.push(void 0),array})):this.thru(interceptor)}),countBy=createAggregator(function(result,value,key){hasOwnProperty.call(result,key)?++result[key]:baseAssignValue(result,key,1)}),find=createFind(findIndex),findLast=createFind(findLastIndex);function forEach(collection,iteratee){return(isArray(collection)?arrayEach:baseEach)(collection,getIteratee(iteratee,3))}function forEachRight(collection,iteratee){return(isArray(collection)?arrayEachRight:baseEachRight)(collection,getIteratee(iteratee,3))}var groupBy=createAggregator(function(result,value,key){hasOwnProperty.call(result,key)?result[key].push(value):baseAssignValue(result,key,[value])}),invokeMap=baseRest(function(collection,path,args){var index=-1,isFunc="function"==typeof path,result=isArrayLike(collection)?Array(collection.length):[];return baseEach(collection,function(value){result[++index]=isFunc?apply(path,value,args):baseInvoke(value,path,args)}),result}),keyBy=createAggregator(function(result,value,key){baseAssignValue(result,key,value)});function map(collection,iteratee){return(isArray(collection)?arrayMap:baseMap)(collection,getIteratee(iteratee,3))}var partition=createAggregator(function(result,value,key){result[key?0:1].push(value)},function(){return[[],[]]}),sortBy=baseRest(function(collection,iteratees){if(null==collection)return[];var length=iteratees.length;return length>1&&isIterateeCall(collection,iteratees[0],iteratees[1])?iteratees=[]:length>2&&isIterateeCall(iteratees[0],iteratees[1],iteratees[2])&&(iteratees=[iteratees[0]]),baseOrderBy(collection,baseFlatten(iteratees,1),[])}),now=ctxNow||function(){return root.Date.now()};function ary(func,n,guard){return n=guard?void 0:n,createWrap(func,128,void 0,void 0,void 0,void 0,n=func&&null==n?func.length:n)}function before(n,func){var result;if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return n=toInteger(n),function(){return--n>0&&(result=func.apply(this,arguments)),n<=1&&(func=void 0),result}}var bind=baseRest(function(func,thisArg,partials){var bitmask=1;if(partials.length){var holders=replaceHolders(partials,getHolder(bind));bitmask|=32}return createWrap(func,bitmask,thisArg,partials,holders)}),bindKey=baseRest(function(object,key,partials){var bitmask=3;if(partials.length){var holders=replaceHolders(partials,getHolder(bindKey));bitmask|=32}return createWrap(key,bitmask,object,partials,holders)});function debounce(func,wait,options){var lastArgs,lastThis,maxWait,result,timerId,lastCallTime,lastInvokeTime=0,leading=!1,maxing=!1,trailing=!0;if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);function invokeFunc(time){var args=lastArgs,thisArg=lastThis;return lastArgs=lastThis=void 0,lastInvokeTime=time,result=func.apply(thisArg,args)}function leadingEdge(time){return lastInvokeTime=time,timerId=setTimeout(timerExpired,wait),leading?invokeFunc(time):result}function shouldInvoke(time){var timeSinceLastCall=time-lastCallTime;return void 0===lastCallTime||timeSinceLastCall>=wait||timeSinceLastCall<0||maxing&&time-lastInvokeTime>=maxWait}function timerExpired(){var time=now();if(shouldInvoke(time))return trailingEdge(time);timerId=setTimeout(timerExpired,function(time){var timeWaiting=wait-(time-lastCallTime);return maxing?nativeMin(timeWaiting,maxWait-(time-lastInvokeTime)):timeWaiting}(time))}function trailingEdge(time){return timerId=void 0,trailing&&lastArgs?invokeFunc(time):(lastArgs=lastThis=void 0,result)}function debounced(){var time=now(),isInvoking=shouldInvoke(time);if(lastArgs=arguments,lastThis=this,lastCallTime=time,isInvoking){if(void 0===timerId)return leadingEdge(lastCallTime);if(maxing)return clearTimeout(timerId),timerId=setTimeout(timerExpired,wait),invokeFunc(lastCallTime)}return void 0===timerId&&(timerId=setTimeout(timerExpired,wait)),result}return wait=toNumber(wait)||0,isObject(options)&&(leading=!!options.leading,maxWait=(maxing="maxWait"in options)?nativeMax(toNumber(options.maxWait)||0,wait):maxWait,trailing="trailing"in options?!!options.trailing:trailing),debounced.cancel=function(){void 0!==timerId&&clearTimeout(timerId),lastInvokeTime=0,lastArgs=lastCallTime=lastThis=timerId=void 0},debounced.flush=function(){return void 0===timerId?result:trailingEdge(now())},debounced}var defer=baseRest(function(func,args){return baseDelay(func,1,args)}),delay=baseRest(function(func,wait,args){return baseDelay(func,toNumber(wait)||0,args)});function memoize(func,resolver){if("function"!=typeof func||null!=resolver&&"function"!=typeof resolver)throw new TypeError(FUNC_ERROR_TEXT);var memoized=function memoized(){var args=arguments,key=resolver?resolver.apply(this,args):args[0],cache=memoized.cache;if(cache.has(key))return cache.get(key);var result=func.apply(this,args);return memoized.cache=cache.set(key,result)||cache,result};return memoized.cache=new(memoize.Cache||MapCache),memoized}function negate(predicate){if("function"!=typeof predicate)throw new TypeError(FUNC_ERROR_TEXT);return function(){var args=arguments;switch(args.length){case 0:return!predicate.call(this);case 1:return!predicate.call(this,args[0]);case 2:return!predicate.call(this,args[0],args[1]);case 3:return!predicate.call(this,args[0],args[1],args[2])}return!predicate.apply(this,args)}}memoize.Cache=MapCache;var overArgs=castRest(function(func,transforms){var funcsLength=(transforms=1==transforms.length&&isArray(transforms[0])?arrayMap(transforms[0],baseUnary(getIteratee())):arrayMap(baseFlatten(transforms,1),baseUnary(getIteratee()))).length;return baseRest(function(args){for(var index=-1,length=nativeMin(args.length,funcsLength);++index<length;)args[index]=transforms[index].call(this,args[index]);return apply(func,this,args)})}),partial=baseRest(function(func,partials){return createWrap(func,32,void 0,partials,replaceHolders(partials,getHolder(partial)))}),partialRight=baseRest(function(func,partials){return createWrap(func,64,void 0,partials,replaceHolders(partials,getHolder(partialRight)))}),rearg=flatRest(function(func,indexes){return createWrap(func,256,void 0,void 0,void 0,indexes)});function eq(value,other){return value===other||value!=value&&other!=other}var gt=createRelationalOperation(baseGt),gte=createRelationalOperation(function(value,other){return value>=other}),isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(value){return isObjectLike(value)&&hasOwnProperty.call(value,"callee")&&!propertyIsEnumerable.call(value,"callee")},isArray=Array.isArray,isArrayBuffer=nodeIsArrayBuffer?baseUnary(nodeIsArrayBuffer):function(value){return isObjectLike(value)&&baseGetTag(value)==arrayBufferTag};function isArrayLike(value){return null!=value&&isLength(value.length)&&!isFunction(value)}function isArrayLikeObject(value){return isObjectLike(value)&&isArrayLike(value)}var isBuffer=nativeIsBuffer||stubFalse,isDate=nodeIsDate?baseUnary(nodeIsDate):function(value){return isObjectLike(value)&&baseGetTag(value)==dateTag};function isError(value){if(!isObjectLike(value))return!1;var tag=baseGetTag(value);return tag==errorTag||"[object DOMException]"==tag||"string"==typeof value.message&&"string"==typeof value.name&&!isPlainObject(value)}function isFunction(value){if(!isObject(value))return!1;var tag=baseGetTag(value);return tag==funcTag||tag==genTag||"[object AsyncFunction]"==tag||"[object Proxy]"==tag}function isInteger(value){return"number"==typeof value&&value==toInteger(value)}function isLength(value){return"number"==typeof value&&value>-1&&value%1==0&&value<=9007199254740991}function isObject(value){var type=typeof value;return null!=value&&("object"==type||"function"==type)}function isObjectLike(value){return null!=value&&"object"==typeof value}var isMap=nodeIsMap?baseUnary(nodeIsMap):function(value){return isObjectLike(value)&&getTag(value)==mapTag};function isNumber(value){return"number"==typeof value||isObjectLike(value)&&baseGetTag(value)==numberTag}function isPlainObject(value){if(!isObjectLike(value)||baseGetTag(value)!=objectTag)return!1;var proto=getPrototype(value);if(null===proto)return!0;var Ctor=hasOwnProperty.call(proto,"constructor")&&proto.constructor;return"function"==typeof Ctor&&Ctor instanceof Ctor&&funcToString.call(Ctor)==objectCtorString}var isRegExp=nodeIsRegExp?baseUnary(nodeIsRegExp):function(value){return isObjectLike(value)&&baseGetTag(value)==regexpTag},isSet=nodeIsSet?baseUnary(nodeIsSet):function(value){return isObjectLike(value)&&getTag(value)==setTag};function isString(value){return"string"==typeof value||!isArray(value)&&isObjectLike(value)&&baseGetTag(value)==stringTag}function isSymbol(value){return"symbol"==typeof value||isObjectLike(value)&&baseGetTag(value)==symbolTag}var isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):function(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[baseGetTag(value)]},lt=createRelationalOperation(baseLt),lte=createRelationalOperation(function(value,other){return value<=other});function toArray(value){if(!value)return[];if(isArrayLike(value))return isString(value)?stringToArray(value):copyArray(value);if(symIterator&&value[symIterator])return function(iterator){for(var data,result=[];!(data=iterator.next()).done;)result.push(data.value);return result}(value[symIterator]());var tag=getTag(value);return(tag==mapTag?mapToArray:tag==setTag?setToArray:values)(value)}function toFinite(value){return value?1/0===(value=toNumber(value))||-1/0===value?17976931348623157e292*(value<0?-1:1):value==value?value:0:0===value?value:0}function toInteger(value){var result=toFinite(value),remainder=result%1;return result==result?remainder?result-remainder:result:0}function toLength(value){return value?baseClamp(toInteger(value),0,4294967295):0}function toNumber(value){if("number"==typeof value)return value;if(isSymbol(value))return NaN;if(isObject(value)){var other="function"==typeof value.valueOf?value.valueOf():value;value=isObject(other)?other+"":other}if("string"!=typeof value)return 0===value?value:+value;value=baseTrim(value);var isBinary=reIsBinary.test(value);return isBinary||reIsOctal.test(value)?freeParseInt(value.slice(2),isBinary?2:8):reIsBadHex.test(value)?NaN:+value}function toPlainObject(value){return copyObject(value,keysIn(value))}function toString(value){return null==value?"":baseToString(value)}var assign=createAssigner(function(object,source){if(isPrototype(source)||isArrayLike(source))copyObject(source,keys(source),object);else for(var key in source)hasOwnProperty.call(source,key)&&assignValue(object,key,source[key])}),assignIn=createAssigner(function(object,source){copyObject(source,keysIn(source),object)}),assignInWith=createAssigner(function(object,source,srcIndex,customizer){copyObject(source,keysIn(source),object,customizer)}),assignWith=createAssigner(function(object,source,srcIndex,customizer){copyObject(source,keys(source),object,customizer)}),at=flatRest(baseAt),defaults=baseRest(function(object,sources){object=Object(object);var index=-1,length=sources.length,guard=length>2?sources[2]:void 0;for(guard&&isIterateeCall(sources[0],sources[1],guard)&&(length=1);++index<length;)for(var source=sources[index],props=keysIn(source),propsIndex=-1,propsLength=props.length;++propsIndex<propsLength;){var key=props[propsIndex],value=object[key];(void 0===value||eq(value,objectProto[key])&&!hasOwnProperty.call(object,key))&&(object[key]=source[key])}return object}),defaultsDeep=baseRest(function(args){return args.push(void 0,customDefaultsMerge),apply(mergeWith,void 0,args)});function get(object,path,defaultValue){var result=null==object?void 0:baseGet(object,path);return void 0===result?defaultValue:result}function hasIn(object,path){return null!=object&&hasPath(object,path,baseHasIn)}var invert=createInverter(function(result,value,key){null!=value&&"function"!=typeof value.toString&&(value=nativeObjectToString.call(value)),result[value]=key},constant(identity)),invertBy=createInverter(function(result,value,key){null!=value&&"function"!=typeof value.toString&&(value=nativeObjectToString.call(value)),hasOwnProperty.call(result,value)?result[value].push(key):result[value]=[key]},getIteratee),invoke=baseRest(baseInvoke);function keys(object){return isArrayLike(object)?arrayLikeKeys(object):baseKeys(object)}function keysIn(object){return isArrayLike(object)?arrayLikeKeys(object,!0):function(object){if(!isObject(object))return function(object){var result=[];if(null!=object)for(var key in Object(object))result.push(key);return result}(object);var isProto=isPrototype(object),result=[];for(var key in object)("constructor"!=key||!isProto&&hasOwnProperty.call(object,key))&&result.push(key);return result}(object)}var merge=createAssigner(function(object,source,srcIndex){baseMerge(object,source,srcIndex)}),mergeWith=createAssigner(function(object,source,srcIndex,customizer){baseMerge(object,source,srcIndex,customizer)}),omit=flatRest(function(object,paths){var result={};if(null==object)return result;var isDeep=!1;paths=arrayMap(paths,function(path){return path=castPath(path,object),isDeep||(isDeep=path.length>1),path}),copyObject(object,getAllKeysIn(object),result),isDeep&&(result=baseClone(result,7,customOmitClone));for(var length=paths.length;length--;)baseUnset(result,paths[length]);return result}),pick=flatRest(function(object,paths){return null==object?{}:function(object,paths){return basePickBy(object,paths,function(value,path){return hasIn(object,path)})}(object,paths)});function pickBy(object,predicate){if(null==object)return{};var props=arrayMap(getAllKeysIn(object),function(prop){return[prop]});return predicate=getIteratee(predicate),basePickBy(object,props,function(value,path){return predicate(value,path[0])})}var toPairs=createToPairs(keys),toPairsIn=createToPairs(keysIn);function values(object){return null==object?[]:baseValues(object,keys(object))}var camelCase=createCompounder(function(result,word,index){return word=word.toLowerCase(),result+(index?capitalize(word):word)});function capitalize(string){return upperFirst(toString(string).toLowerCase())}function deburr(string){return(string=toString(string))&&string.replace(reLatin,deburrLetter).replace(reComboMark,"")}var kebabCase=createCompounder(function(result,word,index){return result+(index?"-":"")+word.toLowerCase()}),lowerCase=createCompounder(function(result,word,index){return result+(index?" ":"")+word.toLowerCase()}),lowerFirst=createCaseFirst("toLowerCase"),snakeCase=createCompounder(function(result,word,index){return result+(index?"_":"")+word.toLowerCase()}),startCase=createCompounder(function(result,word,index){return result+(index?" ":"")+upperFirst(word)}),upperCase=createCompounder(function(result,word,index){return result+(index?" ":"")+word.toUpperCase()}),upperFirst=createCaseFirst("toUpperCase");function words(string,pattern,guard){return string=toString(string),void 0===(pattern=guard?void 0:pattern)?function(string){return reHasUnicodeWord.test(string)}(string)?function(string){return string.match(reUnicodeWord)||[]}(string):function(string){return string.match(reAsciiWord)||[]}(string):string.match(pattern)||[]}var attempt=baseRest(function(func,args){try{return apply(func,void 0,args)}catch(e){return isError(e)?e:new Error(e)}}),bindAll=flatRest(function(object,methodNames){return arrayEach(methodNames,function(key){key=toKey(key),baseAssignValue(object,key,bind(object[key],object))}),object});function constant(value){return function(){return value}}var flow=createFlow(),flowRight=createFlow(!0);function identity(value){return value}function iteratee(func){return baseIteratee("function"==typeof func?func:baseClone(func,1))}var method=baseRest(function(path,args){return function(object){return baseInvoke(object,path,args)}}),methodOf=baseRest(function(object,args){return function(path){return baseInvoke(object,path,args)}});function mixin(object,source,options){var props=keys(source),methodNames=baseFunctions(source,props);null!=options||isObject(source)&&(methodNames.length||!props.length)||(options=source,source=object,object=this,methodNames=baseFunctions(source,keys(source)));var chain=!(isObject(options)&&"chain"in options&&!options.chain),isFunc=isFunction(object);return arrayEach(methodNames,function(methodName){var func=source[methodName];object[methodName]=func,isFunc&&(object.prototype[methodName]=function(){var chainAll=this.__chain__;if(chain||chainAll){var result=object(this.__wrapped__),actions=result.__actions__=copyArray(this.__actions__);return actions.push({func:func,args:arguments,thisArg:object}),result.__chain__=chainAll,result}return func.apply(object,arrayPush([this.value()],arguments))})}),object}function noop(){}var over=createOver(arrayMap),overEvery=createOver(arrayEvery),overSome=createOver(arraySome);function property(path){return isKey(path)?baseProperty(toKey(path)):function(path){return function(object){return baseGet(object,path)}}(path)}var range=createRange(),rangeRight=createRange(!0);function stubArray(){return[]}function stubFalse(){return!1}var source,add=createMathOperation(function(augend,addend){return augend+addend},0),ceil=createRound("ceil"),divide=createMathOperation(function(dividend,divisor){return dividend/divisor},1),floor=createRound("floor"),multiply=createMathOperation(function(multiplier,multiplicand){return multiplier*multiplicand},1),round=createRound("round"),subtract=createMathOperation(function(minuend,subtrahend){return minuend-subtrahend},0);return lodash.after=function(n,func){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return n=toInteger(n),function(){if(--n<1)return func.apply(this,arguments)}},lodash.ary=ary,lodash.assign=assign,lodash.assignIn=assignIn,lodash.assignInWith=assignInWith,lodash.assignWith=assignWith,lodash.at=at,lodash.before=before,lodash.bind=bind,lodash.bindAll=bindAll,lodash.bindKey=bindKey,lodash.castArray=function(){if(!arguments.length)return[];var value=arguments[0];return isArray(value)?value:[value]},lodash.chain=chain,lodash.chunk=function(array,size,guard){size=(guard?isIterateeCall(array,size,guard):void 0===size)?1:nativeMax(toInteger(size),0);var length=null==array?0:array.length;if(!length||size<1)return[];for(var index=0,resIndex=0,result=Array(nativeCeil(length/size));index<length;)result[resIndex++]=baseSlice(array,index,index+=size);return result},lodash.compact=function(array){for(var index=-1,length=null==array?0:array.length,resIndex=0,result=[];++index<length;){var value=array[index];value&&(result[resIndex++]=value)}return result},lodash.concat=function(){var length=arguments.length;if(!length)return[];for(var args=Array(length-1),array=arguments[0],index=length;index--;)args[index-1]=arguments[index];return arrayPush(isArray(array)?copyArray(array):[array],baseFlatten(args,1))},lodash.cond=function(pairs){var length=null==pairs?0:pairs.length,toIteratee=getIteratee();return pairs=length?arrayMap(pairs,function(pair){if("function"!=typeof pair[1])throw new TypeError(FUNC_ERROR_TEXT);return[toIteratee(pair[0]),pair[1]]}):[],baseRest(function(args){for(var index=-1;++index<length;){var pair=pairs[index];if(apply(pair[0],this,args))return apply(pair[1],this,args)}})},lodash.conforms=function(source){return function(source){var props=keys(source);return function(object){return baseConformsTo(object,source,props)}}(baseClone(source,1))},lodash.constant=constant,lodash.countBy=countBy,lodash.create=function(prototype,properties){var result=baseCreate(prototype);return null==properties?result:baseAssign(result,properties)},lodash.curry=function curry(func,arity,guard){var result=createWrap(func,8,void 0,void 0,void 0,void 0,void 0,arity=guard?void 0:arity);return result.placeholder=curry.placeholder,result},lodash.curryRight=function curryRight(func,arity,guard){var result=createWrap(func,16,void 0,void 0,void 0,void 0,void 0,arity=guard?void 0:arity);return result.placeholder=curryRight.placeholder,result},lodash.debounce=debounce,lodash.defaults=defaults,lodash.defaultsDeep=defaultsDeep,lodash.defer=defer,lodash.delay=delay,lodash.difference=difference,lodash.differenceBy=differenceBy,lodash.differenceWith=differenceWith,lodash.drop=function(array,n,guard){var length=null==array?0:array.length;return length?baseSlice(array,(n=guard||void 0===n?1:toInteger(n))<0?0:n,length):[]},lodash.dropRight=function(array,n,guard){var length=null==array?0:array.length;return length?baseSlice(array,0,(n=length-(n=guard||void 0===n?1:toInteger(n)))<0?0:n):[]},lodash.dropRightWhile=function(array,predicate){return array&&array.length?baseWhile(array,getIteratee(predicate,3),!0,!0):[]},lodash.dropWhile=function(array,predicate){return array&&array.length?baseWhile(array,getIteratee(predicate,3),!0):[]},lodash.fill=function(array,value,start,end){var length=null==array?0:array.length;return length?(start&&"number"!=typeof start&&isIterateeCall(array,value,start)&&(start=0,end=length),function(array,value,start,end){var length=array.length;for((start=toInteger(start))<0&&(start=-start>length?0:length+start),(end=void 0===end||end>length?length:toInteger(end))<0&&(end+=length),end=start>end?0:toLength(end);start<end;)array[start++]=value;return array}(array,value,start,end)):[]},lodash.filter=function(collection,predicate){return(isArray(collection)?arrayFilter:baseFilter)(collection,getIteratee(predicate,3))},lodash.flatMap=function(collection,iteratee){return baseFlatten(map(collection,iteratee),1)},lodash.flatMapDeep=function(collection,iteratee){return baseFlatten(map(collection,iteratee),1/0)},lodash.flatMapDepth=function(collection,iteratee,depth){return depth=void 0===depth?1:toInteger(depth),baseFlatten(map(collection,iteratee),depth)},lodash.flatten=flatten,lodash.flattenDeep=function(array){return null!=array&&array.length?baseFlatten(array,1/0):[]},lodash.flattenDepth=function(array,depth){return null!=array&&array.length?baseFlatten(array,depth=void 0===depth?1:toInteger(depth)):[]},lodash.flip=function(func){return createWrap(func,512)},lodash.flow=flow,lodash.flowRight=flowRight,lodash.fromPairs=function(pairs){for(var index=-1,length=null==pairs?0:pairs.length,result={};++index<length;){var pair=pairs[index];result[pair[0]]=pair[1]}return result},lodash.functions=function(object){return null==object?[]:baseFunctions(object,keys(object))},lodash.functionsIn=function(object){return null==object?[]:baseFunctions(object,keysIn(object))},lodash.groupBy=groupBy,lodash.initial=function(array){return null!=array&&array.length?baseSlice(array,0,-1):[]},lodash.intersection=intersection,lodash.intersectionBy=intersectionBy,lodash.intersectionWith=intersectionWith,lodash.invert=invert,lodash.invertBy=invertBy,lodash.invokeMap=invokeMap,lodash.iteratee=iteratee,lodash.keyBy=keyBy,lodash.keys=keys,lodash.keysIn=keysIn,lodash.map=map,lodash.mapKeys=function(object,iteratee){var result={};return iteratee=getIteratee(iteratee,3),baseForOwn(object,function(value,key,object){baseAssignValue(result,iteratee(value,key,object),value)}),result},lodash.mapValues=function(object,iteratee){var result={};return iteratee=getIteratee(iteratee,3),baseForOwn(object,function(value,key,object){baseAssignValue(result,key,iteratee(value,key,object))}),result},lodash.matches=function(source){return baseMatches(baseClone(source,1))},lodash.matchesProperty=function(path,srcValue){return baseMatchesProperty(path,baseClone(srcValue,1))},lodash.memoize=memoize,lodash.merge=merge,lodash.mergeWith=mergeWith,lodash.method=method,lodash.methodOf=methodOf,lodash.mixin=mixin,lodash.negate=negate,lodash.nthArg=function(n){return n=toInteger(n),baseRest(function(args){return baseNth(args,n)})},lodash.omit=omit,lodash.omitBy=function(object,predicate){return pickBy(object,negate(getIteratee(predicate)))},lodash.once=function(func){return before(2,func)},lodash.orderBy=function(collection,iteratees,orders,guard){return null==collection?[]:(isArray(iteratees)||(iteratees=null==iteratees?[]:[iteratees]),isArray(orders=guard?void 0:orders)||(orders=null==orders?[]:[orders]),baseOrderBy(collection,iteratees,orders))},lodash.over=over,lodash.overArgs=overArgs,lodash.overEvery=overEvery,lodash.overSome=overSome,lodash.partial=partial,lodash.partialRight=partialRight,lodash.partition=partition,lodash.pick=pick,lodash.pickBy=pickBy,lodash.property=property,lodash.propertyOf=function(object){return function(path){return null==object?void 0:baseGet(object,path)}},lodash.pull=pull,lodash.pullAll=pullAll,lodash.pullAllBy=function(array,values,iteratee){return array&&array.length&&values&&values.length?basePullAll(array,values,getIteratee(iteratee,2)):array},lodash.pullAllWith=function(array,values,comparator){return array&&array.length&&values&&values.length?basePullAll(array,values,void 0,comparator):array},lodash.pullAt=pullAt,lodash.range=range,lodash.rangeRight=rangeRight,lodash.rearg=rearg,lodash.reject=function(collection,predicate){return(isArray(collection)?arrayFilter:baseFilter)(collection,negate(getIteratee(predicate,3)))},lodash.remove=function(array,predicate){var result=[];if(!array||!array.length)return result;var index=-1,indexes=[],length=array.length;for(predicate=getIteratee(predicate,3);++index<length;){var value=array[index];predicate(value,index,array)&&(result.push(value),indexes.push(index))}return basePullAt(array,indexes),result},lodash.rest=function(func,start){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return baseRest(func,start=void 0===start?start:toInteger(start))},lodash.reverse=reverse,lodash.sampleSize=function(collection,n,guard){return n=(guard?isIterateeCall(collection,n,guard):void 0===n)?1:toInteger(n),(isArray(collection)?arraySampleSize:baseSampleSize)(collection,n)},lodash.set=function(object,path,value){return null==object?object:baseSet(object,path,value)},lodash.setWith=function(object,path,value,customizer){return customizer="function"==typeof customizer?customizer:void 0,null==object?object:baseSet(object,path,value,customizer)},lodash.shuffle=function(collection){return(isArray(collection)?arrayShuffle:baseShuffle)(collection)},lodash.slice=function(array,start,end){var length=null==array?0:array.length;return length?(end&&"number"!=typeof end&&isIterateeCall(array,start,end)?(start=0,end=length):(start=null==start?0:toInteger(start),end=void 0===end?length:toInteger(end)),baseSlice(array,start,end)):[]},lodash.sortBy=sortBy,lodash.sortedUniq=function(array){return array&&array.length?baseSortedUniq(array):[]},lodash.sortedUniqBy=function(array,iteratee){return array&&array.length?baseSortedUniq(array,getIteratee(iteratee,2)):[]},lodash.split=function(string,separator,limit){return limit&&"number"!=typeof limit&&isIterateeCall(string,separator,limit)&&(separator=limit=void 0),(limit=void 0===limit?4294967295:limit>>>0)?(string=toString(string))&&("string"==typeof separator||null!=separator&&!isRegExp(separator))&&!(separator=baseToString(separator))&&hasUnicode(string)?castSlice(stringToArray(string),0,limit):string.split(separator,limit):[]},lodash.spread=function(func,start){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return start=null==start?0:nativeMax(toInteger(start),0),baseRest(function(args){var array=args[start],otherArgs=castSlice(args,0,start);return array&&arrayPush(otherArgs,array),apply(func,this,otherArgs)})},lodash.tail=function(array){var length=null==array?0:array.length;return length?baseSlice(array,1,length):[]},lodash.take=function(array,n,guard){return array&&array.length?baseSlice(array,0,(n=guard||void 0===n?1:toInteger(n))<0?0:n):[]},lodash.takeRight=function(array,n,guard){var length=null==array?0:array.length;return length?baseSlice(array,(n=length-(n=guard||void 0===n?1:toInteger(n)))<0?0:n,length):[]},lodash.takeRightWhile=function(array,predicate){return array&&array.length?baseWhile(array,getIteratee(predicate,3),!1,!0):[]},lodash.takeWhile=function(array,predicate){return array&&array.length?baseWhile(array,getIteratee(predicate,3)):[]},lodash.tap=function(value,interceptor){return interceptor(value),value},lodash.throttle=function(func,wait,options){var leading=!0,trailing=!0;if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return isObject(options)&&(leading="leading"in options?!!options.leading:leading,trailing="trailing"in options?!!options.trailing:trailing),debounce(func,wait,{leading:leading,maxWait:wait,trailing:trailing})},lodash.thru=thru,lodash.toArray=toArray,lodash.toPairs=toPairs,lodash.toPairsIn=toPairsIn,lodash.toPath=function(value){return isArray(value)?arrayMap(value,toKey):isSymbol(value)?[value]:copyArray(stringToPath(toString(value)))},lodash.toPlainObject=toPlainObject,lodash.transform=function(object,iteratee,accumulator){var isArr=isArray(object),isArrLike=isArr||isBuffer(object)||isTypedArray(object);if(iteratee=getIteratee(iteratee,4),null==accumulator){var Ctor=object&&object.constructor;accumulator=isArrLike?isArr?new Ctor:[]:isObject(object)&&isFunction(Ctor)?baseCreate(getPrototype(object)):{}}return(isArrLike?arrayEach:baseForOwn)(object,function(value,index,object){return iteratee(accumulator,value,index,object)}),accumulator},lodash.unary=function(func){return ary(func,1)},lodash.union=union,lodash.unionBy=unionBy,lodash.unionWith=unionWith,lodash.uniq=function(array){return array&&array.length?baseUniq(array):[]},lodash.uniqBy=function(array,iteratee){return array&&array.length?baseUniq(array,getIteratee(iteratee,2)):[]},lodash.uniqWith=function(array,comparator){return comparator="function"==typeof comparator?comparator:void 0,array&&array.length?baseUniq(array,void 0,comparator):[]},lodash.unset=function(object,path){return null==object||baseUnset(object,path)},lodash.unzip=unzip,lodash.unzipWith=unzipWith,lodash.update=function(object,path,updater){return null==object?object:baseUpdate(object,path,castFunction(updater))},lodash.updateWith=function(object,path,updater,customizer){return customizer="function"==typeof customizer?customizer:void 0,null==object?object:baseUpdate(object,path,castFunction(updater),customizer)},lodash.values=values,lodash.valuesIn=function(object){return null==object?[]:baseValues(object,keysIn(object))},lodash.without=without,lodash.words=words,lodash.wrap=function(value,wrapper){return partial(castFunction(wrapper),value)},lodash.xor=xor,lodash.xorBy=xorBy,lodash.xorWith=xorWith,lodash.zip=zip,lodash.zipObject=function(props,values){return baseZipObject(props||[],values||[],assignValue)},lodash.zipObjectDeep=function(props,values){return baseZipObject(props||[],values||[],baseSet)},lodash.zipWith=zipWith,lodash.entries=toPairs,lodash.entriesIn=toPairsIn,lodash.extend=assignIn,lodash.extendWith=assignInWith,mixin(lodash,lodash),lodash.add=add,lodash.attempt=attempt,lodash.camelCase=camelCase,lodash.capitalize=capitalize,lodash.ceil=ceil,lodash.clamp=function(number,lower,upper){return void 0===upper&&(upper=lower,lower=void 0),void 0!==upper&&(upper=(upper=toNumber(upper))==upper?upper:0),void 0!==lower&&(lower=(lower=toNumber(lower))==lower?lower:0),baseClamp(toNumber(number),lower,upper)},lodash.clone=function(value){return baseClone(value,4)},lodash.cloneDeep=function(value){return baseClone(value,5)},lodash.cloneDeepWith=function(value,customizer){return baseClone(value,5,customizer="function"==typeof customizer?customizer:void 0)},lodash.cloneWith=function(value,customizer){return baseClone(value,4,customizer="function"==typeof customizer?customizer:void 0)},lodash.conformsTo=function(object,source){return null==source||baseConformsTo(object,source,keys(source))},lodash.deburr=deburr,lodash.defaultTo=function(value,defaultValue){return null==value||value!=value?defaultValue:value},lodash.divide=divide,lodash.endsWith=function(string,target,position){string=toString(string),target=baseToString(target);var length=string.length,end=position=void 0===position?length:baseClamp(toInteger(position),0,length);return(position-=target.length)>=0&&string.slice(position,end)==target},lodash.eq=eq,lodash.escape=function(string){return(string=toString(string))&&reHasUnescapedHtml.test(string)?string.replace(reUnescapedHtml,escapeHtmlChar):string},lodash.escapeRegExp=function(string){return(string=toString(string))&&reHasRegExpChar.test(string)?string.replace(reRegExpChar,"\\$&"):string},lodash.every=function(collection,predicate,guard){var func=isArray(collection)?arrayEvery:baseEvery;return guard&&isIterateeCall(collection,predicate,guard)&&(predicate=void 0),func(collection,getIteratee(predicate,3))},lodash.find=find,lodash.findIndex=findIndex,lodash.findKey=function(object,predicate){return baseFindKey(object,getIteratee(predicate,3),baseForOwn)},lodash.findLast=findLast,lodash.findLastIndex=findLastIndex,lodash.findLastKey=function(object,predicate){return baseFindKey(object,getIteratee(predicate,3),baseForOwnRight)},lodash.floor=floor,lodash.forEach=forEach,lodash.forEachRight=forEachRight,lodash.forIn=function(object,iteratee){return null==object?object:baseFor(object,getIteratee(iteratee,3),keysIn)},lodash.forInRight=function(object,iteratee){return null==object?object:baseForRight(object,getIteratee(iteratee,3),keysIn)},lodash.forOwn=function(object,iteratee){return object&&baseForOwn(object,getIteratee(iteratee,3))},lodash.forOwnRight=function(object,iteratee){return object&&baseForOwnRight(object,getIteratee(iteratee,3))},lodash.get=get,lodash.gt=gt,lodash.gte=gte,lodash.has=function(object,path){return null!=object&&hasPath(object,path,baseHas)},lodash.hasIn=hasIn,lodash.head=head,lodash.identity=identity,lodash.includes=function(collection,value,fromIndex,guard){collection=isArrayLike(collection)?collection:values(collection),fromIndex=fromIndex&&!guard?toInteger(fromIndex):0;var length=collection.length;return fromIndex<0&&(fromIndex=nativeMax(length+fromIndex,0)),isString(collection)?fromIndex<=length&&collection.indexOf(value,fromIndex)>-1:!!length&&baseIndexOf(collection,value,fromIndex)>-1},lodash.indexOf=function(array,value,fromIndex){var length=null==array?0:array.length;if(!length)return-1;var index=null==fromIndex?0:toInteger(fromIndex);return index<0&&(index=nativeMax(length+index,0)),baseIndexOf(array,value,index)},lodash.inRange=function(number,start,end){return start=toFinite(start),void 0===end?(end=start,start=0):end=toFinite(end),function(number,start,end){return number>=nativeMin(start,end)&&number<nativeMax(start,end)}(number=toNumber(number),start,end)},lodash.invoke=invoke,lodash.isArguments=isArguments,lodash.isArray=isArray,lodash.isArrayBuffer=isArrayBuffer,lodash.isArrayLike=isArrayLike,lodash.isArrayLikeObject=isArrayLikeObject,lodash.isBoolean=function(value){return!0===value||!1===value||isObjectLike(value)&&baseGetTag(value)==boolTag},lodash.isBuffer=isBuffer,lodash.isDate=isDate,lodash.isElement=function(value){return isObjectLike(value)&&1===value.nodeType&&!isPlainObject(value)},lodash.isEmpty=function(value){if(null==value)return!0;if(isArrayLike(value)&&(isArray(value)||"string"==typeof value||"function"==typeof value.splice||isBuffer(value)||isTypedArray(value)||isArguments(value)))return!value.length;var tag=getTag(value);if(tag==mapTag||tag==setTag)return!value.size;if(isPrototype(value))return!baseKeys(value).length;for(var key in value)if(hasOwnProperty.call(value,key))return!1;return!0},lodash.isEqual=function(value,other){return baseIsEqual(value,other)},lodash.isEqualWith=function(value,other,customizer){var result=(customizer="function"==typeof customizer?customizer:void 0)?customizer(value,other):void 0;return void 0===result?baseIsEqual(value,other,void 0,customizer):!!result},lodash.isError=isError,lodash.isFinite=function(value){return"number"==typeof value&&nativeIsFinite(value)},lodash.isFunction=isFunction,lodash.isInteger=isInteger,lodash.isLength=isLength,lodash.isMap=isMap,lodash.isMatch=function(object,source){return object===source||baseIsMatch(object,source,getMatchData(source))},lodash.isMatchWith=function(object,source,customizer){return customizer="function"==typeof customizer?customizer:void 0,baseIsMatch(object,source,getMatchData(source),customizer)},lodash.isNaN=function(value){return isNumber(value)&&value!=+value},lodash.isNative=function(value){if(isMaskable(value))throw new Error("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return baseIsNative(value)},lodash.isNil=function(value){return null==value},lodash.isNull=function(value){return null===value},lodash.isNumber=isNumber,lodash.isObject=isObject,lodash.isObjectLike=isObjectLike,lodash.isPlainObject=isPlainObject,lodash.isRegExp=isRegExp,lodash.isSafeInteger=function(value){return isInteger(value)&&value>=-9007199254740991&&value<=9007199254740991},lodash.isSet=isSet,lodash.isString=isString,lodash.isSymbol=isSymbol,lodash.isTypedArray=isTypedArray,lodash.isUndefined=function(value){return void 0===value},lodash.isWeakMap=function(value){return isObjectLike(value)&&getTag(value)==weakMapTag},lodash.isWeakSet=function(value){return isObjectLike(value)&&"[object WeakSet]"==baseGetTag(value)},lodash.join=function(array,separator){return null==array?"":nativeJoin.call(array,separator)},lodash.kebabCase=kebabCase,lodash.last=last,lodash.lastIndexOf=function(array,value,fromIndex){var length=null==array?0:array.length;if(!length)return-1;var index=length;return void 0!==fromIndex&&(index=(index=toInteger(fromIndex))<0?nativeMax(length+index,0):nativeMin(index,length-1)),value==value?function(array,value,fromIndex){for(var index=fromIndex+1;index--;)if(array[index]===value)return index;return index}(array,value,index):baseFindIndex(array,baseIsNaN,index,!0)},lodash.lowerCase=lowerCase,lodash.lowerFirst=lowerFirst,lodash.lt=lt,lodash.lte=lte,lodash.max=function(array){return array&&array.length?baseExtremum(array,identity,baseGt):void 0},lodash.maxBy=function(array,iteratee){return array&&array.length?baseExtremum(array,getIteratee(iteratee,2),baseGt):void 0},lodash.mean=function(array){return baseMean(array,identity)},lodash.meanBy=function(array,iteratee){return baseMean(array,getIteratee(iteratee,2))},lodash.min=function(array){return array&&array.length?baseExtremum(array,identity,baseLt):void 0},lodash.minBy=function(array,iteratee){return array&&array.length?baseExtremum(array,getIteratee(iteratee,2),baseLt):void 0},lodash.stubArray=stubArray,lodash.stubFalse=stubFalse,lodash.stubObject=function(){return{}},lodash.stubString=function(){return""},lodash.stubTrue=function(){return!0},lodash.multiply=multiply,lodash.nth=function(array,n){return array&&array.length?baseNth(array,toInteger(n)):void 0},lodash.noConflict=function(){return root._===this&&(root._=oldDash),this},lodash.noop=noop,lodash.now=now,lodash.pad=function(string,length,chars){string=toString(string);var strLength=(length=toInteger(length))?stringSize(string):0;if(!length||strLength>=length)return string;var mid=(length-strLength)/2;return createPadding(nativeFloor(mid),chars)+string+createPadding(nativeCeil(mid),chars)},lodash.padEnd=function(string,length,chars){string=toString(string);var strLength=(length=toInteger(length))?stringSize(string):0;return length&&strLength<length?string+createPadding(length-strLength,chars):string},lodash.padStart=function(string,length,chars){string=toString(string);var strLength=(length=toInteger(length))?stringSize(string):0;return length&&strLength<length?createPadding(length-strLength,chars)+string:string},lodash.parseInt=function(string,radix,guard){return guard||null==radix?radix=0:radix&&(radix=+radix),nativeParseInt(toString(string).replace(reTrimStart,""),radix||0)},lodash.random=function(lower,upper,floating){if(floating&&"boolean"!=typeof floating&&isIterateeCall(lower,upper,floating)&&(upper=floating=void 0),void 0===floating&&("boolean"==typeof upper?(floating=upper,upper=void 0):"boolean"==typeof lower&&(floating=lower,lower=void 0)),void 0===lower&&void 0===upper?(lower=0,upper=1):(lower=toFinite(lower),void 0===upper?(upper=lower,lower=0):upper=toFinite(upper)),lower>upper){var temp=lower;lower=upper,upper=temp}if(floating||lower%1||upper%1){var rand=nativeRandom();return nativeMin(lower+rand*(upper-lower+freeParseFloat("1e-"+((rand+"").length-1))),upper)}return baseRandom(lower,upper)},lodash.reduce=function(collection,iteratee,accumulator){var func=isArray(collection)?arrayReduce:baseReduce,initAccum=arguments.length<3;return func(collection,getIteratee(iteratee,4),accumulator,initAccum,baseEach)},lodash.reduceRight=function(collection,iteratee,accumulator){var func=isArray(collection)?arrayReduceRight:baseReduce,initAccum=arguments.length<3;return func(collection,getIteratee(iteratee,4),accumulator,initAccum,baseEachRight)},lodash.repeat=function(string,n,guard){return n=(guard?isIterateeCall(string,n,guard):void 0===n)?1:toInteger(n),baseRepeat(toString(string),n)},lodash.replace=function(){var args=arguments,string=toString(args[0]);return args.length<3?string:string.replace(args[1],args[2])},lodash.result=function(object,path,defaultValue){var index=-1,length=(path=castPath(path,object)).length;for(length||(length=1,object=void 0);++index<length;){var value=null==object?void 0:object[toKey(path[index])];void 0===value&&(index=length,value=defaultValue),object=isFunction(value)?value.call(object):value}return object},lodash.round=round,lodash.runInContext=runInContext,lodash.sample=function(collection){return(isArray(collection)?arraySample:baseSample)(collection)},lodash.size=function(collection){if(null==collection)return 0;if(isArrayLike(collection))return isString(collection)?stringSize(collection):collection.length;var tag=getTag(collection);return tag==mapTag||tag==setTag?collection.size:baseKeys(collection).length},lodash.snakeCase=snakeCase,lodash.some=function(collection,predicate,guard){var func=isArray(collection)?arraySome:baseSome;return guard&&isIterateeCall(collection,predicate,guard)&&(predicate=void 0),func(collection,getIteratee(predicate,3))},lodash.sortedIndex=function(array,value){return baseSortedIndex(array,value)},lodash.sortedIndexBy=function(array,value,iteratee){return baseSortedIndexBy(array,value,getIteratee(iteratee,2))},lodash.sortedIndexOf=function(array,value){var length=null==array?0:array.length;if(length){var index=baseSortedIndex(array,value);if(index<length&&eq(array[index],value))return index}return-1},lodash.sortedLastIndex=function(array,value){return baseSortedIndex(array,value,!0)},lodash.sortedLastIndexBy=function(array,value,iteratee){return baseSortedIndexBy(array,value,getIteratee(iteratee,2),!0)},lodash.sortedLastIndexOf=function(array,value){if(null!=array&&array.length){var index=baseSortedIndex(array,value,!0)-1;if(eq(array[index],value))return index}return-1},lodash.startCase=startCase,lodash.startsWith=function(string,target,position){return string=toString(string),position=null==position?0:baseClamp(toInteger(position),0,string.length),target=baseToString(target),string.slice(position,position+target.length)==target},lodash.subtract=subtract,lodash.sum=function(array){return array&&array.length?baseSum(array,identity):0},lodash.sumBy=function(array,iteratee){return array&&array.length?baseSum(array,getIteratee(iteratee,2)):0},lodash.template=function(string,options,guard){var settings=lodash.templateSettings;guard&&isIterateeCall(string,options,guard)&&(options=void 0),string=toString(string),options=assignInWith({},options,settings,customDefaultsAssignIn);var isEscaping,isEvaluating,imports=assignInWith({},options.imports,settings.imports,customDefaultsAssignIn),importsKeys=keys(imports),importsValues=baseValues(imports,importsKeys),index=0,interpolate=options.interpolate||reNoMatch,source="__p += '",reDelimiters=RegExp((options.escape||reNoMatch).source+"|"+interpolate.source+"|"+(interpolate===reInterpolate?reEsTemplate:reNoMatch).source+"|"+(options.evaluate||reNoMatch).source+"|$","g"),sourceURL="//# sourceURL="+(hasOwnProperty.call(options,"sourceURL")?(options.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++templateCounter+"]")+"\n";string.replace(reDelimiters,function(match,escapeValue,interpolateValue,esTemplateValue,evaluateValue,offset){return interpolateValue||(interpolateValue=esTemplateValue),source+=string.slice(index,offset).replace(reUnescapedString,escapeStringChar),escapeValue&&(isEscaping=!0,source+="' +\n__e("+escapeValue+") +\n'"),evaluateValue&&(isEvaluating=!0,source+="';\n"+evaluateValue+";\n__p += '"),interpolateValue&&(source+="' +\n((__t = ("+interpolateValue+")) == null ? '' : __t) +\n'"),index=offset+match.length,match}),source+="';\n";var variable=hasOwnProperty.call(options,"variable")&&options.variable;if(variable){if(reForbiddenIdentifierChars.test(variable))throw new Error("Invalid `variable` option passed into `_.template`")}else source="with (obj) {\n"+source+"\n}\n";source=(isEvaluating?source.replace(reEmptyStringLeading,""):source).replace(reEmptyStringMiddle,"$1").replace(reEmptyStringTrailing,"$1;"),source="function("+(variable||"obj")+") {\n"+(variable?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(isEscaping?", __e = _.escape":"")+(isEvaluating?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+source+"return __p\n}";var result=attempt(function(){return Function(importsKeys,sourceURL+"return "+source).apply(void 0,importsValues)});if(result.source=source,isError(result))throw result;return result},lodash.times=function(n,iteratee){if((n=toInteger(n))<1||n>9007199254740991)return[];var index=4294967295,length=nativeMin(n,4294967295);n-=4294967295;for(var result=baseTimes(length,iteratee=getIteratee(iteratee));++index<n;)iteratee(index);return result},lodash.toFinite=toFinite,lodash.toInteger=toInteger,lodash.toLength=toLength,lodash.toLower=function(value){return toString(value).toLowerCase()},lodash.toNumber=toNumber,lodash.toSafeInteger=function(value){return value?baseClamp(toInteger(value),-9007199254740991,9007199254740991):0===value?value:0},lodash.toString=toString,lodash.toUpper=function(value){return toString(value).toUpperCase()},lodash.trim=function(string,chars,guard){if((string=toString(string))&&(guard||void 0===chars))return baseTrim(string);if(!string||!(chars=baseToString(chars)))return string;var strSymbols=stringToArray(string),chrSymbols=stringToArray(chars);return castSlice(strSymbols,charsStartIndex(strSymbols,chrSymbols),charsEndIndex(strSymbols,chrSymbols)+1).join("")},lodash.trimEnd=function(string,chars,guard){if((string=toString(string))&&(guard||void 0===chars))return string.slice(0,trimmedEndIndex(string)+1);if(!string||!(chars=baseToString(chars)))return string;var strSymbols=stringToArray(string);return castSlice(strSymbols,0,charsEndIndex(strSymbols,stringToArray(chars))+1).join("")},lodash.trimStart=function(string,chars,guard){if((string=toString(string))&&(guard||void 0===chars))return string.replace(reTrimStart,"");if(!string||!(chars=baseToString(chars)))return string;var strSymbols=stringToArray(string);return castSlice(strSymbols,charsStartIndex(strSymbols,stringToArray(chars))).join("")},lodash.truncate=function(string,options){var length=30,omission="...";if(isObject(options)){var separator="separator"in options?options.separator:separator;length="length"in options?toInteger(options.length):length,omission="omission"in options?baseToString(options.omission):omission}var strLength=(string=toString(string)).length;if(hasUnicode(string)){var strSymbols=stringToArray(string);strLength=strSymbols.length}if(length>=strLength)return string;var end=length-stringSize(omission);if(end<1)return omission;var result=strSymbols?castSlice(strSymbols,0,end).join(""):string.slice(0,end);if(void 0===separator)return result+omission;if(strSymbols&&(end+=result.length-end),isRegExp(separator)){if(string.slice(end).search(separator)){var match,substring=result;for(separator.global||(separator=RegExp(separator.source,toString(reFlags.exec(separator))+"g")),separator.lastIndex=0;match=separator.exec(substring);)var newEnd=match.index;result=result.slice(0,void 0===newEnd?end:newEnd)}}else if(string.indexOf(baseToString(separator),end)!=end){var index=result.lastIndexOf(separator);index>-1&&(result=result.slice(0,index))}return result+omission},lodash.unescape=function(string){return(string=toString(string))&&reHasEscapedHtml.test(string)?string.replace(reEscapedHtml,unescapeHtmlChar):string},lodash.uniqueId=function(prefix){var id=++idCounter;return toString(prefix)+id},lodash.upperCase=upperCase,lodash.upperFirst=upperFirst,lodash.each=forEach,lodash.eachRight=forEachRight,lodash.first=head,mixin(lodash,(source={},baseForOwn(lodash,function(func,methodName){hasOwnProperty.call(lodash.prototype,methodName)||(source[methodName]=func)}),source),{chain:!1}),lodash.VERSION="4.17.21",arrayEach(["bind","bindKey","curry","curryRight","partial","partialRight"],function(methodName){lodash[methodName].placeholder=lodash}),arrayEach(["drop","take"],function(methodName,index){LazyWrapper.prototype[methodName]=function(n){n=void 0===n?1:nativeMax(toInteger(n),0);var result=this.__filtered__&&!index?new LazyWrapper(this):this.clone();return result.__filtered__?result.__takeCount__=nativeMin(n,result.__takeCount__):result.__views__.push({size:nativeMin(n,4294967295),type:methodName+(result.__dir__<0?"Right":"")}),result},LazyWrapper.prototype[methodName+"Right"]=function(n){return this.reverse()[methodName](n).reverse()}}),arrayEach(["filter","map","takeWhile"],function(methodName,index){var type=index+1,isFilter=1==type||3==type;LazyWrapper.prototype[methodName]=function(iteratee){var result=this.clone();return result.__iteratees__.push({iteratee:getIteratee(iteratee,3),type:type}),result.__filtered__=result.__filtered__||isFilter,result}}),arrayEach(["head","last"],function(methodName,index){var takeName="take"+(index?"Right":"");LazyWrapper.prototype[methodName]=function(){return this[takeName](1).value()[0]}}),arrayEach(["initial","tail"],function(methodName,index){var dropName="drop"+(index?"":"Right");LazyWrapper.prototype[methodName]=function(){return this.__filtered__?new LazyWrapper(this):this[dropName](1)}}),LazyWrapper.prototype.compact=function(){return this.filter(identity)},LazyWrapper.prototype.find=function(predicate){return this.filter(predicate).head()},LazyWrapper.prototype.findLast=function(predicate){return this.reverse().find(predicate)},LazyWrapper.prototype.invokeMap=baseRest(function(path,args){return"function"==typeof path?new LazyWrapper(this):this.map(function(value){return baseInvoke(value,path,args)})}),LazyWrapper.prototype.reject=function(predicate){return this.filter(negate(getIteratee(predicate)))},LazyWrapper.prototype.slice=function(start,end){start=toInteger(start);var result=this;return result.__filtered__&&(start>0||end<0)?new LazyWrapper(result):(start<0?result=result.takeRight(-start):start&&(result=result.drop(start)),void 0!==end&&(result=(end=toInteger(end))<0?result.dropRight(-end):result.take(end-start)),result)},LazyWrapper.prototype.takeRightWhile=function(predicate){return this.reverse().takeWhile(predicate).reverse()},LazyWrapper.prototype.toArray=function(){return this.take(4294967295)},baseForOwn(LazyWrapper.prototype,function(func,methodName){var checkIteratee=/^(?:filter|find|map|reject)|While$/.test(methodName),isTaker=/^(?:head|last)$/.test(methodName),lodashFunc=lodash[isTaker?"take"+("last"==methodName?"Right":""):methodName],retUnwrapped=isTaker||/^find/.test(methodName);lodashFunc&&(lodash.prototype[methodName]=function(){var value=this.__wrapped__,args=isTaker?[1]:arguments,isLazy=value instanceof LazyWrapper,iteratee=args[0],useLazy=isLazy||isArray(value),interceptor=function(value){var result=lodashFunc.apply(lodash,arrayPush([value],args));return isTaker&&chainAll?result[0]:result};useLazy&&checkIteratee&&"function"==typeof iteratee&&1!=iteratee.length&&(isLazy=useLazy=!1);var chainAll=this.__chain__,isHybrid=!!this.__actions__.length,isUnwrapped=retUnwrapped&&!chainAll,onlyLazy=isLazy&&!isHybrid;if(!retUnwrapped&&useLazy){value=onlyLazy?value:new LazyWrapper(this);var result=func.apply(value,args);return result.__actions__.push({func:thru,args:[interceptor],thisArg:void 0}),new LodashWrapper(result,chainAll)}return isUnwrapped&&onlyLazy?func.apply(this,args):(result=this.thru(interceptor),isUnwrapped?isTaker?result.value()[0]:result.value():result)})}),arrayEach(["pop","push","shift","sort","splice","unshift"],function(methodName){var func=arrayProto[methodName],chainName=/^(?:push|sort|unshift)$/.test(methodName)?"tap":"thru",retUnwrapped=/^(?:pop|shift)$/.test(methodName);lodash.prototype[methodName]=function(){var args=arguments;if(retUnwrapped&&!this.__chain__){var value=this.value();return func.apply(isArray(value)?value:[],args)}return this[chainName](function(value){return func.apply(isArray(value)?value:[],args)})}}),baseForOwn(LazyWrapper.prototype,function(func,methodName){var lodashFunc=lodash[methodName];if(lodashFunc){var key=lodashFunc.name+"";hasOwnProperty.call(realNames,key)||(realNames[key]=[]),realNames[key].push({name:methodName,func:lodashFunc})}}),realNames[createHybrid(void 0,2).name]=[{name:"wrapper",func:void 0}],LazyWrapper.prototype.clone=function(){var result=new LazyWrapper(this.__wrapped__);return result.__actions__=copyArray(this.__actions__),result.__dir__=this.__dir__,result.__filtered__=this.__filtered__,result.__iteratees__=copyArray(this.__iteratees__),result.__takeCount__=this.__takeCount__,result.__views__=copyArray(this.__views__),result},LazyWrapper.prototype.reverse=function(){if(this.__filtered__){var result=new LazyWrapper(this);result.__dir__=-1,result.__filtered__=!0}else(result=this.clone()).__dir__*=-1;return result},LazyWrapper.prototype.value=function(){var array=this.__wrapped__.value(),dir=this.__dir__,isArr=isArray(array),isRight=dir<0,arrLength=isArr?array.length:0,view=function(start,end,transforms){for(var index=-1,length=transforms.length;++index<length;){var data=transforms[index],size=data.size;switch(data.type){case"drop":start+=size;break;case"dropRight":end-=size;break;case"take":end=nativeMin(end,start+size);break;case"takeRight":start=nativeMax(start,end-size)}}return{start:start,end:end}}(0,arrLength,this.__views__),start=view.start,end=view.end,length=end-start,index=isRight?end:start-1,iteratees=this.__iteratees__,iterLength=iteratees.length,resIndex=0,takeCount=nativeMin(length,this.__takeCount__);if(!isArr||!isRight&&arrLength==length&&takeCount==length)return baseWrapperValue(array,this.__actions__);var result=[];outer:for(;length--&&resIndex<takeCount;){for(var iterIndex=-1,value=array[index+=dir];++iterIndex<iterLength;){var data=iteratees[iterIndex],type=data.type,computed=(0,data.iteratee)(value);if(2==type)value=computed;else if(!computed){if(1==type)continue outer;break outer}}result[resIndex++]=value}return result},lodash.prototype.at=wrapperAt,lodash.prototype.chain=function(){return chain(this)},lodash.prototype.commit=function(){return new LodashWrapper(this.value(),this.__chain__)},lodash.prototype.next=function(){void 0===this.__values__&&(this.__values__=toArray(this.value()));var done=this.__index__>=this.__values__.length;return{done:done,value:done?void 0:this.__values__[this.__index__++]}},lodash.prototype.plant=function(value){for(var result,parent=this;parent instanceof baseLodash;){var clone=wrapperClone(parent);clone.__index__=0,clone.__values__=void 0,result?previous.__wrapped__=clone:result=clone;var previous=clone;parent=parent.__wrapped__}return previous.__wrapped__=value,result},lodash.prototype.reverse=function(){var value=this.__wrapped__;if(value instanceof LazyWrapper){var wrapped=value;return this.__actions__.length&&(wrapped=new LazyWrapper(this)),(wrapped=wrapped.reverse()).__actions__.push({func:thru,args:[reverse],thisArg:void 0}),new LodashWrapper(wrapped,this.__chain__)}return this.thru(reverse)},lodash.prototype.toJSON=lodash.prototype.valueOf=lodash.prototype.value=function(){return baseWrapperValue(this.__wrapped__,this.__actions__)},lodash.prototype.first=lodash.prototype.head,symIterator&&(lodash.prototype[symIterator]=function(){return this}),lodash}();root._=_,void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(){return _}.call(exports,__webpack_require__,exports,module))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}.call(this)},33317:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var _classCallCheck=__webpack_require__(75725).default,_createClass=__webpack_require__(73560).default,_assertThisInitialized=__webpack_require__(48582).default,_inherits=__webpack_require__(71556).default,_createSuper=__webpack_require__(47934).default,base64=__webpack_require__(66193),ieee754=__webpack_require__(51208),customInspectSymbol="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function createBuffer(length){if(length>2147483647)throw new RangeError('The value "'+length+'" is invalid for option "size"');var buf=new Uint8Array(length);return Object.setPrototypeOf(buf,Buffer.prototype),buf}function Buffer(arg,encodingOrOffset,length){if("number"==typeof arg){if("string"==typeof encodingOrOffset)throw new TypeError('The "string" argument must be of type string. Received type number');return allocUnsafe(arg)}return from(arg,encodingOrOffset,length)}function from(value,encodingOrOffset,length){if("string"==typeof value)return function(string,encoding){if("string"==typeof encoding&&""!==encoding||(encoding="utf8"),!Buffer.isEncoding(encoding))throw new TypeError("Unknown encoding: "+encoding);var length=0|byteLength(string,encoding),buf=createBuffer(length),actual=buf.write(string,encoding);return actual!==length&&(buf=buf.slice(0,actual)),buf}(value,encodingOrOffset);if(ArrayBuffer.isView(value))return function(arrayView){if(isInstance(arrayView,Uint8Array)){var copy=new Uint8Array(arrayView);return fromArrayBuffer(copy.buffer,copy.byteOffset,copy.byteLength)}return fromArrayLike(arrayView)}(value);if(null==value)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof value);if(isInstance(value,ArrayBuffer)||value&&isInstance(value.buffer,ArrayBuffer))return fromArrayBuffer(value,encodingOrOffset,length);if("undefined"!=typeof SharedArrayBuffer&&(isInstance(value,SharedArrayBuffer)||value&&isInstance(value.buffer,SharedArrayBuffer)))return fromArrayBuffer(value,encodingOrOffset,length);if("number"==typeof value)throw new TypeError('The "value" argument must not be of type number. Received type number');var valueOf=value.valueOf&&value.valueOf();if(null!=valueOf&&valueOf!==value)return Buffer.from(valueOf,encodingOrOffset,length);var b=function(obj){if(Buffer.isBuffer(obj)){var len=0|checked(obj.length),buf=createBuffer(len);return 0===buf.length||obj.copy(buf,0,0,len),buf}return void 0!==obj.length?"number"!=typeof obj.length||numberIsNaN(obj.length)?createBuffer(0):fromArrayLike(obj):"Buffer"===obj.type&&Array.isArray(obj.data)?fromArrayLike(obj.data):void 0}(value);if(b)return b;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof value[Symbol.toPrimitive])return Buffer.from(value[Symbol.toPrimitive]("string"),encodingOrOffset,length);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof value)}function assertSize(size){if("number"!=typeof size)throw new TypeError('"size" argument must be of type number');if(size<0)throw new RangeError('The value "'+size+'" is invalid for option "size"')}function allocUnsafe(size){return assertSize(size),createBuffer(size<0?0:0|checked(size))}function fromArrayLike(array){for(var length=array.length<0?0:0|checked(array.length),buf=createBuffer(length),i=0;i<length;i+=1)buf[i]=255&array[i];return buf}function fromArrayBuffer(array,byteOffset,length){if(byteOffset<0||array.byteLength<byteOffset)throw new RangeError('"offset" is outside of buffer bounds');if(array.byteLength<byteOffset+(length||0))throw new RangeError('"length" is outside of buffer bounds');var buf;return buf=void 0===byteOffset&&void 0===length?new Uint8Array(array):void 0===length?new Uint8Array(array,byteOffset):new Uint8Array(array,byteOffset,length),Object.setPrototypeOf(buf,Buffer.prototype),buf}function checked(length){if(length>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|length}function byteLength(string,encoding){if(Buffer.isBuffer(string))return string.length;if(ArrayBuffer.isView(string)||isInstance(string,ArrayBuffer))return string.byteLength;if("string"!=typeof string)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof string);var len=string.length,mustMatch=arguments.length>2&&!0===arguments[2];if(!mustMatch&&0===len)return 0;for(var loweredCase=!1;;)switch(encoding){case"ascii":case"latin1":case"binary":return len;case"utf8":case"utf-8":return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*len;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase)return mustMatch?-1:utf8ToBytes(string).length;encoding=(""+encoding).toLowerCase(),loweredCase=!0}}function slowToString(encoding,start,end){var loweredCase=!1;if((void 0===start||start<0)&&(start=0),start>this.length)return"";if((void 0===end||end>this.length)&&(end=this.length),end<=0)return"";if((end>>>=0)<=(start>>>=0))return"";for(encoding||(encoding="utf8");;)switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"latin1":case"binary":return latin1Slice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase(),loweredCase=!0}}function swap(b,n,m){var i=b[n];b[n]=b[m],b[m]=i}function bidirectionalIndexOf(buffer,val,byteOffset,encoding,dir){if(0===buffer.length)return-1;if("string"==typeof byteOffset?(encoding=byteOffset,byteOffset=0):byteOffset>2147483647?byteOffset=2147483647:byteOffset<-2147483648&&(byteOffset=-2147483648),numberIsNaN(byteOffset=+byteOffset)&&(byteOffset=dir?0:buffer.length-1),byteOffset<0&&(byteOffset=buffer.length+byteOffset),byteOffset>=buffer.length){if(dir)return-1;byteOffset=buffer.length-1}else if(byteOffset<0){if(!dir)return-1;byteOffset=0}if("string"==typeof val&&(val=Buffer.from(val,encoding)),Buffer.isBuffer(val))return 0===val.length?-1:arrayIndexOf(buffer,val,byteOffset,encoding,dir);if("number"==typeof val)return val&=255,"function"==typeof Uint8Array.prototype.indexOf?dir?Uint8Array.prototype.indexOf.call(buffer,val,byteOffset):Uint8Array.prototype.lastIndexOf.call(buffer,val,byteOffset):arrayIndexOf(buffer,[val],byteOffset,encoding,dir);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(arr,val,byteOffset,encoding,dir){var i,indexSize=1,arrLength=arr.length,valLength=val.length;if(void 0!==encoding&&("ucs2"===(encoding=String(encoding).toLowerCase())||"ucs-2"===encoding||"utf16le"===encoding||"utf-16le"===encoding)){if(arr.length<2||val.length<2)return-1;indexSize=2,arrLength/=2,valLength/=2,byteOffset/=2}function read(buf,i){return 1===indexSize?buf[i]:buf.readUInt16BE(i*indexSize)}if(dir){var foundIndex=-1;for(i=byteOffset;i<arrLength;i++)if(read(arr,i)===read(val,-1===foundIndex?0:i-foundIndex)){if(-1===foundIndex&&(foundIndex=i),i-foundIndex+1===valLength)return foundIndex*indexSize}else-1!==foundIndex&&(i-=i-foundIndex),foundIndex=-1}else for(byteOffset+valLength>arrLength&&(byteOffset=arrLength-valLength),i=byteOffset;i>=0;i--){for(var found=!0,j=0;j<valLength;j++)if(read(arr,i+j)!==read(val,j)){found=!1;break}if(found)return i}return-1}function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;length?(length=Number(length))>remaining&&(length=remaining):length=remaining;var i,strLen=string.length;for(length>strLen/2&&(length=strLen/2),i=0;i<length;++i){var parsed=parseInt(string.substr(2*i,2),16);if(numberIsNaN(parsed))return i;buf[offset+i]=parsed}return i}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(function(str){for(var byteArray=[],i=0;i<str.length;++i)byteArray.push(255&str.charCodeAt(i));return byteArray}(string),buf,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(function(str,units){for(var c,hi,byteArray=[],i=0;i<str.length&&!((units-=2)<0);++i)hi=(c=str.charCodeAt(i))>>8,byteArray.push(c%256),byteArray.push(hi);return byteArray}(string,buf.length-offset),buf,offset,length)}function base64Slice(buf,start,end){return base64.fromByteArray(0===start&&end===buf.length?buf:buf.slice(start,end))}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);for(var res=[],i=start;i<end;){var firstByte=buf[i],codePoint=null,bytesPerSequence=firstByte>239?4:firstByte>223?3:firstByte>191?2:1;if(i+bytesPerSequence<=end){var secondByte=void 0,thirdByte=void 0,fourthByte=void 0,tempCodePoint=void 0;switch(bytesPerSequence){case 1:firstByte<128&&(codePoint=firstByte);break;case 2:128==(192&(secondByte=buf[i+1]))&&(tempCodePoint=(31&firstByte)<<6|63&secondByte)>127&&(codePoint=tempCodePoint);break;case 3:thirdByte=buf[i+2],128==(192&(secondByte=buf[i+1]))&&128==(192&thirdByte)&&(tempCodePoint=(15&firstByte)<<12|(63&secondByte)<<6|63&thirdByte)>2047&&(tempCodePoint<55296||tempCodePoint>57343)&&(codePoint=tempCodePoint);break;case 4:thirdByte=buf[i+2],fourthByte=buf[i+3],128==(192&(secondByte=buf[i+1]))&&128==(192&thirdByte)&&128==(192&fourthByte)&&(tempCodePoint=(15&firstByte)<<18|(63&secondByte)<<12|(63&thirdByte)<<6|63&fourthByte)>65535&&tempCodePoint<1114112&&(codePoint=tempCodePoint)}}null===codePoint?(codePoint=65533,bytesPerSequence=1):codePoint>65535&&(res.push((codePoint-=65536)>>>10&1023|55296),codePoint=56320|1023&codePoint),res.push(codePoint),i+=bytesPerSequence}return function(codePoints){var len=codePoints.length;if(len<=4096)return String.fromCharCode.apply(String,codePoints);for(var res="",i=0;i<len;)res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=4096));return res}(res)}function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(127&buf[i]);return ret}function latin1Slice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(buf[i]);return ret}function hexSlice(buf,start,end){var len=buf.length;(!start||start<0)&&(start=0),(!end||end<0||end>len)&&(end=len);for(var out="",i=start;i<end;++i)out+=hexSliceLookupTable[buf[i]];return out}function utf16leSlice(buf,start,end){for(var bytes=buf.slice(start,end),res="",i=0;i<bytes.length-1;i+=2)res+=String.fromCharCode(bytes[i]+256*bytes[i+1]);return res}function checkOffset(offset,ext,length){if(offset%1!=0||offset<0)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError('"buffer" argument must be a Buffer instance');if(value>max||value<min)throw new RangeError('"value" argument is out of bounds');if(offset+ext>buf.length)throw new RangeError("Index out of range")}function wrtBigUInt64LE(buf,value,offset,min,max){checkIntBI(value,min,max,buf,offset,7);var lo=Number(value&BigInt(4294967295));buf[offset++]=lo,buf[offset++]=lo>>=8,buf[offset++]=lo>>=8,buf[offset++]=lo>>=8;var hi=Number(value>>BigInt(32)&BigInt(4294967295));return buf[offset++]=hi,buf[offset++]=hi>>=8,buf[offset++]=hi>>=8,buf[offset++]=hi>>=8,offset}function wrtBigUInt64BE(buf,value,offset,min,max){checkIntBI(value,min,max,buf,offset,7);var lo=Number(value&BigInt(4294967295));buf[offset+7]=lo,buf[offset+6]=lo>>=8,buf[offset+5]=lo>>=8,buf[offset+4]=lo>>=8;var hi=Number(value>>BigInt(32)&BigInt(4294967295));return buf[offset+3]=hi,buf[offset+2]=hi>>=8,buf[offset+1]=hi>>=8,buf[offset]=hi>>=8,offset+8}function checkIEEE754(buf,value,offset,ext,max,min){if(offset+ext>buf.length)throw new RangeError("Index out of range");if(offset<0)throw new RangeError("Index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){return value=+value,offset>>>=0,noAssert||checkIEEE754(buf,0,offset,4),ieee754.write(buf,value,offset,littleEndian,23,4),offset+4}function writeDouble(buf,value,offset,littleEndian,noAssert){return value=+value,offset>>>=0,noAssert||checkIEEE754(buf,0,offset,8),ieee754.write(buf,value,offset,littleEndian,52,8),offset+8}exports.Buffer=Buffer,exports.SlowBuffer=function(length){return+length!=length&&(length=0),Buffer.alloc(+length)},exports.INSPECT_MAX_BYTES=50,exports.kMaxLength=2147483647,(Buffer.TYPED_ARRAY_SUPPORT=function(){try{var arr=new Uint8Array(1),proto={foo:function(){return 42}};return Object.setPrototypeOf(proto,Uint8Array.prototype),Object.setPrototypeOf(arr,proto),42===arr.foo()}catch(e){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(Buffer.prototype,"parent",{enumerable:!0,get:function(){if(Buffer.isBuffer(this))return this.buffer}}),Object.defineProperty(Buffer.prototype,"offset",{enumerable:!0,get:function(){if(Buffer.isBuffer(this))return this.byteOffset}}),Buffer.poolSize=8192,Buffer.from=function(value,encodingOrOffset,length){return from(value,encodingOrOffset,length)},Object.setPrototypeOf(Buffer.prototype,Uint8Array.prototype),Object.setPrototypeOf(Buffer,Uint8Array),Buffer.alloc=function(size,fill,encoding){return function(size,fill,encoding){return assertSize(size),size<=0?createBuffer(size):void 0!==fill?"string"==typeof encoding?createBuffer(size).fill(fill,encoding):createBuffer(size).fill(fill):createBuffer(size)}(size,fill,encoding)},Buffer.allocUnsafe=function(size){return allocUnsafe(size)},Buffer.allocUnsafeSlow=function(size){return allocUnsafe(size)},Buffer.isBuffer=function(b){return null!=b&&!0===b._isBuffer&&b!==Buffer.prototype},Buffer.compare=function(a,b){if(isInstance(a,Uint8Array)&&(a=Buffer.from(a,a.offset,a.byteLength)),isInstance(b,Uint8Array)&&(b=Buffer.from(b,b.offset,b.byteLength)),!Buffer.isBuffer(a)||!Buffer.isBuffer(b))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(a===b)return 0;for(var x=a.length,y=b.length,i=0,len=Math.min(x,y);i<len;++i)if(a[i]!==b[i]){x=a[i],y=b[i];break}return x<y?-1:y<x?1:0},Buffer.isEncoding=function(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(list,length){if(!Array.isArray(list))throw new TypeError('"list" argument must be an Array of Buffers');if(0===list.length)return Buffer.alloc(0);var i;if(void 0===length)for(length=0,i=0;i<list.length;++i)length+=list[i].length;var buffer=Buffer.allocUnsafe(length),pos=0;for(i=0;i<list.length;++i){var buf=list[i];if(isInstance(buf,Uint8Array))pos+buf.length>buffer.length?(Buffer.isBuffer(buf)||(buf=Buffer.from(buf)),buf.copy(buffer,pos)):Uint8Array.prototype.set.call(buffer,buf,pos);else{if(!Buffer.isBuffer(buf))throw new TypeError('"list" argument must be an Array of Buffers');buf.copy(buffer,pos)}pos+=buf.length}return buffer},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var len=this.length;if(len%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var i=0;i<len;i+=2)swap(this,i,i+1);return this},Buffer.prototype.swap32=function(){var len=this.length;if(len%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var i=0;i<len;i+=4)swap(this,i,i+3),swap(this,i+1,i+2);return this},Buffer.prototype.swap64=function(){var len=this.length;if(len%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var i=0;i<len;i+=8)swap(this,i,i+7),swap(this,i+1,i+6),swap(this,i+2,i+5),swap(this,i+3,i+4);return this},Buffer.prototype.toLocaleString=Buffer.prototype.toString=function(){var length=this.length;return 0===length?"":0===arguments.length?utf8Slice(this,0,length):slowToString.apply(this,arguments)},Buffer.prototype.equals=function(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b||0===Buffer.compare(this,b)},Buffer.prototype.inspect=function(){var str="",max=exports.INSPECT_MAX_BYTES;return str=this.toString("hex",0,max).replace(/(.{2})/g,"$1 ").trim(),this.length>max&&(str+=" ... "),"<Buffer "+str+">"},customInspectSymbol&&(Buffer.prototype[customInspectSymbol]=Buffer.prototype.inspect),Buffer.prototype.compare=function(target,start,end,thisStart,thisEnd){if(isInstance(target,Uint8Array)&&(target=Buffer.from(target,target.offset,target.byteLength)),!Buffer.isBuffer(target))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof target);if(void 0===start&&(start=0),void 0===end&&(end=target?target.length:0),void 0===thisStart&&(thisStart=0),void 0===thisEnd&&(thisEnd=this.length),start<0||end>target.length||thisStart<0||thisEnd>this.length)throw new RangeError("out of range index");if(thisStart>=thisEnd&&start>=end)return 0;if(thisStart>=thisEnd)return-1;if(start>=end)return 1;if(this===target)return 0;for(var x=(thisEnd>>>=0)-(thisStart>>>=0),y=(end>>>=0)-(start>>>=0),len=Math.min(x,y),thisCopy=this.slice(thisStart,thisEnd),targetCopy=target.slice(start,end),i=0;i<len;++i)if(thisCopy[i]!==targetCopy[i]){x=thisCopy[i],y=targetCopy[i];break}return x<y?-1:y<x?1:0},Buffer.prototype.includes=function(val,byteOffset,encoding){return-1!==this.indexOf(val,byteOffset,encoding)},Buffer.prototype.indexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!0)},Buffer.prototype.lastIndexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!1)},Buffer.prototype.write=function(string,offset,length,encoding){if(void 0===offset)encoding="utf8",length=this.length,offset=0;else if(void 0===length&&"string"==typeof offset)encoding=offset,length=this.length,offset=0;else{if(!isFinite(offset))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");offset>>>=0,isFinite(length)?(length>>>=0,void 0===encoding&&(encoding="utf8")):(encoding=length,length=void 0)}var remaining=this.length-offset;if((void 0===length||length>remaining)&&(length=remaining),string.length>0&&(length<0||offset<0)||offset>this.length)throw new RangeError("Attempt to write outside buffer bounds");encoding||(encoding="utf8");for(var loweredCase=!1;;)switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":case"latin1":case"binary":return asciiWrite(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase(),loweredCase=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},Buffer.prototype.slice=function(start,end){var len=this.length;(start=~~start)<0?(start+=len)<0&&(start=0):start>len&&(start=len),(end=void 0===end?len:~~end)<0?(end+=len)<0&&(end=0):end>len&&(end=len),end<start&&(end=start);var newBuf=this.subarray(start,end);return Object.setPrototypeOf(newBuf,Buffer.prototype),newBuf},Buffer.prototype.readUintLE=Buffer.prototype.readUIntLE=function(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return val},Buffer.prototype.readUintBE=Buffer.prototype.readUIntBE=function(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset+--byteLength],mul=1;byteLength>0&&(mul*=256);)val+=this[offset+--byteLength]*mul;return val},Buffer.prototype.readUint8=Buffer.prototype.readUInt8=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,1,this.length),this[offset]},Buffer.prototype.readUint16LE=Buffer.prototype.readUInt16LE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,2,this.length),this[offset]|this[offset+1]<<8},Buffer.prototype.readUint16BE=Buffer.prototype.readUInt16BE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,2,this.length),this[offset]<<8|this[offset+1]},Buffer.prototype.readUint32LE=Buffer.prototype.readUInt32LE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+16777216*this[offset+3]},Buffer.prototype.readUint32BE=Buffer.prototype.readUInt32BE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),16777216*this[offset]+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])},Buffer.prototype.readBigUInt64LE=defineBigIntMethod(function(offset){validateNumber(offset>>>=0,"offset");var first=this[offset],last=this[offset+7];void 0!==first&&void 0!==last||boundsError(offset,this.length-8);var lo=first+this[++offset]*Math.pow(2,8)+this[++offset]*Math.pow(2,16)+this[++offset]*Math.pow(2,24),hi=this[++offset]+this[++offset]*Math.pow(2,8)+this[++offset]*Math.pow(2,16)+last*Math.pow(2,24);return BigInt(lo)+(BigInt(hi)<<BigInt(32))}),Buffer.prototype.readBigUInt64BE=defineBigIntMethod(function(offset){validateNumber(offset>>>=0,"offset");var first=this[offset],last=this[offset+7];void 0!==first&&void 0!==last||boundsError(offset,this.length-8);var hi=first*Math.pow(2,24)+this[++offset]*Math.pow(2,16)+this[++offset]*Math.pow(2,8)+this[++offset],lo=this[++offset]*Math.pow(2,24)+this[++offset]*Math.pow(2,16)+this[++offset]*Math.pow(2,8)+last;return(BigInt(hi)<<BigInt(32))+BigInt(lo)}),Buffer.prototype.readIntLE=function(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return val>=(mul*=128)&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readIntBE=function(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var i=byteLength,mul=1,val=this[offset+--i];i>0&&(mul*=256);)val+=this[offset+--i]*mul;return val>=(mul*=128)&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readInt8=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,1,this.length),128&this[offset]?-1*(255-this[offset]+1):this[offset]},Buffer.prototype.readInt16LE=function(offset,noAssert){offset>>>=0,noAssert||checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt16BE=function(offset,noAssert){offset>>>=0,noAssert||checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt32LE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24},Buffer.prototype.readInt32BE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]},Buffer.prototype.readBigInt64LE=defineBigIntMethod(function(offset){validateNumber(offset>>>=0,"offset");var first=this[offset],last=this[offset+7];void 0!==first&&void 0!==last||boundsError(offset,this.length-8);var val=this[offset+4]+this[offset+5]*Math.pow(2,8)+this[offset+6]*Math.pow(2,16)+(last<<24);return(BigInt(val)<<BigInt(32))+BigInt(first+this[++offset]*Math.pow(2,8)+this[++offset]*Math.pow(2,16)+this[++offset]*Math.pow(2,24))}),Buffer.prototype.readBigInt64BE=defineBigIntMethod(function(offset){validateNumber(offset>>>=0,"offset");var first=this[offset],last=this[offset+7];void 0!==first&&void 0!==last||boundsError(offset,this.length-8);var val=(first<<24)+this[++offset]*Math.pow(2,16)+this[++offset]*Math.pow(2,8)+this[++offset];return(BigInt(val)<<BigInt(32))+BigInt(this[++offset]*Math.pow(2,24)+this[++offset]*Math.pow(2,16)+this[++offset]*Math.pow(2,8)+last)}),Buffer.prototype.readFloatLE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!0,23,4)},Buffer.prototype.readFloatBE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!1,23,4)},Buffer.prototype.readDoubleLE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!0,52,8)},Buffer.prototype.readDoubleBE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!1,52,8)},Buffer.prototype.writeUintLE=Buffer.prototype.writeUIntLE=function(value,offset,byteLength,noAssert){value=+value,offset>>>=0,byteLength>>>=0,noAssert||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0);var mul=1,i=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUintBE=Buffer.prototype.writeUIntBE=function(value,offset,byteLength,noAssert){value=+value,offset>>>=0,byteLength>>>=0,noAssert||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0);var i=byteLength-1,mul=1;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUint8=Buffer.prototype.writeUInt8=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,1,255,0),this[offset]=255&value,offset+1},Buffer.prototype.writeUint16LE=Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,65535,0),this[offset]=255&value,this[offset+1]=value>>>8,offset+2},Buffer.prototype.writeUint16BE=Buffer.prototype.writeUInt16BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,65535,0),this[offset]=value>>>8,this[offset+1]=255&value,offset+2},Buffer.prototype.writeUint32LE=Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,4294967295,0),this[offset+3]=value>>>24,this[offset+2]=value>>>16,this[offset+1]=value>>>8,this[offset]=255&value,offset+4},Buffer.prototype.writeUint32BE=Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,4294967295,0),this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value,offset+4},Buffer.prototype.writeBigUInt64LE=defineBigIntMethod(function(value){var offset=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return wrtBigUInt64LE(this,value,offset,BigInt(0),BigInt("0xffffffffffffffff"))}),Buffer.prototype.writeBigUInt64BE=defineBigIntMethod(function(value){var offset=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return wrtBigUInt64BE(this,value,offset,BigInt(0),BigInt("0xffffffffffffffff"))}),Buffer.prototype.writeIntLE=function(value,offset,byteLength,noAssert){if(value=+value,offset>>>=0,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=0,mul=1,sub=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i-1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeIntBE=function(value,offset,byteLength,noAssert){if(value=+value,offset>>>=0,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=byteLength-1,mul=1,sub=0;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i+1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeInt8=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,1,127,-128),value<0&&(value=255+value+1),this[offset]=255&value,offset+1},Buffer.prototype.writeInt16LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,32767,-32768),this[offset]=255&value,this[offset+1]=value>>>8,offset+2},Buffer.prototype.writeInt16BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,32767,-32768),this[offset]=value>>>8,this[offset+1]=255&value,offset+2},Buffer.prototype.writeInt32LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),this[offset]=255&value,this[offset+1]=value>>>8,this[offset+2]=value>>>16,this[offset+3]=value>>>24,offset+4},Buffer.prototype.writeInt32BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),value<0&&(value=4294967295+value+1),this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value,offset+4},Buffer.prototype.writeBigInt64LE=defineBigIntMethod(function(value){var offset=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return wrtBigUInt64LE(this,value,offset,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),Buffer.prototype.writeBigInt64BE=defineBigIntMethod(function(value){var offset=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return wrtBigUInt64BE(this,value,offset,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),Buffer.prototype.writeFloatLE=function(value,offset,noAssert){return writeFloat(this,value,offset,!0,noAssert)},Buffer.prototype.writeFloatBE=function(value,offset,noAssert){return writeFloat(this,value,offset,!1,noAssert)},Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){return writeDouble(this,value,offset,!0,noAssert)},Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){return writeDouble(this,value,offset,!1,noAssert)},Buffer.prototype.copy=function(target,targetStart,start,end){if(!Buffer.isBuffer(target))throw new TypeError("argument should be a Buffer");if(start||(start=0),end||0===end||(end=this.length),targetStart>=target.length&&(targetStart=target.length),targetStart||(targetStart=0),end>0&&end<start&&(end=start),end===start)return 0;if(0===target.length||0===this.length)return 0;if(targetStart<0)throw new RangeError("targetStart out of bounds");if(start<0||start>=this.length)throw new RangeError("Index out of range");if(end<0)throw new RangeError("sourceEnd out of bounds");end>this.length&&(end=this.length),target.length-targetStart<end-start&&(end=target.length-targetStart+start);var len=end-start;return this===target&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(targetStart,start,end):Uint8Array.prototype.set.call(target,this.subarray(start,end),targetStart),len},Buffer.prototype.fill=function(val,start,end,encoding){if("string"==typeof val){if("string"==typeof start?(encoding=start,start=0,end=this.length):"string"==typeof end&&(encoding=end,end=this.length),void 0!==encoding&&"string"!=typeof encoding)throw new TypeError("encoding must be a string");if("string"==typeof encoding&&!Buffer.isEncoding(encoding))throw new TypeError("Unknown encoding: "+encoding);if(1===val.length){var code=val.charCodeAt(0);("utf8"===encoding&&code<128||"latin1"===encoding)&&(val=code)}}else"number"==typeof val?val&=255:"boolean"==typeof val&&(val=Number(val));if(start<0||this.length<start||this.length<end)throw new RangeError("Out of range index");if(end<=start)return this;var i;if(start>>>=0,end=void 0===end?this.length:end>>>0,val||(val=0),"number"==typeof val)for(i=start;i<end;++i)this[i]=val;else{var bytes=Buffer.isBuffer(val)?val:Buffer.from(val,encoding),len=bytes.length;if(0===len)throw new TypeError('The value "'+val+'" is invalid for argument "value"');for(i=0;i<end-start;++i)this[i+start]=bytes[i%len]}return this};var errors={};function E(sym,getMessage,Base){errors[sym]=function(_Base){_inherits(NodeError,_Base);var _super=_createSuper(NodeError);function NodeError(){var _this;return _classCallCheck(this,NodeError),_this=_super.call(this),Object.defineProperty(_assertThisInitialized(_this),"message",{value:getMessage.apply(_assertThisInitialized(_this),arguments),writable:!0,configurable:!0}),_this.name="".concat(_this.name," [").concat(sym,"]"),delete _this.name,_this}return _createClass(NodeError,[{key:"code",get:function(){return sym},set:function(value){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:value,writable:!0})}},{key:"toString",value:function(){return"".concat(this.name," [").concat(sym,"]: ").concat(this.message)}}]),NodeError}(Base)}function addNumericalSeparator(val){for(var res="",i=val.length,start="-"===val[0]?1:0;i>=start+4;i-=3)res="_".concat(val.slice(i-3,i)).concat(res);return"".concat(val.slice(0,i)).concat(res)}function checkIntBI(value,min,max,buf,offset,byteLength){if(value>max||value<min){var range,n="bigint"==typeof min?"n":"";throw range=byteLength>3?0===min||min===BigInt(0)?">= 0".concat(n," and < 2").concat(n," ** ").concat(8*(byteLength+1)).concat(n):">= -(2".concat(n," ** ").concat(8*(byteLength+1)-1).concat(n,") and < 2 ** ")+"".concat(8*(byteLength+1)-1).concat(n):">= ".concat(min).concat(n," and <= ").concat(max).concat(n),new errors.ERR_OUT_OF_RANGE("value",range,value)}!function(buf,offset,byteLength){validateNumber(offset,"offset"),void 0!==buf[offset]&&void 0!==buf[offset+byteLength]||boundsError(offset,buf.length-(byteLength+1))}(buf,offset,byteLength)}function validateNumber(value,name){if("number"!=typeof value)throw new errors.ERR_INVALID_ARG_TYPE(name,"number",value)}function boundsError(value,length,type){if(Math.floor(value)!==value)throw validateNumber(value,type),new errors.ERR_OUT_OF_RANGE(type||"offset","an integer",value);if(length<0)throw new errors.ERR_BUFFER_OUT_OF_BOUNDS;throw new errors.ERR_OUT_OF_RANGE(type||"offset",">= ".concat(type?1:0," and <= ").concat(length),value)}E("ERR_BUFFER_OUT_OF_BOUNDS",function(name){return name?"".concat(name," is outside of buffer bounds"):"Attempt to access memory outside buffer bounds"},RangeError),E("ERR_INVALID_ARG_TYPE",function(name,actual){return'The "'.concat(name,'" argument must be of type number. Received type ').concat(typeof actual)},TypeError),E("ERR_OUT_OF_RANGE",function(str,range,input){var msg='The value of "'.concat(str,'" is out of range.'),received=input;return Number.isInteger(input)&&Math.abs(input)>Math.pow(2,32)?received=addNumericalSeparator(String(input)):"bigint"==typeof input&&(received=String(input),(input>Math.pow(BigInt(2),BigInt(32))||input<-Math.pow(BigInt(2),BigInt(32)))&&(received=addNumericalSeparator(received)),received+="n"),msg+" It must be ".concat(range,". Received ").concat(received)},RangeError);var INVALID_BASE64_RE=/[^+/0-9A-Za-z-_]/g;function utf8ToBytes(string,units){var codePoint;units=units||1/0;for(var length=string.length,leadSurrogate=null,bytes=[],i=0;i<length;++i){if((codePoint=string.charCodeAt(i))>55295&&codePoint<57344){if(!leadSurrogate){if(codePoint>56319){(units-=3)>-1&&bytes.push(239,191,189);continue}if(i+1===length){(units-=3)>-1&&bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(codePoint<56320){(units-=3)>-1&&bytes.push(239,191,189),leadSurrogate=codePoint;continue}codePoint=65536+(leadSurrogate-55296<<10|codePoint-56320)}else leadSurrogate&&(units-=3)>-1&&bytes.push(239,191,189);if(leadSurrogate=null,codePoint<128){if((units-=1)<0)break;bytes.push(codePoint)}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,63&codePoint|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,63&codePoint|128)}else{if(!(codePoint<1114112))throw new Error("Invalid code point");if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,63&codePoint|128)}}return bytes}function base64ToBytes(str){return base64.toByteArray(function(str){if((str=(str=str.split("=")[0]).trim().replace(INVALID_BASE64_RE,"")).length<2)return"";for(;str.length%4!=0;)str+="=";return str}(str))}function blitBuffer(src,dst,offset,length){var i;for(i=0;i<length&&!(i+offset>=dst.length||i>=src.length);++i)dst[i+offset]=src[i];return i}function isInstance(obj,type){return obj instanceof type||null!=obj&&null!=obj.constructor&&null!=obj.constructor.name&&obj.constructor.name===type.name}function numberIsNaN(obj){return obj!=obj}var hexSliceLookupTable=function(){for(var table=new Array(256),i=0;i<16;++i)for(var i16=16*i,j=0;j<16;++j)table[i16+j]="0123456789abcdef"[i]+"0123456789abcdef"[j];return table}();function defineBigIntMethod(fn){return"undefined"==typeof BigInt?BufferBigIntNotDefined:fn}function BufferBigIntNotDefined(){throw new Error("BigInt not supported")}},51879:module=>{module.exports=function(obj,reviver){var json,error=null;try{json=JSON.parse(obj,reviver)}catch(err){error=err}return[error,json]}},89916:function(module){var URL_REGEX,FIRST_SEGMENT_REGEX,SLASH_DOT_REGEX,SLASH_DOT_DOT_REGEX,URLToolkit;URL_REGEX=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#[^]*)?$/,FIRST_SEGMENT_REGEX=/^([^\/?#]*)([^]*)$/,SLASH_DOT_REGEX=/(?:\/|^)\.(?=\/)/g,SLASH_DOT_DOT_REGEX=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,module.exports=URLToolkit={buildAbsoluteURL:function(baseURL,relativeURL,opts){if(opts=opts||{},baseURL=baseURL.trim(),!(relativeURL=relativeURL.trim())){if(!opts.alwaysNormalize)return baseURL;var basePartsForNormalise=URLToolkit.parseURL(baseURL);if(!basePartsForNormalise)throw new Error("Error trying to parse base URL.");return basePartsForNormalise.path=URLToolkit.normalizePath(basePartsForNormalise.path),URLToolkit.buildURLFromParts(basePartsForNormalise)}var relativeParts=URLToolkit.parseURL(relativeURL);if(!relativeParts)throw new Error("Error trying to parse relative URL.");if(relativeParts.scheme)return opts.alwaysNormalize?(relativeParts.path=URLToolkit.normalizePath(relativeParts.path),URLToolkit.buildURLFromParts(relativeParts)):relativeURL;var baseParts=URLToolkit.parseURL(baseURL);if(!baseParts)throw new Error("Error trying to parse base URL.");if(!baseParts.netLoc&&baseParts.path&&"/"!==baseParts.path[0]){var pathParts=FIRST_SEGMENT_REGEX.exec(baseParts.path);baseParts.netLoc=pathParts[1],baseParts.path=pathParts[2]}baseParts.netLoc&&!baseParts.path&&(baseParts.path="/");var builtParts={scheme:baseParts.scheme,netLoc:relativeParts.netLoc,path:null,params:relativeParts.params,query:relativeParts.query,fragment:relativeParts.fragment};if(!relativeParts.netLoc&&(builtParts.netLoc=baseParts.netLoc,"/"!==relativeParts.path[0]))if(relativeParts.path){var baseURLPath=baseParts.path,newPath=baseURLPath.substring(0,baseURLPath.lastIndexOf("/")+1)+relativeParts.path;builtParts.path=URLToolkit.normalizePath(newPath)}else builtParts.path=baseParts.path,relativeParts.params||(builtParts.params=baseParts.params,relativeParts.query||(builtParts.query=baseParts.query));return null===builtParts.path&&(builtParts.path=opts.alwaysNormalize?URLToolkit.normalizePath(relativeParts.path):relativeParts.path),URLToolkit.buildURLFromParts(builtParts)},parseURL:function(url){var parts=URL_REGEX.exec(url);return parts?{scheme:parts[1]||"",netLoc:parts[2]||"",path:parts[3]||"",params:parts[4]||"",query:parts[5]||"",fragment:parts[6]||""}:null},normalizePath:function(path){for(path=path.split("").reverse().join("").replace(SLASH_DOT_REGEX,"");path.length!==(path=path.replace(SLASH_DOT_DOT_REGEX,"")).length;);return path.split("").reverse().join("")},buildURLFromParts:function(parts){return parts.scheme+parts.netLoc+parts.path+parts.params+parts.query+parts.fragment}}},40230:module=>{var MAX_UINT32=Math.pow(2,32);module.exports=function(data){var view=new DataView(data.buffer,data.byteOffset,data.byteLength),result={version:data[0],flags:new Uint8Array(data.subarray(1,4)),references:[],referenceId:view.getUint32(4),timescale:view.getUint32(8)},i=12;0===result.version?(result.earliestPresentationTime=view.getUint32(i),result.firstOffset=view.getUint32(i+4),i+=8):(result.earliestPresentationTime=view.getUint32(i)*MAX_UINT32+view.getUint32(i+4),result.firstOffset=view.getUint32(i+8)*MAX_UINT32+view.getUint32(i+12),i+=16);var referenceCount=view.getUint16(i+=2);for(i+=2;referenceCount>0;i+=12,referenceCount--)result.references.push({referenceType:(128&data[i])>>>7,referencedSize:2147483647&view.getUint32(i),subsegmentDuration:view.getUint32(i+4),startsWithSap:!!(128&data[i+8]),sapType:(112&data[i+8])>>>4,sapDeltaTime:268435455&view.getUint32(i+8)});return result}},52405:module=>{var secondsToVideoTs,secondsToAudioTs,videoTsToSeconds,audioTsToSeconds,audioTsToVideoTs,videoTsToAudioTs,metadataTsToSeconds;audioTsToVideoTs=function(timestamp,sampleRate){return secondsToVideoTs(audioTsToSeconds(timestamp,sampleRate))},videoTsToAudioTs=function(timestamp,sampleRate){return secondsToAudioTs(videoTsToSeconds(timestamp),sampleRate)},metadataTsToSeconds=function(timestamp,timelineStartPts,keepOriginalTimestamps){return videoTsToSeconds(keepOriginalTimestamps?timestamp:timestamp-timelineStartPts)},module.exports={ONE_SECOND_IN_TS:9e4,secondsToVideoTs:secondsToVideoTs=function(seconds){return 9e4*seconds},secondsToAudioTs:secondsToAudioTs=function(seconds,sampleRate){return seconds*sampleRate},videoTsToSeconds:videoTsToSeconds=function(timestamp){return timestamp/9e4},audioTsToSeconds:audioTsToSeconds=function(timestamp,sampleRate){return timestamp/sampleRate},audioTsToVideoTs:audioTsToVideoTs,videoTsToAudioTs:videoTsToAudioTs,metadataTsToSeconds:metadataTsToSeconds}},66605:(module,__unused_webpack_exports,__webpack_require__)=>{var window=__webpack_require__(60397),vttjs=module.exports={WebVTT:__webpack_require__(50586),VTTCue:__webpack_require__(37772),VTTRegion:__webpack_require__(94348)};window.vttjs=vttjs,window.WebVTT=vttjs.WebVTT;var cueShim=vttjs.VTTCue,regionShim=vttjs.VTTRegion,nativeVTTCue=window.VTTCue,nativeVTTRegion=window.VTTRegion;vttjs.shim=function(){window.VTTCue=cueShim,window.VTTRegion=regionShim},vttjs.restore=function(){window.VTTCue=nativeVTTCue,window.VTTRegion=nativeVTTRegion},window.VTTCue||vttjs.shim()},50586:(module,__unused_webpack_exports,__webpack_require__)=>{var document=__webpack_require__(72449),_objCreate=Object.create||function(){function F(){}return function(o){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return F.prototype=o,new F}}();function ParsingError(errorData,message){this.name="ParsingError",this.code=errorData.code,this.message=message||errorData.message}function parseTimeStamp(input){function computeSeconds(h,m,s,f){return 3600*(0|h)+60*(0|m)+(0|s)+(0|f)/1e3}var m=input.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);return m?m[3]?computeSeconds(m[1],m[2],m[3].replace(":",""),m[4]):m[1]>59?computeSeconds(m[1],m[2],0,m[4]):computeSeconds(0,m[1],m[2],m[4]):null}function Settings(){this.values=_objCreate(null)}function parseOptions(input,callback,keyValueDelim,groupDelim){var groups=groupDelim?input.split(groupDelim):[input];for(var i in groups)if("string"==typeof groups[i]){var kv=groups[i].split(keyValueDelim);2===kv.length&&callback(kv[0],kv[1])}}function parseCue(input,cue,regionList){var oInput=input;function consumeTimeStamp(){var ts=parseTimeStamp(input);if(null===ts)throw new ParsingError(ParsingError.Errors.BadTimeStamp,"Malformed timestamp: "+oInput);return input=input.replace(/^[^\sa-zA-Z-]+/,""),ts}function skipWhitespace(){input=input.replace(/^\s+/,"")}if(skipWhitespace(),cue.startTime=consumeTimeStamp(),skipWhitespace(),"--\x3e"!==input.substr(0,3))throw new ParsingError(ParsingError.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+oInput);input=input.substr(3),skipWhitespace(),cue.endTime=consumeTimeStamp(),skipWhitespace(),function(input,cue){var settings=new Settings;parseOptions(input,function(k,v){switch(k){case"region":for(var i=regionList.length-1;i>=0;i--)if(regionList[i].id===v){settings.set(k,regionList[i].region);break}break;case"vertical":settings.alt(k,v,["rl","lr"]);break;case"line":var vals=v.split(","),vals0=vals[0];settings.integer(k,vals0),settings.percent(k,vals0)&&settings.set("snapToLines",!1),settings.alt(k,vals0,["auto"]),2===vals.length&&settings.alt("lineAlign",vals[1],["start","center","end"]);break;case"position":vals=v.split(","),settings.percent(k,vals[0]),2===vals.length&&settings.alt("positionAlign",vals[1],["start","center","end"]);break;case"size":settings.percent(k,v);break;case"align":settings.alt(k,v,["start","center","end","left","right"])}},/:/,/\s/),cue.region=settings.get("region",null),cue.vertical=settings.get("vertical","");try{cue.line=settings.get("line","auto")}catch(e){}cue.lineAlign=settings.get("lineAlign","start"),cue.snapToLines=settings.get("snapToLines",!0),cue.size=settings.get("size",100);try{cue.align=settings.get("align","center")}catch(e){cue.align=settings.get("align","middle")}try{cue.position=settings.get("position","auto")}catch(e){cue.position=settings.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},cue.align)}cue.positionAlign=settings.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},cue.align)}(input,cue)}(ParsingError.prototype=_objCreate(Error.prototype)).constructor=ParsingError,ParsingError.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},Settings.prototype={set:function(k,v){this.get(k)||""===v||(this.values[k]=v)},get:function(k,dflt,defaultKey){return defaultKey?this.has(k)?this.values[k]:dflt[defaultKey]:this.has(k)?this.values[k]:dflt},has:function(k){return k in this.values},alt:function(k,v,a){for(var n=0;n<a.length;++n)if(v===a[n]){this.set(k,v);break}},integer:function(k,v){/^-?\d+$/.test(v)&&this.set(k,parseInt(v,10))},percent:function(k,v){return!!(v.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(v=parseFloat(v))>=0&&v<=100)&&(this.set(k,v),!0)}};var TEXTAREA_ELEMENT=document.createElement&&document.createElement("textarea"),TAG_NAME={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},DEFAULT_COLOR_CLASS={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},TAG_ANNOTATION={v:"title",lang:"lang"},NEEDS_PARENT={rt:"ruby"};function parseContent(window,input){function nextToken(){if(!input)return null;var result,m=input.match(/^([^<]*)(<[^>]*>?)?/);return input=input.substr((result=m[1]?m[1]:m[2]).length),result}function shouldAdd(current,element){return!NEEDS_PARENT[element.localName]||NEEDS_PARENT[element.localName]===current.localName}function createElement(type,annotation){var tagName=TAG_NAME[type];if(!tagName)return null;var element=window.document.createElement(tagName),name=TAG_ANNOTATION[type];return name&&annotation&&(element[name]=annotation.trim()),element}for(var t,s,rootDiv=window.document.createElement("div"),current=rootDiv,tagStack=[];null!==(t=nextToken());)if("<"!==t[0])current.appendChild(window.document.createTextNode((TEXTAREA_ELEMENT.innerHTML=t,s=TEXTAREA_ELEMENT.textContent,TEXTAREA_ELEMENT.textContent="",s)));else{if("/"===t[1]){tagStack.length&&tagStack[tagStack.length-1]===t.substr(2).replace(">","")&&(tagStack.pop(),current=current.parentNode);continue}var node,ts=parseTimeStamp(t.substr(1,t.length-2));if(ts){node=window.document.createProcessingInstruction("timestamp",ts),current.appendChild(node);continue}var m=t.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!m)continue;if(!(node=createElement(m[1],m[3])))continue;if(!shouldAdd(current,node))continue;if(m[2]){var classes=m[2].split(".");classes.forEach(function(cl){var bgColor=/^bg_/.test(cl),colorName=bgColor?cl.slice(3):cl;DEFAULT_COLOR_CLASS.hasOwnProperty(colorName)&&(node.style[bgColor?"background-color":"color"]=DEFAULT_COLOR_CLASS[colorName])}),node.className=classes.join(" ")}tagStack.push(m[1]),current.appendChild(node),current=node}return rootDiv}var strongRTLRanges=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function isStrongRTLChar(charCode){for(var i=0;i<strongRTLRanges.length;i++){var currentRange=strongRTLRanges[i];if(charCode>=currentRange[0]&&charCode<=currentRange[1])return!0}return!1}function determineBidi(cueDiv){var nodeStack=[],text="";if(!cueDiv||!cueDiv.childNodes)return"ltr";function pushNodes(nodeStack,node){for(var i=node.childNodes.length-1;i>=0;i--)nodeStack.push(node.childNodes[i])}function nextTextNode(nodeStack){if(!nodeStack||!nodeStack.length)return null;var node=nodeStack.pop(),text=node.textContent||node.innerText;if(text){var m=text.match(/^.*(\n|\r)/);return m?(nodeStack.length=0,m[0]):text}return"ruby"===node.tagName?nextTextNode(nodeStack):node.childNodes?(pushNodes(nodeStack,node),nextTextNode(nodeStack)):void 0}for(pushNodes(nodeStack,cueDiv);text=nextTextNode(nodeStack);)for(var i=0;i<text.length;i++)if(isStrongRTLChar(text.charCodeAt(i)))return"rtl";return"ltr"}function StyleBox(){}function CueStyleBox(window,cue,styleOptions){StyleBox.call(this),this.cue=cue,this.cueDiv=parseContent(window,cue.text);var styles={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:""===cue.vertical?"horizontal-tb":"lr"===cue.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(styles,this.cueDiv),this.div=window.document.createElement("div"),styles={direction:determineBidi(this.cueDiv),writingMode:""===cue.vertical?"horizontal-tb":"lr"===cue.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:"middle"===cue.align?"center":cue.align,font:styleOptions.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(styles),this.div.appendChild(this.cueDiv);var textPos=0;switch(cue.positionAlign){case"start":textPos=cue.position;break;case"center":textPos=cue.position-cue.size/2;break;case"end":textPos=cue.position-cue.size}this.applyStyles(""===cue.vertical?{left:this.formatStyle(textPos,"%"),width:this.formatStyle(cue.size,"%")}:{top:this.formatStyle(textPos,"%"),height:this.formatStyle(cue.size,"%")}),this.move=function(box){this.applyStyles({top:this.formatStyle(box.top,"px"),bottom:this.formatStyle(box.bottom,"px"),left:this.formatStyle(box.left,"px"),right:this.formatStyle(box.right,"px"),height:this.formatStyle(box.height,"px"),width:this.formatStyle(box.width,"px")})}}function BoxPosition(obj){var lh,height,width,top;if(obj.div){height=obj.div.offsetHeight,width=obj.div.offsetWidth,top=obj.div.offsetTop;var rects=(rects=obj.div.childNodes)&&(rects=rects[0])&&rects.getClientRects&&rects.getClientRects();obj=obj.div.getBoundingClientRect(),lh=rects?Math.max(rects[0]&&rects[0].height||0,obj.height/rects.length):0}this.left=obj.left,this.right=obj.right,this.top=obj.top||top,this.height=obj.height||height,this.bottom=obj.bottom||top+(obj.height||height),this.width=obj.width||width,this.lineHeight=void 0!==lh?lh:obj.lineHeight}function moveBoxToLinePosition(window,styleBox,containerBox,boxPositions){var boxPosition=new BoxPosition(styleBox),cue=styleBox.cue,linePos=function(cue){if("number"==typeof cue.line&&(cue.snapToLines||cue.line>=0&&cue.line<=100))return cue.line;if(!cue.track||!cue.track.textTrackList||!cue.track.textTrackList.mediaElement)return-1;for(var track=cue.track,trackList=track.textTrackList,count=0,i=0;i<trackList.length&&trackList[i]!==track;i++)"showing"===trackList[i].mode&&count++;return-1*++count}(cue),axis=[];if(cue.snapToLines){var size;switch(cue.vertical){case"":axis=["+y","-y"],size="height";break;case"rl":axis=["+x","-x"],size="width";break;case"lr":axis=["-x","+x"],size="width"}var step=boxPosition.lineHeight,position=step*Math.round(linePos),maxPosition=containerBox[size]+step,initialAxis=axis[0];Math.abs(position)>maxPosition&&(position=position<0?-1:1,position*=Math.ceil(maxPosition/step)*step),linePos<0&&(position+=""===cue.vertical?containerBox.height:containerBox.width,axis=axis.reverse()),boxPosition.move(initialAxis,position)}else{var calculatedPercentage=boxPosition.lineHeight/containerBox.height*100;switch(cue.lineAlign){case"center":linePos-=calculatedPercentage/2;break;case"end":linePos-=calculatedPercentage}switch(cue.vertical){case"":styleBox.applyStyles({top:styleBox.formatStyle(linePos,"%")});break;case"rl":styleBox.applyStyles({left:styleBox.formatStyle(linePos,"%")});break;case"lr":styleBox.applyStyles({right:styleBox.formatStyle(linePos,"%")})}axis=["+y","-x","+x","-y"],boxPosition=new BoxPosition(styleBox)}var bestPosition=function(b,axis){for(var bestPosition,specifiedPosition=new BoxPosition(b),percentage=1,i=0;i<axis.length;i++){for(;b.overlapsOppositeAxis(containerBox,axis[i])||b.within(containerBox)&&b.overlapsAny(boxPositions);)b.move(axis[i]);if(b.within(containerBox))return b;var p=b.intersectPercentage(containerBox);percentage>p&&(bestPosition=new BoxPosition(b),percentage=p),b=new BoxPosition(specifiedPosition)}return bestPosition||specifiedPosition}(boxPosition,axis);styleBox.move(bestPosition.toCSSCompatValues(containerBox))}function WebVTT(){}StyleBox.prototype.applyStyles=function(styles,div){for(var prop in div=div||this.div,styles)styles.hasOwnProperty(prop)&&(div.style[prop]=styles[prop])},StyleBox.prototype.formatStyle=function(val,unit){return 0===val?0:val+unit},(CueStyleBox.prototype=_objCreate(StyleBox.prototype)).constructor=CueStyleBox,BoxPosition.prototype.move=function(axis,toMove){switch(toMove=void 0!==toMove?toMove:this.lineHeight,axis){case"+x":this.left+=toMove,this.right+=toMove;break;case"-x":this.left-=toMove,this.right-=toMove;break;case"+y":this.top+=toMove,this.bottom+=toMove;break;case"-y":this.top-=toMove,this.bottom-=toMove}},BoxPosition.prototype.overlaps=function(b2){return this.left<b2.right&&this.right>b2.left&&this.top<b2.bottom&&this.bottom>b2.top},BoxPosition.prototype.overlapsAny=function(boxes){for(var i=0;i<boxes.length;i++)if(this.overlaps(boxes[i]))return!0;return!1},BoxPosition.prototype.within=function(container){return this.top>=container.top&&this.bottom<=container.bottom&&this.left>=container.left&&this.right<=container.right},BoxPosition.prototype.overlapsOppositeAxis=function(container,axis){switch(axis){case"+x":return this.left<container.left;case"-x":return this.right>container.right;case"+y":return this.top<container.top;case"-y":return this.bottom>container.bottom}},BoxPosition.prototype.intersectPercentage=function(b2){return Math.max(0,Math.min(this.right,b2.right)-Math.max(this.left,b2.left))*Math.max(0,Math.min(this.bottom,b2.bottom)-Math.max(this.top,b2.top))/(this.height*this.width)},BoxPosition.prototype.toCSSCompatValues=function(reference){return{top:this.top-reference.top,bottom:reference.bottom-this.bottom,left:this.left-reference.left,right:reference.right-this.right,height:this.height,width:this.width}},BoxPosition.getSimpleBoxPosition=function(obj){var height=obj.div?obj.div.offsetHeight:obj.tagName?obj.offsetHeight:0,width=obj.div?obj.div.offsetWidth:obj.tagName?obj.offsetWidth:0,top=obj.div?obj.div.offsetTop:obj.tagName?obj.offsetTop:0;return{left:(obj=obj.div?obj.div.getBoundingClientRect():obj.tagName?obj.getBoundingClientRect():obj).left,right:obj.right,top:obj.top||top,height:obj.height||height,bottom:obj.bottom||top+(obj.height||height),width:obj.width||width}},WebVTT.StringDecoder=function(){return{decode:function(data){if(!data)return"";if("string"!=typeof data)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(data))}}},WebVTT.convertCueToDOMTree=function(window,cuetext){return window&&cuetext?parseContent(window,cuetext):null},WebVTT.processCues=function(window,cues,overlay){if(!window||!cues||!overlay)return null;for(;overlay.firstChild;)overlay.removeChild(overlay.firstChild);var paddedOverlay=window.document.createElement("div");if(paddedOverlay.style.position="absolute",paddedOverlay.style.left="0",paddedOverlay.style.right="0",paddedOverlay.style.top="0",paddedOverlay.style.bottom="0",paddedOverlay.style.margin="1.5%",overlay.appendChild(paddedOverlay),function(cues){for(var i=0;i<cues.length;i++)if(cues[i].hasBeenReset||!cues[i].displayState)return!0;return!1}(cues)){var boxPositions=[],containerBox=BoxPosition.getSimpleBoxPosition(paddedOverlay),styleOptions={font:Math.round(.05*containerBox.height*100)/100+"px sans-serif"};!function(){for(var styleBox,cue,i=0;i<cues.length;i++)styleBox=new CueStyleBox(window,cue=cues[i],styleOptions),paddedOverlay.appendChild(styleBox.div),moveBoxToLinePosition(0,styleBox,containerBox,boxPositions),cue.displayState=styleBox.div,boxPositions.push(BoxPosition.getSimpleBoxPosition(styleBox))}()}else for(var i=0;i<cues.length;i++)paddedOverlay.appendChild(cues[i].displayState)},(WebVTT.Parser=function(window,vttjs,decoder){decoder||(decoder=vttjs,vttjs={}),vttjs||(vttjs={}),this.window=window,this.vttjs=vttjs,this.state="INITIAL",this.buffer="",this.decoder=decoder||new TextDecoder("utf8"),this.regionList=[]}).prototype={reportOrThrowError:function(e){if(!(e instanceof ParsingError))throw e;this.onparsingerror&&this.onparsingerror(e)},parse:function(data){var input,self=this;function collectNextLine(){for(var buffer=self.buffer,pos=0;pos<buffer.length&&"\r"!==buffer[pos]&&"\n"!==buffer[pos];)++pos;var line=buffer.substr(0,pos);return"\r"===buffer[pos]&&++pos,"\n"===buffer[pos]&&++pos,self.buffer=buffer.substr(pos),line}data&&(self.buffer+=self.decoder.decode(data,{stream:!0}));try{var line;if("INITIAL"===self.state){if(!/\r\n|\n/.test(self.buffer))return this;var m=(line=collectNextLine()).match(/^WEBVTT([ \t].*)?$/);if(!m||!m[0])throw new ParsingError(ParsingError.Errors.BadSignature);self.state="HEADER"}for(var alreadyCollectedLine=!1;self.buffer;){if(!/\r\n|\n/.test(self.buffer))return this;switch(alreadyCollectedLine?alreadyCollectedLine=!1:line=collectNextLine(),self.state){case"HEADER":/:/.test(line)?(input=line).match(/X-TIMESTAMP-MAP/)?parseOptions(input,function(k,v){"X-TIMESTAMP-MAP"===k&&function(input){var settings=new Settings;parseOptions(input,function(k,v){switch(k){case"MPEGT":settings.integer(k+"S",v);break;case"LOCA":settings.set(k+"L",parseTimeStamp(v))}},/[^\d]:/,/,/),self.ontimestampmap&&self.ontimestampmap({MPEGTS:settings.get("MPEGTS"),LOCAL:settings.get("LOCAL")})}(v)},/=/):parseOptions(input,function(k,v){"Region"===k&&function(input){var settings=new Settings;if(parseOptions(input,function(k,v){switch(k){case"id":settings.set(k,v);break;case"width":settings.percent(k,v);break;case"lines":settings.integer(k,v);break;case"regionanchor":case"viewportanchor":var xy=v.split(",");if(2!==xy.length)break;var anchor=new Settings;if(anchor.percent("x",xy[0]),anchor.percent("y",xy[1]),!anchor.has("x")||!anchor.has("y"))break;settings.set(k+"X",anchor.get("x")),settings.set(k+"Y",anchor.get("y"));break;case"scroll":settings.alt(k,v,["up"])}},/=/,/\s/),settings.has("id")){var region=new(self.vttjs.VTTRegion||self.window.VTTRegion);region.width=settings.get("width",100),region.lines=settings.get("lines",3),region.regionAnchorX=settings.get("regionanchorX",0),region.regionAnchorY=settings.get("regionanchorY",100),region.viewportAnchorX=settings.get("viewportanchorX",0),region.viewportAnchorY=settings.get("viewportanchorY",100),region.scroll=settings.get("scroll",""),self.onregion&&self.onregion(region),self.regionList.push({id:settings.get("id"),region:region})}}(v)},/:/):line||(self.state="ID");continue;case"NOTE":line||(self.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(line)){self.state="NOTE";break}if(!line)continue;self.cue=new(self.vttjs.VTTCue||self.window.VTTCue)(0,0,"");try{self.cue.align="center"}catch(e){self.cue.align="middle"}if(self.state="CUE",-1===line.indexOf("--\x3e")){self.cue.id=line;continue}case"CUE":try{parseCue(line,self.cue,self.regionList)}catch(e){self.reportOrThrowError(e),self.cue=null,self.state="BADCUE";continue}self.state="CUETEXT";continue;case"CUETEXT":var hasSubstring=-1!==line.indexOf("--\x3e");if(!line||hasSubstring&&(alreadyCollectedLine=!0)){self.oncue&&self.oncue(self.cue),self.cue=null,self.state="ID";continue}self.cue.text&&(self.cue.text+="\n"),self.cue.text+=line.replace(/\u2028/g,"\n").replace(/u2029/g,"\n");continue;case"BADCUE":line||(self.state="ID");continue}}}catch(e){self.reportOrThrowError(e),"CUETEXT"===self.state&&self.cue&&self.oncue&&self.oncue(self.cue),self.cue=null,self.state="INITIAL"===self.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),(this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new ParsingError(ParsingError.Errors.BadSignature)}catch(e){this.reportOrThrowError(e)}return this.onflush&&this.onflush(),this}},module.exports=WebVTT},37772:module=>{var directionSetting={"":1,lr:1,rl:1},alignSetting={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function findAlignSetting(value){return"string"==typeof value&&!!alignSetting[value.toLowerCase()]&&value.toLowerCase()}function VTTCue(startTime,endTime,text){this.hasBeenReset=!1;var _id="",_pauseOnExit=!1,_startTime=startTime,_endTime=endTime,_text=text,_region=null,_vertical="",_snapToLines=!0,_line="auto",_lineAlign="start",_position="auto",_positionAlign="auto",_size=100,_align="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return _id},set:function(value){_id=""+value}},pauseOnExit:{enumerable:!0,get:function(){return _pauseOnExit},set:function(value){_pauseOnExit=!!value}},startTime:{enumerable:!0,get:function(){return _startTime},set:function(value){if("number"!=typeof value)throw new TypeError("Start time must be set to a number.");_startTime=value,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return _endTime},set:function(value){if("number"!=typeof value)throw new TypeError("End time must be set to a number.");_endTime=value,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return _text},set:function(value){_text=""+value,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return _region},set:function(value){_region=value,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return _vertical},set:function(value){var setting=function(value){return"string"==typeof value&&!!directionSetting[value.toLowerCase()]&&value.toLowerCase()}(value);if(!1===setting)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");_vertical=setting,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return _snapToLines},set:function(value){_snapToLines=!!value,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return _line},set:function(value){if("number"!=typeof value&&"auto"!==value)throw new SyntaxError("Line: an invalid number or illegal string was specified.");_line=value,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return _lineAlign},set:function(value){var setting=findAlignSetting(value);setting?(_lineAlign=setting,this.hasBeenReset=!0):console.warn("lineAlign: an invalid or illegal string was specified.")}},position:{enumerable:!0,get:function(){return _position},set:function(value){if(value<0||value>100)throw new Error("Position must be between 0 and 100.");_position=value,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return _positionAlign},set:function(value){var setting=findAlignSetting(value);setting?(_positionAlign=setting,this.hasBeenReset=!0):console.warn("positionAlign: an invalid or illegal string was specified.")}},size:{enumerable:!0,get:function(){return _size},set:function(value){if(value<0||value>100)throw new Error("Size must be between 0 and 100.");_size=value,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return _align},set:function(value){var setting=findAlignSetting(value);if(!setting)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");_align=setting,this.hasBeenReset=!0}}}),this.displayState=void 0}VTTCue.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)},module.exports=VTTCue},94348:module=>{var scrollSetting={"":!0,up:!0};function isValidPercentValue(value){return"number"==typeof value&&value>=0&&value<=100}module.exports=function(){var _width=100,_lines=3,_regionAnchorX=0,_regionAnchorY=100,_viewportAnchorX=0,_viewportAnchorY=100,_scroll="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return _width},set:function(value){if(!isValidPercentValue(value))throw new Error("Width must be between 0 and 100.");_width=value}},lines:{enumerable:!0,get:function(){return _lines},set:function(value){if("number"!=typeof value)throw new TypeError("Lines must be set to a number.");_lines=value}},regionAnchorY:{enumerable:!0,get:function(){return _regionAnchorY},set:function(value){if(!isValidPercentValue(value))throw new Error("RegionAnchorX must be between 0 and 100.");_regionAnchorY=value}},regionAnchorX:{enumerable:!0,get:function(){return _regionAnchorX},set:function(value){if(!isValidPercentValue(value))throw new Error("RegionAnchorY must be between 0 and 100.");_regionAnchorX=value}},viewportAnchorY:{enumerable:!0,get:function(){return _viewportAnchorY},set:function(value){if(!isValidPercentValue(value))throw new Error("ViewportAnchorY must be between 0 and 100.");_viewportAnchorY=value}},viewportAnchorX:{enumerable:!0,get:function(){return _viewportAnchorX},set:function(value){if(!isValidPercentValue(value))throw new Error("ViewportAnchorX must be between 0 and 100.");_viewportAnchorX=value}},scroll:{enumerable:!0,get:function(){return _scroll},set:function(value){var setting=function(value){return"string"==typeof value&&!!scrollSetting[value.toLowerCase()]&&value.toLowerCase()}(value);!1===setting?console.warn("Scroll: an invalid or illegal string was specified."):_scroll=setting}}})}},32668:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{PlayerModule:()=>PlayerModule});var createClass=__webpack_require__(47289),classCallCheck=__webpack_require__(75134),common=__webpack_require__(86019),state=__webpack_require__(24642),operators=__webpack_require__(84816),settings_interface=__webpack_require__(54228),store_keys_enum=__webpack_require__(46531),core=__webpack_require__(83668),snack_bar=__webpack_require__(19966),ngx_pwa_local_storage=__webpack_require__(28857),sidenav=__webpack_require__(7891),moment=__webpack_require__(92070),angular_flex_layout_flex=__webpack_require__(55243),angular_flex_layout_extended=__webpack_require__(75498),MomentDatePipe=function(){var MomentDatePipe=function(){function MomentDatePipe(){(0,classCallCheck.Z)(this,MomentDatePipe)}return(0,createClass.Z)(MomentDatePipe,[{key:"transform",value:function(value,formatToParse){var formatToReturn=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"MMMM Do, dddd";return moment(value,formatToParse).format(formatToReturn)}}]),MomentDatePipe}();return MomentDatePipe.\u0275fac=function(t){return new(t||MomentDatePipe)},MomentDatePipe.\u0275pipe=core.Yjl({name:"momentDate",type:MomentDatePipe,pure:!0}),MomentDatePipe}(),_c0=function(a0){return{width:a0}};function InfoOverlayComponent_div_0_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"div",1),core._uU(1,"\n    "),core.TgZ(2,"div",2),core._uU(3,"\n        "),core._UZ(4,"img",3),core._uU(5,"\n    "),core.qZA(),core._uU(6,"\n    "),core.TgZ(7,"div",4),core._uU(8,"\n        "),core.TgZ(9,"div",5),core._uU(10),core.qZA(),core._uU(11,"\n        "),core.TgZ(12,"div",6),core._uU(13),core.qZA(),core._uU(14,"\n        "),core.TgZ(15,"div",7),core._uU(16,"\n            "),core._UZ(17,"div",8),core._uU(18,"\n            "),core.TgZ(19,"div",9),core._uU(20),core.ALo(21,"momentDate"),core.ALo(22,"momentDate"),core.qZA(),core._uU(23,"\n        "),core.qZA(),core._uU(24,"\n    "),core.qZA(),core._uU(25,"\n"),core.qZA()),2&rf){var ctx_r0=core.oxw();core.ekj("visible",ctx_r0.isVisible)("hidden",!ctx_r0.isVisible),core.xp6(4),core.Q6J("src",(null==ctx_r0.epgProgram?null:ctx_r0.epgProgram.icon[0])||(null==ctx_r0.channel||null==ctx_r0.channel.tvg?null:ctx_r0.channel.tvg.logo),core.LSH),core.xp6(6),core.AsE("\n            ",null==ctx_r0.epgProgram||null==ctx_r0.epgProgram.title[0]?null:ctx_r0.epgProgram.title[0].value," | ",ctx_r0.channel.name,"\n        "),core.xp6(3),core.hij("\n            ",null==ctx_r0.epgProgram||null==ctx_r0.epgProgram.desc[0]?null:ctx_r0.epgProgram.desc[0].value,"\n        "),core.xp6(4),core.Q6J("ngStyle",core.VKq(19,_c0,100*ctx_r0.finishedDuration/ctx_r0.generalDuration+"%")),core.xp6(3),core.AsE("\n                ",core.Dn7(21,11,ctx_r0.start,"YYYYMMDDHHmm ZZ","HH:mm"),"\n                -\n                ",core.Dn7(22,15,ctx_r0.stop,"YYYYMMDDHHmm ZZ","HH:mm"),"\n            ")}}var InfoOverlayComponent=function(){var InfoOverlayComponent=function(){function InfoOverlayComponent(){(0,classCallCheck.Z)(this,InfoOverlayComponent),this.isVisible=!1}return(0,createClass.Z)(InfoOverlayComponent,[{key:"ngOnChanges",value:function(changes){var _this=this;if(changes.channel&&!changes.channel.firstChange&&(clearTimeout(this.currentTimeout),this.isVisible=!0,this.currentTimeout=setTimeout(function(){_this.isVisible=!1},4e3)),changes.epgProgram&&changes.epgProgram.currentValue&&!changes.epgProgram.firstChange){var _changes$epgProgram$c=changes.epgProgram.currentValue;this.setProgramDuration(_changes$epgProgram$c.start,_changes$epgProgram$c.stop)}}},{key:"setProgramDuration",value:function(start,stop){this.stop=moment(stop,"YYYYMMDDHHmm ZZ"),this.start=moment(start,"YYYYMMDDHHmm ZZ");var timeNow=moment(Date.now());this.generalDuration=moment.duration(this.stop.diff(this.start)).asMilliseconds(),this.finishedDuration=moment.duration(this.stop.diff(timeNow)).asMilliseconds()}}]),InfoOverlayComponent}();return InfoOverlayComponent.\u0275fac=function(t){return new(t||InfoOverlayComponent)},InfoOverlayComponent.\u0275cmp=core.Xpm({type:InfoOverlayComponent,selectors:[["app-info-overlay"]],inputs:{channel:"channel",epgProgram:"epgProgram"},features:[core.TTD],decls:2,vars:1,consts:[["class","channel-overlay","fxLayout","row",3,"visible","hidden",4,"ngIf"],["fxLayout","row",1,"channel-overlay"],["fxFlex","100px","fxLayoutAlign","center start",1,"channel-logo"],["width","68","onerror","this.style.display='none'",3,"src"],["fxFlex",""],[1,"program-name"],[1,"program-description"],[1,"program-progress"],[1,"program-finished",3,"ngStyle"],[1,"duration"]],template:function(rf,ctx){1&rf&&(core.YNc(0,InfoOverlayComponent_div_0_Template,26,21,"div",0),core._uU(1,"\n")),2&rf&&core.Q6J("ngIf",ctx.channel&&ctx.epgProgram)},directives:[common.O5,angular_flex_layout_flex.xw,angular_flex_layout_flex.yH,angular_flex_layout_flex.Wh,common.PC,angular_flex_layout_extended.Zl],pipes:[MomentDatePipe],styles:[".channel-overlay[_ngcontent-%COMP%]{position:absolute;bottom:35px;width:100%;background:#2c2b2fdc;min-height:130px;max-height:165px;margin-left:auto;margin-right:auto;left:0;right:0;backdrop-filter:blur(10px)}.program-name[_ngcontent-%COMP%], .program-description[_ngcontent-%COMP%]{margin:20px 0;display:-webkit-box;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis}.channel-logo[_ngcontent-%COMP%]{margin-top:20px}.program-progress[_ngcontent-%COMP%]{width:96%;background:#ccc;height:20px;margin-bottom:8px}.program-name[_ngcontent-%COMP%]{width:96%;max-height:20px;-webkit-line-clamp:1}.program-description[_ngcontent-%COMP%]{width:96%;max-height:55px;-webkit-line-clamp:3}.program-finished[_ngcontent-%COMP%]{background:#717171;height:20px;font-size:.8em;padding-left:10px;color:#000;line-height:20px}.duration[_ngcontent-%COMP%]{position:relative;top:-18px;font-size:.8em;color:#000;left:10px}.visible[_ngcontent-%COMP%]{visibility:visible;opacity:1}.hidden[_ngcontent-%COMP%]{visibility:hidden;opacity:0;transition:visibility 0s 2s,opacity 2s linear}"]}),InfoOverlayComponent}(),ipc_commands=__webpack_require__(8144),data_service=__webpack_require__(23798),divider=__webpack_require__(85694),fesm2020_button=__webpack_require__(90086),tooltip=__webpack_require__(87444),icon=__webpack_require__(59112),list=__webpack_require__(42663),fesm2020_core=__webpack_require__(6731),dialog=__webpack_require__(15304),ngx_translate_core=__webpack_require__(48292);function EpgItemDescriptionComponent_ng_container_6_Template(rf,ctx){if(1&rf&&(core.ynx(0),core._uU(1,"\n        "),core.TgZ(2,"div",5),core._uU(3),core.ALo(4,"translate"),core.qZA(),core._uU(5,"\n        "),core.TgZ(6,"p",6),core._uU(7),core.qZA(),core._uU(8,"\n        "),core.TgZ(9,"div",5),core._uU(10),core.ALo(11,"translate"),core.qZA(),core._uU(12,"\n        "),core.TgZ(13,"p",7),core._uU(14),core.qZA(),core._uU(15,"\n    "),core.BQk()),2&rf){var ctx_r0=core.oxw();core.xp6(3),core.hij("\n            ",core.lcZ(4,4,"EPG.PROGRAM_DIALOG.TITLE"),"\n        "),core.xp6(4),core.Oqu(ctx_r0.epgProgram.title[0].value),core.xp6(3),core.hij("\n            ",core.lcZ(11,6,"EPG.PROGRAM_DIALOG.LANGUAGE"),"\n        "),core.xp6(4),core.Oqu(ctx_r0.epgProgram.title[0].lang)}}function EpgItemDescriptionComponent_ng_container_8_Template(rf,ctx){if(1&rf&&(core.ynx(0),core._uU(1,"\n        "),core.TgZ(2,"div",5),core._uU(3),core.ALo(4,"translate"),core.qZA(),core._uU(5,"\n        "),core.TgZ(6,"p",8),core._uU(7),core.qZA(),core._uU(8,"\n    "),core.BQk()),2&rf){var ctx_r1=core.oxw();core.xp6(3),core.hij("\n            ",core.lcZ(4,2,"EPG.PROGRAM_DIALOG.CATEGORY"),"\n        "),core.xp6(4),core.Oqu(ctx_r1.epgProgram.category[0].value)}}function EpgItemDescriptionComponent_ng_container_10_Template(rf,ctx){if(1&rf&&(core.ynx(0),core._uU(1,"\n        "),core.TgZ(2,"div",5),core._uU(3),core.ALo(4,"translate"),core.qZA(),core._uU(5,"\n        "),core.TgZ(6,"p",9),core._uU(7),core.qZA(),core._uU(8,"\n    "),core.BQk()),2&rf){var ctx_r2=core.oxw();core.xp6(3),core.hij("\n            ",core.lcZ(4,2,"EPG.PROGRAM_DIALOG.DESCRIPTION"),"\n        "),core.xp6(4),core.Oqu(ctx_r2.epgProgram.desc[0].value)}}function EpgItemDescriptionComponent_ng_container_12_Template(rf,ctx){if(1&rf&&(core.ynx(0),core._uU(1,"\n        "),core.TgZ(2,"div",5),core._uU(3),core.ALo(4,"translate"),core.qZA(),core._uU(5,"\n        "),core.TgZ(6,"p",10),core._uU(7),core.qZA(),core._uU(8,"\n    "),core.BQk()),2&rf){var ctx_r3=core.oxw();core.xp6(3),core.hij("\n            ",core.lcZ(4,3,"EPG.PROGRAM_DIALOG.PARENTAL_RATING_SYSTEM"),"\n        "),core.xp6(4),core.AsE("\n            ",ctx_r3.epgProgram.rating[0].value," [",ctx_r3.epgProgram.rating[0].system,"]\n        ")}}var EpgItemDescriptionComponent=function(){var EpgItemDescriptionComponent=(0,createClass.Z)(function EpgItemDescriptionComponent(epgProgram){(0,classCallCheck.Z)(this,EpgItemDescriptionComponent),this.epgProgram=epgProgram});return EpgItemDescriptionComponent.\u0275fac=function(t){return new(t||EpgItemDescriptionComponent)(core.Y36(dialog.WI))},EpgItemDescriptionComponent.\u0275cmp=core.Xpm({type:EpgItemDescriptionComponent,selectors:[["app-epg-item-description"]],decls:22,vars:10,consts:[["mat-dialog-title",""],[1,"mat-typography"],[4,"ngIf"],["align","end"],["mat-button","","mat-dialog-close","","cdkFocusInitial","","color","accent"],[1,"subheading-2"],["data-test","title"],["data-test","lang"],["data-test","category"],["data-test","desc"],["data-test","rating"]],template:function(rf,ctx){1&rf&&(core.TgZ(0,"h2",0),core._uU(1),core.ALo(2,"translate"),core.qZA(),core._uU(3,"\n"),core.TgZ(4,"mat-dialog-content",1),core._uU(5,"\n    "),core.YNc(6,EpgItemDescriptionComponent_ng_container_6_Template,16,8,"ng-container",2),core._uU(7,"\n    "),core.YNc(8,EpgItemDescriptionComponent_ng_container_8_Template,9,4,"ng-container",2),core._uU(9,"\n    "),core.YNc(10,EpgItemDescriptionComponent_ng_container_10_Template,9,4,"ng-container",2),core._uU(11,"\n    "),core.YNc(12,EpgItemDescriptionComponent_ng_container_12_Template,9,5,"ng-container",2),core._uU(13,"\n"),core.qZA(),core._uU(14,"\n"),core.TgZ(15,"mat-dialog-actions",3),core._uU(16,"\n    "),core.TgZ(17,"button",4),core._uU(18),core.ALo(19,"translate"),core.qZA(),core._uU(20,"\n"),core.qZA(),core._uU(21,"\n")),2&rf&&(core.xp6(1),core.hij("\n    ",core.lcZ(2,6,"EPG.PROGRAM_DIALOG.PROGRAM_DETAILS"),"\n"),core.xp6(5),core.Q6J("ngIf",(null==ctx.epgProgram||null==ctx.epgProgram.title?null:ctx.epgProgram.title.length)>0),core.xp6(2),core.Q6J("ngIf",(null==ctx.epgProgram||null==ctx.epgProgram.category?null:ctx.epgProgram.category.length)>0),core.xp6(2),core.Q6J("ngIf",(null==ctx.epgProgram||null==ctx.epgProgram.desc?null:ctx.epgProgram.desc.length)>0),core.xp6(2),core.Q6J("ngIf",(null==ctx.epgProgram||null==ctx.epgProgram.rating?null:ctx.epgProgram.rating.length)>0),core.xp6(6),core.hij("\n        ",core.lcZ(19,8,"HOME.PLAYLISTS.INFO_DIALOG.CLOSE"),"\n    "))},directives:[dialog.uh,dialog.xY,common.O5,dialog.H8,fesm2020_button.lW,dialog.ZT],pipes:[ngx_translate_core.X$],styles:[".subheading-2[_ngcontent-%COMP%]{color:#666;text-decoration:underline;text-transform:uppercase;font-weight:900;font-size:.9em}  .dark-theme .subheading-2{color:#bdbdbd}"]}),EpgItemDescriptionComponent}();function EpgListItemComponent_span_5_Template(rf,ctx){1&rf&&(core.TgZ(0,"span",4),core.ALo(1,"translate"),core._uU(2,"live"),core.qZA()),2&rf&&core.Q6J("matTooltip",core.lcZ(1,1,"EPG.LIVE_NOW"))}function EpgListItemComponent_span_7_Template(rf,ctx){1&rf&&(core.TgZ(0,"span",5),core.ALo(1,"translate"),core._uU(2,"r"),core.qZA()),2&rf&&core.Q6J("matTooltip",core.lcZ(1,1,"EPG.TIMESHIFT_AVAILABLE"))}function EpgListItemComponent_span_9_Template(rf,ctx){if(1&rf){var _r4=core.EpF();core.TgZ(0,"span",6),core.NdJ("click",function($event){core.CHM(_r4);var ctx_r3=core.oxw();return $event.stopPropagation(),ctx_r3.showDescription(ctx_r3.item)}),core.ALo(1,"translate"),core.TgZ(2,"mat-icon"),core._uU(3,"info"),core.qZA(),core.qZA()}2&rf&&core.Q6J("matTooltip",core.lcZ(1,1,"EPG.PROGRAM_DIALOG.SHOW_PROGRAM_DETAILS"))}var EpgListItemComponent=function(){var EpgListItemComponent=function(){function EpgListItemComponent(dialog){(0,classCallCheck.Z)(this,EpgListItemComponent),this.dialog=dialog}return(0,createClass.Z)(EpgListItemComponent,[{key:"showDescription",value:function(program){this.dialog.open(EpgItemDescriptionComponent,{data:program})}}]),EpgListItemComponent}();return EpgListItemComponent.\u0275fac=function(t){return new(t||EpgListItemComponent)(core.Y36(dialog.uw))},EpgListItemComponent.\u0275cmp=core.Xpm({type:EpgListItemComponent,selectors:[["app-epg-list-item"]],inputs:{item:"item",timeNow:"timeNow",timeshiftUntil:"timeshiftUntil"},decls:13,vars:13,consts:[[1,"time"],["class","live badge",3,"matTooltip",4,"ngIf"],["class","rec badge",3,"matTooltip",4,"ngIf"],["class","description-icon",3,"matTooltip","click",4,"ngIf"],[1,"live","badge",3,"matTooltip"],[1,"rec","badge",3,"matTooltip"],[1,"description-icon",3,"matTooltip","click"]],template:function(rf,ctx){1&rf&&(core.TgZ(0,"span",0),core._uU(1),core.ALo(2,"momentDate"),core.ALo(3,"momentDate"),core.qZA(),core._uU(4,"\n"),core.YNc(5,EpgListItemComponent_span_5_Template,3,3,"span",1),core._uU(6,"\n"),core.YNc(7,EpgListItemComponent_span_7_Template,3,3,"span",2),core._uU(8,"\n"),core.YNc(9,EpgListItemComponent_span_9_Template,4,3,"span",3),core._uU(10,"\n"),core._UZ(11,"mat-divider"),core._uU(12,"\n")),2&rf&&(core.xp6(1),core.AsE("",core.Dn7(2,5,ctx.item.start,"YYYYMMDDHHmm ZZ","HH:mm"),"\n    -\n    ",core.Dn7(3,9,ctx.item.stop,"YYYYMMDDHHmm ZZ","HH:mm"),""),core.xp6(4),core.Q6J("ngIf",ctx.timeNow>=ctx.item.start&&ctx.timeNow<=ctx.item.stop),core.xp6(2),core.Q6J("ngIf",ctx.item.start<ctx.timeNow&&ctx.item.stop<ctx.timeNow&&ctx.item.start>ctx.timeshiftUntil),core.xp6(2),core.Q6J("ngIf",ctx.item.desc.length>0))},directives:[common.O5,divider.d,tooltip.gM,icon.Hw],pipes:[MomentDatePipe,ngx_translate_core.X$],styles:[".time[_ngcontent-%COMP%]{color:#666;border-bottom:1px solid #ccc;font-size:.8em;display:inline-block;margin-bottom:5px}.badge[_ngcontent-%COMP%]{border-radius:2px;padding:2px 6px;color:#fff;text-transform:uppercase;margin-left:6px;font-size:.8em}.live[_ngcontent-%COMP%]{background-color:red}.rec[_ngcontent-%COMP%]{background-color:gray}.description-icon[_ngcontent-%COMP%]{float:right;cursor:pointer}"]}),EpgListItemComponent}();function EpgListComponent_ng_container_0_img_9_Template(rf,ctx){if(1&rf&&core._UZ(0,"img",13),2&rf){var ctx_r3=core.oxw(2);core.Q6J("src",ctx_r3.channel.icon,core.LSH)}}function EpgListComponent_ng_container_0_mat_selection_list_50_ng_container_2_ng_container_2_mat_list_item_2_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"mat-list-item"),core._uU(1,"\n                    "),core.TgZ(2,"div",18),core._uU(3,"\n                        "),core._UZ(4,"app-epg-list-item",19),core._uU(5,"\n                    "),core.qZA(),core._uU(6,"\n                    "),core.TgZ(7,"p",18),core._uU(8),core.qZA(),core._uU(9,"\n                "),core.qZA()),2&rf){var item_r10=core.oxw().$implicit,timeshiftUntil_r5=core.oxw(2).ngIf,ctx_r11=core.oxw(2);core.xp6(4),core.Q6J("timeshiftUntil",timeshiftUntil_r5)("timeNow",ctx_r11.timeNow)("item",item_r10),core.xp6(4),core.Oqu(null==item_r10||null==item_r10.title[0]?null:item_r10.title[0].value)}}function EpgListComponent_ng_container_0_mat_selection_list_50_ng_container_2_ng_container_2_ng_template_4_Template(rf,ctx){if(1&rf){var _r18=core.EpF();core._uU(0,"\n                    "),core.TgZ(1,"mat-list-option",20),core.NdJ("click",function(){core.CHM(_r18);var item_r10=core.oxw().$implicit,timeshiftUntil_r5=core.oxw(2).ngIf,ctx_r16=core.oxw(2);return ctx_r16.setEpgProgram(item_r10,ctx_r16.timeNow>=item_r10.start&&ctx_r16.timeNow<=item_r10.stop,item_r10.start>timeshiftUntil_r5)}),core._uU(2,"\n                        "),core.TgZ(3,"div",18),core._uU(4,"\n                            "),core._UZ(5,"app-epg-list-item",19),core._uU(6,"\n                        "),core.qZA(),core._uU(7,"\n                        "),core.TgZ(8,"p",18),core._uU(9),core.qZA(),core._uU(10,"\n                    "),core.qZA(),core._uU(11,"\n                ")}if(2&rf){var item_r10=core.oxw().$implicit,timeshiftUntil_r5=core.oxw(2).ngIf,ctx_r13=core.oxw(2);core.xp6(1),core.ekj("active",ctx_r13.timeNow>=item_r10.start&&ctx_r13.timeNow<=item_r10.stop),core.Q6J("value",item_r10),core.xp6(4),core.Q6J("timeshiftUntil",timeshiftUntil_r5)("timeNow",ctx_r13.timeNow)("item",item_r10),core.xp6(4),core.Oqu(null==item_r10||null==item_r10.title[0]?null:item_r10.title[0].value)}}function EpgListComponent_ng_container_0_mat_selection_list_50_ng_container_2_ng_container_2_Template(rf,ctx){if(1&rf&&(core.ynx(0),core._uU(1,"\n                "),core.YNc(2,EpgListComponent_ng_container_0_mat_selection_list_50_ng_container_2_ng_container_2_mat_list_item_2_Template,10,4,"mat-list-item",0),core._uU(3,"\n                "),core.YNc(4,EpgListComponent_ng_container_0_mat_selection_list_50_ng_container_2_ng_container_2_ng_template_4_Template,12,7,"ng-template",null,17,core.W1O),core._uU(6,"\n            "),core.BQk()),2&rf){var item_r10=ctx.$implicit,_r12=core.MAs(5),timeshiftUntil_r5=core.oxw(2).ngIf,ctx_r9=core.oxw(2);core.xp6(2),core.Q6J("ngIf",item_r10.start<timeshiftUntil_r5||item_r10.start>=ctx_r9.timeNow)("ngIfElse",_r12)}}function EpgListComponent_ng_container_0_mat_selection_list_50_ng_container_2_Template(rf,ctx){if(1&rf&&(core.ynx(0),core._uU(1,"\n            "),core.YNc(2,EpgListComponent_ng_container_0_mat_selection_list_50_ng_container_2_ng_container_2_Template,7,2,"ng-container",16),core._uU(3,"\n        "),core.BQk()),2&rf){var ctx_r6=core.oxw(3);core.xp6(2),core.Q6J("ngForOf",ctx_r6.items)}}function EpgListComponent_ng_container_0_mat_selection_list_50_ng_template_4_Template(rf,ctx){1&rf&&(core._uU(0,"\n            "),core.TgZ(1,"mat-list-option"),core._uU(2),core.ALo(3,"translate"),core.qZA(),core._uU(4,"\n        ")),2&rf&&(core.xp6(2),core.Oqu(core.lcZ(3,1,"EPG.EPG_NOT_AVAILABLE_DATE")))}function EpgListComponent_ng_container_0_mat_selection_list_50_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"mat-selection-list",14),core._uU(1,"\n        "),core.YNc(2,EpgListComponent_ng_container_0_mat_selection_list_50_ng_container_2_Template,4,1,"ng-container",0),core._uU(3,"\n        "),core.YNc(4,EpgListComponent_ng_container_0_mat_selection_list_50_ng_template_4_Template,5,3,"ng-template",null,15,core.W1O),core._uU(6,"\n    "),core.qZA()),2&rf){var _r7=core.MAs(5),ctx_r4=core.oxw(2);core.Q6J("multiple",!1),core.xp6(2),core.Q6J("ngIf",(null==ctx_r4.items?null:ctx_r4.items.length)>0)("ngIfElse",_r7)}}function EpgListComponent_ng_container_0_Template(rf,ctx){if(1&rf){var _r24=core.EpF();core.ynx(0),core._uU(1,"\n    "),core._uU(2,"\n    "),core.TgZ(3,"div",2),core._uU(4,"\n        "),core.TgZ(5,"div",3),core._uU(6,"\n            "),core.TgZ(7,"div",4),core._uU(8,"\n                "),core.YNc(9,EpgListComponent_ng_container_0_img_9_Template,1,1,"img",5),core._uU(10,"\n            "),core.qZA(),core._uU(11,"\n            "),core.TgZ(12,"div",6),core._uU(13,"\n                "),core.TgZ(14,"div",7),core._uU(15),core.qZA(),core._uU(16,"\n                "),core.TgZ(17,"div",8),core._uU(18),core.ALo(19,"translate"),core.qZA(),core._uU(20,"\n            "),core.qZA(),core._uU(21,"\n        "),core.qZA(),core._uU(22,"\n        "),core._UZ(23,"mat-divider"),core._uU(24,"\n        "),core.TgZ(25,"div",9),core._uU(26,"\n            "),core.TgZ(27,"button",10),core.NdJ("click",function(){return core.CHM(_r24),core.oxw().changeDate("prev")}),core.ALo(28,"translate"),core._uU(29,"\n                "),core.TgZ(30,"mat-icon"),core._uU(31,"chevron_left"),core.qZA(),core._uU(32,"\n            "),core.qZA(),core._uU(33,"\n            "),core.TgZ(34,"span",11),core._uU(35),core.ALo(36,"momentDate"),core.qZA(),core._uU(37,"\n            "),core.TgZ(38,"button",10),core.NdJ("click",function(){return core.CHM(_r24),core.oxw().changeDate("next")}),core.ALo(39,"translate"),core._uU(40,"\n                "),core.TgZ(41,"mat-icon"),core._uU(42,"chevron_right"),core.qZA(),core._uU(43,"\n            "),core.qZA(),core._uU(44,"\n        "),core.qZA(),core._uU(45,"\n    "),core.qZA(),core._uU(46,"\n    "),core._UZ(47,"mat-divider"),core._uU(48,"\n\n    "),core._uU(49,"\n    "),core.YNc(50,EpgListComponent_ng_container_0_mat_selection_list_50_Template,7,3,"mat-selection-list",12),core.ALo(51,"async"),core._uU(52,"\n"),core.BQk()}if(2&rf){var ctx_r0=core.oxw();core.xp6(9),core.Q6J("ngIf",null==ctx_r0.channel?null:ctx_r0.channel.icon),core.xp6(6),core.hij("\n                    ",null==ctx_r0.channel||null==ctx_r0.channel.name[0]?null:ctx_r0.channel.name[0].value,"\n                "),core.xp6(3),core.hij("\n                    ",ctx_r0.playingNow?null==ctx_r0.playingNow.title[0]?null:ctx_r0.playingNow.title[0].value:core.lcZ(19,7,"EPG.LIVE_STREAM"),"\n                "),core.xp6(9),core.Q6J("matTooltip",core.lcZ(28,9,"EPG.PREVIOUS_DAY")),core.xp6(8),core.hij("\n                ",core.Dn7(36,11,ctx_r0.dateToday,"YYYYMMDD","MMMM Do, dddd"),""),core.xp6(3),core.Q6J("matTooltip",core.lcZ(39,15,"EPG.NEXT_DAY")),core.xp6(12),core.Q6J("ngIf",core.lcZ(51,17,ctx_r0.timeshiftUntil$))}}function EpgListComponent_ng_template_2_Template(rf,ctx){1&rf&&(core._uU(0,"\n    "),core.TgZ(1,"mat-list"),core._uU(2,"\n        "),core.TgZ(3,"mat-list-item"),core._uU(4),core.ALo(5,"translate"),core._UZ(6,"br"),core._uU(7),core.ALo(8,"translate"),core.qZA(),core._uU(9,"\n    "),core.qZA(),core._uU(10,"\n")),2&rf&&(core.xp6(4),core.hij("\n            ",core.lcZ(5,2,"EPG.EPG_NOT_AVAILABLE_CHANNEL_TITLE"),""),core.xp6(3),core.hij("\n            ",core.lcZ(8,4,"EPG.EPG_NOT_AVAILABLE_CHANNEL_DESCRIPTION"),"\n        "))}var EpgListComponent=function(){var EpgListComponent=function(){function EpgListComponent(channelQuery,channelStore,electronService,ngZone){var _this=this;(0,classCallCheck.Z)(this,EpgListComponent),this.channelQuery=channelQuery,this.channelStore=channelStore,this.electronService=electronService,this.ngZone=ngZone,this.items=[],this.electronService.listenOn(ipc_commands.bU,function(event,response){_this.ngZone.run(function(){return _this.handleEpgData(response)})})}return(0,createClass.Z)(EpgListComponent,[{key:"ngOnInit",value:function(){this.timeshiftUntil$=this.channelQuery.select(function(store){var _a;return store.active.tvg.rec||store.active.timeshift||(null===(_a=store.active.catchup)||void 0===_a?void 0:_a.days)}).pipe((0,operators.UI)(function(value){return moment(Date.now()).subtract(value,"days").format("YYYYMMDDHHmm ZZ")}))}},{key:"handleEpgData",value:function(programs){var _a,_b,_c;(null===(_b=null===(_a=null==programs?void 0:programs.payload)||void 0===_a?void 0:_a.items)||void 0===_b?void 0:_b.length)>0?(this.programs=programs,this.timeNow=moment(Date.now()).format("YYYYMMDDHHmm ZZ"),this.dateToday=moment(Date.now()).format("YYYYMMDD"),this.channel=null===(_c=programs.payload)||void 0===_c?void 0:_c.channel,this.items=this.selectPrograms(programs),this.setPlayingNow()):(this.items=[],this.channel=null,this.channelStore.setCurrentEpgProgram(void 0))}},{key:"selectPrograms",value:function(programs){var _a,_this2=this;return null===(_a=programs.payload)||void 0===_a?void 0:_a.items.filter(function(item){return item.start.includes(_this2.dateToday.toString())}).map(function(program){return Object.assign(Object.assign({},program),{start:moment(program.start,"YYYYMMDDHHmm ZZ").format("YYYYMMDDHHmm ZZ"),stop:moment(program.stop,"YYYYMMDDHHmm ZZ").format("YYYYMMDDHHmm ZZ")})}).sort(function(a,b){return a.start.localeCompare(b.start)})}},{key:"changeDate",value:function(direction){var dateToSwitch;"next"===direction?dateToSwitch=moment(this.dateToday,"YYYYMMDD").add(1,"days").format("YYYYMMDD"):"prev"===direction&&(dateToSwitch=moment(this.dateToday,"YYYYMMDD").subtract(1,"days").format("YYYYMMDD")),this.dateToday=dateToSwitch,this.items=this.selectPrograms(this.programs)}},{key:"setPlayingNow",value:function(){var _this3=this;this.playingNow=this.items.find(function(item){return _this3.timeNow>=item.start&&_this3.timeNow<=item.stop}),this.channelStore.setCurrentEpgProgram(this.playingNow)}},{key:"setEpgProgram",value:function(program,isLive,timeshift){if(isLive)this.channelStore.resetActiveEpgProgram();else{if(!timeshift)return;this.channelStore.setActiveEpgProgram(program)}this.playingNow=program}},{key:"ngOnDestroy",value:function(){this.electronService.removeAllListeners(ipc_commands.bU)}}]),EpgListComponent}();return EpgListComponent.\u0275fac=function(t){return new(t||EpgListComponent)(core.Y36(state.p8),core.Y36(state.b4),core.Y36(data_service.D),core.Y36(core.R0b))},EpgListComponent.\u0275cmp=core.Xpm({type:EpgListComponent,selectors:[["app-epg-list"]],decls:5,vars:2,consts:[[4,"ngIf","ngIfElse"],["noEpg",""],["fxFlex","120px","id","channel-info","color","primary","fxLayout","column"],["fxFlex","79px","fxLayout","row","fxLayoutGap","10px"],["fxFlex","60px","fxLayoutAlign","center center",1,"channel-icon"],["width","48",3,"src",4,"ngIf"],["fxFlex","100","fxFlexAlign","center"],[1,"channel-name"],[1,"program-name"],["fxFlex","40px","fxLayout","row","id","date-navigator"],["fxFlex","40px","mat-icon-button","",3,"matTooltip","click"],["fxFlex","100","fxLayoutAlign","center center",1,"selected-date"],["fxFlex","",3,"multiple",4,"ngIf"],["width","48",3,"src"],["fxFlex","",3,"multiple"],["epgNotAvailable",""],[4,"ngFor","ngForOf"],["timeshiftItem",""],["matLine",""],[3,"timeshiftUntil","timeNow","item"],[3,"value","click"]],template:function(rf,ctx){if(1&rf&&(core.YNc(0,EpgListComponent_ng_container_0_Template,53,19,"ng-container",0),core._uU(1,"\n\n"),core.YNc(2,EpgListComponent_ng_template_2_Template,11,6,"ng-template",null,1,core.W1O),core._uU(4,"\n")),2&rf){var _r1=core.MAs(3);core.Q6J("ngIf",ctx.channel)("ngIfElse",_r1)}},directives:[common.O5,angular_flex_layout_flex.yH,angular_flex_layout_flex.xw,angular_flex_layout_flex.SQ,angular_flex_layout_flex.Wh,angular_flex_layout_flex.XD,divider.d,fesm2020_button.lW,tooltip.gM,icon.Hw,list.Ub,common.sg,list.Tg,fesm2020_core.X2,EpgListItemComponent,list.vS,list.i$],pipes:[ngx_translate_core.X$,MomentDatePipe,common.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;position:absolute;top:0;right:0;left:0;bottom:0;height:100%}.active[_ngcontent-%COMP%]{border-bottom:1px dashed #666}#channel-info[_ngcontent-%COMP%]   .channel-icon[_ngcontent-%COMP%]{overflow:hidden}#channel-info[_ngcontent-%COMP%]   .channel-name[_ngcontent-%COMP%]{font-weight:800}#channel-info[_ngcontent-%COMP%]   .program-name[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;font-size:.9em}mat-selection-list[_ngcontent-%COMP%]{overflow:auto}#date-navigator[_ngcontent-%COMP%]   .selected-date[_ngcontent-%COMP%]{font-size:.9em}"]}),EpgListComponent}(),lodash=__webpack_require__(3132),tabs=__webpack_require__(12605),fesm2020_forms=__webpack_require__(49133),router=__webpack_require__(57725),scrolling=__webpack_require__(97226),expansion=__webpack_require__(53050),ngx_filter_pipe=__webpack_require__(9544),channel_list_container_component_c0=["search"];function ChannelListContainerComponent_mat_list_item_28_img_2_Template(rf,ctx){if(1&rf&&core._UZ(0,"img",13),2&rf){var channel_r4=core.oxw().$implicit;core.Q6J("src",channel_r4.tvg.logo,core.LSH)}}function ChannelListContainerComponent_mat_list_item_28_Template(rf,ctx){if(1&rf){var _r9=core.EpF();core.TgZ(0,"mat-list-item",10),core.NdJ("click",function(){var channel_r4=core.CHM(_r9).$implicit;return core.oxw().selectChannel(channel_r4)}),core._uU(1,"\n                    "),core.YNc(2,ChannelListContainerComponent_mat_list_item_28_img_2_Template,1,1,"img",11),core._uU(3,"\n                    "),core.TgZ(4,"p",12),core._uU(5),core.ALo(6,"translate"),core.qZA(),core._uU(7,"\n                    "),core._UZ(8,"mat-divider"),core._uU(9,"\n                "),core.qZA()}if(2&rf){var channel_r4=ctx.$implicit,i_r5=ctx.index,ctx_r1=core.oxw();core.ekj("active",(null==ctx_r1.selected?null:ctx_r1.selected.id)===channel_r4.id),core.xp6(2),core.Q6J("ngIf",channel_r4.tvg.logo),core.xp6(3),core.hij("\n                        ",i_r5+1+". "+(null==channel_r4?null:channel_r4.name)||core.lcZ(6,4,"CHANNELS.UNNAMED_CHANNEL"),"\n                    ")}}function ChannelListContainerComponent_ng_container_41_mat_expansion_panel_header_4_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"mat-expansion-panel-header"),core._uU(1),core.ALo(2,"titlecase"),core.ALo(3,"translate"),core.qZA()),2&rf){var groups_r10=core.oxw().$implicit;core.xp6(1),core.AsE("\n                            ",core.lcZ(2,2,groups_r10.key||core.lcZ(3,4,"CHANNELS.UNGROUPED")),"\n                            (",groups_r10.value.length,")\n                        ")}}function ChannelListContainerComponent_ng_container_41_ng_template_6_mat_list_item_1_img_2_Template(rf,ctx){if(1&rf&&core._UZ(0,"img",13),2&rf){var channel_r15=core.oxw().$implicit;core.Q6J("src",channel_r15.tvg.logo,core.LSH)}}function ChannelListContainerComponent_ng_container_41_ng_template_6_mat_list_item_1_Template(rf,ctx){if(1&rf){var _r20=core.EpF();core.TgZ(0,"mat-list-item",10),core.NdJ("click",function(){var channel_r15=core.CHM(_r20).$implicit;return core.oxw(3).selectChannel(channel_r15)}),core._uU(1,"\n                                "),core.YNc(2,ChannelListContainerComponent_ng_container_41_ng_template_6_mat_list_item_1_img_2_Template,1,1,"img",11),core._uU(3,"\n                                "),core.TgZ(4,"p",12),core._uU(5),core.ALo(6,"translate"),core.qZA(),core._uU(7,"\n                                "),core._UZ(8,"mat-divider"),core._uU(9,"\n                            "),core.qZA()}if(2&rf){var channel_r15=ctx.$implicit,i_r16=ctx.index,ctx_r14=core.oxw(3);core.ekj("active",(null==ctx_r14.selected?null:ctx_r14.selected.id)===channel_r15.id),core.xp6(2),core.Q6J("ngIf",channel_r15.tvg.logo),core.xp6(3),core.hij("\n                                    ",i_r16+1+". "+(null==channel_r15?null:channel_r15.name)||core.lcZ(6,4,"CHANNELS.UNNAMED_CHANNEL"),"\n                                ")}}function ChannelListContainerComponent_ng_container_41_ng_template_6_Template(rf,ctx){if(1&rf&&(core._uU(0,"\n                            "),core.YNc(1,ChannelListContainerComponent_ng_container_41_ng_template_6_mat_list_item_1_Template,10,6,"mat-list-item",16),core._uU(2,"\n                        ")),2&rf){var groups_r10=core.oxw().$implicit;core.xp6(1),core.Q6J("ngForOf",groups_r10.value)}}function ChannelListContainerComponent_ng_container_41_Template(rf,ctx){if(1&rf&&(core.ynx(0),core._uU(1,"\n                    "),core.TgZ(2,"mat-expansion-panel"),core._uU(3,"\n                        "),core.YNc(4,ChannelListContainerComponent_ng_container_41_mat_expansion_panel_header_4_Template,4,6,"mat-expansion-panel-header",14),core._uU(5,"\n                        "),core.YNc(6,ChannelListContainerComponent_ng_container_41_ng_template_6_Template,3,1,"ng-template",15),core._uU(7,"\n                    "),core.qZA(),core._uU(8,"\n                "),core.BQk()),2&rf){var groups_r10=ctx.$implicit;core.xp6(4),core.Q6J("ngIf",groups_r10.value.length>0)}}function ChannelListContainerComponent_mat_nav_list_50_ng_container_2_mat_list_item_2_img_2_Template(rf,ctx){if(1&rf&&core._UZ(0,"img",13),2&rf){var channel_r27=core.oxw().$implicit;core.Q6J("src",channel_r27.tvg.logo,core.LSH)}}function ChannelListContainerComponent_mat_nav_list_50_ng_container_2_mat_list_item_2_Template(rf,ctx){if(1&rf){var _r32=core.EpF();core.TgZ(0,"mat-list-item",10),core.NdJ("click",function(){var channel_r27=core.CHM(_r32).$implicit;return core.oxw(3).selectChannel(channel_r27)}),core._uU(1,"\n                    "),core.YNc(2,ChannelListContainerComponent_mat_nav_list_50_ng_container_2_mat_list_item_2_img_2_Template,1,1,"img",11),core._uU(3,"\n                    "),core.TgZ(4,"p",12),core._uU(5),core.ALo(6,"translate"),core.qZA(),core._uU(7,"\n                    "),core.TgZ(8,"button",20),core.NdJ("click",function($event){var channel_r27=core.CHM(_r32).$implicit;return core.oxw(3).toggleFavoriteChannel(channel_r27,$event)}),core.ALo(9,"translate"),core._uU(10,"\n                        "),core.TgZ(11,"mat-icon",21),core._uU(12,"star"),core.qZA(),core._uU(13,"\n                    "),core.qZA(),core._uU(14,"\n                    "),core._UZ(15,"mat-divider"),core._uU(16,"\n                "),core.qZA()}if(2&rf){var channel_r27=ctx.$implicit,i_r28=ctx.index,ctx_r26=core.oxw(3);core.ekj("active",(null==ctx_r26.selected?null:ctx_r26.selected.id)===channel_r27.id),core.xp6(2),core.Q6J("ngIf",channel_r27.tvg.logo),core.xp6(3),core.hij("\n                        ",i_r28+1+". "+(null==channel_r27?null:channel_r27.name)||core.lcZ(6,5,"CHANNELS.UNNAMED_CHANNEL"),"\n                    "),core.xp6(3),core.Q6J("matTooltip",core.lcZ(9,7,"CHANNELS.REMOVE_FAVORITE"))}}function ChannelListContainerComponent_mat_nav_list_50_ng_container_2_Template(rf,ctx){if(1&rf&&(core.ynx(0),core._uU(1,"\n                "),core.YNc(2,ChannelListContainerComponent_mat_nav_list_50_ng_container_2_mat_list_item_2_Template,17,9,"mat-list-item",16),core._uU(3,"\n            "),core.BQk()),2&rf){var favorites_r22=core.oxw().ngIf;core.xp6(2),core.Q6J("ngForOf",favorites_r22)}}function ChannelListContainerComponent_mat_nav_list_50_ng_template_4_Template(rf,ctx){1&rf&&(core._uU(0,"\n                "),core.TgZ(1,"mat-list-item"),core.TgZ(2,"strong"),core._uU(3),core.ALo(4,"translate"),core.qZA(),core.qZA(),core._uU(5,"\n                "),core.TgZ(6,"mat-list-item"),core._uU(7),core.ALo(8,"translate"),core.qZA(),core._uU(9,"\n            ")),2&rf&&(core.xp6(3),core.Oqu(core.lcZ(4,2,"CHANNELS.NO_FAVORITES")),core.xp6(4),core.hij("\n                    ",core.lcZ(8,4,"CHANNELS.USE_STAR_TO_FAVORITE"),""))}function ChannelListContainerComponent_mat_nav_list_50_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"mat-nav-list",17),core._uU(1,"\n            "),core.YNc(2,ChannelListContainerComponent_mat_nav_list_50_ng_container_2_Template,4,1,"ng-container",18),core._uU(3,"\n            "),core.YNc(4,ChannelListContainerComponent_mat_nav_list_50_ng_template_4_Template,10,6,"ng-template",null,19,core.W1O),core._uU(6,"\n        "),core.qZA()),2&rf){var favorites_r22=ctx.ngIf,_r24=core.MAs(5);core.xp6(2),core.Q6J("ngIf",favorites_r22.length>0)("ngIfElse",_r24)}}var ChannelListContainerComponent=function(){var ChannelListContainerComponent=function(){function ChannelListContainerComponent(channelQuery,channelStore,snackBar){var _this=this;(0,classCallCheck.Z)(this,ChannelListContainerComponent),this.channelQuery=channelQuery,this.channelStore=channelStore,this.snackBar=snackBar,this.favorites$=this.channelQuery.select(function(store){return _this.channelQuery.getAll().filter(function(channel){return store.favorites.includes(channel.id)})}),this.searchTerm={name:""}}return(0,createClass.Z)(ChannelListContainerComponent,[{key:"channelList",get:function(){return this._channelList},set:function(value){this._channelList=value,this.groupedChannels=lodash.groupBy(value,"group.title")}},{key:"handleKeyboardEvent",value:function(event){"f"===event.key&&event.ctrlKey&&this.searchElement.nativeElement.focus()}},{key:"selectChannel",value:function(channel){this.selected=channel,this.channelStore.setActiveChannel(channel)}},{key:"toggleFavoriteChannel",value:function(channel,clickEvent){clickEvent.stopPropagation(),this.snackBar.open("Favorites were updated!",null,{duration:2e3}),this.channelStore.updateFavorite(channel)}},{key:"trackByFn",value:function(index,channel){return channel.id}}]),ChannelListContainerComponent}();return ChannelListContainerComponent.\u0275fac=function(t){return new(t||ChannelListContainerComponent)(core.Y36(state.p8),core.Y36(state.b4),core.Y36(snack_bar.ux))},ChannelListContainerComponent.\u0275cmp=core.Xpm({type:ChannelListContainerComponent,selectors:[["app-channel-list-container"]],viewQuery:function(rf,ctx){var _t;1&rf&&core.Gf(channel_list_container_component_c0,5),2&rf&&core.iGM(_t=core.CRH())&&(ctx.searchElement=_t.first)},hostBindings:function(rf,ctx){1&rf&&core.NdJ("keypress",function($event){return ctx.handleKeyboardEvent($event)},!1,core.evT)},inputs:{channelList:"channelList"},decls:55,vars:28,consts:[[3,"label"],["type","search",1,"full-width","search-bar",3,"placeholder","ngModel","ngModelChange"],["search",""],["mat-icon-button","","routerLink","/",3,"matTooltip"],["itemSize","50",1,"scroll-viewport"],[3,"active","click",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],["id","groups-list"],["multi",""],[4,"ngFor","ngForOf"],["id","favorites-list",4,"ngIf"],[3,"click"],["width","48","onerror","this.style.display='none'",3,"src",4,"ngIf"],["matLine","",1,"channel-name"],["width","48","onerror","this.style.display='none'",3,"src"],[4,"ngIf"],["matExpansionPanelContent",""],[3,"active","click",4,"ngFor","ngForOf"],["id","favorites-list"],[4,"ngIf","ngIfElse"],["noFavorites",""],["mat-icon-button","","color","primary",3,"matTooltip","click"],["color","accent"]],template:function(rf,ctx){1&rf&&(core.TgZ(0,"mat-tab-group"),core._uU(1,"\n    "),core.TgZ(2,"mat-tab",0),core.ALo(3,"translate"),core._uU(4,"\n        "),core.TgZ(5,"mat-list"),core._uU(6,"\n            "),core.TgZ(7,"mat-list-item"),core._uU(8,"\n                "),core.TgZ(9,"input",1,2),core.NdJ("ngModelChange",function($event){return ctx.searchTerm.name=$event}),core.ALo(11,"translate"),core.qZA(),core._uU(12,"\n                "),core.TgZ(13,"button",3),core.ALo(14,"translate"),core._uU(15,"\n                    "),core.TgZ(16,"mat-icon"),core._uU(17,"create_new_folder"),core.qZA(),core._uU(18,"\n                "),core.qZA(),core._uU(19,"\n            "),core.qZA(),core._uU(20,"\n        "),core.qZA(),core._uU(21,"\n        "),core._UZ(22,"mat-divider"),core._uU(23,"\n        "),core.TgZ(24,"mat-nav-list"),core._uU(25,"\n            "),core.TgZ(26,"cdk-virtual-scroll-viewport",4),core._uU(27,"\n                "),core.YNc(28,ChannelListContainerComponent_mat_list_item_28_Template,10,6,"mat-list-item",5),core.ALo(29,"filterBy"),core._uU(30,"\n            "),core.qZA(),core._uU(31,"\n        "),core.qZA(),core._uU(32,"\n    "),core.qZA(),core._uU(33,"\n\n    "),core.TgZ(34,"mat-tab",0),core.ALo(35,"translate"),core._uU(36,"\n        "),core.TgZ(37,"mat-nav-list",6),core._uU(38,"\n            "),core.TgZ(39,"mat-accordion",7),core._uU(40,"\n                "),core.YNc(41,ChannelListContainerComponent_ng_container_41_Template,9,1,"ng-container",8),core.ALo(42,"keyvalue"),core._uU(43,"\n            "),core.qZA(),core._uU(44,"\n        "),core.qZA(),core._uU(45,"\n    "),core.qZA(),core._uU(46,"\n\n    "),core.TgZ(47,"mat-tab",0),core.ALo(48,"translate"),core._uU(49,"\n        "),core.YNc(50,ChannelListContainerComponent_mat_nav_list_50_Template,7,2,"mat-nav-list",9),core.ALo(51,"async"),core._uU(52,"\n    "),core.qZA(),core._uU(53,"\n"),core.qZA(),core._uU(54,"\n")),2&rf&&(core.xp6(2),core.Q6J("label",core.lcZ(3,11,"CHANNELS.ALL_CHANNELS")),core.xp6(7),core.hYB("placeholder","",core.lcZ(11,13,"CHANNELS.SEARCH_CHANNEL")," (",null==ctx._channelList?null:ctx._channelList.length,")"),core.Q6J("ngModel",ctx.searchTerm.name),core.xp6(4),core.Q6J("matTooltip",core.lcZ(14,15,"CHANNELS.UPLOAD_OR_SELECT_OTHER_PLAYLIST")),core.xp6(15),core.Q6J("cdkVirtualForOf",core.xi3(29,17,ctx._channelList,ctx.searchTerm))("cdkVirtualForTrackBy",ctx.trackByFn),core.xp6(6),core.Q6J("label",core.lcZ(35,20,"CHANNELS.GROUPS")),core.xp6(7),core.Q6J("ngForOf",core.lcZ(42,22,ctx.groupedChannels)),core.xp6(6),core.Q6J("label",core.lcZ(48,24,"CHANNELS.FAVORITES")),core.xp6(3),core.Q6J("ngIf",core.lcZ(51,26,ctx.favorites$)))},directives:[tabs.SP,tabs.uX,list.i$,list.Tg,fesm2020_forms.Fj,fesm2020_forms.JJ,fesm2020_forms.On,fesm2020_button.lW,router.rH,tooltip.gM,icon.Hw,divider.d,list.Hk,scrolling.N7,scrolling.xd,scrolling.x0,expansion.pp,common.sg,common.O5,fesm2020_core.X2,expansion.ib,expansion.HS,expansion.yz],pipes:[ngx_translate_core.X$,ngx_filter_pipe.g,common.Nd,common.Ov,common.rS],styles:[".active[_ngcontent-%COMP%]{background:#ddd}.mat-list-base[_ngcontent-%COMP%]{padding-top:0}  .mat-expansion-panel-body{padding:0!important}.scroll-viewport[_ngcontent-%COMP%]{min-height:calc(100vh - 142px)}.search-bar[_ngcontent-%COMP%]{padding:8px;background:#ddd;border:none;border-radius:4px}  .dark-theme .search-bar{background:#666;color:#fff}  .dark-theme .search-bar::placeholder{color:#ccc}  .dark-theme .active{background:#000}  .mat-tab-label-content{text-transform:uppercase}  .mat-expansion-panel{border-radius:0!important}  .mat-tab-label,   .mat-tab-label-active{min-width:0!important;padding:15px!important;margin:5px!important}.channel-name[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;font-size:.9em;width:290px}[type=search][_ngcontent-%COMP%]::-webkit-search-cancel-button{-webkit-appearance:none;cursor:pointer;appearance:none;height:10px;width:10px;background-image:url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+DQo8c3ZnIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHZpZXdCb3g9IjAgMCA5NiA5NiIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgOTYgOTYiIHhtbDpzcGFjZT0icHJlc2VydmUiPg0KPHBvbHlnb24gZmlsbD0iI2VlZSIgcG9pbnRzPSI5NiwxNCA4MiwwIDQ4LDM0IDE0LDAgMCwxNCAzNCw0OCAwLDgyIDE0LDk2IDQ4LDYyIDgyLDk2IDk2LDgyIDYyLDQ4ICIvPg0KPC9zdmc+DQo=);background-size:10px 10px;color:#fff}"]}),ChannelListContainerComponent}(),toolbar=__webpack_require__(58643),global_window=__webpack_require__(60397),window_default=__webpack_require__.n(global_window),global_document=__webpack_require__(72449),document_default=__webpack_require__.n(global_document),helpers_extends=__webpack_require__(36549),extends_default=__webpack_require__.n(helpers_extends),assertThisInitialized=__webpack_require__(48582),assertThisInitialized_default=__webpack_require__.n(assertThisInitialized),inheritsLoose=__webpack_require__(22814),inheritsLoose_default=__webpack_require__.n(inheritsLoose),tuple=__webpack_require__(51879),tuple_default=__webpack_require__.n(tuple),keycode=__webpack_require__(16444),keycode_default=__webpack_require__.n(keycode),lib=__webpack_require__(15729),lib_default=__webpack_require__.n(lib),browser_index=__webpack_require__(66605),browser_index_default=__webpack_require__.n(browser_index),construct=__webpack_require__(27422),construct_default=__webpack_require__.n(construct),inherits=__webpack_require__(71556),inherits_default=__webpack_require__.n(inherits),url_toolkit=__webpack_require__(89916),url_toolkit_default=__webpack_require__.n(url_toolkit);const resolve_url=function(baseUrl,relativeUrl){if(/^[a-z]+:/i.test(relativeUrl))return relativeUrl;/^data:/.test(baseUrl)&&(baseUrl=window_default().location&&window_default().location.href||"");var nativeURL="function"==typeof window_default().URL,protocolLess=/^\/\//.test(baseUrl),removeLocation=!window_default().location&&!/\/\//i.test(baseUrl);if(nativeURL?baseUrl=new(window_default().URL)(baseUrl,window_default().location||"http://example.com"):/\/\//i.test(baseUrl)||(baseUrl=url_toolkit_default().buildAbsoluteURL(window_default().location&&window_default().location.href||"",baseUrl)),nativeURL){var newUrl=new URL(relativeUrl,baseUrl);return removeLocation?newUrl.href.slice("http://example.com".length):protocolLess?newUrl.href.slice(newUrl.protocol.length):newUrl.href}return url_toolkit_default().buildAbsoluteURL(baseUrl,relativeUrl)};var Stream=function(){function Stream(){this.listeners={}}var _proto=Stream.prototype;return _proto.on=function(type,listener){this.listeners[type]||(this.listeners[type]=[]),this.listeners[type].push(listener)},_proto.off=function(type,listener){if(!this.listeners[type])return!1;var index=this.listeners[type].indexOf(listener);return this.listeners[type]=this.listeners[type].slice(0),this.listeners[type].splice(index,1),index>-1},_proto.trigger=function(type){var callbacks=this.listeners[type];if(callbacks)if(2===arguments.length)for(var length=callbacks.length,i=0;i<length;++i)callbacks[i].call(this,arguments[1]);else for(var args=Array.prototype.slice.call(arguments,1),_length=callbacks.length,_i=0;_i<_length;++_i)callbacks[_i].apply(this,args)},_proto.dispose=function(){this.listeners={}},_proto.pipe=function(destination){this.on("data",function(data){destination.push(data)})},Stream}(),Buffer=__webpack_require__(33317).Buffer;function decodeB64ToUint8Array(b64Text){for(var s,decodedString=(s=b64Text,window_default().atob?window_default().atob(s):Buffer.from(s,"base64").toString("binary")),array=new Uint8Array(decodedString.length),i=0;i<decodedString.length;i++)array[i]=decodedString.charCodeAt(i);return array}
/*! @name m3u8-parser @version 4.7.0 @license Apache-2.0 */
var a,DESCRIPTORS,LineStream=function(_Stream){function LineStream(){var _this;return(_this=_Stream.call(this)||this).buffer="",_this}return inheritsLoose_default()(LineStream,_Stream),LineStream.prototype.push=function(data){var nextNewline;for(this.buffer+=data,nextNewline=this.buffer.indexOf("\n");nextNewline>-1;nextNewline=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,nextNewline)),this.buffer=this.buffer.substring(nextNewline+1)},LineStream}(Stream),TAB=String.fromCharCode(9),parseByterange=function(byterangeString){var match=/([0-9.]*)?@?([0-9.]*)?/.exec(byterangeString||""),result={};return match[1]&&(result.length=parseInt(match[1],10)),match[2]&&(result.offset=parseInt(match[2],10)),result},parseAttributes=function(attributes){for(var attr,attrs=attributes.split(new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))')),result={},i=attrs.length;i--;)""!==attrs[i]&&((attr=/([^=]*)=(.*)/.exec(attrs[i]).slice(1))[0]=attr[0].replace(/^\s+|\s+$/g,""),attr[1]=attr[1].replace(/^\s+|\s+$/g,""),attr[1]=attr[1].replace(/^['"](.*)['"]$/g,"$1"),result[attr[0]]=attr[1]);return result},ParseStream=function(_Stream){function ParseStream(){var _this;return(_this=_Stream.call(this)||this).customParsers=[],_this.tagMappers=[],_this}inheritsLoose_default()(ParseStream,_Stream);var _proto=ParseStream.prototype;return _proto.push=function(line){var match,event,_this2=this;0!==(line=line.trim()).length&&("#"===line[0]?this.tagMappers.reduce(function(acc,mapper){var mappedLine=mapper(line);return mappedLine===line?acc:acc.concat([mappedLine])},[line]).forEach(function(newLine){for(var i=0;i<_this2.customParsers.length;i++)if(_this2.customParsers[i].call(_this2,newLine))return;if(0===newLine.indexOf("#EXT"))if(newLine=newLine.replace("\r",""),match=/^#EXTM3U/.exec(newLine))_this2.trigger("data",{type:"tag",tagType:"m3u"});else{if(match=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(newLine))return event={type:"tag",tagType:"inf"},match[1]&&(event.duration=parseFloat(match[1])),match[2]&&(event.title=match[2]),void _this2.trigger("data",event);if(match=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(newLine))return event={type:"tag",tagType:"targetduration"},match[1]&&(event.duration=parseInt(match[1],10)),void _this2.trigger("data",event);if(match=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(newLine))return event={type:"tag",tagType:"version"},match[1]&&(event.version=parseInt(match[1],10)),void _this2.trigger("data",event);if(match=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(newLine))return event={type:"tag",tagType:"media-sequence"},match[1]&&(event.number=parseInt(match[1],10)),void _this2.trigger("data",event);if(match=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(newLine))return event={type:"tag",tagType:"discontinuity-sequence"},match[1]&&(event.number=parseInt(match[1],10)),void _this2.trigger("data",event);if(match=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(newLine))return event={type:"tag",tagType:"playlist-type"},match[1]&&(event.playlistType=match[1]),void _this2.trigger("data",event);if(match=/^#EXT-X-BYTERANGE:?(.*)?$/.exec(newLine))return event=extends_default()(parseByterange(match[1]),{type:"tag",tagType:"byterange"}),void _this2.trigger("data",event);if(match=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(newLine))return event={type:"tag",tagType:"allow-cache"},match[1]&&(event.allowed=!/NO/.test(match[1])),void _this2.trigger("data",event);if(match=/^#EXT-X-MAP:?(.*)$/.exec(newLine)){if(event={type:"tag",tagType:"map"},match[1]){var attributes=parseAttributes(match[1]);attributes.URI&&(event.uri=attributes.URI),attributes.BYTERANGE&&(event.byterange=parseByterange(attributes.BYTERANGE))}_this2.trigger("data",event)}else if(match=/^#EXT-X-STREAM-INF:?(.*)$/.exec(newLine)){if(event={type:"tag",tagType:"stream-inf"},match[1]){if(event.attributes=parseAttributes(match[1]),event.attributes.RESOLUTION){var split=event.attributes.RESOLUTION.split("x"),resolution={};split[0]&&(resolution.width=parseInt(split[0],10)),split[1]&&(resolution.height=parseInt(split[1],10)),event.attributes.RESOLUTION=resolution}event.attributes.BANDWIDTH&&(event.attributes.BANDWIDTH=parseInt(event.attributes.BANDWIDTH,10)),event.attributes["PROGRAM-ID"]&&(event.attributes["PROGRAM-ID"]=parseInt(event.attributes["PROGRAM-ID"],10))}_this2.trigger("data",event)}else{if(match=/^#EXT-X-MEDIA:?(.*)$/.exec(newLine))return event={type:"tag",tagType:"media"},match[1]&&(event.attributes=parseAttributes(match[1])),void _this2.trigger("data",event);if(match=/^#EXT-X-ENDLIST/.exec(newLine))_this2.trigger("data",{type:"tag",tagType:"endlist"});else if(match=/^#EXT-X-DISCONTINUITY/.exec(newLine))_this2.trigger("data",{type:"tag",tagType:"discontinuity"});else{if(match=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(newLine))return event={type:"tag",tagType:"program-date-time"},match[1]&&(event.dateTimeString=match[1],event.dateTimeObject=new Date(match[1])),void _this2.trigger("data",event);if(match=/^#EXT-X-KEY:?(.*)$/.exec(newLine))return event={type:"tag",tagType:"key"},match[1]&&(event.attributes=parseAttributes(match[1]),event.attributes.IV&&("0x"===event.attributes.IV.substring(0,2).toLowerCase()&&(event.attributes.IV=event.attributes.IV.substring(2)),event.attributes.IV=event.attributes.IV.match(/.{8}/g),event.attributes.IV[0]=parseInt(event.attributes.IV[0],16),event.attributes.IV[1]=parseInt(event.attributes.IV[1],16),event.attributes.IV[2]=parseInt(event.attributes.IV[2],16),event.attributes.IV[3]=parseInt(event.attributes.IV[3],16),event.attributes.IV=new Uint32Array(event.attributes.IV))),void _this2.trigger("data",event);if(match=/^#EXT-X-START:?(.*)$/.exec(newLine))return event={type:"tag",tagType:"start"},match[1]&&(event.attributes=parseAttributes(match[1]),event.attributes["TIME-OFFSET"]=parseFloat(event.attributes["TIME-OFFSET"]),event.attributes.PRECISE=/YES/.test(event.attributes.PRECISE)),void _this2.trigger("data",event);if(match=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(newLine))return(event={type:"tag",tagType:"cue-out-cont"}).data=match[1]?match[1]:"",void _this2.trigger("data",event);if(match=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(newLine))return(event={type:"tag",tagType:"cue-out"}).data=match[1]?match[1]:"",void _this2.trigger("data",event);if(match=/^#EXT-X-CUE-IN:?(.*)?$/.exec(newLine))return(event={type:"tag",tagType:"cue-in"}).data=match[1]?match[1]:"",void _this2.trigger("data",event);if((match=/^#EXT-X-SKIP:(.*)$/.exec(newLine))&&match[1])return(event={type:"tag",tagType:"skip"}).attributes=parseAttributes(match[1]),event.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(event.attributes["SKIPPED-SEGMENTS"]=parseInt(event.attributes["SKIPPED-SEGMENTS"],10)),event.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(event.attributes["RECENTLY-REMOVED-DATERANGES"]=event.attributes["RECENTLY-REMOVED-DATERANGES"].split(TAB)),void _this2.trigger("data",event);if((match=/^#EXT-X-PART:(.*)$/.exec(newLine))&&match[1])return(event={type:"tag",tagType:"part"}).attributes=parseAttributes(match[1]),["DURATION"].forEach(function(key){event.attributes.hasOwnProperty(key)&&(event.attributes[key]=parseFloat(event.attributes[key]))}),["INDEPENDENT","GAP"].forEach(function(key){event.attributes.hasOwnProperty(key)&&(event.attributes[key]=/YES/.test(event.attributes[key]))}),event.attributes.hasOwnProperty("BYTERANGE")&&(event.attributes.byterange=parseByterange(event.attributes.BYTERANGE)),void _this2.trigger("data",event);if((match=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(newLine))&&match[1])return(event={type:"tag",tagType:"server-control"}).attributes=parseAttributes(match[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(key){event.attributes.hasOwnProperty(key)&&(event.attributes[key]=parseFloat(event.attributes[key]))}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(key){event.attributes.hasOwnProperty(key)&&(event.attributes[key]=/YES/.test(event.attributes[key]))}),void _this2.trigger("data",event);if((match=/^#EXT-X-PART-INF:(.*)$/.exec(newLine))&&match[1])return(event={type:"tag",tagType:"part-inf"}).attributes=parseAttributes(match[1]),["PART-TARGET"].forEach(function(key){event.attributes.hasOwnProperty(key)&&(event.attributes[key]=parseFloat(event.attributes[key]))}),void _this2.trigger("data",event);if((match=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(newLine))&&match[1])return(event={type:"tag",tagType:"preload-hint"}).attributes=parseAttributes(match[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(key){if(event.attributes.hasOwnProperty(key)){event.attributes[key]=parseInt(event.attributes[key],10);var subkey="BYTERANGE-LENGTH"===key?"length":"offset";event.attributes.byterange=event.attributes.byterange||{},event.attributes.byterange[subkey]=event.attributes[key],delete event.attributes[key]}}),void _this2.trigger("data",event);if((match=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(newLine))&&match[1])return(event={type:"tag",tagType:"rendition-report"}).attributes=parseAttributes(match[1]),["LAST-MSN","LAST-PART"].forEach(function(key){event.attributes.hasOwnProperty(key)&&(event.attributes[key]=parseInt(event.attributes[key],10))}),void _this2.trigger("data",event);_this2.trigger("data",{type:"tag",data:newLine.slice(4)})}}}else _this2.trigger("data",{type:"comment",text:newLine.slice(1)})}):this.trigger("data",{type:"uri",uri:line}))},_proto.addParser=function(_ref){var _this3=this,expression=_ref.expression,customType=_ref.customType,dataParser=_ref.dataParser,segment=_ref.segment;"function"!=typeof dataParser&&(dataParser=function(line){return line}),this.customParsers.push(function(line){if(expression.exec(line))return _this3.trigger("data",{type:"custom",data:dataParser(line),customType:customType,segment:segment}),!0})},_proto.addTagMapper=function(_ref2){var expression=_ref2.expression,map=_ref2.map;this.tagMappers.push(function(line){return expression.test(line)?map(line):line})},ParseStream}(Stream),camelCaseKeys=function(attributes){var result={};return Object.keys(attributes).forEach(function(key){var str;result[(str=key,str.toLowerCase().replace(/-(\w)/g,function(a){return a[1].toUpperCase()}))]=attributes[key]}),result},setHoldBack=function(manifest){var serverControl=manifest.serverControl,targetDuration=manifest.targetDuration,partTargetDuration=manifest.partTargetDuration;if(serverControl){var tag="#EXT-X-SERVER-CONTROL",hb="holdBack",phb="partHoldBack",minTargetDuration=targetDuration&&3*targetDuration,minPartDuration=partTargetDuration&&2*partTargetDuration;targetDuration&&!serverControl.hasOwnProperty(hb)&&(serverControl[hb]=minTargetDuration,this.trigger("info",{message:tag+" defaulting HOLD-BACK to targetDuration * 3 ("+minTargetDuration+")."})),minTargetDuration&&serverControl[hb]<minTargetDuration&&(this.trigger("warn",{message:tag+" clamping HOLD-BACK ("+serverControl[hb]+") to targetDuration * 3 ("+minTargetDuration+")"}),serverControl[hb]=minTargetDuration),partTargetDuration&&!serverControl.hasOwnProperty(phb)&&(serverControl[phb]=3*partTargetDuration,this.trigger("info",{message:tag+" defaulting PART-HOLD-BACK to partTargetDuration * 3 ("+serverControl[phb]+")."})),partTargetDuration&&serverControl[phb]<minPartDuration&&(this.trigger("warn",{message:tag+" clamping PART-HOLD-BACK ("+serverControl[phb]+") to partTargetDuration * 2 ("+minPartDuration+")."}),serverControl[phb]=minPartDuration)}},Parser=function(_Stream){function Parser(){var _this;(_this=_Stream.call(this)||this).lineStream=new LineStream,_this.parseStream=new ParseStream,_this.lineStream.pipe(_this.parseStream);var currentMap,_key,self=assertThisInitialized_default()(_this),uris=[],currentUri={},hasParts=!1,noop=function(){},defaultMediaGroups={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},currentTimeline=0;_this.manifest={allowCache:!0,discontinuityStarts:[],segments:[]};var lastByterangeEnd=0,lastPartByterangeEnd=0;return _this.on("end",function(){currentUri.uri||!currentUri.parts&&!currentUri.preloadHints||(!currentUri.map&&currentMap&&(currentUri.map=currentMap),!currentUri.key&&_key&&(currentUri.key=_key),currentUri.timeline||"number"!=typeof currentTimeline||(currentUri.timeline=currentTimeline),_this.manifest.preloadSegment=currentUri)}),_this.parseStream.on("data",function(entry){var mediaGroup,rendition;({tag:function(){({version:function(){entry.version&&(this.manifest.version=entry.version)},"allow-cache":function(){this.manifest.allowCache=entry.allowed,"allowed"in entry||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var byterange={};"length"in entry&&(currentUri.byterange=byterange,byterange.length=entry.length,"offset"in entry||(entry.offset=lastByterangeEnd)),"offset"in entry&&(currentUri.byterange=byterange,byterange.offset=entry.offset),lastByterangeEnd=byterange.offset+byterange.length},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),entry.duration>0&&(currentUri.duration=entry.duration),0===entry.duration&&(currentUri.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=uris},key:function(){if(entry.attributes)if("NONE"!==entry.attributes.METHOD)if(entry.attributes.URI){if("com.apple.streamingkeydelivery"===entry.attributes.KEYFORMAT)return this.manifest.contentProtection=this.manifest.contentProtection||{},void(this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:entry.attributes});if("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===entry.attributes.KEYFORMAT)return-1===["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(entry.attributes.METHOD)?void this.trigger("warn",{message:"invalid key method provided for Widevine"}):("SAMPLE-AES-CENC"===entry.attributes.METHOD&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),"data:text/plain;base64,"!==entry.attributes.URI.substring(0,23)?void this.trigger("warn",{message:"invalid key URI provided for Widevine"}):entry.attributes.KEYID&&"0x"===entry.attributes.KEYID.substring(0,2)?(this.manifest.contentProtection=this.manifest.contentProtection||{},void(this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:entry.attributes.KEYFORMAT,keyId:entry.attributes.KEYID.substring(2)},pssh:decodeB64ToUint8Array(entry.attributes.URI.split(",")[1])})):void this.trigger("warn",{message:"invalid key ID provided for Widevine"}));entry.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),_key={method:entry.attributes.METHOD||"AES-128",uri:entry.attributes.URI},void 0!==entry.attributes.IV&&(_key.iv=entry.attributes.IV)}else this.trigger("warn",{message:"ignoring key declaration without URI"});else _key=null;else this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){isFinite(entry.number)?this.manifest.mediaSequence=entry.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+entry.number})},"discontinuity-sequence":function(){isFinite(entry.number)?(this.manifest.discontinuitySequence=entry.number,currentTimeline=entry.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+entry.number})},"playlist-type":function(){/VOD|EVENT/.test(entry.playlistType)?this.manifest.playlistType=entry.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+entry.playlist})},map:function(){currentMap={},entry.uri&&(currentMap.uri=entry.uri),entry.byterange&&(currentMap.byterange=entry.byterange),_key&&(currentMap.key=_key)},"stream-inf":function(){this.manifest.playlists=uris,this.manifest.mediaGroups=this.manifest.mediaGroups||defaultMediaGroups,entry.attributes?(currentUri.attributes||(currentUri.attributes={}),extends_default()(currentUri.attributes,entry.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||defaultMediaGroups,entry.attributes&&entry.attributes.TYPE&&entry.attributes["GROUP-ID"]&&entry.attributes.NAME){var mediaGroupType=this.manifest.mediaGroups[entry.attributes.TYPE];mediaGroupType[entry.attributes["GROUP-ID"]]=mediaGroupType[entry.attributes["GROUP-ID"]]||{},mediaGroup=mediaGroupType[entry.attributes["GROUP-ID"]],(rendition={default:/yes/i.test(entry.attributes.DEFAULT)}).autoselect=!!rendition.default||/yes/i.test(entry.attributes.AUTOSELECT),entry.attributes.LANGUAGE&&(rendition.language=entry.attributes.LANGUAGE),entry.attributes.URI&&(rendition.uri=entry.attributes.URI),entry.attributes["INSTREAM-ID"]&&(rendition.instreamId=entry.attributes["INSTREAM-ID"]),entry.attributes.CHARACTERISTICS&&(rendition.characteristics=entry.attributes.CHARACTERISTICS),entry.attributes.FORCED&&(rendition.forced=/yes/i.test(entry.attributes.FORCED)),mediaGroup[entry.attributes.NAME]=rendition}else this.trigger("warn",{message:"ignoring incomplete or missing media group"})},discontinuity:function(){currentTimeline+=1,currentUri.discontinuity=!0,this.manifest.discontinuityStarts.push(uris.length)},"program-date-time":function(){void 0===this.manifest.dateTimeString&&(this.manifest.dateTimeString=entry.dateTimeString,this.manifest.dateTimeObject=entry.dateTimeObject),currentUri.dateTimeString=entry.dateTimeString,currentUri.dateTimeObject=entry.dateTimeObject},targetduration:function(){!isFinite(entry.duration)||entry.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+entry.duration}):(this.manifest.targetDuration=entry.duration,setHoldBack.call(this,this.manifest))},start:function(){entry.attributes&&!isNaN(entry.attributes["TIME-OFFSET"])?this.manifest.start={timeOffset:entry.attributes["TIME-OFFSET"],precise:entry.attributes.PRECISE}:this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"})},"cue-out":function(){currentUri.cueOut=entry.data},"cue-out-cont":function(){currentUri.cueOutCont=entry.data},"cue-in":function(){currentUri.cueIn=entry.data},skip:function(){this.manifest.skip=camelCaseKeys(entry.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",entry.attributes,["SKIPPED-SEGMENTS"])},part:function(){var _this2=this;hasParts=!0;var segmentIndex=this.manifest.segments.length,part=camelCaseKeys(entry.attributes);currentUri.parts=currentUri.parts||[],currentUri.parts.push(part),part.byterange&&(part.byterange.hasOwnProperty("offset")||(part.byterange.offset=lastPartByterangeEnd),lastPartByterangeEnd=part.byterange.offset+part.byterange.length),this.warnOnMissingAttributes_("#EXT-X-PART #"+(currentUri.parts.length-1)+" for segment #"+segmentIndex,entry.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach(function(r,i){r.hasOwnProperty("lastPart")||_this2.trigger("warn",{message:"#EXT-X-RENDITION-REPORT #"+i+" lacks required attribute(s): LAST-PART"})})},"server-control":function(){var attrs=this.manifest.serverControl=camelCaseKeys(entry.attributes);attrs.hasOwnProperty("canBlockReload")||(attrs.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),setHoldBack.call(this,this.manifest),attrs.canSkipDateranges&&!attrs.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint":function(){var segmentIndex=this.manifest.segments.length,hint=camelCaseKeys(entry.attributes),isPart=hint.type&&"PART"===hint.type;currentUri.preloadHints=currentUri.preloadHints||[],currentUri.preloadHints.push(hint),hint.byterange&&(hint.byterange.hasOwnProperty("offset")||(hint.byterange.offset=isPart?lastPartByterangeEnd:0,isPart&&(lastPartByterangeEnd=hint.byterange.offset+hint.byterange.length)));var index=currentUri.preloadHints.length-1;if(this.warnOnMissingAttributes_("#EXT-X-PRELOAD-HINT #"+index+" for segment #"+segmentIndex,entry.attributes,["TYPE","URI"]),hint.type)for(var i=0;i<currentUri.preloadHints.length-1;i++){var otherHint=currentUri.preloadHints[i];otherHint.type&&otherHint.type===hint.type&&this.trigger("warn",{message:"#EXT-X-PRELOAD-HINT #"+index+" for segment #"+segmentIndex+" has the same TYPE "+hint.type+" as preload hint #"+i})}},"rendition-report":function(){var report=camelCaseKeys(entry.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(report);var index=this.manifest.renditionReports.length-1,required=["LAST-MSN","URI"];hasParts&&required.push("LAST-PART"),this.warnOnMissingAttributes_("#EXT-X-RENDITION-REPORT #"+index,entry.attributes,required)},"part-inf":function(){this.manifest.partInf=camelCaseKeys(entry.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",entry.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),setHoldBack.call(this,this.manifest)}}[entry.tagType]||noop).call(self)},uri:function(){currentUri.uri=entry.uri,uris.push(currentUri),this.manifest.targetDuration&&!("duration"in currentUri)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),currentUri.duration=this.manifest.targetDuration),_key&&(currentUri.key=_key),currentUri.timeline=currentTimeline,currentMap&&(currentUri.map=currentMap),lastPartByterangeEnd=0,currentUri={}},comment:function(){},custom:function(){entry.segment?(currentUri.custom=currentUri.custom||{},currentUri.custom[entry.customType]=entry.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[entry.customType]=entry.data)}})[entry.type].call(self)}),_this}inheritsLoose_default()(Parser,_Stream);var _proto=Parser.prototype;return _proto.warnOnMissingAttributes_=function(identifier,attributes,required){var missing=[];required.forEach(function(key){attributes.hasOwnProperty(key)||missing.push(key)}),missing.length&&this.trigger("warn",{message:identifier+" lacks required attribute(s): "+missing.join(", ")})},_proto.push=function(chunk){this.lineStream.push(chunk)},_proto.end=function(){this.lineStream.push("\n"),this.trigger("end")},_proto.addParser=function(options){this.parseStream.addParser(options)},_proto.addTagMapper=function(options){this.parseStream.addTagMapper(options)},Parser}(Stream),regexs={mp4:/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v|stpp.ttml.im1t)/,webm:/^(vp0?[89]|av0?1|opus|vorbis)/,ogg:/^(vp0?[89]|theora|flac|opus|vorbis)/,video:/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,audio:/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3|speex|aac)/,text:/^(stpp.ttml.im1t)/,muxerVideo:/^(avc0?1)/,muxerAudio:/^(mp4a)/,muxerText:/a^/},mediaTypes=["video","audio","text"],upperMediaTypes=["Video","Audio","Text"],translateLegacyCodec=function(codec){return codec?codec.replace(/avc1\.(\d+)\.(\d+)/i,function(orig,profile,avcLevel){return"avc1."+("00"+Number(profile).toString(16)).slice(-2)+"00"+("00"+Number(avcLevel).toString(16)).slice(-2)}):codec},parseCodecs=function(codecString){void 0===codecString&&(codecString="");var codecs=codecString.split(","),result=[];return codecs.forEach(function(codec){var codecType;codec=codec.trim(),mediaTypes.forEach(function(name){var match=regexs[name].exec(codec.toLowerCase());if(match&&!(match.length<=1)){codecType=name;var type=codec.substring(0,match[1].length),details=codec.replace(type,"");result.push({type:type,details:details,mediaType:name})}}),codecType||result.push({type:codec,details:"",mediaType:"unknown"})}),result},isAudioCodec=function(codec){return void 0===codec&&(codec=""),regexs.audio.test(codec.trim().toLowerCase())},getMimeForCodec=function(codecString){if(codecString&&"string"==typeof codecString){var codec,codecs=codecString.toLowerCase().split(",").map(function(c){return translateLegacyCodec(c.trim())}),type="video";1===codecs.length&&isAudioCodec(codecs[0])?type="audio":1===codecs.length&&(void 0===(codec=codecs[0])&&(codec=""),regexs.text.test(codec.trim().toLowerCase()))&&(type="application");var container="mp4";return codecs.every(function(c){return regexs.mp4.test(c)})?container="mp4":codecs.every(function(c){return regexs.webm.test(c)})?container="webm":codecs.every(function(c){return regexs.ogg.test(c)})&&(container="ogg"),type+"/"+container+';codecs="'+codecString+'"'}},browserSupportsCodec=function(codecString){return void 0===codecString&&(codecString=""),window_default().MediaSource&&window_default().MediaSource.isTypeSupported&&window_default().MediaSource.isTypeSupported(getMimeForCodec(codecString))||!1},muxerSupportsCodec=function(codecString){return void 0===codecString&&(codecString=""),codecString.toLowerCase().split(",").every(function(codec){codec=codec.trim();for(var i=0;i<upperMediaTypes.length;i++)if(regexs["muxer"+upperMediaTypes[i]].test(codec))return!0;return!1})},MPEGURL_REGEX=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i,DASH_REGEX=/^application\/dash\+xml/i,simpleTypeFromSourceType=function(type){return MPEGURL_REGEX.test(type)?"hls":DASH_REGEX.test(type)?"dash":"application/vnd.videojs.vhs+json"===type?"vhs-json":null},xmldom_lib=__webpack_require__(83874),isObject=function(obj){return!!obj&&"object"==typeof obj},merge=function merge(){for(var _len=arguments.length,objects=new Array(_len),_key=0;_key<_len;_key++)objects[_key]=arguments[_key];return objects.reduce(function(result,source){return"object"!=typeof source||Object.keys(source).forEach(function(key){result[key]=Array.isArray(result[key])&&Array.isArray(source[key])?result[key].concat(source[key]):isObject(result[key])&&isObject(source[key])?merge(result[key],source[key]):source[key]}),result},{})},flatten=function(lists){return lists.reduce(function(x,y){return x.concat(y)},[])},from=function(list){if(!list.length)return[];for(var result=[],i=0;i<list.length;i++)result.push(list[i]);return result},urlTypeToSegment=function(_ref){var _ref$baseUrl=_ref.baseUrl,_ref$source=_ref.source,source=void 0===_ref$source?"":_ref$source,_ref$range=_ref.range,range=void 0===_ref$range?"":_ref$range,_ref$indexRange=_ref.indexRange,indexRange=void 0===_ref$indexRange?"":_ref$indexRange,segment={uri:source,resolvedUri:resolve_url((void 0===_ref$baseUrl?"":_ref$baseUrl)||"",source)};if(range||indexRange){var ranges=(range||indexRange).split("-"),startRange=parseInt(ranges[0],10),endRange=parseInt(ranges[1],10);segment.byterange={length:endRange-startRange+1,offset:startRange}}return segment},parseEndNumber=function(endNumber){return endNumber&&"number"!=typeof endNumber&&(endNumber=parseInt(endNumber,10)),isNaN(endNumber)?null:endNumber},segmentRange={static:function(attributes){var duration=attributes.duration,_attributes$timescale=attributes.timescale,timescale=void 0===_attributes$timescale?1:_attributes$timescale,sourceDuration=attributes.sourceDuration,periodDuration=attributes.periodDuration,endNumber=parseEndNumber(attributes.endNumber),segmentDuration=duration/timescale;return"number"==typeof endNumber?{start:0,end:endNumber}:"number"==typeof periodDuration?{start:0,end:periodDuration/segmentDuration}:{start:0,end:sourceDuration/segmentDuration}},dynamic:function(attributes){var NOW=attributes.NOW,clientOffset=attributes.clientOffset,availabilityStartTime=attributes.availabilityStartTime,_attributes$timescale2=attributes.timescale,timescale=void 0===_attributes$timescale2?1:_attributes$timescale2,duration=attributes.duration,_attributes$start=attributes.start,start=void 0===_attributes$start?0:_attributes$start,_attributes$minimumUp=attributes.minimumUpdatePeriod,minimumUpdatePeriod=void 0===_attributes$minimumUp?0:_attributes$minimumUp,_attributes$timeShift=attributes.timeShiftBufferDepth,timeShiftBufferDepth=void 0===_attributes$timeShift?1/0:_attributes$timeShift,endNumber=parseEndNumber(attributes.endNumber),now=(NOW+clientOffset)/1e3,periodStartWC=availabilityStartTime+start,segmentCount=Math.ceil((now+minimumUpdatePeriod-periodStartWC)*timescale/duration),availableStart=Math.floor((now-periodStartWC-timeShiftBufferDepth)*timescale/duration),availableEnd=Math.floor((now-periodStartWC)*timescale/duration);return{start:Math.max(0,availableStart),end:"number"==typeof endNumber?endNumber:Math.min(segmentCount,availableEnd)}}},parseByDuration=function(attributes){var type=attributes.type,duration=attributes.duration,_attributes$timescale4=attributes.timescale,timescale=void 0===_attributes$timescale4?1:_attributes$timescale4,periodDuration=attributes.periodDuration,sourceDuration=attributes.sourceDuration,_segmentRange$type=segmentRange[type](attributes),segments=function(start,end){for(var result=[],i=start;i<end;i++)result.push(i);return result}(_segmentRange$type.start,_segmentRange$type.end).map(function(attributes){return function(number,index){var duration=attributes.duration,_attributes$timescale3=attributes.timescale,_attributes$startNumb=attributes.startNumber;return{number:(void 0===_attributes$startNumb?1:_attributes$startNumb)+number,duration:duration/(void 0===_attributes$timescale3?1:_attributes$timescale3),timeline:attributes.periodIndex,time:index*duration}}}(attributes));if("static"===type){var index=segments.length-1;segments[index].duration=("number"==typeof periodDuration?periodDuration:sourceDuration)-duration/timescale*index}return segments},segmentsFromBase=function(attributes){var baseUrl=attributes.baseUrl,_attributes$initializ=attributes.initialization,initialization=void 0===_attributes$initializ?{}:_attributes$initializ,sourceDuration=attributes.sourceDuration,_attributes$indexRang=attributes.indexRange,indexRange=void 0===_attributes$indexRang?"":_attributes$indexRang,duration=attributes.duration;if(!baseUrl)throw new Error("NO_BASE_URL");var initSegment=urlTypeToSegment({baseUrl:baseUrl,source:initialization.sourceURL,range:initialization.range}),segment=urlTypeToSegment({baseUrl:baseUrl,source:baseUrl,indexRange:indexRange});if(segment.map=initSegment,duration){var segmentTimeInfo=parseByDuration(attributes);segmentTimeInfo.length&&(segment.duration=segmentTimeInfo[0].duration,segment.timeline=segmentTimeInfo[0].timeline)}else sourceDuration&&(segment.duration=sourceDuration,segment.timeline=0);return segment.number=0,[segment]},addSidxSegmentsToPlaylist=function(playlist,sidx,baseUrl){for(var initSegment=playlist.sidx.map?playlist.sidx.map:null,sourceDuration=playlist.sidx.duration,timeline=playlist.timeline||0,sidxByteRange=playlist.sidx.byterange,sidxEnd=sidxByteRange.offset+sidxByteRange.length,timescale=sidx.timescale,mediaReferences=sidx.references.filter(function(r){return 1!==r.referenceType}),segments=[],type=playlist.endList?"static":"dynamic",startIndex=sidxEnd+sidx.firstOffset,i=0;i<mediaReferences.length;i++){var reference=sidx.references[i],size=reference.referencedSize,segment=segmentsFromBase({baseUrl:baseUrl,timescale:timescale,timeline:timeline,periodIndex:timeline,duration:reference.subsegmentDuration,sourceDuration:sourceDuration,indexRange:startIndex+"-"+(startIndex+size-1),type:type})[0];initSegment&&(segment.map=initSegment),segments.push(segment),startIndex+=size}return playlist.segments=segments,playlist},generateSidxKey=function(sidx){return sidx&&sidx.uri+"-"+(byterange=sidx.byterange).offset+"-"+(byterange.offset+byterange.length-1);var byterange},mergeDiscontiguousPlaylists=function(playlists){var o;return(o=playlists.reduce(function(acc,playlist){var _acc$name$segments,name=playlist.attributes.id+(playlist.attributes.lang||"");return acc[name]?(playlist.segments[0]&&(playlist.segments[0].discontinuity=!0),(_acc$name$segments=acc[name].segments).push.apply(_acc$name$segments,playlist.segments),playlist.attributes.contentProtection&&(acc[name].attributes.contentProtection=playlist.attributes.contentProtection)):acc[name]=playlist,acc},{}),Object.keys(o).map(function(k){return o[k]})).map(function(playlist){return playlist.discontinuityStarts=("discontinuity",playlist.segments.reduce(function(a,e,i){return e.discontinuity&&a.push(i),a},[])),playlist})},addSidxSegmentsToPlaylist$1=function(playlist,sidxMapping){var sidxKey=generateSidxKey(playlist.sidx),sidxMatch=sidxKey&&sidxMapping[sidxKey]&&sidxMapping[sidxKey].sidx;return sidxMatch&&addSidxSegmentsToPlaylist(playlist,sidxMatch,playlist.sidx.resolvedUri),playlist},addSidxSegmentsToPlaylists=function(playlists,sidxMapping){if(void 0===sidxMapping&&(sidxMapping={}),!Object.keys(sidxMapping).length)return playlists;for(var i in playlists)playlists[i]=addSidxSegmentsToPlaylist$1(playlists[i],sidxMapping);return playlists},formatVideoPlaylist=function(_ref3){var _attributes2,attributes=_ref3.attributes,segments=_ref3.segments,sidx=_ref3.sidx,playlist={attributes:(_attributes2={NAME:attributes.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:attributes.width,height:attributes.height},CODECS:attributes.codecs,BANDWIDTH:attributes.bandwidth},_attributes2["PROGRAM-ID"]=1,_attributes2),uri:"",endList:"static"===attributes.type,timeline:attributes.periodIndex,resolvedUri:"",targetDuration:attributes.duration,segments:segments,mediaSequence:segments.length?segments[0].number:1};return attributes.contentProtection&&(playlist.contentProtection=attributes.contentProtection),sidx&&(playlist.sidx=sidx),playlist},videoOnly=function(_ref4){var attributes=_ref4.attributes;return"video/mp4"===attributes.mimeType||"video/webm"===attributes.mimeType||"video"===attributes.contentType},audioOnly=function(_ref5){var attributes=_ref5.attributes;return"audio/mp4"===attributes.mimeType||"audio/webm"===attributes.mimeType||"audio"===attributes.contentType},vttOnly=function(_ref6){var attributes=_ref6.attributes;return"text/vtt"===attributes.mimeType||"text"===attributes.contentType},getLiveRValue=function(attributes,time,duration){var _attributes$timescale=attributes.timescale,_attributes$start=attributes.start,_attributes$minimumUp=attributes.minimumUpdatePeriod;return Math.ceil((((attributes.NOW+attributes.clientOffset)/1e3+(void 0===_attributes$minimumUp?0:_attributes$minimumUp)-(attributes.availabilityStartTime+(void 0===_attributes$start?0:_attributes$start)))*(void 0===_attributes$timescale?1:_attributes$timescale)-time)/duration)},parseByTimeline=function(attributes,segmentTimeline){for(var type=attributes.type,_attributes$minimumUp2=attributes.minimumUpdatePeriod,minimumUpdatePeriod=void 0===_attributes$minimumUp2?0:_attributes$minimumUp2,_attributes$media=attributes.media,media=void 0===_attributes$media?"":_attributes$media,sourceDuration=attributes.sourceDuration,_attributes$timescale2=attributes.timescale,timescale=void 0===_attributes$timescale2?1:_attributes$timescale2,_attributes$startNumb=attributes.startNumber,startNumber=void 0===_attributes$startNumb?1:_attributes$startNumb,timeline=attributes.periodIndex,segments=[],time=-1,sIndex=0;sIndex<segmentTimeline.length;sIndex++){var S=segmentTimeline[sIndex],duration=S.d,repeat=S.r||0,segmentTime=S.t||0;time<0&&(time=segmentTime),segmentTime&&segmentTime>time&&(time=segmentTime);var count=void 0;if(repeat<0){var nextS=sIndex+1;count=nextS===segmentTimeline.length?"dynamic"===type&&minimumUpdatePeriod>0&&media.indexOf("$Number$")>0?getLiveRValue(attributes,time,duration):(sourceDuration*timescale-time)/duration:(segmentTimeline[nextS].t-time)/duration}else count=repeat+1;for(var end=startNumber+segments.length+count,number=startNumber+segments.length;number<end;)segments.push({number:number,duration:duration/timescale,time:time,timeline:timeline}),time+=duration,number++}return segments},identifierPattern=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,constructTemplateUrl=function(url,values){return url.replace(identifierPattern,function(values){return function(match,identifier,format,width){if("$$"===match)return"$";if(void 0===values[identifier])return match;var value=""+values[identifier];return"RepresentationID"===identifier?value:(width=format?parseInt(width,10):1,value.length>=width?value:""+new Array(width-value.length+1).join("0")+value)}}(values))},segmentsFromTemplate=function(attributes,segmentTimeline){var templateValues={RepresentationID:attributes.id,Bandwidth:attributes.bandwidth||0},_attributes$initializ=attributes.initialization,initialization=void 0===_attributes$initializ?{sourceURL:"",range:""}:_attributes$initializ,mapSegment=urlTypeToSegment({baseUrl:attributes.baseUrl,source:constructTemplateUrl(initialization.sourceURL,templateValues),range:initialization.range}),segments=function(attributes,segmentTimeline){return attributes.duration||segmentTimeline?attributes.duration?parseByDuration(attributes):parseByTimeline(attributes,segmentTimeline):[{number:attributes.startNumber||1,duration:attributes.sourceDuration,time:0,timeline:attributes.periodIndex}]}(attributes,segmentTimeline);return segments.map(function(segment){templateValues.Number=segment.number,templateValues.Time=segment.time;var uri=constructTemplateUrl(attributes.media||"",templateValues),presentationTime=attributes.periodStart+(segment.time-(attributes.presentationTimeOffset||0))/(attributes.timescale||1);return{uri:uri,timeline:segment.timeline,duration:segment.duration,resolvedUri:resolve_url(attributes.baseUrl||"",uri),map:mapSegment,number:segment.number,presentationTime:presentationTime}})},segmentsFromList=function(attributes,segmentTimeline){var duration=attributes.duration,_attributes$segmentUr=attributes.segmentUrls,segmentUrls=void 0===_attributes$segmentUr?[]:_attributes$segmentUr,periodStart=attributes.periodStart;if(!duration&&!segmentTimeline||duration&&segmentTimeline)throw new Error("SEGMENT_TIME_UNSPECIFIED");var segmentTimeInfo,segmentUrlMap=segmentUrls.map(function(segmentUrlObject){return function(attributes,segmentUrl){var baseUrl=attributes.baseUrl,_attributes$initializ=attributes.initialization,initialization=void 0===_attributes$initializ?{}:_attributes$initializ,initSegment=urlTypeToSegment({baseUrl:baseUrl,source:initialization.sourceURL,range:initialization.range}),segment=urlTypeToSegment({baseUrl:baseUrl,source:segmentUrl.media,range:segmentUrl.mediaRange});return segment.map=initSegment,segment}(attributes,segmentUrlObject)});return duration&&(segmentTimeInfo=parseByDuration(attributes)),segmentTimeline&&(segmentTimeInfo=parseByTimeline(attributes,segmentTimeline)),segmentTimeInfo.map(function(segmentTime,index){if(segmentUrlMap[index]){var segment=segmentUrlMap[index],timescale=attributes.timescale||1,presentationTimeOffset=attributes.presentationTimeOffset||0;return segment.timeline=segmentTime.timeline,segment.duration=segmentTime.duration,segment.number=segmentTime.number,segment.presentationTime=periodStart+(segmentTime.time-presentationTimeOffset)/timescale,segment}}).filter(function(segment){return segment})},generateSegments=function(_ref){var segmentAttributes,segmentsFn,attributes=_ref.attributes,segmentInfo=_ref.segmentInfo;segmentInfo.template?(segmentsFn=segmentsFromTemplate,segmentAttributes=merge(attributes,segmentInfo.template)):segmentInfo.base?(segmentsFn=segmentsFromBase,segmentAttributes=merge(attributes,segmentInfo.base)):segmentInfo.list&&(segmentsFn=segmentsFromList,segmentAttributes=merge(attributes,segmentInfo.list));var segmentsInfo={attributes:attributes};if(!segmentsFn)return segmentsInfo;var segments=segmentsFn(segmentAttributes,segmentInfo.segmentTimeline);if(segmentAttributes.duration){var _segmentAttributes$ti=segmentAttributes.timescale;segmentAttributes.duration=segmentAttributes.duration/(void 0===_segmentAttributes$ti?1:_segmentAttributes$ti)}else segmentAttributes.duration=segments.length?segments.reduce(function(max,segment){return Math.max(max,Math.ceil(segment.duration))},0):0;return segmentsInfo.attributes=segmentAttributes,segmentsInfo.segments=segments,segmentInfo.base&&segmentAttributes.indexRange&&(segmentsInfo.sidx=segments[0],segmentsInfo.segments=[]),segmentsInfo},findChildren=function(element,name){return from(element.childNodes).filter(function(_ref){return _ref.tagName===name})},getContent=function(element){return element.textContent.trim()},parseDuration=function(str){var match=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(str);if(!match)return 0;var _match$slice=match.slice(1),month=_match$slice[1],day=_match$slice[2],hour=_match$slice[3],minute=_match$slice[4],second=_match$slice[5];return 31536e3*parseFloat(_match$slice[0]||0)+2592e3*parseFloat(month||0)+86400*parseFloat(day||0)+3600*parseFloat(hour||0)+60*parseFloat(minute||0)+parseFloat(second||0)},parsers={mediaPresentationDuration:function(value){return parseDuration(value)},availabilityStartTime:function(value){return/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(str=value)&&(str+="Z"),Date.parse(str)/1e3;var str},minimumUpdatePeriod:function(value){return parseDuration(value)},suggestedPresentationDelay:function(value){return parseDuration(value)},type:function(value){return value},timeShiftBufferDepth:function(value){return parseDuration(value)},start:function(value){return parseDuration(value)},width:function(value){return parseInt(value,10)},height:function(value){return parseInt(value,10)},bandwidth:function(value){return parseInt(value,10)},startNumber:function(value){return parseInt(value,10)},timescale:function(value){return parseInt(value,10)},presentationTimeOffset:function(value){return parseInt(value,10)},duration:function(value){var parsedValue=parseInt(value,10);return isNaN(parsedValue)?parseDuration(value):parsedValue},d:function(value){return parseInt(value,10)},t:function(value){return parseInt(value,10)},r:function(value){return parseInt(value,10)},DEFAULT:function(value){return value}},mpd_parser_es_parseAttributes=function(el){return el&&el.attributes?from(el.attributes).reduce(function(a,e){return a[e.name]=(parsers[e.name]||parsers.DEFAULT)(e.value),a},{}):{}},keySystemsMap={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},buildBaseUrls=function(referenceUrls,baseUrlElements){return baseUrlElements.length?flatten(referenceUrls.map(function(reference){return baseUrlElements.map(function(baseUrlElement){return resolve_url(reference,getContent(baseUrlElement))})})):referenceUrls},getSegmentInformation=function(adaptationSet){var segmentTemplate=findChildren(adaptationSet,"SegmentTemplate")[0],segmentList=findChildren(adaptationSet,"SegmentList")[0],segmentUrls=segmentList&&findChildren(segmentList,"SegmentURL").map(function(s){return merge({tag:"SegmentURL"},mpd_parser_es_parseAttributes(s))}),segmentBase=findChildren(adaptationSet,"SegmentBase")[0],segmentTimelineParentNode=segmentList||segmentTemplate,segmentTimeline=segmentTimelineParentNode&&findChildren(segmentTimelineParentNode,"SegmentTimeline")[0],segmentInitializationParentNode=segmentList||segmentBase||segmentTemplate,segmentInitialization=segmentInitializationParentNode&&findChildren(segmentInitializationParentNode,"Initialization")[0],template=segmentTemplate&&mpd_parser_es_parseAttributes(segmentTemplate);template&&segmentInitialization?template.initialization=segmentInitialization&&mpd_parser_es_parseAttributes(segmentInitialization):template&&template.initialization&&(template.initialization={sourceURL:template.initialization});var segmentInfo={template:template,segmentTimeline:segmentTimeline&&findChildren(segmentTimeline,"S").map(function(s){return mpd_parser_es_parseAttributes(s)}),list:segmentList&&merge(mpd_parser_es_parseAttributes(segmentList),{segmentUrls:segmentUrls,initialization:mpd_parser_es_parseAttributes(segmentInitialization)}),base:segmentBase&&merge(mpd_parser_es_parseAttributes(segmentBase),{initialization:mpd_parser_es_parseAttributes(segmentInitialization)})};return Object.keys(segmentInfo).forEach(function(key){segmentInfo[key]||delete segmentInfo[key]}),segmentInfo},toAdaptationSets=function(mpdAttributes,mpdBaseUrls){return function(period,index){var periodBaseUrls=buildBaseUrls(mpdBaseUrls,findChildren(period.node,"BaseURL")),parsedPeriodId=parseInt(period.attributes.id,10),periodIndex=window_default().isNaN(parsedPeriodId)?index:parsedPeriodId,periodAttributes=merge(mpdAttributes,{periodIndex:periodIndex,periodStart:period.attributes.start});"number"==typeof period.attributes.duration&&(periodAttributes.periodDuration=period.attributes.duration);var adaptationSets=findChildren(period.node,"AdaptationSet"),periodSegmentInfo=getSegmentInformation(period.node);return flatten(adaptationSets.map(function(periodAttributes,periodBaseUrls,periodSegmentInfo){return function(adaptationSet){var service,adaptationSetAttributes=mpd_parser_es_parseAttributes(adaptationSet),adaptationSetBaseUrls=buildBaseUrls(periodBaseUrls,findChildren(adaptationSet,"BaseURL")),role=findChildren(adaptationSet,"Role")[0],roleAttributes={role:mpd_parser_es_parseAttributes(role)},attrs=merge(periodAttributes,adaptationSetAttributes,roleAttributes),accessibility=findChildren(adaptationSet,"Accessibility")[0],captionServices="urn:scte:dash:cc:cea-608:2015"===(service=mpd_parser_es_parseAttributes(accessibility)).schemeIdUri?("string"!=typeof service.value?[]:service.value.split(";")).map(function(value){var channel,language;if(language=value,/^CC\d=/.test(value)){var _value$split=value.split("=");channel=_value$split[0],language=_value$split[1]}else/^CC\d$/.test(value)&&(channel=value);return{channel:channel,language:language}}):"urn:scte:dash:cc:cea-708:2015"===service.schemeIdUri?("string"!=typeof service.value?[]:service.value.split(";")).map(function(value){var flags={channel:void 0,language:void 0,aspectRatio:1,easyReader:0,"3D":0};if(/=/.test(value)){var _value$split2=value.split("="),_value$split2$=_value$split2[1],opts=void 0===_value$split2$?"":_value$split2$;flags.channel=_value$split2[0],flags.language=value,opts.split(",").forEach(function(opt){var _opt$split=opt.split(":"),name=_opt$split[0],val=_opt$split[1];"lang"===name?flags.language=val:"er"===name?flags.easyReader=Number(val):"war"===name?flags.aspectRatio=Number(val):"3D"===name&&(flags["3D"]=Number(val))})}else flags.language=value;return flags.channel&&(flags.channel="SERVICE"+flags.channel),flags}):void 0;captionServices&&(attrs=merge(attrs,{captionServices:captionServices}));var label=findChildren(adaptationSet,"Label")[0];if(label&&label.childNodes.length){var labelVal=label.childNodes[0].nodeValue.trim();attrs=merge(attrs,{label:labelVal})}var contentProtection=findChildren(adaptationSet,"ContentProtection").reduce(function(acc,node){var attributes=mpd_parser_es_parseAttributes(node),keySystem=keySystemsMap[attributes.schemeIdUri];if(keySystem){acc[keySystem]={attributes:attributes};var psshNode=findChildren(node,"cenc:pssh")[0];if(psshNode){var pssh=getContent(psshNode),psshBuffer=pssh&&decodeB64ToUint8Array(pssh);acc[keySystem].pssh=psshBuffer}}return acc},{});Object.keys(contentProtection).length&&(attrs=merge(attrs,{contentProtection:contentProtection}));var segmentInfo=getSegmentInformation(adaptationSet),representations=findChildren(adaptationSet,"Representation"),adaptationSetSegmentInfo=merge(periodSegmentInfo,segmentInfo);return flatten(representations.map(function(adaptationSetAttributes,adaptationSetBaseUrls,adaptationSetSegmentInfo){return function(representation){var repBaseUrlElements=findChildren(representation,"BaseURL"),repBaseUrls=buildBaseUrls(adaptationSetBaseUrls,repBaseUrlElements),attributes=merge(adaptationSetAttributes,mpd_parser_es_parseAttributes(representation)),representationSegmentInfo=getSegmentInformation(representation);return repBaseUrls.map(function(baseUrl){return{segmentInfo:merge(adaptationSetSegmentInfo,representationSegmentInfo),attributes:merge(attributes,{baseUrl:baseUrl})}})}}(attrs,adaptationSetBaseUrls,adaptationSetSegmentInfo)))}}(periodAttributes,periodBaseUrls,periodSegmentInfo)))}},stringToMpdXml=function(manifestString){if(""===manifestString)throw new Error("DASH_EMPTY_MANIFEST");var xml,mpd,parser=new xmldom_lib.DOMParser;try{mpd=(xml=parser.parseFromString(manifestString,"application/xml"))&&"MPD"===xml.documentElement.tagName?xml.documentElement:null}catch(e){}if(!mpd||mpd&&mpd.getElementsByTagName("parsererror").length>0)throw new Error("DASH_INVALID_XML");return mpd},parse=function(manifestString,options){void 0===options&&(options={});var parsedManifestInfo=function(mpd,options){void 0===options&&(options={});var _options=options,_options$manifestUri=_options.manifestUri,manifestUri=void 0===_options$manifestUri?"":_options$manifestUri,_options$NOW=_options.NOW,NOW=void 0===_options$NOW?Date.now():_options$NOW,_options$clientOffset=_options.clientOffset,clientOffset=void 0===_options$clientOffset?0:_options$clientOffset,periodNodes=findChildren(mpd,"Period");if(!periodNodes.length)throw new Error("INVALID_NUMBER_OF_PERIOD");var locations=findChildren(mpd,"Location"),mpdAttributes=mpd_parser_es_parseAttributes(mpd),mpdBaseUrls=buildBaseUrls([manifestUri],findChildren(mpd,"BaseURL"));mpdAttributes.type=mpdAttributes.type||"static",mpdAttributes.sourceDuration=mpdAttributes.mediaPresentationDuration||0,mpdAttributes.NOW=NOW,mpdAttributes.clientOffset=clientOffset,locations.length&&(mpdAttributes.locations=locations.map(getContent));var periods=[];return periodNodes.forEach(function(node,index){var attributes=mpd_parser_es_parseAttributes(node),priorPeriod=periods[index-1];attributes.start=function(_ref){var attributes=_ref.attributes,priorPeriodAttributes=_ref.priorPeriodAttributes;return"number"==typeof attributes.start?attributes.start:priorPeriodAttributes&&"number"==typeof priorPeriodAttributes.start&&"number"==typeof priorPeriodAttributes.duration?priorPeriodAttributes.start+priorPeriodAttributes.duration:priorPeriodAttributes||"static"!==_ref.mpdType?null:0}({attributes:attributes,priorPeriodAttributes:priorPeriod?priorPeriod.attributes:null,mpdType:mpdAttributes.type}),periods.push({node:node,attributes:attributes})}),{locations:mpdAttributes.locations,representationInfo:flatten(periods.map(toAdaptationSets(mpdAttributes,mpdBaseUrls)))}}(stringToMpdXml(manifestString),options);return function(dashPlaylists,locations,sidxMapping){var _mediaGroups;if(void 0===sidxMapping&&(sidxMapping={}),!dashPlaylists.length)return{};var _dashPlaylists$0$attr=dashPlaylists[0].attributes,duration=_dashPlaylists$0$attr.sourceDuration,type=_dashPlaylists$0$attr.type,suggestedPresentationDelay=_dashPlaylists$0$attr.suggestedPresentationDelay,minimumUpdatePeriod=_dashPlaylists$0$attr.minimumUpdatePeriod,videoPlaylists=mergeDiscontiguousPlaylists(dashPlaylists.filter(videoOnly)).map(formatVideoPlaylist),audioPlaylists=mergeDiscontiguousPlaylists(dashPlaylists.filter(audioOnly)),vttPlaylists=dashPlaylists.filter(vttOnly),captions=dashPlaylists.map(function(playlist){return playlist.attributes.captionServices}).filter(Boolean),manifest={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:(_mediaGroups={AUDIO:{},VIDEO:{}},_mediaGroups["CLOSED-CAPTIONS"]={},_mediaGroups.SUBTITLES={},_mediaGroups),uri:"",duration:duration,playlists:addSidxSegmentsToPlaylists(videoPlaylists,sidxMapping)};return minimumUpdatePeriod>=0&&(manifest.minimumUpdatePeriod=1e3*minimumUpdatePeriod),locations&&(manifest.locations=locations),"dynamic"===type&&(manifest.suggestedPresentationDelay=suggestedPresentationDelay),audioPlaylists.length&&(manifest.mediaGroups.AUDIO.audio=function(playlists,sidxMapping,isAudioOnly){var mainPlaylist;void 0===sidxMapping&&(sidxMapping={}),void 0===isAudioOnly&&(isAudioOnly=!1);var formattedPlaylists=playlists.reduce(function(a,playlist){var role=playlist.attributes.role&&playlist.attributes.role.value||"",language=playlist.attributes.lang||"",label=playlist.attributes.label||"main";language&&!playlist.attributes.label&&(label=playlist.attributes.lang+(role?" ("+role+")":"")),a[label]||(a[label]={language:language,autoselect:!0,default:"main"===role,playlists:[],uri:""});var formatted=addSidxSegmentsToPlaylist$1(function(_ref,isAudioOnly){var _attributes,attributes=_ref.attributes,segments=_ref.segments,sidx=_ref.sidx,playlist={attributes:(_attributes={NAME:attributes.id,BANDWIDTH:attributes.bandwidth,CODECS:attributes.codecs},_attributes["PROGRAM-ID"]=1,_attributes),uri:"",endList:"static"===attributes.type,timeline:attributes.periodIndex,resolvedUri:"",targetDuration:attributes.duration,segments:segments,mediaSequence:segments.length?segments[0].number:1};return attributes.contentProtection&&(playlist.contentProtection=attributes.contentProtection),sidx&&(playlist.sidx=sidx),isAudioOnly&&(playlist.attributes.AUDIO="audio",playlist.attributes.SUBTITLES="subs"),playlist}(playlist,isAudioOnly),sidxMapping);return a[label].playlists.push(formatted),void 0===mainPlaylist&&"main"===role&&((mainPlaylist=playlist).default=!0),a},{});return mainPlaylist||(formattedPlaylists[Object.keys(formattedPlaylists)[0]].default=!0),formattedPlaylists}(audioPlaylists,sidxMapping,0===manifest.playlists.length)),vttPlaylists.length&&(manifest.mediaGroups.SUBTITLES.subs=function(playlists,sidxMapping){return void 0===sidxMapping&&(sidxMapping={}),playlists.reduce(function(a,playlist){var label=playlist.attributes.lang||"text";return a[label]||(a[label]={language:label,default:!1,autoselect:!1,playlists:[],uri:""}),a[label].playlists.push(addSidxSegmentsToPlaylist$1(function(_ref2){var _m3u8Attributes,attributes=_ref2.attributes,segments=_ref2.segments;void 0===segments&&(segments=[{uri:attributes.baseUrl,timeline:attributes.periodIndex,resolvedUri:attributes.baseUrl||"",duration:attributes.sourceDuration,number:0}],attributes.duration=attributes.sourceDuration);var m3u8Attributes=((_m3u8Attributes={NAME:attributes.id,BANDWIDTH:attributes.bandwidth})["PROGRAM-ID"]=1,_m3u8Attributes);return attributes.codecs&&(m3u8Attributes.CODECS=attributes.codecs),{attributes:m3u8Attributes,uri:"",endList:"static"===attributes.type,timeline:attributes.periodIndex,resolvedUri:attributes.baseUrl||"",targetDuration:attributes.duration,segments:segments,mediaSequence:segments.length?segments[0].number:1}}(playlist),sidxMapping)),a},{})}(vttPlaylists,sidxMapping)),captions.length&&(manifest.mediaGroups["CLOSED-CAPTIONS"].cc=captions.reduce(function(svcObj,svc){return svc?(svc.forEach(function(service){var language=service.language;svcObj[language]={autoselect:!1,default:!1,instreamId:service.channel,language:language},service.hasOwnProperty("aspectRatio")&&(svcObj[language].aspectRatio=service.aspectRatio),service.hasOwnProperty("easyReader")&&(svcObj[language].easyReader=service.easyReader),service.hasOwnProperty("3D")&&(svcObj[language]["3D"]=service["3D"])}),svcObj):svcObj},{})),manifest}(parsedManifestInfo.representationInfo.map(generateSegments),parsedManifestInfo.locations,options.sidxMapping)},parse_sidx=__webpack_require__(40230),parse_sidx_default=__webpack_require__.n(parse_sidx),byte_helpers_toUint8=function(bytes){return bytes instanceof Uint8Array?bytes:(Array.isArray(bytes)||ArrayBuffer.isView(bytes)||bytes instanceof ArrayBuffer||(bytes="number"!=typeof bytes||"number"==typeof bytes&&bytes!=bytes?0:[bytes]),new Uint8Array(bytes&&bytes.buffer||bytes,bytes&&bytes.byteOffset||0,bytes&&bytes.byteLength||0))},BigInt=window_default().BigInt||Number,BYTE_TABLE=[BigInt("0x1"),BigInt("0x100"),BigInt("0x10000"),BigInt("0x1000000"),BigInt("0x100000000"),BigInt("0x10000000000"),BigInt("0x1000000000000"),BigInt("0x100000000000000"),BigInt("0x10000000000000000")],byte_helpers_bytesToNumber=(a=new Uint16Array([65484]),new Uint8Array(a.buffer,a.byteOffset,a.byteLength),function(bytes,_temp){var _ref=void 0===_temp?{}:_temp,_ref$signed=_ref.signed,signed=void 0!==_ref$signed&&_ref$signed,_ref$le=_ref.le,le=void 0!==_ref$le&&_ref$le;bytes=byte_helpers_toUint8(bytes);var fn=le?"reduce":"reduceRight",number=(bytes[fn]?bytes[fn]:Array.prototype[fn]).call(bytes,function(total,byte,i){var exponent=le?i:Math.abs(i+1-bytes.length);return total+BigInt(byte)*BYTE_TABLE[exponent]},BigInt(0));if(signed){var max=BYTE_TABLE[bytes.length]/BigInt(2)-BigInt(1);(number=BigInt(number))>max&&(number-=max,number-=max,number-=BigInt(2))}return Number(number)}),stringToBytes=function(string,stringIsBytes){if("string"!=typeof string&&string&&"function"==typeof string.toString&&(string=string.toString()),"string"!=typeof string)return new Uint8Array;stringIsBytes||(string=unescape(encodeURIComponent(string)));for(var view=new Uint8Array(string.length),i=0;i<string.length;i++)view[i]=string.charCodeAt(i);return view},byte_helpers_bytesMatch=function(a,b,_temp3){var _ref3=void 0===_temp3?{}:_temp3,_ref3$offset=_ref3.offset,offset=void 0===_ref3$offset?0:_ref3$offset,_ref3$mask=_ref3.mask,mask=void 0===_ref3$mask?[]:_ref3$mask;return a=byte_helpers_toUint8(a),(b=byte_helpers_toUint8(b)).length&&a.length-offset>=b.length&&(b.every?b.every:Array.prototype.every).call(b,function(bByte,i){return bByte===(mask[i]?mask[i]&a[offset+i]:a[offset+i])})},ID3=byte_helpers_toUint8([73,68,51]),getId3Offset=function getId3Offset(bytes,offset){return void 0===offset&&(offset=0),(bytes=byte_helpers_toUint8(bytes)).length-offset<10||!byte_helpers_bytesMatch(bytes,ID3,{offset:offset})?offset:(offset+=function(bytes,offset){void 0===offset&&(offset=0);var returnSize=(bytes=byte_helpers_toUint8(bytes))[offset+6]<<21|bytes[offset+7]<<14|bytes[offset+8]<<7|bytes[offset+9];return(16&bytes[offset+5])>>4?returnSize+20:returnSize+10}(bytes,offset),getId3Offset(bytes,offset))},normalizePath=(new Uint8Array([79,112,117,115,72,101,97,100]),function(path){return"string"==typeof path?stringToBytes(path):path}),parseDescriptors=function(bytes){bytes=byte_helpers_toUint8(bytes);for(var results=[],i=0;bytes.length>i;){var tag=bytes[i],size=0,headerSize=0,byte=bytes[++headerSize];for(headerSize++;128&byte;)size=(127&byte)<<7,byte=bytes[headerSize],headerSize++;size+=127&byte;for(var z=0;z<DESCRIPTORS.length;z++){var _DESCRIPTORS$z=DESCRIPTORS[z];if(tag===_DESCRIPTORS$z.id){results.push((0,_DESCRIPTORS$z.parser)(bytes.subarray(headerSize,headerSize+size)));break}}i+=size+headerSize}return results};DESCRIPTORS=[{id:3,parser:function(bytes){var desc={tag:3,id:bytes[0]<<8|bytes[1],flags:bytes[2],size:3,dependsOnEsId:0,ocrEsId:0,descriptors:[],url:""};if(128&desc.flags&&(desc.dependsOnEsId=bytes[desc.size]<<8|bytes[desc.size+1],desc.size+=2),64&desc.flags){var len=bytes[desc.size];desc.url=function(bytes){if(!bytes)return"";bytes=Array.prototype.slice.call(bytes);var string=String.fromCharCode.apply(null,byte_helpers_toUint8(bytes));try{return decodeURIComponent(escape(string))}catch(e){}return string}(bytes.subarray(desc.size+1,desc.size+1+len)),desc.size+=len}return 32&desc.flags&&(desc.ocrEsId=bytes[desc.size]<<8|bytes[desc.size+1],desc.size+=2),desc.descriptors=parseDescriptors(bytes.subarray(desc.size))||[],desc}},{id:4,parser:function(bytes){return{tag:4,oti:bytes[0],streamType:bytes[1],bufferSize:bytes[2]<<16|bytes[3]<<8|bytes[4],maxBitrate:bytes[5]<<24|bytes[6]<<16|bytes[7]<<8|bytes[8],avgBitrate:bytes[9]<<24|bytes[10]<<16|bytes[11]<<8|bytes[12],descriptors:parseDescriptors(bytes.subarray(13))}}},{id:5,parser:function(bytes){return{tag:5,bytes:bytes}}},{id:6,parser:function(bytes){return{tag:6,bytes:bytes}}}];var findBox=function findBox(bytes,paths,complete){void 0===complete&&(complete=!1),paths=function(paths){return Array.isArray(paths)?paths.map(function(p){return normalizePath(p)}):[normalizePath(paths)]}(paths),bytes=byte_helpers_toUint8(bytes);var results=[];if(!paths.length)return results;for(var i=0;i<bytes.length;){var size=(bytes[i]<<24|bytes[i+1]<<16|bytes[i+2]<<8|bytes[i+3])>>>0,type=bytes.subarray(i+4,i+8);if(0===size)break;var end=i+size;if(end>bytes.length){if(complete)break;end=bytes.length}var data=bytes.subarray(i+8,end);byte_helpers_bytesMatch(type,paths[0])&&(1===paths.length?results.push(data):results.push.apply(results,findBox(data,paths.slice(1),complete))),i=end}return results},EBML_TAGS={EBML:byte_helpers_toUint8([26,69,223,163]),DocType:byte_helpers_toUint8([66,130]),Segment:byte_helpers_toUint8([24,83,128,103]),SegmentInfo:byte_helpers_toUint8([21,73,169,102]),Tracks:byte_helpers_toUint8([22,84,174,107]),Track:byte_helpers_toUint8([174]),TrackNumber:byte_helpers_toUint8([215]),DefaultDuration:byte_helpers_toUint8([35,227,131]),TrackEntry:byte_helpers_toUint8([174]),TrackType:byte_helpers_toUint8([131]),FlagDefault:byte_helpers_toUint8([136]),CodecID:byte_helpers_toUint8([134]),CodecPrivate:byte_helpers_toUint8([99,162]),VideoTrack:byte_helpers_toUint8([224]),AudioTrack:byte_helpers_toUint8([225]),Cluster:byte_helpers_toUint8([31,67,182,117]),Timestamp:byte_helpers_toUint8([231]),TimestampScale:byte_helpers_toUint8([42,215,177]),BlockGroup:byte_helpers_toUint8([160]),BlockDuration:byte_helpers_toUint8([155]),Block:byte_helpers_toUint8([161]),SimpleBlock:byte_helpers_toUint8([163])},LENGTH_TABLE=[128,64,32,16,8,4,2,1],getvint=function(bytes,offset,removeLength,signed){void 0===removeLength&&(removeLength=!0),void 0===signed&&(signed=!1);var length=function(byte){for(var len=1,i=0;i<LENGTH_TABLE.length&&!(byte&LENGTH_TABLE[i]);i++)len++;return len}(bytes[offset]),valueBytes=bytes.subarray(offset,offset+length);return removeLength&&((valueBytes=Array.prototype.slice.call(bytes,offset,offset+length))[0]^=LENGTH_TABLE[length-1]),{length:length,value:byte_helpers_bytesToNumber(valueBytes,{signed:signed}),bytes:valueBytes}},ebml_helpers_normalizePath=function normalizePath(path){return"string"==typeof path?path.match(/.{1,2}/g).map(function(p){return normalizePath(p)}):"number"==typeof path?function(number,_temp2){var _ref2$le=(void 0===_temp2?{}:_temp2).le,le=void 0!==_ref2$le&&_ref2$le;("bigint"!=typeof number&&"number"!=typeof number||"number"==typeof number&&number!=number)&&(number=0),number=BigInt(number);for(var byteCount=Math.ceil(number.toString(2).length/8),bytes=new Uint8Array(new ArrayBuffer(byteCount)),i=0;i<byteCount;i++){var byteIndex=le?i:Math.abs(i+1-bytes.length);bytes[byteIndex]=Number(number/BYTE_TABLE[i]&BigInt(255)),number<0&&(bytes[byteIndex]=Math.abs(~bytes[byteIndex]),bytes[byteIndex]-=0===i?1:2)}return bytes}(path):path},getInfinityDataSize=function getInfinityDataSize(id,bytes,offset){if(offset>=bytes.length)return bytes.length;var innerid=getvint(bytes,offset,!1);if(byte_helpers_bytesMatch(id.bytes,innerid.bytes))return offset;var dataHeader=getvint(bytes,offset+innerid.length);return getInfinityDataSize(id,bytes,offset+dataHeader.length+dataHeader.value+innerid.length)},findEbml=function findEbml(bytes,paths){paths=function(paths){return Array.isArray(paths)?paths.map(function(p){return ebml_helpers_normalizePath(p)}):[ebml_helpers_normalizePath(paths)]}(paths),bytes=byte_helpers_toUint8(bytes);var results=[];if(!paths.length)return results;for(var i=0;i<bytes.length;){var id=getvint(bytes,i,!1),dataHeader=getvint(bytes,i+id.length),dataStart=i+id.length+dataHeader.length;127===dataHeader.value&&(dataHeader.value=getInfinityDataSize(id,bytes,dataStart),dataHeader.value!==bytes.length&&(dataHeader.value-=dataStart));var data=bytes.subarray(dataStart,dataStart+dataHeader.value>bytes.length?bytes.length:dataStart+dataHeader.value);byte_helpers_bytesMatch(paths[0],id.bytes)&&(1===paths.length?results.push(data):results=results.concat(findEbml(data,paths.slice(1)))),i+=id.length+dataHeader.length+data.length}return results},NAL_TYPE_ONE=byte_helpers_toUint8([0,0,0,1]),NAL_TYPE_TWO=byte_helpers_toUint8([0,0,1]),EMULATION_PREVENTION=byte_helpers_toUint8([0,0,3]),discardEmulationPreventionBytes=function(bytes){for(var positions=[],i=1;i<bytes.length-2;)byte_helpers_bytesMatch(bytes.subarray(i,i+3),EMULATION_PREVENTION)&&(positions.push(i+2),i++),i++;if(0===positions.length)return bytes;var newLength=bytes.length-positions.length,newData=new Uint8Array(newLength),sourceIndex=0;for(i=0;i<newLength;sourceIndex++,i++)sourceIndex===positions[0]&&(sourceIndex++,positions.shift()),newData[i]=bytes[sourceIndex];return newData},findNal=function(bytes,dataType,types,nalLimit){void 0===nalLimit&&(nalLimit=1/0),bytes=byte_helpers_toUint8(bytes),types=[].concat(types);for(var nalStart,i=0,nalsFound=0;i<bytes.length&&(nalsFound<nalLimit||nalStart);){var nalOffset=void 0;if(byte_helpers_bytesMatch(bytes.subarray(i),NAL_TYPE_ONE)?nalOffset=4:byte_helpers_bytesMatch(bytes.subarray(i),NAL_TYPE_TWO)&&(nalOffset=3),nalOffset){if(nalsFound++,nalStart)return discardEmulationPreventionBytes(bytes.subarray(nalStart,i));var nalType=void 0;"h264"===dataType?nalType=31&bytes[i+nalOffset]:"h265"===dataType&&(nalType=bytes[i+nalOffset]>>1&63),-1!==types.indexOf(nalType)&&(nalStart=i+nalOffset),i+=nalOffset+("h264"===dataType?1:2)}else i++}return bytes.subarray(0,0)},CONSTANTS={webm:byte_helpers_toUint8([119,101,98,109]),matroska:byte_helpers_toUint8([109,97,116,114,111,115,107,97]),flac:byte_helpers_toUint8([102,76,97,67]),ogg:byte_helpers_toUint8([79,103,103,83]),ac3:byte_helpers_toUint8([11,119]),riff:byte_helpers_toUint8([82,73,70,70]),avi:byte_helpers_toUint8([65,86,73]),wav:byte_helpers_toUint8([87,65,86,69]),"3gp":byte_helpers_toUint8([102,116,121,112,51,103]),mp4:byte_helpers_toUint8([102,116,121,112]),fmp4:byte_helpers_toUint8([115,116,121,112]),mov:byte_helpers_toUint8([102,116,121,112,113,116]),moov:byte_helpers_toUint8([109,111,111,118]),moof:byte_helpers_toUint8([109,111,111,102])},_isLikely={aac:function(bytes){var offset=getId3Offset(bytes);return byte_helpers_bytesMatch(bytes,[255,16],{offset:offset,mask:[255,22]})},mp3:function(bytes){var offset=getId3Offset(bytes);return byte_helpers_bytesMatch(bytes,[255,2],{offset:offset,mask:[255,6]})},webm:function(bytes){var docType=findEbml(bytes,[EBML_TAGS.EBML,EBML_TAGS.DocType])[0];return byte_helpers_bytesMatch(docType,CONSTANTS.webm)},mkv:function(bytes){var docType=findEbml(bytes,[EBML_TAGS.EBML,EBML_TAGS.DocType])[0];return byte_helpers_bytesMatch(docType,CONSTANTS.matroska)},mp4:function(bytes){return!_isLikely["3gp"](bytes)&&!_isLikely.mov(bytes)&&(!(!byte_helpers_bytesMatch(bytes,CONSTANTS.mp4,{offset:4})&&!byte_helpers_bytesMatch(bytes,CONSTANTS.fmp4,{offset:4}))||!(!byte_helpers_bytesMatch(bytes,CONSTANTS.moof,{offset:4})&&!byte_helpers_bytesMatch(bytes,CONSTANTS.moov,{offset:4}))||void 0)},mov:function(bytes){return byte_helpers_bytesMatch(bytes,CONSTANTS.mov,{offset:4})},"3gp":function(bytes){return byte_helpers_bytesMatch(bytes,CONSTANTS["3gp"],{offset:4})},ac3:function(bytes){var offset=getId3Offset(bytes);return byte_helpers_bytesMatch(bytes,CONSTANTS.ac3,{offset:offset})},ts:function(bytes){if(bytes.length<189&&bytes.length>=1)return 71===bytes[0];for(var i=0;i+188<bytes.length&&i<188;){if(71===bytes[i]&&71===bytes[i+188])return!0;i+=1}return!1},flac:function(bytes){var offset=getId3Offset(bytes);return byte_helpers_bytesMatch(bytes,CONSTANTS.flac,{offset:offset})},ogg:function(bytes){return byte_helpers_bytesMatch(bytes,CONSTANTS.ogg)},avi:function(bytes){return byte_helpers_bytesMatch(bytes,CONSTANTS.riff)&&byte_helpers_bytesMatch(bytes,CONSTANTS.avi,{offset:8})},wav:function(bytes){return byte_helpers_bytesMatch(bytes,CONSTANTS.riff)&&byte_helpers_bytesMatch(bytes,CONSTANTS.wav,{offset:8})},h264:function(bytes){return function(bytes,type,nalLimit){return findNal(bytes,"h264",7,3)}(bytes).length},h265:function(bytes){return function(bytes,type,nalLimit){return findNal(bytes,"h265",[32,33],3)}(bytes).length}},isLikelyTypes=Object.keys(_isLikely).filter(function(t){return"ts"!==t&&"h264"!==t&&"h265"!==t}).concat(["ts","h264","h265"]);isLikelyTypes.forEach(function(type){var isLikelyFn=_isLikely[type];_isLikely[type]=function(bytes){return isLikelyFn(byte_helpers_toUint8(bytes))}});for(var browserApi,isLikely=_isLikely,detectContainerForBytes=function(bytes){bytes=byte_helpers_toUint8(bytes);for(var i=0;i<isLikelyTypes.length;i++){var type=isLikelyTypes[i];if(isLikely[type](bytes))return type}return""},clock=__webpack_require__(52405),hooks_={},hooks=function(type,fn){return hooks_[type]=hooks_[type]||[],fn&&(hooks_[type]=hooks_[type].concat(fn)),hooks_[type]},removeHook=function(type,fn){var index=hooks(type).indexOf(fn);return!(index<=-1||(hooks_[type]=hooks_[type].slice(),hooks_[type].splice(index,1),0))},FullscreenApi={prefixed:!0},apiMap=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"]],specApi=apiMap[0],i=0;i<apiMap.length;i++)if(apiMap[i][1]in document_default()){browserApi=apiMap[i];break}if(browserApi){for(var _i=0;_i<browserApi.length;_i++)FullscreenApi[specApi[_i]]=browserApi[_i];FullscreenApi.prefixed=browserApi[0]!==specApi[0]}var video_es_history=[],log$1=function createLogger$1(name){var logByType,level="info",log=function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];logByType("log",level,args)};return logByType=function(name,log){return function(type,level,args){var lvl=log.levels[level],lvlRegExp=new RegExp("^("+lvl+")$");if("log"!==type&&args.unshift(type.toUpperCase()+":"),args.unshift(name+":"),video_es_history){video_es_history.push([].concat(args));var splice=video_es_history.length-1e3;video_es_history.splice(0,splice>0?splice:0)}if(window_default().console){var fn=window_default().console[type];fn||"debug"!==type||(fn=window_default().console.info||window_default().console.log),fn&&lvl&&lvlRegExp.test(type)&&fn[Array.isArray(args)?"apply":"call"](window_default().console,args)}}}(name,log),log.createLogger=function(subname){return createLogger$1(name+": "+subname)},log.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:level},log.level=function(lvl){if("string"==typeof lvl){if(!log.levels.hasOwnProperty(lvl))throw new Error('"'+lvl+'" in not a valid log level');level=lvl}return level},(log.history=function(){return video_es_history?[].concat(video_es_history):[]}).filter=function(fname){return(video_es_history||[]).filter(function(historyItem){return new RegExp(".*"+fname+".*").test(historyItem[0])})},log.history.clear=function(){video_es_history&&(video_es_history.length=0)},log.history.disable=function(){null!==video_es_history&&(video_es_history.length=0,video_es_history=null)},log.history.enable=function(){null===video_es_history&&(video_es_history=[])},log.error=function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return logByType("error",level,args)},log.warn=function(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++)args[_key3]=arguments[_key3];return logByType("warn",level,args)},log.debug=function(){for(var _len4=arguments.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++)args[_key4]=arguments[_key4];return logByType("debug",level,args)},log}("VIDEOJS"),createLogger=log$1.createLogger,video_es_toString=Object.prototype.toString,keys=function(object){return video_es_isObject(object)?Object.keys(object):[]};function each(object,fn){keys(object).forEach(function(key){return fn(object[key],key)})}function video_es_assign(target){for(var _len=arguments.length,sources=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)sources[_key-1]=arguments[_key];return Object.assign?extends_default().apply(void 0,[target].concat(sources)):(sources.forEach(function(source){source&&each(source,function(value,key){target[key]=value})}),target)}function video_es_isObject(value){return!!value&&"object"==typeof value}function isPlain(value){return video_es_isObject(value)&&"[object Object]"===video_es_toString.call(value)&&value.constructor===Object}function computedStyle(el,prop){if(!el||!prop)return"";if("function"==typeof window_default().getComputedStyle){var computedStyleValue;try{computedStyleValue=window_default().getComputedStyle(el)}catch(e){return""}return computedStyleValue?computedStyleValue.getPropertyValue(prop)||computedStyleValue[prop]:""}return""}var match,result,version,USER_AGENT=window_default().navigator&&window_default().navigator.userAgent||"",webkitVersionMap=/AppleWebKit\/([\d.]+)/i.exec(USER_AGENT),appleWebkitVersion=webkitVersionMap?parseFloat(webkitVersionMap.pop()):null,IS_IPOD=/iPod/i.test(USER_AGENT),IOS_VERSION=(match=USER_AGENT.match(/OS (\d+)_/i))&&match[1]?match[1]:null,IS_ANDROID=/Android/i.test(USER_AGENT),ANDROID_VERSION=function(){var match=USER_AGENT.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!match)return null;var major=match[1]&&parseFloat(match[1]),minor=match[2]&&parseFloat(match[2]);return major&&minor?parseFloat(match[1]+"."+match[2]):major||null}(),IS_NATIVE_ANDROID=IS_ANDROID&&ANDROID_VERSION<5&&appleWebkitVersion<537,IS_FIREFOX=/Firefox/i.test(USER_AGENT),IS_EDGE=/Edg/i.test(USER_AGENT),IS_CHROME=!IS_EDGE&&(/Chrome/i.test(USER_AGENT)||/CriOS/i.test(USER_AGENT)),CHROME_VERSION=function(){var match=USER_AGENT.match(/(Chrome|CriOS)\/(\d+)/);return match&&match[2]?parseFloat(match[2]):null}(),IE_VERSION=(result=/MSIE\s(\d+)\.\d/.exec(USER_AGENT),!(version=result&&parseFloat(result[1]))&&/Trident\/7.0/i.test(USER_AGENT)&&/rv:11.0/.test(USER_AGENT)&&(version=11),version),IS_SAFARI=/Safari/i.test(USER_AGENT)&&!IS_CHROME&&!IS_ANDROID&&!IS_EDGE,IS_WINDOWS=/Windows/i.test(USER_AGENT),TOUCH_ENABLED=Boolean(isReal()&&("ontouchstart"in window_default()||window_default().navigator.maxTouchPoints||window_default().DocumentTouch&&window_default().document instanceof window_default().DocumentTouch)),IS_IPAD=/iPad/i.test(USER_AGENT)||IS_SAFARI&&TOUCH_ENABLED&&!/iPhone/i.test(USER_AGENT),IS_IPHONE=/iPhone/i.test(USER_AGENT)&&!IS_IPAD,IS_IOS=IS_IPHONE||IS_IPAD||IS_IPOD,IS_ANY_SAFARI=(IS_SAFARI||IS_IOS)&&!IS_CHROME,browser=Object.freeze({__proto__:null,IS_IPOD:IS_IPOD,IOS_VERSION:IOS_VERSION,IS_ANDROID:IS_ANDROID,ANDROID_VERSION:ANDROID_VERSION,IS_NATIVE_ANDROID:IS_NATIVE_ANDROID,IS_FIREFOX:IS_FIREFOX,IS_EDGE:IS_EDGE,IS_CHROME:IS_CHROME,CHROME_VERSION:CHROME_VERSION,IE_VERSION:IE_VERSION,IS_SAFARI:IS_SAFARI,IS_WINDOWS:IS_WINDOWS,TOUCH_ENABLED:TOUCH_ENABLED,IS_IPAD:IS_IPAD,IS_IPHONE:IS_IPHONE,IS_IOS:IS_IOS,IS_ANY_SAFARI:IS_ANY_SAFARI});function isNonBlankString(str){return"string"==typeof str&&Boolean(str.trim())}function throwIfWhitespace(str){if(str.indexOf(" ")>=0)throw new Error("class has illegal whitespace characters")}function isReal(){return document_default()===window_default().document}function isEl(value){return video_es_isObject(value)&&1===value.nodeType}function isInFrame(){try{return window_default().parent!==window_default().self}catch(x){return!0}}function createQuerier(method){return function(selector,context){if(!isNonBlankString(selector))return document_default()[method](null);isNonBlankString(context)&&(context=document_default().querySelector(context));var ctx=isEl(context)?context:document_default();return ctx[method]&&ctx[method](selector)}}function createEl(tagName,properties,attributes,content){void 0===tagName&&(tagName="div"),void 0===properties&&(properties={}),void 0===attributes&&(attributes={});var el=document_default().createElement(tagName);return Object.getOwnPropertyNames(properties).forEach(function(propName){var val=properties[propName];-1!==propName.indexOf("aria-")||"role"===propName||"type"===propName?(log$1.warn("Setting attributes in the second argument of createEl()\nhas been deprecated. Use the third argument instead.\ncreateEl(type, properties, attributes). Attempting to set "+propName+" to "+val+"."),el.setAttribute(propName,val)):"textContent"===propName?textContent(el,val):el[propName]===val&&"tabIndex"!==propName||(el[propName]=val)}),Object.getOwnPropertyNames(attributes).forEach(function(attrName){el.setAttribute(attrName,attributes[attrName])}),content&&appendContent(el,content),el}function textContent(el,text){return void 0===el.textContent?el.innerText=text:el.textContent=text,el}function prependTo(child,parent){parent.firstChild?parent.insertBefore(child,parent.firstChild):parent.appendChild(child)}function hasClass(element,classToCheck){return throwIfWhitespace(classToCheck),element.classList?element.classList.contains(classToCheck):(className=classToCheck,new RegExp("(^|\\s)"+className+"($|\\s)")).test(element.className);var className}function addClass(element,classToAdd){return element.classList?element.classList.add(classToAdd):hasClass(element,classToAdd)||(element.className=(element.className+" "+classToAdd).trim()),element}function removeClass(element,classToRemove){return element?(element.classList?element.classList.remove(classToRemove):(throwIfWhitespace(classToRemove),element.className=element.className.split(/\s+/).filter(function(c){return c!==classToRemove}).join(" ")),element):(log$1.warn("removeClass was called with an element that doesn't exist"),null)}function toggleClass(element,classToToggle,predicate){var has=hasClass(element,classToToggle);if("function"==typeof predicate&&(predicate=predicate(element,classToToggle)),"boolean"!=typeof predicate&&(predicate=!has),predicate!==has)return predicate?addClass(element,classToToggle):removeClass(element,classToToggle),element}function setAttributes(el,attributes){Object.getOwnPropertyNames(attributes).forEach(function(attrName){var attrValue=attributes[attrName];null==attrValue||!1===attrValue?el.removeAttribute(attrName):el.setAttribute(attrName,!0===attrValue?"":attrValue)})}function getAttributes(tag){var obj={};if(tag&&tag.attributes&&tag.attributes.length>0)for(var attrs=tag.attributes,i=attrs.length-1;i>=0;i--){var attrName=attrs[i].name,attrVal=attrs[i].value;"boolean"!=typeof tag[attrName]&&-1===",autoplay,controls,playsinline,loop,muted,default,defaultMuted,".indexOf(","+attrName+",")||(attrVal=null!==attrVal),obj[attrName]=attrVal}return obj}function getAttribute(el,attribute){return el.getAttribute(attribute)}function setAttribute(el,attribute,value){el.setAttribute(attribute,value)}function removeAttribute(el,attribute){el.removeAttribute(attribute)}function blockTextSelection(){document_default().body.focus(),document_default().onselectstart=function(){return!1}}function unblockTextSelection(){document_default().onselectstart=function(){return!0}}function getBoundingClientRect(el){if(el&&el.getBoundingClientRect&&el.parentNode){var rect=el.getBoundingClientRect(),result={};return["bottom","height","left","right","top","width"].forEach(function(k){void 0!==rect[k]&&(result[k]=rect[k])}),result.height||(result.height=parseFloat(computedStyle(el,"height"))),result.width||(result.width=parseFloat(computedStyle(el,"width"))),result}}function findPosition(el){if(!el||el&&!el.offsetParent)return{left:0,top:0,width:0,height:0};for(var width=el.offsetWidth,height=el.offsetHeight,left=0,top=0;el.offsetParent&&el!==document_default()[FullscreenApi.fullscreenElement];)left+=el.offsetLeft,top+=el.offsetTop,el=el.offsetParent;return{left:left,top:top,width:width,height:height}}function getPointerPosition(el,event){var translated={x:0,y:0};if(IS_IOS)for(var item=el;item&&"html"!==item.nodeName.toLowerCase();){var transform=computedStyle(item,"transform");if(/^matrix/.test(transform)){var values=transform.slice(7,-1).split(/,\s/).map(Number);translated.x+=values[4],translated.y+=values[5]}else if(/^matrix3d/.test(transform)){var _values=transform.slice(9,-1).split(/,\s/).map(Number);translated.x+=_values[12],translated.y+=_values[13]}item=item.parentNode}var position={},boxTarget=findPosition(event.target),box=findPosition(el),boxW=box.width,offsetY=event.offsetY-(box.top-boxTarget.top),offsetX=event.offsetX-(box.left-boxTarget.left);return event.changedTouches&&(offsetX=event.changedTouches[0].pageX-box.left,offsetY=event.changedTouches[0].pageY+box.top,IS_IOS&&(offsetX-=translated.x,offsetY-=translated.y)),position.y=1-Math.max(0,Math.min(1,offsetY/box.height)),position.x=Math.max(0,Math.min(1,offsetX/boxW)),position}function isTextNode(value){return video_es_isObject(value)&&3===value.nodeType}function emptyEl(el){for(;el.firstChild;)el.removeChild(el.firstChild);return el}function normalizeContent(content){return"function"==typeof content&&(content=content()),(Array.isArray(content)?content:[content]).map(function(value){return"function"==typeof value&&(value=value()),isEl(value)||isTextNode(value)?value:"string"==typeof value&&/\S/.test(value)?document_default().createTextNode(value):void 0}).filter(function(value){return value})}function appendContent(el,content){return normalizeContent(content).forEach(function(node){return el.appendChild(node)}),el}function insertContent(el,content){return appendContent(emptyEl(el),content)}function isSingleLeftClick(event){return void 0===event.button&&void 0===event.buttons||0===event.button&&void 0===event.buttons||"mouseup"===event.type&&0===event.button&&0===event.buttons||0===event.button&&1===event.buttons}var videojs$1,$=createQuerier("querySelector"),$$=createQuerier("querySelectorAll"),Dom=Object.freeze({__proto__:null,isReal:isReal,isEl:isEl,isInFrame:isInFrame,createEl:createEl,textContent:textContent,prependTo:prependTo,hasClass:hasClass,addClass:addClass,removeClass:removeClass,toggleClass:toggleClass,setAttributes:setAttributes,getAttributes:getAttributes,getAttribute:getAttribute,setAttribute:setAttribute,removeAttribute:removeAttribute,blockTextSelection:blockTextSelection,unblockTextSelection:unblockTextSelection,getBoundingClientRect:getBoundingClientRect,findPosition:findPosition,getPointerPosition:getPointerPosition,isTextNode:isTextNode,emptyEl:emptyEl,normalizeContent:normalizeContent,appendContent:appendContent,insertContent:insertContent,isSingleLeftClick:isSingleLeftClick,$:$,$$:$$}),_windowLoaded=!1,autoSetup=function(){if(!1!==videojs$1.options.autoSetup){var vids=Array.prototype.slice.call(document_default().getElementsByTagName("video")),audios=Array.prototype.slice.call(document_default().getElementsByTagName("audio")),divs=Array.prototype.slice.call(document_default().getElementsByTagName("video-js")),mediaEls=vids.concat(audios,divs);if(mediaEls&&mediaEls.length>0)for(var i=0,e=mediaEls.length;i<e;i++){var mediaEl=mediaEls[i];if(!mediaEl||!mediaEl.getAttribute){autoSetupTimeout(1);break}void 0===mediaEl.player&&null!==mediaEl.getAttribute("data-setup")&&videojs$1(mediaEl)}else _windowLoaded||autoSetupTimeout(1)}};function autoSetupTimeout(wait,vjs){isReal()&&(vjs&&(videojs$1=vjs),window_default().setTimeout(autoSetup,wait))}function setWindowLoaded(){_windowLoaded=!0,window_default().removeEventListener("load",setWindowLoaded)}isReal()&&("complete"===document_default().readyState?setWindowLoaded():window_default().addEventListener("load",setWindowLoaded));var FakeWeakMap,createStyleElement=function(className){var style=document_default().createElement("style");return style.className=className,style},setTextContent=function(el,content){el.styleSheet?el.styleSheet.cssText=content:el.textContent=content},_guid=3;function newGUID(){return _guid++}window_default().WeakMap||(FakeWeakMap=function(){function FakeWeakMap(){this.vdata="vdata"+Math.floor(window_default().performance&&window_default().performance.now()||Date.now()),this.data={}}var _proto=FakeWeakMap.prototype;return _proto.set=function(key,value){var access=key[this.vdata]||newGUID();return key[this.vdata]||(key[this.vdata]=access),this.data[access]=value,this},_proto.get=function(key){var access=key[this.vdata];if(access)return this.data[access];log$1("We have no data for this element",key)},_proto.has=function(key){return key[this.vdata]in this.data},_proto.delete=function(key){var access=key[this.vdata];access&&(delete this.data[access],delete key[this.vdata])},FakeWeakMap}());var _supportsPassive,DomData=window_default().WeakMap?new WeakMap:new FakeWeakMap;function _cleanUpEvents(elem,type){if(DomData.has(elem)){var data=DomData.get(elem);0===data.handlers[type].length&&(delete data.handlers[type],elem.removeEventListener?elem.removeEventListener(type,data.dispatcher,!1):elem.detachEvent&&elem.detachEvent("on"+type,data.dispatcher)),Object.getOwnPropertyNames(data.handlers).length<=0&&(delete data.handlers,delete data.dispatcher,delete data.disabled),0===Object.getOwnPropertyNames(data).length&&DomData.delete(elem)}}function _handleMultipleEvents(fn,elem,types,callback){types.forEach(function(type){fn(elem,type,callback)})}function fixEvent(event){if(event.fixed_)return event;function returnTrue(){return!0}function returnFalse(){return!1}if(!event||!event.isPropagationStopped||!event.isImmediatePropagationStopped){var old=event||window_default().event;for(var key in event={},old)"layerX"!==key&&"layerY"!==key&&"keyLocation"!==key&&"webkitMovementX"!==key&&"webkitMovementY"!==key&&("returnValue"===key&&old.preventDefault||(event[key]=old[key]));if(event.target||(event.target=event.srcElement||document_default()),event.relatedTarget||(event.relatedTarget=event.fromElement===event.target?event.toElement:event.fromElement),event.preventDefault=function(){old.preventDefault&&old.preventDefault(),event.returnValue=!1,old.returnValue=!1,event.defaultPrevented=!0},event.defaultPrevented=!1,event.stopPropagation=function(){old.stopPropagation&&old.stopPropagation(),event.cancelBubble=!0,old.cancelBubble=!0,event.isPropagationStopped=returnTrue},event.isPropagationStopped=returnFalse,event.stopImmediatePropagation=function(){old.stopImmediatePropagation&&old.stopImmediatePropagation(),event.isImmediatePropagationStopped=returnTrue,event.stopPropagation()},event.isImmediatePropagationStopped=returnFalse,null!=event.clientX){var doc=document_default().documentElement,body=document_default().body;event.pageX=event.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0),event.pageY=event.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)}event.which=event.charCode||event.keyCode,null!=event.button&&(event.button=1&event.button?0:4&event.button?1:2&event.button?2:0)}return event.fixed_=!0,event}var passiveEvents=["touchstart","touchmove"];function on(elem,type,fn){if(Array.isArray(type))return _handleMultipleEvents(on,elem,type,fn);DomData.has(elem)||DomData.set(elem,{});var data=DomData.get(elem);if(data.handlers||(data.handlers={}),data.handlers[type]||(data.handlers[type]=[]),fn.guid||(fn.guid=newGUID()),data.handlers[type].push(fn),data.dispatcher||(data.disabled=!1,data.dispatcher=function(event,hash){if(!data.disabled){event=fixEvent(event);var handlers=data.handlers[event.type];if(handlers)for(var handlersCopy=handlers.slice(0),m=0,n=handlersCopy.length;m<n&&!event.isImmediatePropagationStopped();m++)try{handlersCopy[m].call(elem,event,hash)}catch(e){log$1.error(e)}}}),1===data.handlers[type].length)if(elem.addEventListener){var options=!1;(function(){if("boolean"!=typeof _supportsPassive){_supportsPassive=!1;try{var opts=Object.defineProperty({},"passive",{get:function(){_supportsPassive=!0}});window_default().addEventListener("test",null,opts),window_default().removeEventListener("test",null,opts)}catch(e){}}return _supportsPassive})()&&passiveEvents.indexOf(type)>-1&&(options={passive:!0}),elem.addEventListener(type,data.dispatcher,options)}else elem.attachEvent&&elem.attachEvent("on"+type,data.dispatcher)}function off(elem,type,fn){if(DomData.has(elem)){var data=DomData.get(elem);if(data.handlers){if(Array.isArray(type))return _handleMultipleEvents(off,elem,type,fn);var removeType=function(el,t){data.handlers[t]=[],_cleanUpEvents(el,t)};if(void 0!==type){var handlers=data.handlers[type];if(handlers)if(fn){if(fn.guid)for(var n=0;n<handlers.length;n++)handlers[n].guid===fn.guid&&handlers.splice(n--,1);_cleanUpEvents(elem,type)}else removeType(elem,type)}else for(var t in data.handlers)Object.prototype.hasOwnProperty.call(data.handlers||{},t)&&removeType(elem,t)}}}function trigger(elem,event,hash){var elemData=DomData.has(elem)?DomData.get(elem):{},parent=elem.parentNode||elem.ownerDocument;if("string"==typeof event?event={type:event,target:elem}:event.target||(event.target=elem),event=fixEvent(event),elemData.dispatcher&&elemData.dispatcher.call(elem,event,hash),parent&&!event.isPropagationStopped()&&!0===event.bubbles)trigger.call(null,parent,event,hash);else if(!parent&&!event.defaultPrevented&&event.target&&event.target[event.type]){DomData.has(event.target)||DomData.set(event.target,{});var targetData=DomData.get(event.target);event.target[event.type]&&(targetData.disabled=!0,"function"==typeof event.target[event.type]&&event.target[event.type](),targetData.disabled=!1)}return!event.defaultPrevented}function one(elem,type,fn){if(Array.isArray(type))return _handleMultipleEvents(one,elem,type,fn);var func=function func(){off(elem,type,func),fn.apply(this,arguments)};func.guid=fn.guid=fn.guid||newGUID(),on(elem,type,func)}function any(elem,type,fn){var func=function func(){off(elem,type,func),fn.apply(this,arguments)};func.guid=fn.guid=fn.guid||newGUID(),on(elem,type,func)}var EVENT_MAP,Events=Object.freeze({__proto__:null,fixEvent:fixEvent,on:on,off:off,trigger:trigger,one:one,any:any}),bind=function(context,fn,uid){fn.guid||(fn.guid=newGUID());var bound=fn.bind(context);return bound.guid=uid?uid+"_"+fn.guid:fn.guid,bound},throttle=function(fn,wait){var last=window_default().performance.now();return function(){var now=window_default().performance.now();now-last>=wait&&(fn.apply(void 0,arguments),last=now)}},EventTarget$2=function(){};EventTarget$2.prototype.allowedEvents_={},EventTarget$2.prototype.addEventListener=EventTarget$2.prototype.on=function(type,fn){var ael=this.addEventListener;this.addEventListener=function(){},on(this,type,fn),this.addEventListener=ael},EventTarget$2.prototype.removeEventListener=EventTarget$2.prototype.off=function(type,fn){off(this,type,fn)},EventTarget$2.prototype.one=function(type,fn){var ael=this.addEventListener;this.addEventListener=function(){},one(this,type,fn),this.addEventListener=ael},EventTarget$2.prototype.any=function(type,fn){var ael=this.addEventListener;this.addEventListener=function(){},any(this,type,fn),this.addEventListener=ael},EventTarget$2.prototype.dispatchEvent=EventTarget$2.prototype.trigger=function(event){var type=event.type||event;"string"==typeof event&&(event={type:type}),event=fixEvent(event),this.allowedEvents_[type]&&this["on"+type]&&this["on"+type](event),trigger(this,event)},EventTarget$2.prototype.queueTrigger=function(event){var _this=this;EVENT_MAP||(EVENT_MAP=new Map);var type=event.type||event,map=EVENT_MAP.get(this);map||(map=new Map,EVENT_MAP.set(this,map));var oldTimeout=map.get(type);map.delete(type),window_default().clearTimeout(oldTimeout);var timeout=window_default().setTimeout(function(){0===map.size&&(map=null,EVENT_MAP.delete(_this)),_this.trigger(event)},0);map.set(type,timeout)};var objName=function(obj){return"function"==typeof obj.name?obj.name():"string"==typeof obj.name?obj.name:obj.name_?obj.name_:obj.constructor&&obj.constructor.name?obj.constructor.name:typeof obj},isEvented=function(object){return object instanceof EventTarget$2||!!object.eventBusEl_&&["on","one","off","trigger"].every(function(k){return"function"==typeof object[k]})},isValidEventType=function(type){return"string"==typeof type&&/\S/.test(type)||Array.isArray(type)&&!!type.length},validateTarget=function(target,obj,fnName){if(!target||!target.nodeName&&!isEvented(target))throw new Error("Invalid target for "+objName(obj)+"#"+fnName+"; must be a DOM node or evented object.")},validateEventType=function(type,obj,fnName){if(!isValidEventType(type))throw new Error("Invalid event type for "+objName(obj)+"#"+fnName+"; must be a non-empty string or array.")},validateListener=function(listener,obj,fnName){if("function"!=typeof listener)throw new Error("Invalid listener for "+objName(obj)+"#"+fnName+"; must be a function.")},normalizeListenArgs=function(self,args,fnName){var target,type,listener,isTargetingSelf=args.length<3||args[0]===self||args[0]===self.eventBusEl_;return isTargetingSelf?(target=self.eventBusEl_,args.length>=3&&args.shift(),type=args[0],listener=args[1]):(target=args[0],type=args[1],listener=args[2]),validateTarget(target,self,fnName),validateEventType(type,self,fnName),validateListener(listener,self,fnName),{isTargetingSelf:isTargetingSelf,target:target,type:type,listener:listener=bind(self,listener)}},listen=function(target,method,type,listener){validateTarget(target,target,method),target.nodeName?Events[method](target,type,listener):target[method](type,listener)},EventedMixin={on:function(){for(var _this=this,_len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var _normalizeListenArgs=normalizeListenArgs(this,args,"on"),isTargetingSelf=_normalizeListenArgs.isTargetingSelf,target=_normalizeListenArgs.target,type=_normalizeListenArgs.type,listener=_normalizeListenArgs.listener;if(listen(target,"on",type,listener),!isTargetingSelf){var removeListenerOnDispose=function(){return _this.off(target,type,listener)};removeListenerOnDispose.guid=listener.guid;var removeRemoverOnTargetDispose=function(){return _this.off("dispose",removeListenerOnDispose)};removeRemoverOnTargetDispose.guid=listener.guid,listen(this,"on","dispose",removeListenerOnDispose),listen(target,"on","dispose",removeRemoverOnTargetDispose)}},one:function(){for(var _this2=this,_len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];var _normalizeListenArgs2=normalizeListenArgs(this,args,"one"),isTargetingSelf=_normalizeListenArgs2.isTargetingSelf,target=_normalizeListenArgs2.target,type=_normalizeListenArgs2.type,listener=_normalizeListenArgs2.listener;if(isTargetingSelf)listen(target,"one",type,listener);else{var wrapper=function wrapper(){_this2.off(target,type,wrapper);for(var _len3=arguments.length,largs=new Array(_len3),_key3=0;_key3<_len3;_key3++)largs[_key3]=arguments[_key3];listener.apply(null,largs)};wrapper.guid=listener.guid,listen(target,"one",type,wrapper)}},any:function(){for(var _this3=this,_len4=arguments.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++)args[_key4]=arguments[_key4];var _normalizeListenArgs3=normalizeListenArgs(this,args,"any"),isTargetingSelf=_normalizeListenArgs3.isTargetingSelf,target=_normalizeListenArgs3.target,type=_normalizeListenArgs3.type,listener=_normalizeListenArgs3.listener;if(isTargetingSelf)listen(target,"any",type,listener);else{var wrapper=function wrapper(){_this3.off(target,type,wrapper);for(var _len5=arguments.length,largs=new Array(_len5),_key5=0;_key5<_len5;_key5++)largs[_key5]=arguments[_key5];listener.apply(null,largs)};wrapper.guid=listener.guid,listen(target,"any",type,wrapper)}},off:function(targetOrType,typeOrListener,listener){if(!targetOrType||isValidEventType(targetOrType))off(this.eventBusEl_,targetOrType,typeOrListener);else{var target=targetOrType,type=typeOrListener;validateTarget(target,this,"off"),validateEventType(type,this,"off"),validateListener(listener,this,"off"),listener=bind(this,listener),this.off("dispose",listener),target.nodeName?(off(target,type,listener),off(target,"dispose",listener)):isEvented(target)&&(target.off(type,listener),target.off("dispose",listener))}},trigger:function(event,hash){if(validateTarget(this.eventBusEl_,this,"trigger"),!isValidEventType(event&&"string"!=typeof event?event.type:event)){var error="Invalid event type for "+objName(this)+"#trigger; must be a non-empty string or object with a type key that has a non-empty value.";if(!event)throw new Error(error);(this.log||log$1).error(error)}return trigger(this.eventBusEl_,event,hash)}};function evented(target,options){void 0===options&&(options={});var eventBusKey=options.eventBusKey;if(eventBusKey){if(!target[eventBusKey].nodeName)throw new Error('The eventBusKey "'+eventBusKey+'" does not refer to an element.');target.eventBusEl_=target[eventBusKey]}else target.eventBusEl_=createEl("span",{className:"vjs-event-bus"});return video_es_assign(target,EventedMixin),target.eventedCallbacks&&target.eventedCallbacks.forEach(function(callback){callback()}),target.on("dispose",function(){target.off(),[target,target.el_,target.eventBusEl_].forEach(function(val){val&&DomData.has(val)&&DomData.delete(val)}),window_default().setTimeout(function(){target.eventBusEl_=null},0)}),target}var StatefulMixin={state:{},setState:function(stateUpdates){var changes,_this=this;return"function"==typeof stateUpdates&&(stateUpdates=stateUpdates()),each(stateUpdates,function(value,key){_this.state[key]!==value&&((changes=changes||{})[key]={from:_this.state[key],to:value}),_this.state[key]=value}),changes&&isEvented(this)&&this.trigger({changes:changes,type:"statechanged"}),changes}};function stateful(target,defaultState){return video_es_assign(target,StatefulMixin),target.state=video_es_assign({},target.state,defaultState),"function"==typeof target.handleStateChanged&&isEvented(target)&&target.on("statechanged",target.handleStateChanged),target}var toLowerCase=function(string){return"string"!=typeof string?string:string.replace(/./,function(w){return w.toLowerCase()})},toTitleCase$1=function(string){return"string"!=typeof string?string:string.replace(/./,function(w){return w.toUpperCase()})};function mergeOptions$3(){for(var result={},_len=arguments.length,sources=new Array(_len),_key=0;_key<_len;_key++)sources[_key]=arguments[_key];return sources.forEach(function(source){source&&each(source,function(value,key){isPlain(value)?(isPlain(result[key])||(result[key]={}),result[key]=mergeOptions$3(result[key],value)):result[key]=value})}),result}var MapSham=function(){function MapSham(){this.map_={}}var _proto=MapSham.prototype;return _proto.has=function(key){return key in this.map_},_proto.delete=function(key){var has=this.has(key);return delete this.map_[key],has},_proto.set=function(key,value){return this.map_[key]=value,this},_proto.forEach=function(callback,thisArg){for(var key in this.map_)callback.call(thisArg,this.map_[key],key,this)},MapSham}(),Map$1=window_default().Map?window_default().Map:MapSham,SetSham=function(){function SetSham(){this.set_={}}var _proto=SetSham.prototype;return _proto.has=function(key){return key in this.set_},_proto.delete=function(key){var has=this.has(key);return delete this.set_[key],has},_proto.add=function(key){return this.set_[key]=1,this},_proto.forEach=function(callback,thisArg){for(var key in this.set_)callback.call(thisArg,key,key,this)},SetSham}(),Set=window_default().Set?window_default().Set:SetSham,Component$1=function(){function Component(player,options,ready){if(this.player_=!player&&this.play?player=this:player,this.isDisposed_=!1,this.parentComponent_=null,this.options_=mergeOptions$3({},this.options_),options=this.options_=mergeOptions$3(this.options_,options),this.id_=options.id||options.el&&options.el.id,!this.id_){var id=player&&player.id&&player.id()||"no_player";this.id_=id+"_component_"+newGUID()}this.name_=options.name||null,options.el?this.el_=options.el:!1!==options.createEl&&(this.el_=this.createEl()),!1!==options.evented&&(evented(this,{eventBusKey:this.el_?"el_":null}),this.handleLanguagechange=this.handleLanguagechange.bind(this),this.on(this.player_,"languagechange",this.handleLanguagechange)),stateful(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.setTimeoutIds_=new Set,this.setIntervalIds_=new Set,this.rafIds_=new Set,this.namedRafs_=new Map$1,this.clearingTimersOnDispose_=!1,!1!==options.initChildren&&this.initChildren(),this.ready(ready),!1!==options.reportTouchActivity&&this.enableTouchActivity()}var _proto=Component.prototype;return _proto.dispose=function(){if(!this.isDisposed_){if(this.readyQueue_&&(this.readyQueue_.length=0),this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(var i=this.children_.length-1;i>=0;i--)this.children_[i].dispose&&this.children_[i].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),this.el_=null),this.player_=null}},_proto.isDisposed=function(){return Boolean(this.isDisposed_)},_proto.player=function(){return this.player_},_proto.options=function(obj){return obj?(this.options_=mergeOptions$3(this.options_,obj),this.options_):this.options_},_proto.el=function(){return this.el_},_proto.createEl=function(tagName,properties,attributes){return createEl(tagName,properties,attributes)},_proto.localize=function(string,tokens,defaultValue){void 0===defaultValue&&(defaultValue=string);var code=this.player_.language&&this.player_.language(),languages=this.player_.languages&&this.player_.languages(),language=languages&&languages[code],primaryCode=code&&code.split("-")[0],primaryLang=languages&&languages[primaryCode],localizedString=defaultValue;return language&&language[string]?localizedString=language[string]:primaryLang&&primaryLang[string]&&(localizedString=primaryLang[string]),tokens&&(localizedString=localizedString.replace(/\{(\d+)\}/g,function(match,index){var value=tokens[index-1],ret=value;return void 0===value&&(ret=match),ret})),localizedString},_proto.handleLanguagechange=function(){},_proto.contentEl=function(){return this.contentEl_||this.el_},_proto.id=function(){return this.id_},_proto.name=function(){return this.name_},_proto.children=function(){return this.children_},_proto.getChildById=function(id){return this.childIndex_[id]},_proto.getChild=function(name){if(name)return this.childNameIndex_[name]},_proto.getDescendant=function(){for(var _len=arguments.length,names=new Array(_len),_key=0;_key<_len;_key++)names[_key]=arguments[_key];names=names.reduce(function(acc,n){return acc.concat(n)},[]);for(var currentChild=this,i=0;i<names.length;i++)if(!(currentChild=currentChild.getChild(names[i]))||!currentChild.getChild)return;return currentChild},_proto.addChild=function(child,options,index){var component,componentName;if(void 0===options&&(options={}),void 0===index&&(index=this.children_.length),"string"==typeof child){componentName=toTitleCase$1(child);var componentClassName=options.componentClass||componentName;options.name=componentName;var ComponentClass=Component.getComponent(componentClassName);if(!ComponentClass)throw new Error("Component "+componentClassName+" does not exist");if("function"!=typeof ComponentClass)return null;component=new ComponentClass(this.player_||this,options)}else component=child;if(component.parentComponent_&&component.parentComponent_.removeChild(component),this.children_.splice(index,0,component),component.parentComponent_=this,"function"==typeof component.id&&(this.childIndex_[component.id()]=component),(componentName=componentName||component.name&&toTitleCase$1(component.name()))&&(this.childNameIndex_[componentName]=component,this.childNameIndex_[toLowerCase(componentName)]=component),"function"==typeof component.el&&component.el()){var refNode=null;this.children_[index+1]&&(this.children_[index+1].el_?refNode=this.children_[index+1].el_:isEl(this.children_[index+1])&&(refNode=this.children_[index+1])),this.contentEl().insertBefore(component.el(),refNode)}return component},_proto.removeChild=function(component){if("string"==typeof component&&(component=this.getChild(component)),component&&this.children_){for(var childFound=!1,i=this.children_.length-1;i>=0;i--)if(this.children_[i]===component){childFound=!0,this.children_.splice(i,1);break}if(childFound){component.parentComponent_=null,this.childIndex_[component.id()]=null,this.childNameIndex_[toTitleCase$1(component.name())]=null,this.childNameIndex_[toLowerCase(component.name())]=null;var compEl=component.el();compEl&&compEl.parentNode===this.contentEl()&&this.contentEl().removeChild(component.el())}}},_proto.initChildren=function(){var _this=this,children=this.options_.children;if(children){var workingChildren,parentOptions=this.options_,Tech=Component.getComponent("Tech");(workingChildren=Array.isArray(children)?children:Object.keys(children)).concat(Object.keys(this.options_).filter(function(child){return!workingChildren.some(function(wchild){return"string"==typeof wchild?child===wchild:child===wchild.name})})).map(function(child){var name,opts;return"string"==typeof child?opts=children[name=child]||_this.options_[name]||{}:(name=child.name,opts=child),{name:name,opts:opts}}).filter(function(child){var c=Component.getComponent(child.opts.componentClass||toTitleCase$1(child.name));return c&&!Tech.isTech(c)}).forEach(function(child){var name=child.name,opts=child.opts;if(void 0!==parentOptions[name]&&(opts=parentOptions[name]),!1!==opts){!0===opts&&(opts={}),opts.playerOptions=_this.options_.playerOptions;var newChild=_this.addChild(name,opts);newChild&&(_this[name]=newChild)}})}},_proto.buildCSSClass=function(){return""},_proto.ready=function(fn,sync){if(void 0===sync&&(sync=!1),fn)return this.isReady_?void(sync?fn.call(this):this.setTimeout(fn,1)):(this.readyQueue_=this.readyQueue_||[],void this.readyQueue_.push(fn))},_proto.triggerReady=function(){this.isReady_=!0,this.setTimeout(function(){var readyQueue=this.readyQueue_;this.readyQueue_=[],readyQueue&&readyQueue.length>0&&readyQueue.forEach(function(fn){fn.call(this)},this),this.trigger("ready")},1)},_proto.$=function(selector,context){return $(selector,context||this.contentEl())},_proto.$$=function(selector,context){return $$(selector,context||this.contentEl())},_proto.hasClass=function(classToCheck){return hasClass(this.el_,classToCheck)},_proto.addClass=function(classToAdd){addClass(this.el_,classToAdd)},_proto.removeClass=function(classToRemove){removeClass(this.el_,classToRemove)},_proto.toggleClass=function(classToToggle,predicate){toggleClass(this.el_,classToToggle,predicate)},_proto.show=function(){this.removeClass("vjs-hidden")},_proto.hide=function(){this.addClass("vjs-hidden")},_proto.lockShowing=function(){this.addClass("vjs-lock-showing")},_proto.unlockShowing=function(){this.removeClass("vjs-lock-showing")},_proto.getAttribute=function(attribute){return getAttribute(this.el_,attribute)},_proto.setAttribute=function(attribute,value){setAttribute(this.el_,attribute,value)},_proto.removeAttribute=function(attribute){removeAttribute(this.el_,attribute)},_proto.width=function(num,skipListeners){return this.dimension("width",num,skipListeners)},_proto.height=function(num,skipListeners){return this.dimension("height",num,skipListeners)},_proto.dimensions=function(width,height){this.width(width,!0),this.height(height)},_proto.dimension=function(widthOrHeight,num,skipListeners){if(void 0!==num)return null!==num&&num==num||(num=0),this.el_.style[widthOrHeight]=-1!==(""+num).indexOf("%")||-1!==(""+num).indexOf("px")?num:"auto"===num?"":num+"px",void(skipListeners||this.trigger("componentresize"));if(!this.el_)return 0;var val=this.el_.style[widthOrHeight],pxIndex=val.indexOf("px");return-1!==pxIndex?parseInt(val.slice(0,pxIndex),10):parseInt(this.el_["offset"+toTitleCase$1(widthOrHeight)],10)},_proto.currentDimension=function(widthOrHeight){var computedWidthOrHeight=0;if("width"!==widthOrHeight&&"height"!==widthOrHeight)throw new Error("currentDimension only accepts width or height value");if(computedWidthOrHeight=computedStyle(this.el_,widthOrHeight),0===(computedWidthOrHeight=parseFloat(computedWidthOrHeight))||isNaN(computedWidthOrHeight)){var rule="offset"+toTitleCase$1(widthOrHeight);computedWidthOrHeight=this.el_[rule]}return computedWidthOrHeight},_proto.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}},_proto.currentWidth=function(){return this.currentDimension("width")},_proto.currentHeight=function(){return this.currentDimension("height")},_proto.focus=function(){this.el_.focus()},_proto.blur=function(){this.el_.blur()},_proto.handleKeyDown=function(event){this.player_&&(event.stopPropagation(),this.player_.handleKeyDown(event))},_proto.handleKeyPress=function(event){this.handleKeyDown(event)},_proto.emitTapEvents=function(){var couldBeTap,touchStart=0,firstTouch=null;this.on("touchstart",function(event){1===event.touches.length&&(firstTouch={pageX:event.touches[0].pageX,pageY:event.touches[0].pageY},touchStart=window_default().performance.now(),couldBeTap=!0)}),this.on("touchmove",function(event){if(event.touches.length>1)couldBeTap=!1;else if(firstTouch){var xdiff=event.touches[0].pageX-firstTouch.pageX,ydiff=event.touches[0].pageY-firstTouch.pageY;Math.sqrt(xdiff*xdiff+ydiff*ydiff)>10&&(couldBeTap=!1)}});var noTap=function(){couldBeTap=!1};this.on("touchleave",noTap),this.on("touchcancel",noTap),this.on("touchend",function(event){firstTouch=null,!0===couldBeTap&&window_default().performance.now()-touchStart<200&&(event.preventDefault(),this.trigger("tap"))})},_proto.enableTouchActivity=function(){if(this.player()&&this.player().reportUserActivity){var touchHolding,report=bind(this.player(),this.player().reportUserActivity);this.on("touchstart",function(){report(),this.clearInterval(touchHolding),touchHolding=this.setInterval(report,250)});var touchEnd=function(event){report(),this.clearInterval(touchHolding)};this.on("touchmove",report),this.on("touchend",touchEnd),this.on("touchcancel",touchEnd)}},_proto.setTimeout=function(fn,timeout){var timeoutId,_this2=this;return fn=bind(this,fn),this.clearTimersOnDispose_(),timeoutId=window_default().setTimeout(function(){_this2.setTimeoutIds_.has(timeoutId)&&_this2.setTimeoutIds_.delete(timeoutId),fn()},timeout),this.setTimeoutIds_.add(timeoutId),timeoutId},_proto.clearTimeout=function(timeoutId){return this.setTimeoutIds_.has(timeoutId)&&(this.setTimeoutIds_.delete(timeoutId),window_default().clearTimeout(timeoutId)),timeoutId},_proto.setInterval=function(fn,interval){fn=bind(this,fn),this.clearTimersOnDispose_();var intervalId=window_default().setInterval(fn,interval);return this.setIntervalIds_.add(intervalId),intervalId},_proto.clearInterval=function(intervalId){return this.setIntervalIds_.has(intervalId)&&(this.setIntervalIds_.delete(intervalId),window_default().clearInterval(intervalId)),intervalId},_proto.requestAnimationFrame=function(fn){var id,_this3=this;return this.supportsRaf_?(this.clearTimersOnDispose_(),fn=bind(this,fn),id=window_default().requestAnimationFrame(function(){_this3.rafIds_.has(id)&&_this3.rafIds_.delete(id),fn()}),this.rafIds_.add(id),id):this.setTimeout(fn,1e3/60)},_proto.requestNamedAnimationFrame=function(name,fn){var _this4=this;if(!this.namedRafs_.has(name)){this.clearTimersOnDispose_(),fn=bind(this,fn);var id=this.requestAnimationFrame(function(){fn(),_this4.namedRafs_.has(name)&&_this4.namedRafs_.delete(name)});return this.namedRafs_.set(name,id),name}},_proto.cancelNamedAnimationFrame=function(name){this.namedRafs_.has(name)&&(this.cancelAnimationFrame(this.namedRafs_.get(name)),this.namedRafs_.delete(name))},_proto.cancelAnimationFrame=function(id){return this.supportsRaf_?(this.rafIds_.has(id)&&(this.rafIds_.delete(id),window_default().cancelAnimationFrame(id)),id):this.clearTimeout(id)},_proto.clearTimersOnDispose_=function(){var _this5=this;this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",function(){[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach(function(_ref){var cancelName=_ref[1];_this5[_ref[0]].forEach(function(val,key){return _this5[cancelName](key)})}),_this5.clearingTimersOnDispose_=!1}))},Component.registerComponent=function(name,ComponentToRegister){if("string"!=typeof name||!name)throw new Error('Illegal component name, "'+name+'"; must be a non-empty string.');var Tech=Component.getComponent("Tech"),isTech=Tech&&Tech.isTech(ComponentToRegister),isComp=Component===ComponentToRegister||Component.prototype.isPrototypeOf(ComponentToRegister.prototype);if(isTech||!isComp)throw new Error('Illegal component, "'+name+'"; '+(isTech?"techs must be registered using Tech.registerTech()":"must be a Component subclass")+".");name=toTitleCase$1(name),Component.components_||(Component.components_={});var Player=Component.getComponent("Player");if("Player"===name&&Player&&Player.players){var players=Player.players,playerNames=Object.keys(players);if(players&&playerNames.length>0&&playerNames.map(function(pname){return players[pname]}).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return Component.components_[name]=ComponentToRegister,Component.components_[toLowerCase(name)]=ComponentToRegister,ComponentToRegister},Component.getComponent=function(name){if(name&&Component.components_)return Component.components_[name]},Component}();function getRange(fnName,valueIndex,ranges,rangeIndex){return function(fnName,index,maxIndex){if("number"!=typeof index||index<0||index>maxIndex)throw new Error("Failed to execute '"+fnName+"' on 'TimeRanges': The index provided ("+index+") is non-numeric or out of bounds (0-"+maxIndex+").")}(fnName,rangeIndex,ranges.length-1),ranges[rangeIndex][valueIndex]}function createTimeRangesObj(ranges){var timeRangesObj;return timeRangesObj=void 0===ranges||0===ranges.length?{length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:{length:ranges.length,start:getRange.bind(null,"start",0,ranges),end:getRange.bind(null,"end",1,ranges)},window_default().Symbol&&window_default().Symbol.iterator&&(timeRangesObj[window_default().Symbol.iterator]=function(){return(ranges||[]).values()}),timeRangesObj}function createTimeRanges(start,end){return Array.isArray(start)?createTimeRangesObj(start):void 0===start||void 0===end?createTimeRangesObj():createTimeRangesObj([[start,end]])}function bufferedPercent(buffered,duration){var start,end,bufferedDuration=0;if(!duration)return 0;buffered&&buffered.length||(buffered=createTimeRanges(0,0));for(var i=0;i<buffered.length;i++)start=buffered.start(i),(end=buffered.end(i))>duration&&(end=duration),bufferedDuration+=end-start;return bufferedDuration/duration}function MediaError(value){if(value instanceof MediaError)return value;"number"==typeof value?this.code=value:"string"==typeof value?this.message=value:video_es_isObject(value)&&("number"==typeof value.code&&(this.code=value.code),video_es_assign(this,value)),this.message||(this.message=MediaError.defaultMessages[this.code]||"")}Component$1.prototype.supportsRaf_="function"==typeof window_default().requestAnimationFrame&&"function"==typeof window_default().cancelAnimationFrame,Component$1.registerComponent("Component",Component$1),MediaError.prototype.code=0,MediaError.prototype.message="",MediaError.prototype.status=null,MediaError.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],MediaError.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var errNum=0;errNum<MediaError.errorTypes.length;errNum++)MediaError[MediaError.errorTypes[errNum]]=errNum,MediaError.prototype[MediaError.errorTypes[errNum]]=errNum;function isPromise(value){return null!=value&&"function"==typeof value.then}function silencePromise(value){isPromise(value)&&value.then(null,function(e){})}var trackToJson_=function(track){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(function(acc,prop,i){return track[prop]&&(acc[prop]=track[prop]),acc},{cues:track.cues&&Array.prototype.map.call(track.cues,function(cue){return{startTime:cue.startTime,endTime:cue.endTime,text:cue.text,id:cue.id}})})},ModalDialog=function(_Component){function ModalDialog(player,options){var _this;return(_this=_Component.call(this,player,options)||this).handleKeyDown_=function(e){return _this.handleKeyDown(e)},_this.close_=function(e){return _this.close(e)},_this.opened_=_this.hasBeenOpened_=_this.hasBeenFilled_=!1,_this.closeable(!_this.options_.uncloseable),_this.content(_this.options_.content),_this.contentEl_=createEl("div",{className:"vjs-modal-dialog-content"},{role:"document"}),_this.descEl_=createEl("p",{className:"vjs-modal-dialog-description vjs-control-text",id:_this.el().getAttribute("aria-describedby")}),textContent(_this.descEl_,_this.description()),_this.el_.appendChild(_this.descEl_),_this.el_.appendChild(_this.contentEl_),_this}inheritsLoose_default()(ModalDialog,_Component);var _proto=ModalDialog.prototype;return _proto.createEl=function(){return _Component.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})},_proto.dispose=function(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,_Component.prototype.dispose.call(this)},_proto.buildCSSClass=function(){return"vjs-modal-dialog vjs-hidden "+_Component.prototype.buildCSSClass.call(this)},_proto.label=function(){return this.localize(this.options_.label||"Modal Window")},_proto.description=function(){var desc=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(desc+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),desc},_proto.open=function(){if(!this.opened_){var player=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!player.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&player.pause(),this.on("keydown",this.handleKeyDown_),this.hadControls_=player.controls(),player.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}},_proto.opened=function(value){return"boolean"==typeof value&&this[value?"open":"close"](),this.opened_},_proto.close=function(){if(this.opened_){var player=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&player.play(),this.off("keydown",this.handleKeyDown_),this.hadControls_&&player.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}},_proto.closeable=function(value){if("boolean"==typeof value){var closeable=this.closeable_=!!value,close=this.getChild("closeButton");if(closeable&&!close){var temp=this.contentEl_;this.contentEl_=this.el_,close=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=temp,this.on(close,"close",this.close_)}!closeable&&close&&(this.off(close,"close",this.close_),this.removeChild(close),close.dispose())}return this.closeable_},_proto.fill=function(){this.fillWith(this.content())},_proto.fillWith=function(content){var contentEl=this.contentEl(),parentEl=contentEl.parentNode,nextSiblingEl=contentEl.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,parentEl.removeChild(contentEl),this.empty(),insertContent(contentEl,content),this.trigger("modalfill"),nextSiblingEl?parentEl.insertBefore(contentEl,nextSiblingEl):parentEl.appendChild(contentEl);var closeButton=this.getChild("closeButton");closeButton&&parentEl.appendChild(closeButton.el_)},_proto.empty=function(){this.trigger("beforemodalempty"),emptyEl(this.contentEl()),this.trigger("modalempty")},_proto.content=function(value){return void 0!==value&&(this.content_=value),this.content_},_proto.conditionalFocus_=function(){var activeEl=document_default().activeElement,playerEl=this.player_.el_;this.previouslyActiveEl_=null,(playerEl.contains(activeEl)||playerEl===activeEl)&&(this.previouslyActiveEl_=activeEl,this.focus())},_proto.conditionalBlur_=function(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)},_proto.handleKeyDown=function(event){if(event.stopPropagation(),keycode_default().isEventKey(event,"Escape")&&this.closeable())return event.preventDefault(),void this.close();if(keycode_default().isEventKey(event,"Tab")){for(var focusIndex,focusableEls=this.focusableEls_(),activeEl=this.el_.querySelector(":focus"),i=0;i<focusableEls.length;i++)if(activeEl===focusableEls[i]){focusIndex=i;break}document_default().activeElement===this.el_&&(focusIndex=0),event.shiftKey&&0===focusIndex?(focusableEls[focusableEls.length-1].focus(),event.preventDefault()):event.shiftKey||focusIndex!==focusableEls.length-1||(focusableEls[0].focus(),event.preventDefault())}},_proto.focusableEls_=function(){var allChildren=this.el_.querySelectorAll("*");return Array.prototype.filter.call(allChildren,function(child){return(child instanceof window_default().HTMLAnchorElement||child instanceof window_default().HTMLAreaElement)&&child.hasAttribute("href")||(child instanceof window_default().HTMLInputElement||child instanceof window_default().HTMLSelectElement||child instanceof window_default().HTMLTextAreaElement||child instanceof window_default().HTMLButtonElement)&&!child.hasAttribute("disabled")||child instanceof window_default().HTMLIFrameElement||child instanceof window_default().HTMLObjectElement||child instanceof window_default().HTMLEmbedElement||child.hasAttribute("tabindex")&&-1!==child.getAttribute("tabindex")||child.hasAttribute("contenteditable")})},ModalDialog}(Component$1);ModalDialog.prototype.options_={pauseOnOpen:!0,temporary:!0},Component$1.registerComponent("ModalDialog",ModalDialog);var TrackList=function(_EventTarget){function TrackList(tracks){var _this;void 0===tracks&&(tracks=[]),(_this=_EventTarget.call(this)||this).tracks_=[],Object.defineProperty(assertThisInitialized_default()(_this),"length",{get:function(){return this.tracks_.length}});for(var i=0;i<tracks.length;i++)_this.addTrack(tracks[i]);return _this}inheritsLoose_default()(TrackList,_EventTarget);var _proto=TrackList.prototype;return _proto.addTrack=function(track){var _this2=this,index=this.tracks_.length;""+index in this||Object.defineProperty(this,index,{get:function(){return this.tracks_[index]}}),-1===this.tracks_.indexOf(track)&&(this.tracks_.push(track),this.trigger({track:track,type:"addtrack",target:this})),track.labelchange_=function(){_this2.trigger({track:track,type:"labelchange",target:_this2})},isEvented(track)&&track.addEventListener("labelchange",track.labelchange_)},_proto.removeTrack=function(rtrack){for(var track,i=0,l=this.length;i<l;i++)if(this[i]===rtrack){(track=this[i]).off&&track.off(),this.tracks_.splice(i,1);break}track&&this.trigger({track:track,type:"removetrack",target:this})},_proto.getTrackById=function(id){for(var result=null,i=0,l=this.length;i<l;i++){var track=this[i];if(track.id===id){result=track;break}}return result},TrackList}(EventTarget$2);for(var video_es_event in TrackList.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack",labelchange:"labelchange"},TrackList.prototype.allowedEvents_)TrackList.prototype["on"+video_es_event]=null;var disableOthers$1=function(list,track){for(var i=0;i<list.length;i++)Object.keys(list[i]).length&&track.id!==list[i].id&&(list[i].enabled=!1)},AudioTrackList=function(_TrackList){function AudioTrackList(tracks){var _this;void 0===tracks&&(tracks=[]);for(var i=tracks.length-1;i>=0;i--)if(tracks[i].enabled){disableOthers$1(tracks,tracks[i]);break}return(_this=_TrackList.call(this,tracks)||this).changing_=!1,_this}inheritsLoose_default()(AudioTrackList,_TrackList);var _proto=AudioTrackList.prototype;return _proto.addTrack=function(track){var _this2=this;track.enabled&&disableOthers$1(this,track),_TrackList.prototype.addTrack.call(this,track),track.addEventListener&&(track.enabledChange_=function(){_this2.changing_||(_this2.changing_=!0,disableOthers$1(_this2,track),_this2.changing_=!1,_this2.trigger("change"))},track.addEventListener("enabledchange",track.enabledChange_))},_proto.removeTrack=function(rtrack){_TrackList.prototype.removeTrack.call(this,rtrack),rtrack.removeEventListener&&rtrack.enabledChange_&&(rtrack.removeEventListener("enabledchange",rtrack.enabledChange_),rtrack.enabledChange_=null)},AudioTrackList}(TrackList),disableOthers=function(list,track){for(var i=0;i<list.length;i++)Object.keys(list[i]).length&&track.id!==list[i].id&&(list[i].selected=!1)},VideoTrackList=function(_TrackList){function VideoTrackList(tracks){var _this;void 0===tracks&&(tracks=[]);for(var i=tracks.length-1;i>=0;i--)if(tracks[i].selected){disableOthers(tracks,tracks[i]);break}return(_this=_TrackList.call(this,tracks)||this).changing_=!1,Object.defineProperty(assertThisInitialized_default()(_this),"selectedIndex",{get:function(){for(var _i=0;_i<this.length;_i++)if(this[_i].selected)return _i;return-1},set:function(){}}),_this}inheritsLoose_default()(VideoTrackList,_TrackList);var _proto=VideoTrackList.prototype;return _proto.addTrack=function(track){var _this2=this;track.selected&&disableOthers(this,track),_TrackList.prototype.addTrack.call(this,track),track.addEventListener&&(track.selectedChange_=function(){_this2.changing_||(_this2.changing_=!0,disableOthers(_this2,track),_this2.changing_=!1,_this2.trigger("change"))},track.addEventListener("selectedchange",track.selectedChange_))},_proto.removeTrack=function(rtrack){_TrackList.prototype.removeTrack.call(this,rtrack),rtrack.removeEventListener&&rtrack.selectedChange_&&(rtrack.removeEventListener("selectedchange",rtrack.selectedChange_),rtrack.selectedChange_=null)},VideoTrackList}(TrackList),TextTrackList=function(_TrackList){function TextTrackList(){return _TrackList.apply(this,arguments)||this}inheritsLoose_default()(TextTrackList,_TrackList);var _proto=TextTrackList.prototype;return _proto.addTrack=function(track){var _this=this;_TrackList.prototype.addTrack.call(this,track),this.queueChange_||(this.queueChange_=function(){return _this.queueTrigger("change")}),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=function(){return _this.trigger("selectedlanguagechange")}),track.addEventListener("modechange",this.queueChange_),-1===["metadata","chapters"].indexOf(track.kind)&&track.addEventListener("modechange",this.triggerSelectedlanguagechange_)},_proto.removeTrack=function(rtrack){_TrackList.prototype.removeTrack.call(this,rtrack),rtrack.removeEventListener&&(this.queueChange_&&rtrack.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&rtrack.removeEventListener("modechange",this.triggerSelectedlanguagechange_))},TextTrackList}(TrackList),HtmlTrackElementList=function(){function HtmlTrackElementList(trackElements){void 0===trackElements&&(trackElements=[]),this.trackElements_=[],Object.defineProperty(this,"length",{get:function(){return this.trackElements_.length}});for(var i=0,length=trackElements.length;i<length;i++)this.addTrackElement_(trackElements[i])}var _proto=HtmlTrackElementList.prototype;return _proto.addTrackElement_=function(trackElement){var index=this.trackElements_.length;""+index in this||Object.defineProperty(this,index,{get:function(){return this.trackElements_[index]}}),-1===this.trackElements_.indexOf(trackElement)&&this.trackElements_.push(trackElement)},_proto.getTrackElementByTrack_=function(track){for(var trackElement_,i=0,length=this.trackElements_.length;i<length;i++)if(track===this.trackElements_[i].track){trackElement_=this.trackElements_[i];break}return trackElement_},_proto.removeTrackElement_=function(trackElement){for(var i=0,length=this.trackElements_.length;i<length;i++)if(trackElement===this.trackElements_[i]){this.trackElements_[i].track&&"function"==typeof this.trackElements_[i].track.off&&this.trackElements_[i].track.off(),"function"==typeof this.trackElements_[i].off&&this.trackElements_[i].off(),this.trackElements_.splice(i,1);break}},HtmlTrackElementList}(),TextTrackCueList=function(){function TextTrackCueList(cues){TextTrackCueList.prototype.setCues_.call(this,cues),Object.defineProperty(this,"length",{get:function(){return this.length_}})}var _proto=TextTrackCueList.prototype;return _proto.setCues_=function(cues){var oldLength=this.length||0,i=0,l=cues.length;this.cues_=cues,this.length_=cues.length;var defineProp=function(index){""+index in this||Object.defineProperty(this,""+index,{get:function(){return this.cues_[index]}})};if(oldLength<l)for(i=oldLength;i<l;i++)defineProp.call(this,i)},_proto.getCueById=function(id){for(var result=null,i=0,l=this.length;i<l;i++){var cue=this[i];if(cue.id===id){result=cue;break}}return result},TextTrackCueList}(),VideoTrackKind={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},AudioTrackKind={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},TextTrackKind={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},TextTrackMode={disabled:"disabled",hidden:"hidden",showing:"showing"},Track=function(_EventTarget){function Track(options){var _this;void 0===options&&(options={}),_this=_EventTarget.call(this)||this;var trackProps={id:options.id||"vjs_track_"+newGUID(),kind:options.kind||"",language:options.language||""},label=options.label||"",_loop=function(key){Object.defineProperty(assertThisInitialized_default()(_this),key,{get:function(){return trackProps[key]},set:function(){}})};for(var key in trackProps)_loop(key);return Object.defineProperty(assertThisInitialized_default()(_this),"label",{get:function(){return label},set:function(newLabel){newLabel!==label&&(label=newLabel,this.trigger("labelchange"))}}),_this}return inheritsLoose_default()(Track,_EventTarget),Track}(EventTarget$2),parseUrl=function(url){var props=["protocol","hostname","port","pathname","search","hash","host"],a=document_default().createElement("a");a.href=url;for(var details={},i=0;i<props.length;i++)details[props[i]]=a[props[i]];return"http:"===details.protocol&&(details.host=details.host.replace(/:80$/,"")),"https:"===details.protocol&&(details.host=details.host.replace(/:443$/,"")),details.protocol||(details.protocol=window_default().location.protocol),details.host||(details.host=window_default().location.host),details},getAbsoluteURL=function(url){if(!url.match(/^https?:\/\//)){var a=document_default().createElement("a");a.href=url,url=a.href}return url},getFileExtension=function(path){if("string"==typeof path){var pathParts=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/.exec(path);if(pathParts)return pathParts.pop().toLowerCase()}return""},isCrossOrigin=function(url,winLoc){void 0===winLoc&&(winLoc=window_default().location);var urlInfo=parseUrl(url);return(":"===urlInfo.protocol?winLoc.protocol:urlInfo.protocol)+urlInfo.host!==winLoc.protocol+winLoc.host},Url=Object.freeze({__proto__:null,parseUrl:parseUrl,getAbsoluteURL:getAbsoluteURL,getFileExtension:getFileExtension,isCrossOrigin:isCrossOrigin}),parseCues=function(srcContent,track){var parser=new(window_default().WebVTT.Parser)(window_default(),window_default().vttjs,window_default().WebVTT.StringDecoder()),errors=[];parser.oncue=function(cue){track.addCue(cue)},parser.onparsingerror=function(error){errors.push(error)},parser.onflush=function(){track.trigger({type:"loadeddata",target:track})},parser.parse(srcContent),errors.length>0&&(window_default().console&&window_default().console.groupCollapsed&&window_default().console.groupCollapsed("Text Track parsing errors for "+track.src),errors.forEach(function(error){return log$1.error(error)}),window_default().console&&window_default().console.groupEnd&&window_default().console.groupEnd()),parser.flush()},loadTrack=function(src,track){var opts={uri:src},crossOrigin=isCrossOrigin(src);crossOrigin&&(opts.cors=crossOrigin);var withCredentials="use-credentials"===track.tech_.crossOrigin();withCredentials&&(opts.withCredentials=withCredentials),lib_default()(opts,bind(this,function(err,response,responseBody){if(err)return log$1.error(err,response);track.loaded_=!0,"function"!=typeof window_default().WebVTT?track.tech_&&track.tech_.any(["vttjsloaded","vttjserror"],function(event){if("vttjserror"!==event.type)return parseCues(responseBody,track);log$1.error("vttjs failed to load, stopping trying to process "+track.src)}):parseCues(responseBody,track)}))},TextTrack=function(_Track){function TextTrack(options){var _this;if(void 0===options&&(options={}),!options.tech)throw new Error("A tech was not provided.");var settings=mergeOptions$3(options,{kind:TextTrackKind[options.kind]||"subtitles",language:options.language||options.srclang||""}),mode=TextTrackMode[settings.mode]||"disabled",default_=settings.default;"metadata"!==settings.kind&&"chapters"!==settings.kind||(mode="hidden"),(_this=_Track.call(this,settings)||this).tech_=settings.tech,_this.cues_=[],_this.activeCues_=[],_this.preload_=!1!==_this.tech_.preloadTextTracks;var cues=new TextTrackCueList(_this.cues_),activeCues=new TextTrackCueList(_this.activeCues_),changed=!1,timeupdateHandler=bind(assertThisInitialized_default()(_this),function(){this.tech_.isReady_&&!this.tech_.isDisposed()&&(this.activeCues=this.activeCues,changed&&(this.trigger("cuechange"),changed=!1))});return _this.tech_.one("dispose",function(){_this.tech_.off("timeupdate",timeupdateHandler)}),"disabled"!==mode&&_this.tech_.on("timeupdate",timeupdateHandler),Object.defineProperties(assertThisInitialized_default()(_this),{default:{get:function(){return default_},set:function(){}},mode:{get:function(){return mode},set:function(newMode){TextTrackMode[newMode]&&mode!==newMode&&(mode=newMode,this.preload_||"disabled"===mode||0!==this.cues.length||loadTrack(this.src,this),this.tech_.off("timeupdate",timeupdateHandler),"disabled"!==mode&&this.tech_.on("timeupdate",timeupdateHandler),this.trigger("modechange"))}},cues:{get:function(){return this.loaded_?cues:null},set:function(){}},activeCues:{get:function(){if(!this.loaded_)return null;if(0===this.cues.length)return activeCues;for(var ct=this.tech_.currentTime(),active=[],i=0,l=this.cues.length;i<l;i++){var cue=this.cues[i];(cue.startTime<=ct&&cue.endTime>=ct||cue.startTime===cue.endTime&&cue.startTime<=ct&&cue.startTime+.5>=ct)&&active.push(cue)}if(changed=!1,active.length!==this.activeCues_.length)changed=!0;else for(var _i=0;_i<active.length;_i++)-1===this.activeCues_.indexOf(active[_i])&&(changed=!0);return this.activeCues_=active,activeCues.setCues_(this.activeCues_),activeCues},set:function(){}}}),settings.src?(_this.src=settings.src,_this.preload_||(_this.loaded_=!0),(_this.preload_||"subtitles"!==settings.kind&&"captions"!==settings.kind)&&loadTrack(_this.src,assertThisInitialized_default()(_this))):_this.loaded_=!0,_this}inheritsLoose_default()(TextTrack,_Track);var _proto=TextTrack.prototype;return _proto.addCue=function(originalCue){var cue=originalCue;if(window_default().vttjs&&!(originalCue instanceof window_default().vttjs.VTTCue)){for(var prop in cue=new(window_default().vttjs.VTTCue)(originalCue.startTime,originalCue.endTime,originalCue.text),originalCue)prop in cue||(cue[prop]=originalCue[prop]);cue.id=originalCue.id,cue.originalCue_=originalCue}for(var tracks=this.tech_.textTracks(),i=0;i<tracks.length;i++)tracks[i]!==this&&tracks[i].removeCue(cue);this.cues_.push(cue),this.cues.setCues_(this.cues_)},_proto.removeCue=function(_removeCue){for(var i=this.cues_.length;i--;){var cue=this.cues_[i];if(cue===_removeCue||cue.originalCue_&&cue.originalCue_===_removeCue){this.cues_.splice(i,1),this.cues.setCues_(this.cues_);break}}},TextTrack}(Track);TextTrack.prototype.allowedEvents_={cuechange:"cuechange"};var AudioTrack=function(_Track){function AudioTrack(options){var _this;void 0===options&&(options={});var settings=mergeOptions$3(options,{kind:AudioTrackKind[options.kind]||""});_this=_Track.call(this,settings)||this;var enabled=!1;return Object.defineProperty(assertThisInitialized_default()(_this),"enabled",{get:function(){return enabled},set:function(newEnabled){"boolean"==typeof newEnabled&&newEnabled!==enabled&&(enabled=newEnabled,this.trigger("enabledchange"))}}),settings.enabled&&(_this.enabled=settings.enabled),_this.loaded_=!0,_this}return inheritsLoose_default()(AudioTrack,_Track),AudioTrack}(Track),VideoTrack=function(_Track){function VideoTrack(options){var _this;void 0===options&&(options={});var settings=mergeOptions$3(options,{kind:VideoTrackKind[options.kind]||""});_this=_Track.call(this,settings)||this;var selected=!1;return Object.defineProperty(assertThisInitialized_default()(_this),"selected",{get:function(){return selected},set:function(newSelected){"boolean"==typeof newSelected&&newSelected!==selected&&(selected=newSelected,this.trigger("selectedchange"))}}),settings.selected&&(_this.selected=settings.selected),_this}return inheritsLoose_default()(VideoTrack,_Track),VideoTrack}(Track),HTMLTrackElement=function(_EventTarget){function HTMLTrackElement(options){var _this,readyState;void 0===options&&(options={}),_this=_EventTarget.call(this)||this;var track=new TextTrack(options);return _this.kind=track.kind,_this.src=track.src,_this.srclang=track.language,_this.label=track.label,_this.default=track.default,Object.defineProperties(assertThisInitialized_default()(_this),{readyState:{get:function(){return readyState}},track:{get:function(){return track}}}),readyState=0,track.addEventListener("loadeddata",function(){readyState=2,_this.trigger({type:"load",target:assertThisInitialized_default()(_this)})}),_this}return inheritsLoose_default()(HTMLTrackElement,_EventTarget),HTMLTrackElement}(EventTarget$2);HTMLTrackElement.prototype.allowedEvents_={load:"load"},HTMLTrackElement.NONE=0,HTMLTrackElement.LOADING=1,HTMLTrackElement.LOADED=2,HTMLTrackElement.ERROR=3;var NORMAL={audio:{ListClass:AudioTrackList,TrackClass:AudioTrack,capitalName:"Audio"},video:{ListClass:VideoTrackList,TrackClass:VideoTrack,capitalName:"Video"},text:{ListClass:TextTrackList,TrackClass:TextTrack,capitalName:"Text"}};Object.keys(NORMAL).forEach(function(type){NORMAL[type].getterName=type+"Tracks",NORMAL[type].privateName=type+"Tracks_"});var REMOTE={remoteText:{ListClass:TextTrackList,TrackClass:TextTrack,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:HtmlTrackElementList,TrackClass:HTMLTrackElement,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},ALL=extends_default()({},NORMAL,REMOTE);REMOTE.names=Object.keys(REMOTE),NORMAL.names=Object.keys(NORMAL),ALL.names=[].concat(REMOTE.names).concat(NORMAL.names);var Tech=function(_Component){function Tech(options,ready){var _this;return void 0===options&&(options={}),void 0===ready&&(ready=function(){}),options.reportTouchActivity=!1,(_this=_Component.call(this,null,options,ready)||this).onDurationChange_=function(e){return _this.onDurationChange(e)},_this.trackProgress_=function(e){return _this.trackProgress(e)},_this.trackCurrentTime_=function(e){return _this.trackCurrentTime(e)},_this.stopTrackingCurrentTime_=function(e){return _this.stopTrackingCurrentTime(e)},_this.disposeSourceHandler_=function(e){return _this.disposeSourceHandler(e)},_this.hasStarted_=!1,_this.on("playing",function(){this.hasStarted_=!0}),_this.on("loadstart",function(){this.hasStarted_=!1}),ALL.names.forEach(function(name){var props=ALL[name];options&&options[props.getterName]&&(_this[props.privateName]=options[props.getterName])}),_this.featuresProgressEvents||_this.manualProgressOn(),_this.featuresTimeupdateEvents||_this.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(function(track){!1===options["native"+track+"Tracks"]&&(_this["featuresNative"+track+"Tracks"]=!1)}),!1===options.nativeCaptions||!1===options.nativeTextTracks?_this.featuresNativeTextTracks=!1:!0!==options.nativeCaptions&&!0!==options.nativeTextTracks||(_this.featuresNativeTextTracks=!0),_this.featuresNativeTextTracks||_this.emulateTextTracks(),_this.preloadTextTracks=!1!==options.preloadTextTracks,_this.autoRemoteTextTracks_=new ALL.text.ListClass,_this.initTrackListeners(),options.nativeControlsForTouch||_this.emitTapEvents(),_this.constructor&&(_this.name_=_this.constructor.name||"Unknown Tech"),_this}inheritsLoose_default()(Tech,_Component);var _proto=Tech.prototype;return _proto.triggerSourceset=function(src){var _this2=this;this.isReady_||this.one("ready",function(){return _this2.setTimeout(function(){return _this2.triggerSourceset(src)},1)}),this.trigger({src:src,type:"sourceset"})},_proto.manualProgressOn=function(){this.on("durationchange",this.onDurationChange_),this.manualProgress=!0,this.one("ready",this.trackProgress_)},_proto.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange_)},_proto.trackProgress=function(event){this.stopTrackingProgress(),this.progressInterval=this.setInterval(bind(this,function(){var numBufferedPercent=this.bufferedPercent();this.bufferedPercent_!==numBufferedPercent&&this.trigger("progress"),this.bufferedPercent_=numBufferedPercent,1===numBufferedPercent&&this.stopTrackingProgress()}),500)},_proto.onDurationChange=function(event){this.duration_=this.duration()},_proto.buffered=function(){return createTimeRanges(0,0)},_proto.bufferedPercent=function(){return bufferedPercent(this.buffered(),this.duration_)},_proto.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},_proto.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime_),this.on("pause",this.stopTrackingCurrentTime_)},_proto.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime_),this.off("pause",this.stopTrackingCurrentTime_)},_proto.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)},_proto.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},_proto.dispose=function(){this.clearTracks(NORMAL.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),_Component.prototype.dispose.call(this)},_proto.clearTracks=function(types){var _this3=this;(types=[].concat(types)).forEach(function(type){for(var list=_this3[type+"Tracks"]()||[],i=list.length;i--;){var track=list[i];"text"===type&&_this3.removeRemoteTextTrack(track),list.removeTrack(track)}})},_proto.cleanupAutoTextTracks=function(){for(var list=this.autoRemoteTextTracks_||[],i=list.length;i--;)this.removeRemoteTextTrack(list[i])},_proto.reset=function(){},_proto.crossOrigin=function(){},_proto.setCrossOrigin=function(){},_proto.error=function(err){return void 0!==err&&(this.error_=new MediaError(err),this.trigger("error")),this.error_},_proto.played=function(){return this.hasStarted_?createTimeRanges(0,0):createTimeRanges()},_proto.play=function(){},_proto.setScrubbing=function(){},_proto.scrubbing=function(){},_proto.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},_proto.initTrackListeners=function(){var _this4=this;NORMAL.names.forEach(function(name){var trackListChanges=function(){_this4.trigger(name+"trackchange")},tracks=_this4[NORMAL[name].getterName]();tracks.addEventListener("removetrack",trackListChanges),tracks.addEventListener("addtrack",trackListChanges),_this4.on("dispose",function(){tracks.removeEventListener("removetrack",trackListChanges),tracks.removeEventListener("addtrack",trackListChanges)})})},_proto.addWebVttScript_=function(){var _this5=this;if(!window_default().WebVTT)if(document_default().body.contains(this.el())){if(!this.options_["vtt.js"]&&isPlain(browser_index_default())&&Object.keys(browser_index_default()).length>0)return void this.trigger("vttjsloaded");var script=document_default().createElement("script");script.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",script.onload=function(){_this5.trigger("vttjsloaded")},script.onerror=function(){_this5.trigger("vttjserror")},this.on("dispose",function(){script.onload=null,script.onerror=null}),window_default().WebVTT=!0,this.el().parentNode.appendChild(script)}else this.ready(this.addWebVttScript_)},_proto.emulateTextTracks=function(){var _this6=this,tracks=this.textTracks(),remoteTracks=this.remoteTextTracks(),handleAddTrack=function(e){return tracks.addTrack(e.track)},handleRemoveTrack=function(e){return tracks.removeTrack(e.track)};remoteTracks.on("addtrack",handleAddTrack),remoteTracks.on("removetrack",handleRemoveTrack),this.addWebVttScript_();var updateDisplay=function(){return _this6.trigger("texttrackchange")},textTracksChanges=function(){updateDisplay();for(var i=0;i<tracks.length;i++){var track=tracks[i];track.removeEventListener("cuechange",updateDisplay),"showing"===track.mode&&track.addEventListener("cuechange",updateDisplay)}};textTracksChanges(),tracks.addEventListener("change",textTracksChanges),tracks.addEventListener("addtrack",textTracksChanges),tracks.addEventListener("removetrack",textTracksChanges),this.on("dispose",function(){remoteTracks.off("addtrack",handleAddTrack),remoteTracks.off("removetrack",handleRemoveTrack),tracks.removeEventListener("change",textTracksChanges),tracks.removeEventListener("addtrack",textTracksChanges),tracks.removeEventListener("removetrack",textTracksChanges);for(var i=0;i<tracks.length;i++)tracks[i].removeEventListener("cuechange",updateDisplay)})},_proto.addTextTrack=function(kind,label,language){if(!kind)throw new Error("TextTrack kind is required but was not provided");return function(self,kind,label,language,options){void 0===options&&(options={});var tracks=self.textTracks();options.kind=kind,label&&(options.label=label),language&&(options.language=language),options.tech=self;var track=new ALL.text.TrackClass(options);return tracks.addTrack(track),track}(this,kind,label,language)},_proto.createRemoteTextTrack=function(options){var track=mergeOptions$3(options,{tech:this});return new REMOTE.remoteTextEl.TrackClass(track)},_proto.addRemoteTextTrack=function(options,manualCleanup){var _this7=this;void 0===options&&(options={});var htmlTrackElement=this.createRemoteTextTrack(options);return!0!==manualCleanup&&!1!==manualCleanup&&(log$1.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'),manualCleanup=!0),this.remoteTextTrackEls().addTrackElement_(htmlTrackElement),this.remoteTextTracks().addTrack(htmlTrackElement.track),!0!==manualCleanup&&this.ready(function(){return _this7.autoRemoteTextTracks_.addTrack(htmlTrackElement.track)}),htmlTrackElement},_proto.removeRemoteTextTrack=function(track){var trackElement=this.remoteTextTrackEls().getTrackElementByTrack_(track);this.remoteTextTrackEls().removeTrackElement_(trackElement),this.remoteTextTracks().removeTrack(track),this.autoRemoteTextTracks_.removeTrack(track)},_proto.getVideoPlaybackQuality=function(){return{}},_proto.requestPictureInPicture=function(){var PromiseClass=this.options_.Promise||window_default().Promise;if(PromiseClass)return PromiseClass.reject()},_proto.disablePictureInPicture=function(){return!0},_proto.setDisablePictureInPicture=function(){},_proto.setPoster=function(){},_proto.playsinline=function(){},_proto.setPlaysinline=function(){},_proto.overrideNativeAudioTracks=function(){},_proto.overrideNativeVideoTracks=function(){},_proto.canPlayType=function(){return""},Tech.canPlayType=function(){return""},Tech.canPlaySource=function(srcObj,options){return Tech.canPlayType(srcObj.type)},Tech.isTech=function(component){return component.prototype instanceof Tech||component instanceof Tech||component===Tech},Tech.registerTech=function(name,tech){if(Tech.techs_||(Tech.techs_={}),!Tech.isTech(tech))throw new Error("Tech "+name+" must be a Tech");if(!Tech.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!Tech.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return name=toTitleCase$1(name),Tech.techs_[name]=tech,Tech.techs_[toLowerCase(name)]=tech,"Tech"!==name&&Tech.defaultTechOrder_.push(name),tech},Tech.getTech=function(name){if(name)return Tech.techs_&&Tech.techs_[name]?Tech.techs_[name]:(name=toTitleCase$1(name),window_default()&&window_default().videojs&&window_default().videojs[name]?(log$1.warn("The "+name+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),window_default().videojs[name]):void 0)},Tech}(Component$1);ALL.names.forEach(function(name){var props=ALL[name];Tech.prototype[props.getterName]=function(){return this[props.privateName]=this[props.privateName]||new props.ListClass,this[props.privateName]}}),Tech.prototype.featuresVolumeControl=!0,Tech.prototype.featuresMuteControl=!0,Tech.prototype.featuresFullscreenResize=!1,Tech.prototype.featuresPlaybackRate=!1,Tech.prototype.featuresProgressEvents=!1,Tech.prototype.featuresSourceset=!1,Tech.prototype.featuresTimeupdateEvents=!1,Tech.prototype.featuresNativeTextTracks=!1,Tech.withSourceHandlers=function(_Tech){_Tech.registerSourceHandler=function(handler,index){var handlers=_Tech.sourceHandlers;handlers||(handlers=_Tech.sourceHandlers=[]),void 0===index&&(index=handlers.length),handlers.splice(index,0,handler)},_Tech.canPlayType=function(type){for(var can,handlers=_Tech.sourceHandlers||[],i=0;i<handlers.length;i++)if(can=handlers[i].canPlayType(type))return can;return""},_Tech.selectSourceHandler=function(source,options){for(var handlers=_Tech.sourceHandlers||[],i=0;i<handlers.length;i++)if(handlers[i].canHandleSource(source,options))return handlers[i];return null},_Tech.canPlaySource=function(srcObj,options){var sh=_Tech.selectSourceHandler(srcObj,options);return sh?sh.canHandleSource(srcObj,options):""},["seekable","seeking","duration"].forEach(function(fnName){var originalFn=this[fnName];"function"==typeof originalFn&&(this[fnName]=function(){return this.sourceHandler_&&this.sourceHandler_[fnName]?this.sourceHandler_[fnName].apply(this.sourceHandler_,arguments):originalFn.apply(this,arguments)})},_Tech.prototype),_Tech.prototype.setSource=function(source){var sh=_Tech.selectSourceHandler(source,this.options_);sh||(_Tech.nativeSourceHandler?sh=_Tech.nativeSourceHandler:log$1.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler_),sh!==_Tech.nativeSourceHandler&&(this.currentSource_=source),this.sourceHandler_=sh.handleSource(source,this,this.options_),this.one("dispose",this.disposeSourceHandler_)},_Tech.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},Component$1.registerComponent("Tech",Tech),Tech.registerTech("Tech",Tech),Tech.defaultTechOrder_=[];var middlewares={},middlewareInstances={},TERMINATOR={};function setSource(player,src,next){player.setTimeout(function(){return setSourceHelper(src,middlewares[src.type],next,player)},1)}function mediate(middleware,tech,method,arg){void 0===arg&&(arg=null);var callMethod="call"+toTitleCase$1(method),middlewareValue=middleware.reduce(middlewareIterator(callMethod),arg),terminated=middlewareValue===TERMINATOR,returnValue=terminated?null:tech[method](middlewareValue);return function(mws,method,value,terminated){for(var i=mws.length-1;i>=0;i--){var mw=mws[i];mw[method]&&mw[method](terminated,value)}}(middleware,method,returnValue,terminated),returnValue}var allowedGetters={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1,ended:1},allowedSetters={setCurrentTime:1,setMuted:1,setVolume:1},allowedMediators={play:1,pause:1};function middlewareIterator(method){return function(value,mw){return value===TERMINATOR?TERMINATOR:mw[method]?mw[method](value):value}}function setSourceHelper(src,middleware,next,player,acc,lastRun){void 0===src&&(src={}),void 0===middleware&&(middleware=[]),void 0===acc&&(acc=[]),void 0===lastRun&&(lastRun=!1);var mwFactory=middleware[0],mwrest=middleware.slice(1);if("string"==typeof mwFactory)setSourceHelper(src,middlewares[mwFactory],next,player,acc,lastRun);else if(mwFactory){var mw=function(player,mwFactory){var mws=middlewareInstances[player.id()],mw=null;if(null==mws)return mw=mwFactory(player),middlewareInstances[player.id()]=[[mwFactory,mw]],mw;for(var i=0;i<mws.length;i++){var _mws$i=mws[i];_mws$i[0]===mwFactory&&(mw=_mws$i[1])}return null===mw&&(mw=mwFactory(player),mws.push([mwFactory,mw])),mw}(player,mwFactory);if(!mw.setSource)return acc.push(mw),setSourceHelper(src,mwrest,next,player,acc,lastRun);mw.setSource(video_es_assign({},src),function(err,_src){if(err)return setSourceHelper(src,mwrest,next,player,acc,lastRun);acc.push(mw),setSourceHelper(_src,src.type===_src.type?mwrest:middlewares[_src.type],next,player,acc,lastRun)})}else mwrest.length?setSourceHelper(src,mwrest,next,player,acc,lastRun):lastRun?next(src,acc):setSourceHelper(src,middlewares["*"],next,player,acc,!0)}var MimetypesKind={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",caf:"audio/x-caf",flac:"audio/flac",oga:"audio/ogg",wav:"audio/wav",m3u8:"application/x-mpegURL",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},getMimetype=function(src){void 0===src&&(src="");var ext=getFileExtension(src);return MimetypesKind[ext.toLowerCase()]||""},filterSource=function filterSource(src){if(Array.isArray(src)){var newsrc=[];src.forEach(function(srcobj){srcobj=filterSource(srcobj),Array.isArray(srcobj)?newsrc=newsrc.concat(srcobj):video_es_isObject(srcobj)&&newsrc.push(srcobj)}),src=newsrc}else src="string"==typeof src&&src.trim()?[fixSource({src:src})]:video_es_isObject(src)&&"string"==typeof src.src&&src.src&&src.src.trim()?[fixSource(src)]:[];return src};function fixSource(src){if(!src.type){var mimetype=getMimetype(src.src);mimetype&&(src.type=mimetype)}return src}var MediaLoader=function(_Component){function MediaLoader(player,options,ready){var _this,options_=mergeOptions$3({createEl:!1},options);if(_this=_Component.call(this,player,options_,ready)||this,options.playerOptions.sources&&0!==options.playerOptions.sources.length)player.src(options.playerOptions.sources);else for(var i=0,j=options.playerOptions.techOrder;i<j.length;i++){var techName=toTitleCase$1(j[i]),tech=Tech.getTech(techName);if(techName||(tech=Component$1.getComponent(techName)),tech&&tech.isSupported()){player.loadTech_(techName);break}}return _this}return inheritsLoose_default()(MediaLoader,_Component),MediaLoader}(Component$1);Component$1.registerComponent("MediaLoader",MediaLoader);var ClickableComponent=function(_Component){function ClickableComponent(player,options){var _this;return(_this=_Component.call(this,player,options)||this).handleMouseOver_=function(e){return _this.handleMouseOver(e)},_this.handleMouseOut_=function(e){return _this.handleMouseOut(e)},_this.handleClick_=function(e){return _this.handleClick(e)},_this.handleKeyDown_=function(e){return _this.handleKeyDown(e)},_this.emitTapEvents(),_this.enable(),_this}inheritsLoose_default()(ClickableComponent,_Component);var _proto=ClickableComponent.prototype;return _proto.createEl=function(tag,props,attributes){void 0===tag&&(tag="div"),void 0===props&&(props={}),void 0===attributes&&(attributes={}),props=video_es_assign({className:this.buildCSSClass(),tabIndex:0},props),"button"===tag&&log$1.error("Creating a ClickableComponent with an HTML element of "+tag+" is not supported; use a Button instead."),attributes=video_es_assign({role:"button"},attributes),this.tabIndex_=props.tabIndex;var el=createEl(tag,props,attributes);return el.appendChild(createEl("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(el),el},_proto.dispose=function(){this.controlTextEl_=null,_Component.prototype.dispose.call(this)},_proto.createControlTextEl=function(el){return this.controlTextEl_=createEl("span",{className:"vjs-control-text"},{"aria-live":"polite"}),el&&el.appendChild(this.controlTextEl_),this.controlText(this.controlText_,el),this.controlTextEl_},_proto.controlText=function(text,el){if(void 0===el&&(el=this.el()),void 0===text)return this.controlText_||"Need Text";var localizedText=this.localize(text);this.controlText_=text,textContent(this.controlTextEl_,localizedText),this.nonIconControl||this.player_.options_.noUITitleAttributes||el.setAttribute("title",localizedText)},_proto.buildCSSClass=function(){return"vjs-control vjs-button "+_Component.prototype.buildCSSClass.call(this)},_proto.enable=function(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),void 0!==this.tabIndex_&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick_),this.on("keydown",this.handleKeyDown_))},_proto.disable=function(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),void 0!==this.tabIndex_&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver_),this.off("mouseout",this.handleMouseOut_),this.off(["tap","click"],this.handleClick_),this.off("keydown",this.handleKeyDown_)},_proto.handleLanguagechange=function(){this.controlText(this.controlText_)},_proto.handleClick=function(event){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)},_proto.handleKeyDown=function(event){keycode_default().isEventKey(event,"Space")||keycode_default().isEventKey(event,"Enter")?(event.preventDefault(),event.stopPropagation(),this.trigger("click")):_Component.prototype.handleKeyDown.call(this,event)},ClickableComponent}(Component$1);Component$1.registerComponent("ClickableComponent",ClickableComponent),Component$1.registerComponent("PosterImage",function(_ClickableComponent){function PosterImage(player,options){var _this;return(_this=_ClickableComponent.call(this,player,options)||this).update(),_this.update_=function(e){return _this.update(e)},player.on("posterchange",_this.update_),_this}inheritsLoose_default()(PosterImage,_ClickableComponent);var _proto=PosterImage.prototype;return _proto.dispose=function(){this.player().off("posterchange",this.update_),_ClickableComponent.prototype.dispose.call(this)},_proto.createEl=function(){return createEl("div",{className:"vjs-poster",tabIndex:-1})},_proto.update=function(event){var url=this.player().poster();this.setSrc(url),url?this.show():this.hide()},_proto.setSrc=function(url){var backgroundImage="";url&&(backgroundImage='url("'+url+'")'),this.el_.style.backgroundImage=backgroundImage},_proto.handleClick=function(event){if(this.player_.controls()){var sourceIsEncrypted=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&this.player_.eme.sessions.length>0;!this.player_.tech(!0)||(IE_VERSION||IS_EDGE)&&sourceIsEncrypted||this.player_.tech(!0).focus(),this.player_.paused()?silencePromise(this.player_.play()):this.player_.pause()}},PosterImage}(ClickableComponent));var fontMap={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function constructColor(color,opacity){var hex;if(4===color.length)hex=color[1]+color[1]+color[2]+color[2]+color[3]+color[3];else{if(7!==color.length)throw new Error("Invalid color code provided, "+color+"; must be formatted as e.g. #f0e or #f604e2.");hex=color.slice(1)}return"rgba("+parseInt(hex.slice(0,2),16)+","+parseInt(hex.slice(2,4),16)+","+parseInt(hex.slice(4,6),16)+","+opacity+")"}function tryUpdateStyle(el,style,rule){try{el.style[style]=rule}catch(e){return}}var TextTrackDisplay=function(_Component){function TextTrackDisplay(player,options,ready){var _this;_this=_Component.call(this,player,options,ready)||this;var updateDisplayHandler=function(e){return _this.updateDisplay(e)};return player.on("loadstart",function(e){return _this.toggleDisplay(e)}),player.on("texttrackchange",updateDisplayHandler),player.on("loadedmetadata",function(e){return _this.preselectTrack(e)}),player.ready(bind(assertThisInitialized_default()(_this),function(){if(player.tech_&&player.tech_.featuresNativeTextTracks)this.hide();else{player.on("fullscreenchange",updateDisplayHandler),player.on("playerresize",updateDisplayHandler),window_default().addEventListener("orientationchange",updateDisplayHandler),player.on("dispose",function(){return window_default().removeEventListener("orientationchange",updateDisplayHandler)});for(var tracks=this.options_.playerOptions.tracks||[],i=0;i<tracks.length;i++)this.player_.addRemoteTextTrack(tracks[i],!0);this.preselectTrack()}})),_this}inheritsLoose_default()(TextTrackDisplay,_Component);var _proto=TextTrackDisplay.prototype;return _proto.preselectTrack=function(){for(var firstDesc,firstCaptions,preferredTrack,modes={captions:1,subtitles:1},trackList=this.player_.textTracks(),userPref=this.player_.cache_.selectedLanguage,i=0;i<trackList.length;i++){var track=trackList[i];userPref&&userPref.enabled&&userPref.language&&userPref.language===track.language&&track.kind in modes?track.kind===userPref.kind?preferredTrack=track:preferredTrack||(preferredTrack=track):userPref&&!userPref.enabled?(preferredTrack=null,firstDesc=null,firstCaptions=null):track.default&&("descriptions"!==track.kind||firstDesc?track.kind in modes&&!firstCaptions&&(firstCaptions=track):firstDesc=track)}preferredTrack?preferredTrack.mode="showing":firstCaptions?firstCaptions.mode="showing":firstDesc&&(firstDesc.mode="showing")},_proto.toggleDisplay=function(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},_proto.createEl=function(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{translate:"yes","aria-live":"off","aria-atomic":"true"})},_proto.clearDisplay=function(){"function"==typeof window_default().WebVTT&&window_default().WebVTT.processCues(window_default(),[],this.el_)},_proto.updateDisplay=function(){var tracks=this.player_.textTracks(),allowMultipleShowingTracks=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),allowMultipleShowingTracks){for(var showingTracks=[],_i=0;_i<tracks.length;++_i){var track=tracks[_i];"showing"===track.mode&&showingTracks.push(track)}this.updateForTrack(showingTracks)}else{for(var descriptionsTrack=null,captionsSubtitlesTrack=null,i=tracks.length;i--;){var _track=tracks[i];"showing"===_track.mode&&("descriptions"===_track.kind?descriptionsTrack=_track:captionsSubtitlesTrack=_track)}captionsSubtitlesTrack?("off"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","off"),this.updateForTrack(captionsSubtitlesTrack)):descriptionsTrack&&("assertive"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","assertive"),this.updateForTrack(descriptionsTrack))}},_proto.updateDisplayState=function(track){for(var overrides=this.player_.textTrackSettings.getValues(),cues=track.activeCues,i=cues.length;i--;){var cue=cues[i];if(cue){var cueDiv=cue.displayState;if(overrides.color&&(cueDiv.firstChild.style.color=overrides.color),overrides.textOpacity&&tryUpdateStyle(cueDiv.firstChild,"color",constructColor(overrides.color||"#fff",overrides.textOpacity)),overrides.backgroundColor&&(cueDiv.firstChild.style.backgroundColor=overrides.backgroundColor),overrides.backgroundOpacity&&tryUpdateStyle(cueDiv.firstChild,"backgroundColor",constructColor(overrides.backgroundColor||"#000",overrides.backgroundOpacity)),overrides.windowColor&&(overrides.windowOpacity?tryUpdateStyle(cueDiv,"backgroundColor",constructColor(overrides.windowColor,overrides.windowOpacity)):cueDiv.style.backgroundColor=overrides.windowColor),overrides.edgeStyle&&("dropshadow"===overrides.edgeStyle?cueDiv.firstChild.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px #222":"raised"===overrides.edgeStyle?cueDiv.firstChild.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px #222":"depressed"===overrides.edgeStyle?cueDiv.firstChild.style.textShadow="1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px #222":"uniform"===overrides.edgeStyle&&(cueDiv.firstChild.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px #222")),overrides.fontPercent&&1!==overrides.fontPercent){var fontSize=window_default().parseFloat(cueDiv.style.fontSize);cueDiv.style.fontSize=fontSize*overrides.fontPercent+"px",cueDiv.style.height="auto",cueDiv.style.top="auto"}overrides.fontFamily&&"default"!==overrides.fontFamily&&("small-caps"===overrides.fontFamily?cueDiv.firstChild.style.fontVariant="small-caps":cueDiv.firstChild.style.fontFamily=fontMap[overrides.fontFamily])}}},_proto.updateForTrack=function(tracks){if(Array.isArray(tracks)||(tracks=[tracks]),"function"==typeof window_default().WebVTT&&!tracks.every(function(track){return!track.activeCues})){for(var cues=[],i=0;i<tracks.length;++i)for(var track=tracks[i],j=0;j<track.activeCues.length;++j)cues.push(track.activeCues[j]);window_default().WebVTT.processCues(window_default(),cues,this.el_);for(var _i2=0;_i2<tracks.length;++_i2){for(var _track2=tracks[_i2],_j=0;_j<_track2.activeCues.length;++_j){var cueEl=_track2.activeCues[_j].displayState;addClass(cueEl,"vjs-text-track-cue"),addClass(cueEl,"vjs-text-track-cue-"+(_track2.language?_track2.language:_i2)),_track2.language&&setAttribute(cueEl,"lang",_track2.language)}this.player_.textTrackSettings&&this.updateDisplayState(_track2)}}},TextTrackDisplay}(Component$1);Component$1.registerComponent("TextTrackDisplay",TextTrackDisplay),Component$1.registerComponent("LoadingSpinner",function(_Component){function LoadingSpinner(){return _Component.apply(this,arguments)||this}return inheritsLoose_default()(LoadingSpinner,_Component),LoadingSpinner.prototype.createEl=function(){var isAudio=this.player_.isAudio(),playerType=this.localize(isAudio?"Audio Player":"Video Player"),controlText=createEl("span",{className:"vjs-control-text",textContent:this.localize("{1} is loading.",[playerType])}),el=_Component.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});return el.appendChild(controlText),el},LoadingSpinner}(Component$1));var Button=function(_ClickableComponent){function Button(){return _ClickableComponent.apply(this,arguments)||this}inheritsLoose_default()(Button,_ClickableComponent);var _proto=Button.prototype;return _proto.createEl=function(tag,props,attributes){void 0===props&&(props={}),void 0===attributes&&(attributes={});var el=createEl("button",props=video_es_assign({className:this.buildCSSClass()},props),attributes=video_es_assign({type:"button"},attributes));return el.appendChild(createEl("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(el),el},_proto.addChild=function(child,options){return void 0===options&&(options={}),log$1.warn("Adding an actionable (user controllable) child to a Button ("+this.constructor.name+") is not supported; use a ClickableComponent instead."),Component$1.prototype.addChild.call(this,child,options)},_proto.enable=function(){_ClickableComponent.prototype.enable.call(this),this.el_.removeAttribute("disabled")},_proto.disable=function(){_ClickableComponent.prototype.disable.call(this),this.el_.setAttribute("disabled","disabled")},_proto.handleKeyDown=function(event){keycode_default().isEventKey(event,"Space")||keycode_default().isEventKey(event,"Enter")?event.stopPropagation():_ClickableComponent.prototype.handleKeyDown.call(this,event)},Button}(ClickableComponent);Component$1.registerComponent("Button",Button);var BigPlayButton=function(_Button){function BigPlayButton(player,options){var _this;return(_this=_Button.call(this,player,options)||this).mouseused_=!1,_this.on("mousedown",function(e){return _this.handleMouseDown(e)}),_this}inheritsLoose_default()(BigPlayButton,_Button);var _proto=BigPlayButton.prototype;return _proto.buildCSSClass=function(){return"vjs-big-play-button"},_proto.handleClick=function(event){var playPromise=this.player_.play();if(this.mouseused_&&event.clientX&&event.clientY){var sourceIsEncrypted=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&this.player_.eme.sessions.length>0;return silencePromise(playPromise),void(!this.player_.tech(!0)||(IE_VERSION||IS_EDGE)&&sourceIsEncrypted||this.player_.tech(!0).focus())}var cb=this.player_.getChild("controlBar"),playToggle=cb&&cb.getChild("playToggle");if(playToggle){var playFocus=function(){return playToggle.focus()};isPromise(playPromise)?playPromise.then(playFocus,function(){}):this.setTimeout(playFocus,1)}else this.player_.tech(!0).focus()},_proto.handleKeyDown=function(event){this.mouseused_=!1,_Button.prototype.handleKeyDown.call(this,event)},_proto.handleMouseDown=function(event){this.mouseused_=!0},BigPlayButton}(Button);BigPlayButton.prototype.controlText_="Play Video",Component$1.registerComponent("BigPlayButton",BigPlayButton),Component$1.registerComponent("CloseButton",function(_Button){function CloseButton(player,options){var _this;return(_this=_Button.call(this,player,options)||this).controlText(options&&options.controlText||_this.localize("Close")),_this}inheritsLoose_default()(CloseButton,_Button);var _proto=CloseButton.prototype;return _proto.buildCSSClass=function(){return"vjs-close-button "+_Button.prototype.buildCSSClass.call(this)},_proto.handleClick=function(event){this.trigger({type:"close",bubbles:!1})},_proto.handleKeyDown=function(event){keycode_default().isEventKey(event,"Esc")?(event.preventDefault(),event.stopPropagation(),this.trigger("click")):_Button.prototype.handleKeyDown.call(this,event)},CloseButton}(Button));var PlayToggle=function(_Button){function PlayToggle(player,options){var _this;return void 0===options&&(options={}),_this=_Button.call(this,player,options)||this,options.replay=void 0===options.replay||options.replay,_this.on(player,"play",function(e){return _this.handlePlay(e)}),_this.on(player,"pause",function(e){return _this.handlePause(e)}),options.replay&&_this.on(player,"ended",function(e){return _this.handleEnded(e)}),_this}inheritsLoose_default()(PlayToggle,_Button);var _proto=PlayToggle.prototype;return _proto.buildCSSClass=function(){return"vjs-play-control "+_Button.prototype.buildCSSClass.call(this)},_proto.handleClick=function(event){this.player_.paused()?silencePromise(this.player_.play()):this.player_.pause()},_proto.handleSeeked=function(event){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(event):this.handlePlay(event)},_proto.handlePlay=function(event){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")},_proto.handlePause=function(event){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")},_proto.handleEnded=function(event){var _this2=this;this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.controlText("Replay"),this.one(this.player_,"seeked",function(e){return _this2.handleSeeked(e)})},PlayToggle}(Button);PlayToggle.prototype.controlText_="Play",Component$1.registerComponent("PlayToggle",PlayToggle);var defaultImplementation=function(seconds,guide){seconds=seconds<0?0:seconds;var s=Math.floor(seconds%60),m=Math.floor(seconds/60%60),h=Math.floor(seconds/3600),gm=Math.floor(guide/60%60),gh=Math.floor(guide/3600);return(isNaN(seconds)||seconds===1/0)&&(h=m=s="-"),(h=h>0||gh>0?h+":":"")+(m=((h||gm>=10)&&m<10?"0"+m:m)+":")+(s<10?"0"+s:s)},implementation=defaultImplementation;function formatTime(seconds,guide){return void 0===guide&&(guide=seconds),implementation(seconds,guide)}var TimeDisplay=function(_Component){function TimeDisplay(player,options){var _this;return(_this=_Component.call(this,player,options)||this).on(player,["timeupdate","ended"],function(e){return _this.updateContent(e)}),_this.updateTextNode_(),_this}inheritsLoose_default()(TimeDisplay,_Component);var _proto=TimeDisplay.prototype;return _proto.createEl=function(){var className=this.buildCSSClass(),el=_Component.prototype.createEl.call(this,"div",{className:className+" vjs-time-control vjs-control"}),span=createEl("span",{className:"vjs-control-text",textContent:this.localize(this.labelText_)+"\xa0"},{role:"presentation"});return el.appendChild(span),this.contentEl_=createEl("span",{className:className+"-display"},{"aria-live":"off",role:"presentation"}),el.appendChild(this.contentEl_),el},_proto.dispose=function(){this.contentEl_=null,this.textNode_=null,_Component.prototype.dispose.call(this)},_proto.updateTextNode_=function(time){var _this2=this;void 0===time&&(time=0),time=formatTime(time),this.formattedTime_!==time&&(this.formattedTime_=time,this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",function(){if(_this2.contentEl_){var oldNode=_this2.textNode_;oldNode&&_this2.contentEl_.firstChild!==oldNode&&(oldNode=null,log$1.warn("TimeDisplay#updateTextnode_: Prevented replacement of text node element since it was no longer a child of this node. Appending a new node instead.")),_this2.textNode_=document_default().createTextNode(_this2.formattedTime_),_this2.textNode_&&(oldNode?_this2.contentEl_.replaceChild(_this2.textNode_,oldNode):_this2.contentEl_.appendChild(_this2.textNode_))}}))},_proto.updateContent=function(event){},TimeDisplay}(Component$1);TimeDisplay.prototype.labelText_="Time",TimeDisplay.prototype.controlText_="Time",Component$1.registerComponent("TimeDisplay",TimeDisplay);var CurrentTimeDisplay=function(_TimeDisplay){function CurrentTimeDisplay(){return _TimeDisplay.apply(this,arguments)||this}inheritsLoose_default()(CurrentTimeDisplay,_TimeDisplay);var _proto=CurrentTimeDisplay.prototype;return _proto.buildCSSClass=function(){return"vjs-current-time"},_proto.updateContent=function(event){var time;time=this.player_.ended()?this.player_.duration():this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),this.updateTextNode_(time)},CurrentTimeDisplay}(TimeDisplay);CurrentTimeDisplay.prototype.labelText_="Current Time",CurrentTimeDisplay.prototype.controlText_="Current Time",Component$1.registerComponent("CurrentTimeDisplay",CurrentTimeDisplay);var DurationDisplay=function(_TimeDisplay){function DurationDisplay(player,options){var _this,updateContent=function(e){return _this.updateContent(e)};return(_this=_TimeDisplay.call(this,player,options)||this).on(player,"durationchange",updateContent),_this.on(player,"loadstart",updateContent),_this.on(player,"loadedmetadata",updateContent),_this}inheritsLoose_default()(DurationDisplay,_TimeDisplay);var _proto=DurationDisplay.prototype;return _proto.buildCSSClass=function(){return"vjs-duration"},_proto.updateContent=function(event){var duration=this.player_.duration();this.updateTextNode_(duration)},DurationDisplay}(TimeDisplay);DurationDisplay.prototype.labelText_="Duration",DurationDisplay.prototype.controlText_="Duration",Component$1.registerComponent("DurationDisplay",DurationDisplay),Component$1.registerComponent("TimeDivider",function(_Component){function TimeDivider(){return _Component.apply(this,arguments)||this}return inheritsLoose_default()(TimeDivider,_Component),TimeDivider.prototype.createEl=function(){var el=_Component.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider"},{"aria-hidden":!0}),div=_Component.prototype.createEl.call(this,"div"),span=_Component.prototype.createEl.call(this,"span",{textContent:"/"});return div.appendChild(span),el.appendChild(div),el},TimeDivider}(Component$1));var RemainingTimeDisplay=function(_TimeDisplay){function RemainingTimeDisplay(player,options){var _this;return(_this=_TimeDisplay.call(this,player,options)||this).on(player,"durationchange",function(e){return _this.updateContent(e)}),_this}inheritsLoose_default()(RemainingTimeDisplay,_TimeDisplay);var _proto=RemainingTimeDisplay.prototype;return _proto.buildCSSClass=function(){return"vjs-remaining-time"},_proto.createEl=function(){var el=_TimeDisplay.prototype.createEl.call(this);return el.insertBefore(createEl("span",{},{"aria-hidden":!0},"-"),this.contentEl_),el},_proto.updateContent=function(event){var time;"number"==typeof this.player_.duration()&&(time=this.player_.ended()?0:this.player_.remainingTimeDisplay?this.player_.remainingTimeDisplay():this.player_.remainingTime(),this.updateTextNode_(time))},RemainingTimeDisplay}(TimeDisplay);RemainingTimeDisplay.prototype.labelText_="Remaining Time",RemainingTimeDisplay.prototype.controlText_="Remaining Time",Component$1.registerComponent("RemainingTimeDisplay",RemainingTimeDisplay),Component$1.registerComponent("LiveDisplay",function(_Component){function LiveDisplay(player,options){var _this;return(_this=_Component.call(this,player,options)||this).updateShowing(),_this.on(_this.player(),"durationchange",function(e){return _this.updateShowing(e)}),_this}inheritsLoose_default()(LiveDisplay,_Component);var _proto=LiveDisplay.prototype;return _proto.createEl=function(){var el=_Component.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});return this.contentEl_=createEl("div",{className:"vjs-live-display"},{"aria-live":"off"}),this.contentEl_.appendChild(createEl("span",{className:"vjs-control-text",textContent:this.localize("Stream Type")+"\xa0"})),this.contentEl_.appendChild(document_default().createTextNode(this.localize("LIVE"))),el.appendChild(this.contentEl_),el},_proto.dispose=function(){this.contentEl_=null,_Component.prototype.dispose.call(this)},_proto.updateShowing=function(event){this.player().duration()===1/0?this.show():this.hide()},LiveDisplay}(Component$1));var SeekToLive=function(_Button){function SeekToLive(player,options){var _this;return(_this=_Button.call(this,player,options)||this).updateLiveEdgeStatus(),_this.player_.liveTracker&&(_this.updateLiveEdgeStatusHandler_=function(e){return _this.updateLiveEdgeStatus(e)},_this.on(_this.player_.liveTracker,"liveedgechange",_this.updateLiveEdgeStatusHandler_)),_this}inheritsLoose_default()(SeekToLive,_Button);var _proto=SeekToLive.prototype;return _proto.createEl=function(){var el=_Button.prototype.createEl.call(this,"button",{className:"vjs-seek-to-live-control vjs-control"});return this.textEl_=createEl("span",{className:"vjs-seek-to-live-text",textContent:this.localize("LIVE")},{"aria-hidden":"true"}),el.appendChild(this.textEl_),el},_proto.updateLiveEdgeStatus=function(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))},_proto.handleClick=function(){this.player_.liveTracker.seekToLiveEdge()},_proto.dispose=function(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_),this.textEl_=null,_Button.prototype.dispose.call(this)},SeekToLive}(Button);SeekToLive.prototype.controlText_="Seek to live, currently playing live",Component$1.registerComponent("SeekToLive",SeekToLive);var clamp=function(number,min,max){return number=Number(number),Math.min(max,Math.max(min,isNaN(number)?min:number))},Slider=function(_Component){function Slider(player,options){var _this;return(_this=_Component.call(this,player,options)||this).handleMouseDown_=function(e){return _this.handleMouseDown(e)},_this.handleMouseUp_=function(e){return _this.handleMouseUp(e)},_this.handleKeyDown_=function(e){return _this.handleKeyDown(e)},_this.handleClick_=function(e){return _this.handleClick(e)},_this.handleMouseMove_=function(e){return _this.handleMouseMove(e)},_this.update_=function(e){return _this.update(e)},_this.bar=_this.getChild(_this.options_.barName),_this.vertical(!!_this.options_.vertical),_this.enable(),_this}inheritsLoose_default()(Slider,_Component);var _proto=Slider.prototype;return _proto.enabled=function(){return this.enabled_},_proto.enable=function(){this.enabled()||(this.on("mousedown",this.handleMouseDown_),this.on("touchstart",this.handleMouseDown_),this.on("keydown",this.handleKeyDown_),this.on("click",this.handleClick_),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)},_proto.disable=function(){if(this.enabled()){var doc=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown_),this.off("touchstart",this.handleMouseDown_),this.off("keydown",this.handleKeyDown_),this.off("click",this.handleClick_),this.off(this.player_,"controlsvisible",this.update_),this.off(doc,"mousemove",this.handleMouseMove_),this.off(doc,"mouseup",this.handleMouseUp_),this.off(doc,"touchmove",this.handleMouseMove_),this.off(doc,"touchend",this.handleMouseUp_),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}},_proto.createEl=function(type,props,attributes){return void 0===props&&(props={}),void 0===attributes&&(attributes={}),props.className=props.className+" vjs-slider",props=video_es_assign({tabIndex:0},props),attributes=video_es_assign({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},attributes),_Component.prototype.createEl.call(this,type,props,attributes)},_proto.handleMouseDown=function(event){var doc=this.bar.el_.ownerDocument;"mousedown"===event.type&&event.preventDefault(),"touchstart"!==event.type||IS_CHROME||event.preventDefault(),blockTextSelection(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(doc,"mousemove",this.handleMouseMove_),this.on(doc,"mouseup",this.handleMouseUp_),this.on(doc,"touchmove",this.handleMouseMove_),this.on(doc,"touchend",this.handleMouseUp_),this.handleMouseMove(event)},_proto.handleMouseMove=function(event){},_proto.handleMouseUp=function(){var doc=this.bar.el_.ownerDocument;unblockTextSelection(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(doc,"mousemove",this.handleMouseMove_),this.off(doc,"mouseup",this.handleMouseUp_),this.off(doc,"touchmove",this.handleMouseMove_),this.off(doc,"touchend",this.handleMouseUp_),this.update()},_proto.update=function(){var _this2=this;if(this.el_&&this.bar){var progress=this.getProgress();return progress===this.progress_||(this.progress_=progress,this.requestNamedAnimationFrame("Slider#update",function(){var sizeKey=_this2.vertical()?"height":"width";_this2.bar.el().style[sizeKey]=(100*progress).toFixed(2)+"%"})),progress}},_proto.getProgress=function(){return Number(clamp(this.getPercent(),0,1).toFixed(4))},_proto.calculateDistance=function(event){var position=getPointerPosition(this.el_,event);return this.vertical()?position.y:position.x},_proto.handleKeyDown=function(event){keycode_default().isEventKey(event,"Left")||keycode_default().isEventKey(event,"Down")?(event.preventDefault(),event.stopPropagation(),this.stepBack()):keycode_default().isEventKey(event,"Right")||keycode_default().isEventKey(event,"Up")?(event.preventDefault(),event.stopPropagation(),this.stepForward()):_Component.prototype.handleKeyDown.call(this,event)},_proto.handleClick=function(event){event.stopPropagation(),event.preventDefault()},_proto.vertical=function(bool){if(void 0===bool)return this.vertical_||!1;this.vertical_=!!bool,this.addClass(this.vertical_?"vjs-slider-vertical":"vjs-slider-horizontal")},Slider}(Component$1);Component$1.registerComponent("Slider",Slider);var percentify=function(time,end){return clamp(time/end*100,0,100).toFixed(2)+"%"},LoadProgressBar=function(_Component){function LoadProgressBar(player,options){var _this;return(_this=_Component.call(this,player,options)||this).partEls_=[],_this.on(player,"progress",function(e){return _this.update(e)}),_this}inheritsLoose_default()(LoadProgressBar,_Component);var _proto=LoadProgressBar.prototype;return _proto.createEl=function(){var el=_Component.prototype.createEl.call(this,"div",{className:"vjs-load-progress"}),wrapper=createEl("span",{className:"vjs-control-text"}),loadedText=createEl("span",{textContent:this.localize("Loaded")}),separator=document_default().createTextNode(": ");return this.percentageEl_=createEl("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),el.appendChild(wrapper),wrapper.appendChild(loadedText),wrapper.appendChild(separator),wrapper.appendChild(this.percentageEl_),el},_proto.dispose=function(){this.partEls_=null,this.percentageEl_=null,_Component.prototype.dispose.call(this)},_proto.update=function(event){var _this2=this;this.requestNamedAnimationFrame("LoadProgressBar#update",function(){var liveTracker=_this2.player_.liveTracker,buffered=_this2.player_.buffered(),duration=liveTracker&&liveTracker.isLive()?liveTracker.seekableEnd():_this2.player_.duration(),bufferedEnd=_this2.player_.bufferedEnd(),children=_this2.partEls_,percent=percentify(bufferedEnd,duration);_this2.percent_!==percent&&(_this2.el_.style.width=percent,textContent(_this2.percentageEl_,percent),_this2.percent_=percent);for(var i=0;i<buffered.length;i++){var start=buffered.start(i),end=buffered.end(i),part=children[i];part||(part=_this2.el_.appendChild(createEl()),children[i]=part),part.dataset.start===start&&part.dataset.end===end||(part.dataset.start=start,part.dataset.end=end,part.style.left=percentify(start,bufferedEnd),part.style.width=percentify(end-start,bufferedEnd))}for(var _i=children.length;_i>buffered.length;_i--)_this2.el_.removeChild(children[_i-1]);children.length=buffered.length})},LoadProgressBar}(Component$1);Component$1.registerComponent("LoadProgressBar",LoadProgressBar);var TimeTooltip=function(_Component){function TimeTooltip(player,options){var _this;return(_this=_Component.call(this,player,options)||this).update=throttle(bind(assertThisInitialized_default()(_this),_this.update),30),_this}inheritsLoose_default()(TimeTooltip,_Component);var _proto=TimeTooltip.prototype;return _proto.createEl=function(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})},_proto.update=function(seekBarRect,seekBarPoint,content){var tooltipRect=findPosition(this.el_),playerRect=getBoundingClientRect(this.player_.el()),seekBarPointPx=seekBarRect.width*seekBarPoint;if(playerRect&&tooltipRect){var spaceLeftOfPoint=seekBarRect.left-playerRect.left+seekBarPointPx,spaceRightOfPoint=seekBarRect.width-seekBarPointPx+(playerRect.right-seekBarRect.right),pullTooltipBy=tooltipRect.width/2;spaceLeftOfPoint<pullTooltipBy?pullTooltipBy+=pullTooltipBy-spaceLeftOfPoint:spaceRightOfPoint<pullTooltipBy&&(pullTooltipBy=spaceRightOfPoint),pullTooltipBy<0?pullTooltipBy=0:pullTooltipBy>tooltipRect.width&&(pullTooltipBy=tooltipRect.width),pullTooltipBy=Math.round(pullTooltipBy),this.el_.style.right="-"+pullTooltipBy+"px",this.write(content)}},_proto.write=function(content){textContent(this.el_,content)},_proto.updateTime=function(seekBarRect,seekBarPoint,time,cb){var _this2=this;this.requestNamedAnimationFrame("TimeTooltip#updateTime",function(){var content,duration=_this2.player_.duration();if(_this2.player_.liveTracker&&_this2.player_.liveTracker.isLive()){var liveWindow=_this2.player_.liveTracker.liveWindow(),secondsBehind=liveWindow-seekBarPoint*liveWindow;content=(secondsBehind<1?"":"-")+formatTime(secondsBehind,liveWindow)}else content=formatTime(time,duration);_this2.update(seekBarRect,seekBarPoint,content),cb&&cb()})},TimeTooltip}(Component$1);Component$1.registerComponent("TimeTooltip",TimeTooltip);var PlayProgressBar=function(_Component){function PlayProgressBar(player,options){var _this;return(_this=_Component.call(this,player,options)||this).update=throttle(bind(assertThisInitialized_default()(_this),_this.update),30),_this}inheritsLoose_default()(PlayProgressBar,_Component);var _proto=PlayProgressBar.prototype;return _proto.createEl=function(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})},_proto.update=function(seekBarRect,seekBarPoint){var timeTooltip=this.getChild("timeTooltip");if(timeTooltip){var time=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();timeTooltip.updateTime(seekBarRect,seekBarPoint,time)}},PlayProgressBar}(Component$1);PlayProgressBar.prototype.options_={children:[]},IS_IOS||IS_ANDROID||PlayProgressBar.prototype.options_.children.push("timeTooltip"),Component$1.registerComponent("PlayProgressBar",PlayProgressBar);var MouseTimeDisplay=function(_Component){function MouseTimeDisplay(player,options){var _this;return(_this=_Component.call(this,player,options)||this).update=throttle(bind(assertThisInitialized_default()(_this),_this.update),30),_this}inheritsLoose_default()(MouseTimeDisplay,_Component);var _proto=MouseTimeDisplay.prototype;return _proto.createEl=function(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},_proto.update=function(seekBarRect,seekBarPoint){var _this2=this,time=seekBarPoint*this.player_.duration();this.getChild("timeTooltip").updateTime(seekBarRect,seekBarPoint,time,function(){_this2.el_.style.left=seekBarRect.width*seekBarPoint+"px"})},MouseTimeDisplay}(Component$1);MouseTimeDisplay.prototype.options_={children:["timeTooltip"]},Component$1.registerComponent("MouseTimeDisplay",MouseTimeDisplay);var SeekBar=function(_Slider){function SeekBar(player,options){var _this;return(_this=_Slider.call(this,player,options)||this).setEventHandlers_(),_this}inheritsLoose_default()(SeekBar,_Slider);var _proto=SeekBar.prototype;return _proto.setEventHandlers_=function(){var _this2=this;this.update_=bind(this,this.update),this.update=throttle(this.update_,30),this.on(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.enableIntervalHandler_=function(e){return _this2.enableInterval_(e)},this.disableIntervalHandler_=function(e){return _this2.disableInterval_(e)},this.on(this.player_,["playing"],this.enableIntervalHandler_),this.on(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in document_default()&&"visibilityState"in document_default()&&this.on(document_default(),"visibilitychange",this.toggleVisibility_)},_proto.toggleVisibility_=function(e){"hidden"===document_default().visibilityState?(this.cancelNamedAnimationFrame("SeekBar#update"),this.cancelNamedAnimationFrame("Slider#update"),this.disableInterval_(e)):(this.player_.ended()||this.player_.paused()||this.enableInterval_(),this.update())},_proto.enableInterval_=function(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,30))},_proto.disableInterval_=function(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&e&&"ended"!==e.type||this.updateInterval&&(this.clearInterval(this.updateInterval),this.updateInterval=null)},_proto.createEl=function(){return _Slider.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},_proto.update=function(event){var _this3=this;if("hidden"!==document_default().visibilityState){var percent=_Slider.prototype.update.call(this);return this.requestNamedAnimationFrame("SeekBar#update",function(){var currentTime=_this3.player_.ended()?_this3.player_.duration():_this3.getCurrentTime_(),liveTracker=_this3.player_.liveTracker,duration=_this3.player_.duration();liveTracker&&liveTracker.isLive()&&(duration=_this3.player_.liveTracker.liveCurrentTime()),_this3.percent_!==percent&&(_this3.el_.setAttribute("aria-valuenow",(100*percent).toFixed(2)),_this3.percent_=percent),_this3.currentTime_===currentTime&&_this3.duration_===duration||(_this3.el_.setAttribute("aria-valuetext",_this3.localize("progress bar timing: currentTime={1} duration={2}",[formatTime(currentTime,duration),formatTime(duration,duration)],"{1} of {2}")),_this3.currentTime_=currentTime,_this3.duration_=duration),_this3.bar&&_this3.bar.update(getBoundingClientRect(_this3.el()),_this3.getProgress())}),percent}},_proto.userSeek_=function(ct){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(ct)},_proto.getCurrentTime_=function(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()},_proto.getPercent=function(){var percent,currentTime=this.getCurrentTime_(),liveTracker=this.player_.liveTracker;return liveTracker&&liveTracker.isLive()?(percent=(currentTime-liveTracker.seekableStart())/liveTracker.liveWindow(),liveTracker.atLiveEdge()&&(percent=1)):percent=currentTime/this.player_.duration(),percent},_proto.handleMouseDown=function(event){isSingleLeftClick(event)&&(event.stopPropagation(),this.player_.scrubbing(!0),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),_Slider.prototype.handleMouseDown.call(this,event))},_proto.handleMouseMove=function(event){if(isSingleLeftClick(event)){var newTime,distance=this.calculateDistance(event),liveTracker=this.player_.liveTracker;if(liveTracker&&liveTracker.isLive()){if(distance>=.99)return void liveTracker.seekToLiveEdge();var seekableStart=liveTracker.seekableStart(),seekableEnd=liveTracker.liveCurrentTime();if((newTime=seekableStart+distance*liveTracker.liveWindow())>=seekableEnd&&(newTime=seekableEnd),newTime<=seekableStart&&(newTime=seekableStart+.1),newTime===1/0)return}else(newTime=distance*this.player_.duration())===this.player_.duration()&&(newTime-=.1);this.userSeek_(newTime)}},_proto.enable=function(){_Slider.prototype.enable.call(this);var mouseTimeDisplay=this.getChild("mouseTimeDisplay");mouseTimeDisplay&&mouseTimeDisplay.show()},_proto.disable=function(){_Slider.prototype.disable.call(this);var mouseTimeDisplay=this.getChild("mouseTimeDisplay");mouseTimeDisplay&&mouseTimeDisplay.hide()},_proto.handleMouseUp=function(event){_Slider.prototype.handleMouseUp.call(this,event),event&&event.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying?silencePromise(this.player_.play()):this.update_()},_proto.stepForward=function(){this.userSeek_(this.player_.currentTime()+5)},_proto.stepBack=function(){this.userSeek_(this.player_.currentTime()-5)},_proto.handleAction=function(event){this.player_.paused()?this.player_.play():this.player_.pause()},_proto.handleKeyDown=function(event){var liveTracker=this.player_.liveTracker;if(keycode_default().isEventKey(event,"Space")||keycode_default().isEventKey(event,"Enter"))event.preventDefault(),event.stopPropagation(),this.handleAction(event);else if(keycode_default().isEventKey(event,"Home"))event.preventDefault(),event.stopPropagation(),this.userSeek_(0);else if(keycode_default().isEventKey(event,"End"))event.preventDefault(),event.stopPropagation(),liveTracker&&liveTracker.isLive()?this.userSeek_(liveTracker.liveCurrentTime()):this.userSeek_(this.player_.duration());else if(/^[0-9]$/.test(keycode_default()(event))){event.preventDefault(),event.stopPropagation();var gotoFraction=10*(keycode_default().codes[keycode_default()(event)]-keycode_default().codes[0])/100;liveTracker&&liveTracker.isLive()?this.userSeek_(liveTracker.seekableStart()+liveTracker.liveWindow()*gotoFraction):this.userSeek_(this.player_.duration()*gotoFraction)}else keycode_default().isEventKey(event,"PgDn")?(event.preventDefault(),event.stopPropagation(),this.userSeek_(this.player_.currentTime()-60)):keycode_default().isEventKey(event,"PgUp")?(event.preventDefault(),event.stopPropagation(),this.userSeek_(this.player_.currentTime()+60)):_Slider.prototype.handleKeyDown.call(this,event)},_proto.dispose=function(){this.disableInterval_(),this.off(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableIntervalHandler_),this.off(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in document_default()&&"visibilityState"in document_default()&&this.off(document_default(),"visibilitychange",this.toggleVisibility_),_Slider.prototype.dispose.call(this)},SeekBar}(Slider);SeekBar.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},IS_IOS||IS_ANDROID||SeekBar.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),Component$1.registerComponent("SeekBar",SeekBar);var ProgressControl=function(_Component){function ProgressControl(player,options){var _this;return(_this=_Component.call(this,player,options)||this).handleMouseMove=throttle(bind(assertThisInitialized_default()(_this),_this.handleMouseMove),30),_this.throttledHandleMouseSeek=throttle(bind(assertThisInitialized_default()(_this),_this.handleMouseSeek),30),_this.handleMouseUpHandler_=function(e){return _this.handleMouseUp(e)},_this.handleMouseDownHandler_=function(e){return _this.handleMouseDown(e)},_this.enable(),_this}inheritsLoose_default()(ProgressControl,_Component);var _proto=ProgressControl.prototype;return _proto.createEl=function(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},_proto.handleMouseMove=function(event){var seekBar=this.getChild("seekBar");if(seekBar){var playProgressBar=seekBar.getChild("playProgressBar"),mouseTimeDisplay=seekBar.getChild("mouseTimeDisplay");if(playProgressBar||mouseTimeDisplay){var seekBarEl=seekBar.el(),seekBarRect=findPosition(seekBarEl),seekBarPoint=getPointerPosition(seekBarEl,event).x;seekBarPoint=clamp(seekBarPoint,0,1),mouseTimeDisplay&&mouseTimeDisplay.update(seekBarRect,seekBarPoint),playProgressBar&&playProgressBar.update(seekBarRect,seekBar.getProgress())}}},_proto.handleMouseSeek=function(event){var seekBar=this.getChild("seekBar");seekBar&&seekBar.handleMouseMove(event)},_proto.enabled=function(){return this.enabled_},_proto.disable=function(){if(this.children().forEach(function(child){return child.disable&&child.disable()}),this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDownHandler_),this.off(this.el_,"mousemove",this.handleMouseMove),this.removeListenersAddedOnMousedownAndTouchstart(),this.addClass("disabled"),this.enabled_=!1,this.player_.scrubbing())){var seekBar=this.getChild("seekBar");this.player_.scrubbing(!1),seekBar.videoWasPlaying&&silencePromise(this.player_.play())}},_proto.enable=function(){this.children().forEach(function(child){return child.enable&&child.enable()}),this.enabled()||(this.on(["mousedown","touchstart"],this.handleMouseDownHandler_),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)},_proto.removeListenersAddedOnMousedownAndTouchstart=function(){var doc=this.el_.ownerDocument;this.off(doc,"mousemove",this.throttledHandleMouseSeek),this.off(doc,"touchmove",this.throttledHandleMouseSeek),this.off(doc,"mouseup",this.handleMouseUpHandler_),this.off(doc,"touchend",this.handleMouseUpHandler_)},_proto.handleMouseDown=function(event){var doc=this.el_.ownerDocument,seekBar=this.getChild("seekBar");seekBar&&seekBar.handleMouseDown(event),this.on(doc,"mousemove",this.throttledHandleMouseSeek),this.on(doc,"touchmove",this.throttledHandleMouseSeek),this.on(doc,"mouseup",this.handleMouseUpHandler_),this.on(doc,"touchend",this.handleMouseUpHandler_)},_proto.handleMouseUp=function(event){var seekBar=this.getChild("seekBar");seekBar&&seekBar.handleMouseUp(event),this.removeListenersAddedOnMousedownAndTouchstart()},ProgressControl}(Component$1);ProgressControl.prototype.options_={children:["seekBar"]},Component$1.registerComponent("ProgressControl",ProgressControl);var PictureInPictureToggle=function(_Button){function PictureInPictureToggle(player,options){var _this;return(_this=_Button.call(this,player,options)||this).on(player,["enterpictureinpicture","leavepictureinpicture"],function(e){return _this.handlePictureInPictureChange(e)}),_this.on(player,["disablepictureinpicturechanged","loadedmetadata"],function(e){return _this.handlePictureInPictureEnabledChange(e)}),_this.disable(),_this}inheritsLoose_default()(PictureInPictureToggle,_Button);var _proto=PictureInPictureToggle.prototype;return _proto.buildCSSClass=function(){return"vjs-picture-in-picture-control "+_Button.prototype.buildCSSClass.call(this)},_proto.handlePictureInPictureEnabledChange=function(){document_default().pictureInPictureEnabled&&!1===this.player_.disablePictureInPicture()?this.enable():this.disable()},_proto.handlePictureInPictureChange=function(event){this.player_.isInPictureInPicture()?this.controlText("Exit Picture-in-Picture"):this.controlText("Picture-in-Picture"),this.handlePictureInPictureEnabledChange()},_proto.handleClick=function(event){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()},PictureInPictureToggle}(Button);PictureInPictureToggle.prototype.controlText_="Picture-in-Picture",Component$1.registerComponent("PictureInPictureToggle",PictureInPictureToggle);var FullscreenToggle=function(_Button){function FullscreenToggle(player,options){var _this;return(_this=_Button.call(this,player,options)||this).on(player,"fullscreenchange",function(e){return _this.handleFullscreenChange(e)}),!1===document_default()[player.fsApi_.fullscreenEnabled]&&_this.disable(),_this}inheritsLoose_default()(FullscreenToggle,_Button);var _proto=FullscreenToggle.prototype;return _proto.buildCSSClass=function(){return"vjs-fullscreen-control "+_Button.prototype.buildCSSClass.call(this)},_proto.handleFullscreenChange=function(event){this.player_.isFullscreen()?this.controlText("Non-Fullscreen"):this.controlText("Fullscreen")},_proto.handleClick=function(event){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()},FullscreenToggle}(Button);FullscreenToggle.prototype.controlText_="Fullscreen",Component$1.registerComponent("FullscreenToggle",FullscreenToggle),Component$1.registerComponent("VolumeLevel",function(_Component){function VolumeLevel(){return _Component.apply(this,arguments)||this}return inheritsLoose_default()(VolumeLevel,_Component),VolumeLevel.prototype.createEl=function(){var el=_Component.prototype.createEl.call(this,"div",{className:"vjs-volume-level"});return el.appendChild(_Component.prototype.createEl.call(this,"span",{className:"vjs-control-text"})),el},VolumeLevel}(Component$1)),Component$1.registerComponent("VolumeLevelTooltip",function(_Component){function VolumeLevelTooltip(player,options){var _this;return(_this=_Component.call(this,player,options)||this).update=throttle(bind(assertThisInitialized_default()(_this),_this.update),30),_this}inheritsLoose_default()(VolumeLevelTooltip,_Component);var _proto=VolumeLevelTooltip.prototype;return _proto.createEl=function(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-volume-tooltip"},{"aria-hidden":"true"})},_proto.update=function(rangeBarRect,rangeBarPoint,vertical,content){if(!vertical){var tooltipRect=getBoundingClientRect(this.el_),playerRect=getBoundingClientRect(this.player_.el()),volumeBarPointPx=rangeBarRect.width*rangeBarPoint;if(!playerRect||!tooltipRect)return;var spaceLeftOfPoint=rangeBarRect.left-playerRect.left+volumeBarPointPx,spaceRightOfPoint=rangeBarRect.width-volumeBarPointPx+(playerRect.right-rangeBarRect.right),pullTooltipBy=tooltipRect.width/2;spaceLeftOfPoint<pullTooltipBy?pullTooltipBy+=pullTooltipBy-spaceLeftOfPoint:spaceRightOfPoint<pullTooltipBy&&(pullTooltipBy=spaceRightOfPoint),pullTooltipBy<0?pullTooltipBy=0:pullTooltipBy>tooltipRect.width&&(pullTooltipBy=tooltipRect.width),this.el_.style.right="-"+pullTooltipBy+"px"}this.write(content+"%")},_proto.write=function(content){textContent(this.el_,content)},_proto.updateVolume=function(rangeBarRect,rangeBarPoint,vertical,volume,cb){var _this2=this;this.requestNamedAnimationFrame("VolumeLevelTooltip#updateVolume",function(){_this2.update(rangeBarRect,rangeBarPoint,vertical,volume.toFixed(0)),cb&&cb()})},VolumeLevelTooltip}(Component$1));var MouseVolumeLevelDisplay=function(_Component){function MouseVolumeLevelDisplay(player,options){var _this;return(_this=_Component.call(this,player,options)||this).update=throttle(bind(assertThisInitialized_default()(_this),_this.update),30),_this}inheritsLoose_default()(MouseVolumeLevelDisplay,_Component);var _proto=MouseVolumeLevelDisplay.prototype;return _proto.createEl=function(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},_proto.update=function(rangeBarRect,rangeBarPoint,vertical){var _this2=this,volume=100*rangeBarPoint;this.getChild("volumeLevelTooltip").updateVolume(rangeBarRect,rangeBarPoint,vertical,volume,function(){vertical?_this2.el_.style.bottom=rangeBarRect.height*rangeBarPoint+"px":_this2.el_.style.left=rangeBarRect.width*rangeBarPoint+"px"})},MouseVolumeLevelDisplay}(Component$1);MouseVolumeLevelDisplay.prototype.options_={children:["volumeLevelTooltip"]},Component$1.registerComponent("MouseVolumeLevelDisplay",MouseVolumeLevelDisplay);var VolumeBar=function(_Slider){function VolumeBar(player,options){var _this;return(_this=_Slider.call(this,player,options)||this).on("slideractive",function(e){return _this.updateLastVolume_(e)}),_this.on(player,"volumechange",function(e){return _this.updateARIAAttributes(e)}),player.ready(function(){return _this.updateARIAAttributes()}),_this}inheritsLoose_default()(VolumeBar,_Slider);var _proto=VolumeBar.prototype;return _proto.createEl=function(){return _Slider.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})},_proto.handleMouseDown=function(event){isSingleLeftClick(event)&&_Slider.prototype.handleMouseDown.call(this,event)},_proto.handleMouseMove=function(event){var mouseVolumeLevelDisplay=this.getChild("mouseVolumeLevelDisplay");if(mouseVolumeLevelDisplay){var volumeBarEl=this.el(),volumeBarRect=getBoundingClientRect(volumeBarEl),vertical=this.vertical(),volumeBarPoint=getPointerPosition(volumeBarEl,event);volumeBarPoint=clamp(volumeBarPoint=vertical?volumeBarPoint.y:volumeBarPoint.x,0,1),mouseVolumeLevelDisplay.update(volumeBarRect,volumeBarPoint,vertical)}isSingleLeftClick(event)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(event)))},_proto.checkMuted=function(){this.player_.muted()&&this.player_.muted(!1)},_proto.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},_proto.stepForward=function(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)},_proto.stepBack=function(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)},_proto.updateARIAAttributes=function(event){var ariaValue=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",ariaValue),this.el_.setAttribute("aria-valuetext",ariaValue+"%")},_proto.volumeAsPercentage_=function(){return Math.round(100*this.player_.volume())},_proto.updateLastVolume_=function(){var _this2=this,volumeBeforeDrag=this.player_.volume();this.one("sliderinactive",function(){0===_this2.player_.volume()&&_this2.player_.lastVolume_(volumeBeforeDrag)})},VolumeBar}(Slider);VolumeBar.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},IS_IOS||IS_ANDROID||VolumeBar.prototype.options_.children.splice(0,0,"mouseVolumeLevelDisplay"),VolumeBar.prototype.playerEvent="volumechange",Component$1.registerComponent("VolumeBar",VolumeBar);var VolumeControl=function(_Component){function VolumeControl(player,options){var _this;return void 0===options&&(options={}),options.vertical=options.vertical||!1,(void 0===options.volumeBar||isPlain(options.volumeBar))&&(options.volumeBar=options.volumeBar||{},options.volumeBar.vertical=options.vertical),_this=_Component.call(this,player,options)||this,function(self,player){player.tech_&&!player.tech_.featuresVolumeControl&&self.addClass("vjs-hidden"),self.on(player,"loadstart",function(){player.tech_.featuresVolumeControl?self.removeClass("vjs-hidden"):self.addClass("vjs-hidden")})}(assertThisInitialized_default()(_this),player),_this.throttledHandleMouseMove=throttle(bind(assertThisInitialized_default()(_this),_this.handleMouseMove),30),_this.handleMouseUpHandler_=function(e){return _this.handleMouseUp(e)},_this.on("mousedown",function(e){return _this.handleMouseDown(e)}),_this.on("touchstart",function(e){return _this.handleMouseDown(e)}),_this.on("mousemove",function(e){return _this.handleMouseMove(e)}),_this.on(_this.volumeBar,["focus","slideractive"],function(){_this.volumeBar.addClass("vjs-slider-active"),_this.addClass("vjs-slider-active"),_this.trigger("slideractive")}),_this.on(_this.volumeBar,["blur","sliderinactive"],function(){_this.volumeBar.removeClass("vjs-slider-active"),_this.removeClass("vjs-slider-active"),_this.trigger("sliderinactive")}),_this}inheritsLoose_default()(VolumeControl,_Component);var _proto=VolumeControl.prototype;return _proto.createEl=function(){var orientationClass="vjs-volume-horizontal";return this.options_.vertical&&(orientationClass="vjs-volume-vertical"),_Component.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+orientationClass})},_proto.handleMouseDown=function(event){var doc=this.el_.ownerDocument;this.on(doc,"mousemove",this.throttledHandleMouseMove),this.on(doc,"touchmove",this.throttledHandleMouseMove),this.on(doc,"mouseup",this.handleMouseUpHandler_),this.on(doc,"touchend",this.handleMouseUpHandler_)},_proto.handleMouseUp=function(event){var doc=this.el_.ownerDocument;this.off(doc,"mousemove",this.throttledHandleMouseMove),this.off(doc,"touchmove",this.throttledHandleMouseMove),this.off(doc,"mouseup",this.handleMouseUpHandler_),this.off(doc,"touchend",this.handleMouseUpHandler_)},_proto.handleMouseMove=function(event){this.volumeBar.handleMouseMove(event)},VolumeControl}(Component$1);VolumeControl.prototype.options_={children:["volumeBar"]},Component$1.registerComponent("VolumeControl",VolumeControl);var MuteToggle=function(_Button){function MuteToggle(player,options){var _this;return _this=_Button.call(this,player,options)||this,function(self,player){player.tech_&&!player.tech_.featuresMuteControl&&self.addClass("vjs-hidden"),self.on(player,"loadstart",function(){player.tech_.featuresMuteControl?self.removeClass("vjs-hidden"):self.addClass("vjs-hidden")})}(assertThisInitialized_default()(_this),player),_this.on(player,["loadstart","volumechange"],function(e){return _this.update(e)}),_this}inheritsLoose_default()(MuteToggle,_Button);var _proto=MuteToggle.prototype;return _proto.buildCSSClass=function(){return"vjs-mute-control "+_Button.prototype.buildCSSClass.call(this)},_proto.handleClick=function(event){var vol=this.player_.volume(),lastVolume=this.player_.lastVolume_();0===vol?(this.player_.volume(lastVolume<.1?.1:lastVolume),this.player_.muted(!1)):this.player_.muted(!this.player_.muted())},_proto.update=function(event){this.updateIcon_(),this.updateControlText_()},_proto.updateIcon_=function(){var vol=this.player_.volume(),level=3;IS_IOS&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),0===vol||this.player_.muted()?level=0:vol<.33?level=1:vol<.67&&(level=2);for(var i=0;i<4;i++)removeClass(this.el_,"vjs-vol-"+i);addClass(this.el_,"vjs-vol-"+level)},_proto.updateControlText_=function(){var text=this.player_.muted()||0===this.player_.volume()?"Unmute":"Mute";this.controlText()!==text&&this.controlText(text)},MuteToggle}(Button);MuteToggle.prototype.controlText_="Mute",Component$1.registerComponent("MuteToggle",MuteToggle);var VolumePanel=function(_Component){function VolumePanel(player,options){var _this;return void 0===options&&(options={}),options.inline=void 0===options.inline||options.inline,(void 0===options.volumeControl||isPlain(options.volumeControl))&&(options.volumeControl=options.volumeControl||{},options.volumeControl.vertical=!options.inline),(_this=_Component.call(this,player,options)||this).handleKeyPressHandler_=function(e){return _this.handleKeyPress(e)},_this.on(player,["loadstart"],function(e){return _this.volumePanelState_(e)}),_this.on(_this.muteToggle,"keyup",function(e){return _this.handleKeyPress(e)}),_this.on(_this.volumeControl,"keyup",function(e){return _this.handleVolumeControlKeyUp(e)}),_this.on("keydown",function(e){return _this.handleKeyPress(e)}),_this.on("mouseover",function(e){return _this.handleMouseOver(e)}),_this.on("mouseout",function(e){return _this.handleMouseOut(e)}),_this.on(_this.volumeControl,["slideractive"],_this.sliderActive_),_this.on(_this.volumeControl,["sliderinactive"],_this.sliderInactive_),_this}inheritsLoose_default()(VolumePanel,_Component);var _proto=VolumePanel.prototype;return _proto.sliderActive_=function(){this.addClass("vjs-slider-active")},_proto.sliderInactive_=function(){this.removeClass("vjs-slider-active")},_proto.volumePanelState_=function(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")},_proto.createEl=function(){var orientationClass="vjs-volume-panel-horizontal";return this.options_.inline||(orientationClass="vjs-volume-panel-vertical"),_Component.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+orientationClass})},_proto.dispose=function(){this.handleMouseOut(),_Component.prototype.dispose.call(this)},_proto.handleVolumeControlKeyUp=function(event){keycode_default().isEventKey(event,"Esc")&&this.muteToggle.focus()},_proto.handleMouseOver=function(event){this.addClass("vjs-hover"),on(document_default(),"keyup",this.handleKeyPressHandler_)},_proto.handleMouseOut=function(event){this.removeClass("vjs-hover"),off(document_default(),"keyup",this.handleKeyPressHandler_)},_proto.handleKeyPress=function(event){keycode_default().isEventKey(event,"Esc")&&this.handleMouseOut()},VolumePanel}(Component$1);VolumePanel.prototype.options_={children:["muteToggle","volumeControl"]},Component$1.registerComponent("VolumePanel",VolumePanel);var Menu=function(_Component){function Menu(player,options){var _this;return _this=_Component.call(this,player,options)||this,options&&(_this.menuButton_=options.menuButton),_this.focusedChild_=-1,_this.on("keydown",function(e){return _this.handleKeyDown(e)}),_this.boundHandleBlur_=function(e){return _this.handleBlur(e)},_this.boundHandleTapClick_=function(e){return _this.handleTapClick(e)},_this}inheritsLoose_default()(Menu,_Component);var _proto=Menu.prototype;return _proto.addEventListenerForItem=function(component){component instanceof Component$1&&(this.on(component,"blur",this.boundHandleBlur_),this.on(component,["tap","click"],this.boundHandleTapClick_))},_proto.removeEventListenerForItem=function(component){component instanceof Component$1&&(this.off(component,"blur",this.boundHandleBlur_),this.off(component,["tap","click"],this.boundHandleTapClick_))},_proto.removeChild=function(component){"string"==typeof component&&(component=this.getChild(component)),this.removeEventListenerForItem(component),_Component.prototype.removeChild.call(this,component)},_proto.addItem=function(component){var childComponent=this.addChild(component);childComponent&&this.addEventListenerForItem(childComponent)},_proto.createEl=function(){this.contentEl_=createEl(this.options_.contentElType||"ul",{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");var el=_Component.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return el.appendChild(this.contentEl_),on(el,"click",function(event){event.preventDefault(),event.stopImmediatePropagation()}),el},_proto.dispose=function(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,_Component.prototype.dispose.call(this)},_proto.handleBlur=function(event){var relatedTarget=event.relatedTarget||document_default().activeElement;if(!this.children().some(function(element){return element.el()===relatedTarget})){var btn=this.menuButton_;btn&&btn.buttonPressed_&&relatedTarget!==btn.el().firstChild&&btn.unpressButton()}},_proto.handleTapClick=function(event){if(this.menuButton_){this.menuButton_.unpressButton();var childComponents=this.children();if(!Array.isArray(childComponents))return;var foundComponent=childComponents.filter(function(component){return component.el()===event.target})[0];if(!foundComponent)return;"CaptionSettingsMenuItem"!==foundComponent.name()&&this.menuButton_.focus()}},_proto.handleKeyDown=function(event){keycode_default().isEventKey(event,"Left")||keycode_default().isEventKey(event,"Down")?(event.preventDefault(),event.stopPropagation(),this.stepForward()):(keycode_default().isEventKey(event,"Right")||keycode_default().isEventKey(event,"Up"))&&(event.preventDefault(),event.stopPropagation(),this.stepBack())},_proto.stepForward=function(){var stepChild=0;void 0!==this.focusedChild_&&(stepChild=this.focusedChild_+1),this.focus(stepChild)},_proto.stepBack=function(){var stepChild=0;void 0!==this.focusedChild_&&(stepChild=this.focusedChild_-1),this.focus(stepChild)},_proto.focus=function(item){void 0===item&&(item=0);var children=this.children().slice();children.length&&children[0].hasClass("vjs-menu-title")&&children.shift(),children.length>0&&(item<0?item=0:item>=children.length&&(item=children.length-1),this.focusedChild_=item,children[item].el_.focus())},Menu}(Component$1);Component$1.registerComponent("Menu",Menu);var MenuButton=function(_Component){function MenuButton(player,options){var _this;void 0===options&&(options={}),(_this=_Component.call(this,player,options)||this).menuButton_=new Button(player,options),_this.menuButton_.controlText(_this.controlText_),_this.menuButton_.el_.setAttribute("aria-haspopup","true");var buttonClass=Button.prototype.buildCSSClass();_this.menuButton_.el_.className=_this.buildCSSClass()+" "+buttonClass,_this.menuButton_.removeClass("vjs-control"),_this.addChild(_this.menuButton_),_this.update(),_this.enabled_=!0;var handleClick=function(e){return _this.handleClick(e)};return _this.handleMenuKeyUp_=function(e){return _this.handleMenuKeyUp(e)},_this.on(_this.menuButton_,"tap",handleClick),_this.on(_this.menuButton_,"click",handleClick),_this.on(_this.menuButton_,"keydown",function(e){return _this.handleKeyDown(e)}),_this.on(_this.menuButton_,"mouseenter",function(){_this.addClass("vjs-hover"),_this.menu.show(),on(document_default(),"keyup",_this.handleMenuKeyUp_)}),_this.on("mouseleave",function(e){return _this.handleMouseLeave(e)}),_this.on("keydown",function(e){return _this.handleSubmenuKeyDown(e)}),_this}inheritsLoose_default()(MenuButton,_Component);var _proto=MenuButton.prototype;return _proto.update=function(){var menu=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=menu,this.addChild(menu),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?this.hide():this.show()},_proto.createMenu=function(){var menu=new Menu(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){var titleEl=createEl("li",{className:"vjs-menu-title",textContent:toTitleCase$1(this.options_.title),tabIndex:-1}),titleComponent=new Component$1(this.player_,{el:titleEl});menu.addItem(titleComponent)}if(this.items=this.createItems(),this.items)for(var i=0;i<this.items.length;i++)menu.addItem(this.items[i]);return menu},_proto.createItems=function(){},_proto.createEl=function(){return _Component.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})},_proto.buildWrapperCSSClass=function(){var menuButtonClass="vjs-menu-button";return"vjs-menu-button "+(menuButtonClass+=!0===this.options_.inline?"-inline":"-popup")+" "+Button.prototype.buildCSSClass()+" "+_Component.prototype.buildCSSClass.call(this)},_proto.buildCSSClass=function(){var menuButtonClass="vjs-menu-button";return"vjs-menu-button "+(menuButtonClass+=!0===this.options_.inline?"-inline":"-popup")+" "+_Component.prototype.buildCSSClass.call(this)},_proto.controlText=function(text,el){return void 0===el&&(el=this.menuButton_.el()),this.menuButton_.controlText(text,el)},_proto.dispose=function(){this.handleMouseLeave(),_Component.prototype.dispose.call(this)},_proto.handleClick=function(event){this.buttonPressed_?this.unpressButton():this.pressButton()},_proto.handleMouseLeave=function(event){this.removeClass("vjs-hover"),off(document_default(),"keyup",this.handleMenuKeyUp_)},_proto.focus=function(){this.menuButton_.focus()},_proto.blur=function(){this.menuButton_.blur()},_proto.handleKeyDown=function(event){keycode_default().isEventKey(event,"Esc")||keycode_default().isEventKey(event,"Tab")?(this.buttonPressed_&&this.unpressButton(),keycode_default().isEventKey(event,"Tab")||(event.preventDefault(),this.menuButton_.focus())):(keycode_default().isEventKey(event,"Up")||keycode_default().isEventKey(event,"Down"))&&(this.buttonPressed_||(event.preventDefault(),this.pressButton()))},_proto.handleMenuKeyUp=function(event){(keycode_default().isEventKey(event,"Esc")||keycode_default().isEventKey(event,"Tab"))&&this.removeClass("vjs-hover")},_proto.handleSubmenuKeyPress=function(event){this.handleSubmenuKeyDown(event)},_proto.handleSubmenuKeyDown=function(event){(keycode_default().isEventKey(event,"Esc")||keycode_default().isEventKey(event,"Tab"))&&(this.buttonPressed_&&this.unpressButton(),keycode_default().isEventKey(event,"Tab")||(event.preventDefault(),this.menuButton_.focus()))},_proto.pressButton=function(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),IS_IOS&&isInFrame())return;this.menu.focus()}},_proto.unpressButton=function(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))},_proto.disable=function(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()},_proto.enable=function(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()},MenuButton}(Component$1);Component$1.registerComponent("MenuButton",MenuButton);var TrackButton=function(_MenuButton){function TrackButton(player,options){var _this,tracks=options.tracks;if((_this=_MenuButton.call(this,player,options)||this).items.length<=1&&_this.hide(),!tracks)return assertThisInitialized_default()(_this);var updateHandler=bind(assertThisInitialized_default()(_this),_this.update);return tracks.addEventListener("removetrack",updateHandler),tracks.addEventListener("addtrack",updateHandler),tracks.addEventListener("labelchange",updateHandler),_this.player_.on("ready",updateHandler),_this.player_.on("dispose",function(){tracks.removeEventListener("removetrack",updateHandler),tracks.removeEventListener("addtrack",updateHandler),tracks.removeEventListener("labelchange",updateHandler)}),_this}return inheritsLoose_default()(TrackButton,_MenuButton),TrackButton}(MenuButton);Component$1.registerComponent("TrackButton",TrackButton);var MenuKeys=["Tab","Esc","Up","Down","Right","Left"],MenuItem=function(_ClickableComponent){function MenuItem(player,options){var _this;return(_this=_ClickableComponent.call(this,player,options)||this).selectable=options.selectable,_this.isSelected_=options.selected||!1,_this.multiSelectable=options.multiSelectable,_this.selected(_this.isSelected_),_this.el_.setAttribute("role",_this.selectable?_this.multiSelectable?"menuitemcheckbox":"menuitemradio":"menuitem"),_this}inheritsLoose_default()(MenuItem,_ClickableComponent);var _proto=MenuItem.prototype;return _proto.createEl=function(type,props,attrs){this.nonIconControl=!0;var el=_ClickableComponent.prototype.createEl.call(this,"li",video_es_assign({className:"vjs-menu-item",tabIndex:-1},props),attrs);return el.replaceChild(createEl("span",{className:"vjs-menu-item-text",textContent:this.localize(this.options_.label)}),el.querySelector(".vjs-icon-placeholder")),el},_proto.handleKeyDown=function(event){MenuKeys.some(function(key){return keycode_default().isEventKey(event,key)})||_ClickableComponent.prototype.handleKeyDown.call(this,event)},_proto.handleClick=function(event){this.selected(!0)},_proto.selected=function(_selected){this.selectable&&(_selected?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))},MenuItem}(ClickableComponent);Component$1.registerComponent("MenuItem",MenuItem);var TextTrackMenuItem=function(_MenuItem){function TextTrackMenuItem(player,options){var _this,track=options.track,tracks=player.textTracks();options.label=track.label||track.language||"Unknown",options.selected="showing"===track.mode,(_this=_MenuItem.call(this,player,options)||this).track=track,_this.kinds=(options.kinds||[options.kind||_this.track.kind]).filter(Boolean);var event,changeHandler=function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];_this.handleTracksChange.apply(assertThisInitialized_default()(_this),args)},selectedLanguageChangeHandler=function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];_this.handleSelectedLanguageChange.apply(assertThisInitialized_default()(_this),args)};return player.on(["loadstart","texttrackchange"],changeHandler),tracks.addEventListener("change",changeHandler),tracks.addEventListener("selectedlanguagechange",selectedLanguageChangeHandler),_this.on("dispose",function(){player.off(["loadstart","texttrackchange"],changeHandler),tracks.removeEventListener("change",changeHandler),tracks.removeEventListener("selectedlanguagechange",selectedLanguageChangeHandler)}),void 0===tracks.onchange&&_this.on(["tap","click"],function(){if("object"!=typeof window_default().Event)try{event=new(window_default().Event)("change")}catch(err){}event||(event=document_default().createEvent("Event")).initEvent("change",!0,!0),tracks.dispatchEvent(event)}),_this.handleTracksChange(),_this}inheritsLoose_default()(TextTrackMenuItem,_MenuItem);var _proto=TextTrackMenuItem.prototype;return _proto.handleClick=function(event){var referenceTrack=this.track,tracks=this.player_.textTracks();if(_MenuItem.prototype.handleClick.call(this,event),tracks)for(var i=0;i<tracks.length;i++){var track=tracks[i];-1!==this.kinds.indexOf(track.kind)&&(track===referenceTrack?"showing"!==track.mode&&(track.mode="showing"):"disabled"!==track.mode&&(track.mode="disabled"))}},_proto.handleTracksChange=function(event){var shouldBeSelected="showing"===this.track.mode;shouldBeSelected!==this.isSelected_&&this.selected(shouldBeSelected)},_proto.handleSelectedLanguageChange=function(event){if("showing"===this.track.mode){var selectedLanguage=this.player_.cache_.selectedLanguage;if(selectedLanguage&&selectedLanguage.enabled&&selectedLanguage.language===this.track.language&&selectedLanguage.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}},_proto.dispose=function(){this.track=null,_MenuItem.prototype.dispose.call(this)},TextTrackMenuItem}(MenuItem);Component$1.registerComponent("TextTrackMenuItem",TextTrackMenuItem);var OffTextTrackMenuItem=function(_TextTrackMenuItem){function OffTextTrackMenuItem(player,options){return options.track={player:player,kind:options.kind,kinds:options.kinds,default:!1,mode:"disabled"},options.kinds||(options.kinds=[options.kind]),options.track.label=options.label?options.label:options.kinds.join(" and ")+" off",options.selectable=!0,options.multiSelectable=!1,_TextTrackMenuItem.call(this,player,options)||this}inheritsLoose_default()(OffTextTrackMenuItem,_TextTrackMenuItem);var _proto=OffTextTrackMenuItem.prototype;return _proto.handleTracksChange=function(event){for(var tracks=this.player().textTracks(),shouldBeSelected=!0,i=0,l=tracks.length;i<l;i++){var track=tracks[i];if(this.options_.kinds.indexOf(track.kind)>-1&&"showing"===track.mode){shouldBeSelected=!1;break}}shouldBeSelected!==this.isSelected_&&this.selected(shouldBeSelected)},_proto.handleSelectedLanguageChange=function(event){for(var tracks=this.player().textTracks(),allHidden=!0,i=0,l=tracks.length;i<l;i++){var track=tracks[i];if(["captions","descriptions","subtitles"].indexOf(track.kind)>-1&&"showing"===track.mode){allHidden=!1;break}}allHidden&&(this.player_.cache_.selectedLanguage={enabled:!1})},OffTextTrackMenuItem}(TextTrackMenuItem);Component$1.registerComponent("OffTextTrackMenuItem",OffTextTrackMenuItem);var TextTrackButton=function(_TrackButton){function TextTrackButton(player,options){return void 0===options&&(options={}),options.tracks=player.textTracks(),_TrackButton.call(this,player,options)||this}return inheritsLoose_default()(TextTrackButton,_TrackButton),TextTrackButton.prototype.createItems=function(items,TrackMenuItem){var label;void 0===items&&(items=[]),void 0===TrackMenuItem&&(TrackMenuItem=TextTrackMenuItem),this.label_&&(label=this.label_+" off"),items.push(new OffTextTrackMenuItem(this.player_,{kinds:this.kinds_,kind:this.kind_,label:label})),this.hideThreshold_+=1;var tracks=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(var i=0;i<tracks.length;i++){var track=tracks[i];if(this.kinds_.indexOf(track.kind)>-1){var item=new TrackMenuItem(this.player_,{track:track,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});item.addClass("vjs-"+track.kind+"-menu-item"),items.push(item)}}return items},TextTrackButton}(TrackButton);Component$1.registerComponent("TextTrackButton",TextTrackButton);var ChaptersTrackMenuItem=function(_MenuItem){function ChaptersTrackMenuItem(player,options){var _this,track=options.track,cue=options.cue,currentTime=player.currentTime();return options.selectable=!0,options.multiSelectable=!1,options.label=cue.text,options.selected=cue.startTime<=currentTime&&currentTime<cue.endTime,(_this=_MenuItem.call(this,player,options)||this).track=track,_this.cue=cue,track.addEventListener("cuechange",bind(assertThisInitialized_default()(_this),_this.update)),_this}inheritsLoose_default()(ChaptersTrackMenuItem,_MenuItem);var _proto=ChaptersTrackMenuItem.prototype;return _proto.handleClick=function(event){_MenuItem.prototype.handleClick.call(this),this.player_.currentTime(this.cue.startTime),this.update(this.cue.startTime)},_proto.update=function(event){var cue=this.cue,currentTime=this.player_.currentTime();this.selected(cue.startTime<=currentTime&&currentTime<cue.endTime)},ChaptersTrackMenuItem}(MenuItem);Component$1.registerComponent("ChaptersTrackMenuItem",ChaptersTrackMenuItem);var ChaptersButton=function(_TextTrackButton){function ChaptersButton(player,options,ready){return _TextTrackButton.call(this,player,options,ready)||this}inheritsLoose_default()(ChaptersButton,_TextTrackButton);var _proto=ChaptersButton.prototype;return _proto.buildCSSClass=function(){return"vjs-chapters-button "+_TextTrackButton.prototype.buildCSSClass.call(this)},_proto.buildWrapperCSSClass=function(){return"vjs-chapters-button "+_TextTrackButton.prototype.buildWrapperCSSClass.call(this)},_proto.update=function(event){this.track_&&(!event||"addtrack"!==event.type&&"removetrack"!==event.type)||this.setTrack(this.findChaptersTrack()),_TextTrackButton.prototype.update.call(this)},_proto.setTrack=function(track){if(this.track_!==track){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){var remoteTextTrackEl=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);remoteTextTrackEl&&remoteTextTrackEl.removeEventListener("load",this.updateHandler_),this.track_=null}if(this.track_=track,this.track_){this.track_.mode="hidden";var _remoteTextTrackEl=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);_remoteTextTrackEl&&_remoteTextTrackEl.addEventListener("load",this.updateHandler_)}}},_proto.findChaptersTrack=function(){for(var tracks=this.player_.textTracks()||[],i=tracks.length-1;i>=0;i--){var track=tracks[i];if(track.kind===this.kind_)return track}},_proto.getMenuCaption=function(){return this.track_&&this.track_.label?this.track_.label:this.localize(toTitleCase$1(this.kind_))},_proto.createMenu=function(){return this.options_.title=this.getMenuCaption(),_TextTrackButton.prototype.createMenu.call(this)},_proto.createItems=function(){var items=[];if(!this.track_)return items;var cues=this.track_.cues;if(!cues)return items;for(var i=0,l=cues.length;i<l;i++){var mi=new ChaptersTrackMenuItem(this.player_,{track:this.track_,cue:cues[i]});items.push(mi)}return items},ChaptersButton}(TextTrackButton);ChaptersButton.prototype.kind_="chapters",ChaptersButton.prototype.controlText_="Chapters",Component$1.registerComponent("ChaptersButton",ChaptersButton);var DescriptionsButton=function(_TextTrackButton){function DescriptionsButton(player,options,ready){var _this;_this=_TextTrackButton.call(this,player,options,ready)||this;var tracks=player.textTracks(),changeHandler=bind(assertThisInitialized_default()(_this),_this.handleTracksChange);return tracks.addEventListener("change",changeHandler),_this.on("dispose",function(){tracks.removeEventListener("change",changeHandler)}),_this}inheritsLoose_default()(DescriptionsButton,_TextTrackButton);var _proto=DescriptionsButton.prototype;return _proto.handleTracksChange=function(event){for(var tracks=this.player().textTracks(),disabled=!1,i=0,l=tracks.length;i<l;i++){var track=tracks[i];if(track.kind!==this.kind_&&"showing"===track.mode){disabled=!0;break}}disabled?this.disable():this.enable()},_proto.buildCSSClass=function(){return"vjs-descriptions-button "+_TextTrackButton.prototype.buildCSSClass.call(this)},_proto.buildWrapperCSSClass=function(){return"vjs-descriptions-button "+_TextTrackButton.prototype.buildWrapperCSSClass.call(this)},DescriptionsButton}(TextTrackButton);DescriptionsButton.prototype.kind_="descriptions",DescriptionsButton.prototype.controlText_="Descriptions",Component$1.registerComponent("DescriptionsButton",DescriptionsButton);var SubtitlesButton=function(_TextTrackButton){function SubtitlesButton(player,options,ready){return _TextTrackButton.call(this,player,options,ready)||this}inheritsLoose_default()(SubtitlesButton,_TextTrackButton);var _proto=SubtitlesButton.prototype;return _proto.buildCSSClass=function(){return"vjs-subtitles-button "+_TextTrackButton.prototype.buildCSSClass.call(this)},_proto.buildWrapperCSSClass=function(){return"vjs-subtitles-button "+_TextTrackButton.prototype.buildWrapperCSSClass.call(this)},SubtitlesButton}(TextTrackButton);SubtitlesButton.prototype.kind_="subtitles",SubtitlesButton.prototype.controlText_="Subtitles",Component$1.registerComponent("SubtitlesButton",SubtitlesButton);var CaptionSettingsMenuItem=function(_TextTrackMenuItem){function CaptionSettingsMenuItem(player,options){var _this;return options.track={player:player,kind:options.kind,label:options.kind+" settings",selectable:!1,default:!1,mode:"disabled"},options.selectable=!1,options.name="CaptionSettingsMenuItem",(_this=_TextTrackMenuItem.call(this,player,options)||this).addClass("vjs-texttrack-settings"),_this.controlText(", opens "+options.kind+" settings dialog"),_this}return inheritsLoose_default()(CaptionSettingsMenuItem,_TextTrackMenuItem),CaptionSettingsMenuItem.prototype.handleClick=function(event){this.player().getChild("textTrackSettings").open()},CaptionSettingsMenuItem}(TextTrackMenuItem);Component$1.registerComponent("CaptionSettingsMenuItem",CaptionSettingsMenuItem);var CaptionsButton=function(_TextTrackButton){function CaptionsButton(player,options,ready){return _TextTrackButton.call(this,player,options,ready)||this}inheritsLoose_default()(CaptionsButton,_TextTrackButton);var _proto=CaptionsButton.prototype;return _proto.buildCSSClass=function(){return"vjs-captions-button "+_TextTrackButton.prototype.buildCSSClass.call(this)},_proto.buildWrapperCSSClass=function(){return"vjs-captions-button "+_TextTrackButton.prototype.buildWrapperCSSClass.call(this)},_proto.createItems=function(){var items=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(items.push(new CaptionSettingsMenuItem(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),_TextTrackButton.prototype.createItems.call(this,items)},CaptionsButton}(TextTrackButton);CaptionsButton.prototype.kind_="captions",CaptionsButton.prototype.controlText_="Captions",Component$1.registerComponent("CaptionsButton",CaptionsButton);var SubsCapsMenuItem=function(_TextTrackMenuItem){function SubsCapsMenuItem(){return _TextTrackMenuItem.apply(this,arguments)||this}return inheritsLoose_default()(SubsCapsMenuItem,_TextTrackMenuItem),SubsCapsMenuItem.prototype.createEl=function(type,props,attrs){var el=_TextTrackMenuItem.prototype.createEl.call(this,type,props,attrs),parentSpan=el.querySelector(".vjs-menu-item-text");return"captions"===this.options_.track.kind&&(parentSpan.appendChild(createEl("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),parentSpan.appendChild(createEl("span",{className:"vjs-control-text",textContent:" "+this.localize("Captions")}))),el},SubsCapsMenuItem}(TextTrackMenuItem);Component$1.registerComponent("SubsCapsMenuItem",SubsCapsMenuItem);var SubsCapsButton=function(_TextTrackButton){function SubsCapsButton(player,options){var _this;return void 0===options&&(options={}),(_this=_TextTrackButton.call(this,player,options)||this).label_="subtitles",["en","en-us","en-ca","fr-ca"].indexOf(_this.player_.language_)>-1&&(_this.label_="captions"),_this.menuButton_.controlText(toTitleCase$1(_this.label_)),_this}inheritsLoose_default()(SubsCapsButton,_TextTrackButton);var _proto=SubsCapsButton.prototype;return _proto.buildCSSClass=function(){return"vjs-subs-caps-button "+_TextTrackButton.prototype.buildCSSClass.call(this)},_proto.buildWrapperCSSClass=function(){return"vjs-subs-caps-button "+_TextTrackButton.prototype.buildWrapperCSSClass.call(this)},_proto.createItems=function(){var items=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(items.push(new CaptionSettingsMenuItem(this.player_,{kind:this.label_})),this.hideThreshold_+=1),_TextTrackButton.prototype.createItems.call(this,items,SubsCapsMenuItem)},SubsCapsButton}(TextTrackButton);SubsCapsButton.prototype.kinds_=["captions","subtitles"],SubsCapsButton.prototype.controlText_="Subtitles",Component$1.registerComponent("SubsCapsButton",SubsCapsButton);var AudioTrackMenuItem=function(_MenuItem){function AudioTrackMenuItem(player,options){var _this,track=options.track,tracks=player.audioTracks();options.label=track.label||track.language||"Unknown",options.selected=track.enabled,(_this=_MenuItem.call(this,player,options)||this).track=track,_this.addClass("vjs-"+track.kind+"-menu-item");var changeHandler=function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];_this.handleTracksChange.apply(assertThisInitialized_default()(_this),args)};return tracks.addEventListener("change",changeHandler),_this.on("dispose",function(){tracks.removeEventListener("change",changeHandler)}),_this}inheritsLoose_default()(AudioTrackMenuItem,_MenuItem);var _proto=AudioTrackMenuItem.prototype;return _proto.createEl=function(type,props,attrs){var el=_MenuItem.prototype.createEl.call(this,type,props,attrs),parentSpan=el.querySelector(".vjs-menu-item-text");return"main-desc"===this.options_.track.kind&&(parentSpan.appendChild(_MenuItem.prototype.createEl.call(this,"span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),parentSpan.appendChild(_MenuItem.prototype.createEl.call(this,"span",{className:"vjs-control-text",textContent:this.localize("Descriptions")}))),el},_proto.handleClick=function(event){_MenuItem.prototype.handleClick.call(this,event),this.track.enabled=!0},_proto.handleTracksChange=function(event){this.selected(this.track.enabled)},AudioTrackMenuItem}(MenuItem);Component$1.registerComponent("AudioTrackMenuItem",AudioTrackMenuItem);var AudioTrackButton=function(_TrackButton){function AudioTrackButton(player,options){return void 0===options&&(options={}),options.tracks=player.audioTracks(),_TrackButton.call(this,player,options)||this}inheritsLoose_default()(AudioTrackButton,_TrackButton);var _proto=AudioTrackButton.prototype;return _proto.buildCSSClass=function(){return"vjs-audio-button "+_TrackButton.prototype.buildCSSClass.call(this)},_proto.buildWrapperCSSClass=function(){return"vjs-audio-button "+_TrackButton.prototype.buildWrapperCSSClass.call(this)},_proto.createItems=function(items){void 0===items&&(items=[]),this.hideThreshold_=1;for(var tracks=this.player_.audioTracks(),i=0;i<tracks.length;i++)items.push(new AudioTrackMenuItem(this.player_,{track:tracks[i],selectable:!0,multiSelectable:!1}));return items},AudioTrackButton}(TrackButton);AudioTrackButton.prototype.controlText_="Audio Track",Component$1.registerComponent("AudioTrackButton",AudioTrackButton);var PlaybackRateMenuItem=function(_MenuItem){function PlaybackRateMenuItem(player,options){var _this,label=options.rate,rate=parseFloat(label,10);return options.label=label,options.selected=rate===player.playbackRate(),options.selectable=!0,options.multiSelectable=!1,(_this=_MenuItem.call(this,player,options)||this).label=label,_this.rate=rate,_this.on(player,"ratechange",function(e){return _this.update(e)}),_this}inheritsLoose_default()(PlaybackRateMenuItem,_MenuItem);var _proto=PlaybackRateMenuItem.prototype;return _proto.handleClick=function(event){_MenuItem.prototype.handleClick.call(this),this.player().playbackRate(this.rate)},_proto.update=function(event){this.selected(this.player().playbackRate()===this.rate)},PlaybackRateMenuItem}(MenuItem);PlaybackRateMenuItem.prototype.contentElType="button",Component$1.registerComponent("PlaybackRateMenuItem",PlaybackRateMenuItem);var PlaybackRateMenuButton=function(_MenuButton){function PlaybackRateMenuButton(player,options){var _this;return(_this=_MenuButton.call(this,player,options)||this).menuButton_.el_.setAttribute("aria-describedby",_this.labelElId_),_this.updateVisibility(),_this.updateLabel(),_this.on(player,"loadstart",function(e){return _this.updateVisibility(e)}),_this.on(player,"ratechange",function(e){return _this.updateLabel(e)}),_this.on(player,"playbackrateschange",function(e){return _this.handlePlaybackRateschange(e)}),_this}inheritsLoose_default()(PlaybackRateMenuButton,_MenuButton);var _proto=PlaybackRateMenuButton.prototype;return _proto.createEl=function(){var el=_MenuButton.prototype.createEl.call(this);return this.labelElId_="vjs-playback-rate-value-label-"+this.id_,this.labelEl_=createEl("div",{className:"vjs-playback-rate-value",id:this.labelElId_,textContent:"1x"}),el.appendChild(this.labelEl_),el},_proto.dispose=function(){this.labelEl_=null,_MenuButton.prototype.dispose.call(this)},_proto.buildCSSClass=function(){return"vjs-playback-rate "+_MenuButton.prototype.buildCSSClass.call(this)},_proto.buildWrapperCSSClass=function(){return"vjs-playback-rate "+_MenuButton.prototype.buildWrapperCSSClass.call(this)},_proto.createItems=function(){for(var rates=this.playbackRates(),items=[],i=rates.length-1;i>=0;i--)items.push(new PlaybackRateMenuItem(this.player(),{rate:rates[i]+"x"}));return items},_proto.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},_proto.handleClick=function(event){for(var currentRate=this.player().playbackRate(),rates=this.playbackRates(),newRate=rates[0],i=0;i<rates.length;i++)if(rates[i]>currentRate){newRate=rates[i];break}this.player().playbackRate(newRate)},_proto.handlePlaybackRateschange=function(event){this.update()},_proto.playbackRates=function(){var player=this.player();return player.playbackRates&&player.playbackRates()||[]},_proto.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0},_proto.updateVisibility=function(event){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},_proto.updateLabel=function(event){this.playbackRateSupported()&&(this.labelEl_.textContent=this.player().playbackRate()+"x")},PlaybackRateMenuButton}(MenuButton);PlaybackRateMenuButton.prototype.controlText_="Playback Rate",Component$1.registerComponent("PlaybackRateMenuButton",PlaybackRateMenuButton);var Spacer=function(_Component){function Spacer(){return _Component.apply(this,arguments)||this}inheritsLoose_default()(Spacer,_Component);var _proto=Spacer.prototype;return _proto.buildCSSClass=function(){return"vjs-spacer "+_Component.prototype.buildCSSClass.call(this)},_proto.createEl=function(tag,props,attributes){return void 0===tag&&(tag="div"),void 0===props&&(props={}),void 0===attributes&&(attributes={}),props.className||(props.className=this.buildCSSClass()),_Component.prototype.createEl.call(this,tag,props,attributes)},Spacer}(Component$1);Component$1.registerComponent("Spacer",Spacer),Component$1.registerComponent("CustomControlSpacer",function(_Spacer){function CustomControlSpacer(){return _Spacer.apply(this,arguments)||this}inheritsLoose_default()(CustomControlSpacer,_Spacer);var _proto=CustomControlSpacer.prototype;return _proto.buildCSSClass=function(){return"vjs-custom-control-spacer "+_Spacer.prototype.buildCSSClass.call(this)},_proto.createEl=function(){return _Spacer.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),textContent:"\xa0"})},CustomControlSpacer}(Spacer));var ControlBar=function(_Component){function ControlBar(){return _Component.apply(this,arguments)||this}return inheritsLoose_default()(ControlBar,_Component),ControlBar.prototype.createEl=function(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"})},ControlBar}(Component$1);ControlBar.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]},"exitPictureInPicture"in document_default()&&ControlBar.prototype.options_.children.splice(ControlBar.prototype.options_.children.length-1,0,"pictureInPictureToggle"),Component$1.registerComponent("ControlBar",ControlBar);var ErrorDisplay=function(_ModalDialog){function ErrorDisplay(player,options){var _this;return(_this=_ModalDialog.call(this,player,options)||this).on(player,"error",function(e){return _this.open(e)}),_this}inheritsLoose_default()(ErrorDisplay,_ModalDialog);var _proto=ErrorDisplay.prototype;return _proto.buildCSSClass=function(){return"vjs-error-display "+_ModalDialog.prototype.buildCSSClass.call(this)},_proto.content=function(){var error=this.player().error();return error?this.localize(error.message):""},ErrorDisplay}(ModalDialog);ErrorDisplay.prototype.options_=extends_default()({},ModalDialog.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),Component$1.registerComponent("ErrorDisplay",ErrorDisplay);var COLOR_BLACK=["#000","Black"],COLOR_BLUE=["#00F","Blue"],COLOR_CYAN=["#0FF","Cyan"],COLOR_GREEN=["#0F0","Green"],COLOR_MAGENTA=["#F0F","Magenta"],COLOR_RED=["#F00","Red"],COLOR_WHITE=["#FFF","White"],COLOR_YELLOW=["#FF0","Yellow"],OPACITY_OPAQUE=["1","Opaque"],OPACITY_SEMI=["0.5","Semi-Transparent"],OPACITY_TRANS=["0","Transparent"],selectConfigs={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[COLOR_BLACK,COLOR_WHITE,COLOR_RED,COLOR_GREEN,COLOR_BLUE,COLOR_YELLOW,COLOR_MAGENTA,COLOR_CYAN]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[OPACITY_OPAQUE,OPACITY_SEMI,OPACITY_TRANS]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[COLOR_WHITE,COLOR_BLACK,COLOR_RED,COLOR_GREEN,COLOR_BLUE,COLOR_YELLOW,COLOR_MAGENTA,COLOR_CYAN]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function(v){return"1.00"===v?null:Number(v)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[OPACITY_OPAQUE,OPACITY_SEMI]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[OPACITY_TRANS,OPACITY_SEMI,OPACITY_OPAQUE]}};function parseOptionValue(value,parser){if(parser&&(value=parser(value)),value&&"none"!==value)return value}selectConfigs.windowColor.options=selectConfigs.backgroundColor.options;var TextTrackSettings=function(_ModalDialog){function TextTrackSettings(player,options){var _this;return options.temporary=!1,(_this=_ModalDialog.call(this,player,options)||this).updateDisplay=_this.updateDisplay.bind(assertThisInitialized_default()(_this)),_this.fill(),_this.hasBeenOpened_=_this.hasBeenFilled_=!0,_this.endDialog=createEl("p",{className:"vjs-control-text",textContent:_this.localize("End of dialog window.")}),_this.el().appendChild(_this.endDialog),_this.setDefaults(),void 0===options.persistTextTrackSettings&&(_this.options_.persistTextTrackSettings=_this.options_.playerOptions.persistTextTrackSettings),_this.on(_this.$(".vjs-done-button"),"click",function(){_this.saveSettings(),_this.close()}),_this.on(_this.$(".vjs-default-button"),"click",function(){_this.setDefaults(),_this.updateDisplay()}),each(selectConfigs,function(config){_this.on(_this.$(config.selector),"change",_this.updateDisplay)}),_this.options_.persistTextTrackSettings&&_this.restoreSettings(),_this}inheritsLoose_default()(TextTrackSettings,_ModalDialog);var _proto=TextTrackSettings.prototype;return _proto.dispose=function(){this.endDialog=null,_ModalDialog.prototype.dispose.call(this)},_proto.createElSelect_=function(key,legendId,type){var _this2=this;void 0===legendId&&(legendId=""),void 0===type&&(type="label");var config=selectConfigs[key],id=config.id.replace("%s",this.id_),selectLabelledbyIds=[legendId,id].join(" ").trim();return["<"+type+' id="'+id+'" class="'+("label"===type?"vjs-label":"")+'">',this.localize(config.label),"</"+type+">",'<select aria-labelledby="'+selectLabelledbyIds+'">'].concat(config.options.map(function(o){var optionId=id+"-"+o[1].replace(/\W+/g,"");return['<option id="'+optionId+'" value="'+o[0]+'" ','aria-labelledby="'+selectLabelledbyIds+" "+optionId+'">',_this2.localize(o[1]),"</option>"].join("")})).concat("</select>").join("")},_proto.createElFgColor_=function(){var legendId="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+legendId+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",legendId),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",legendId),"</span>","</fieldset>"].join("")},_proto.createElBgColor_=function(){var legendId="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+legendId+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",legendId),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",legendId),"</span>","</fieldset>"].join("")},_proto.createElWinColor_=function(){var legendId="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+legendId+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",legendId),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",legendId),"</span>","</fieldset>"].join("")},_proto.createElColors_=function(){return createEl("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},_proto.createElFont_=function(){return createEl("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})},_proto.createElControls_=function(){var defaultsDescription=this.localize("restore all settings to the default values");return createEl("div",{className:"vjs-track-settings-controls",innerHTML:['<button type="button" class="vjs-default-button" title="'+defaultsDescription+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+defaultsDescription+"</span>","</button>",'<button type="button" class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})},_proto.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},_proto.label=function(){return this.localize("Caption Settings Dialog")},_proto.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},_proto.buildCSSClass=function(){return _ModalDialog.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},_proto.getValues=function(){var object,fn,initial,_this3=this;return fn=function(accum,config,key){var el,value=parseOptionValue((el=_this3.$(config.selector)).options[el.options.selectedIndex].value,config.parser);return void 0!==value&&(accum[key]=value),accum},void 0===(initial={})&&(initial=0),keys(object=selectConfigs).reduce(function(accum,key){return fn(accum,object[key],key)},initial)},_proto.setValues=function(values){var _this4=this;each(selectConfigs,function(config,key){!function(el,value,parser){if(value)for(var i=0;i<el.options.length;i++)if(parseOptionValue(el.options[i].value,parser)===value){el.selectedIndex=i;break}}(_this4.$(config.selector),values[key],config.parser)})},_proto.setDefaults=function(){var _this5=this;each(selectConfigs,function(config){var index=config.hasOwnProperty("default")?config.default:0;_this5.$(config.selector).selectedIndex=index})},_proto.restoreSettings=function(){var values;try{values=JSON.parse(window_default().localStorage.getItem("vjs-text-track-settings"))}catch(err){log$1.warn(err)}values&&this.setValues(values)},_proto.saveSettings=function(){if(this.options_.persistTextTrackSettings){var values=this.getValues();try{Object.keys(values).length?window_default().localStorage.setItem("vjs-text-track-settings",JSON.stringify(values)):window_default().localStorage.removeItem("vjs-text-track-settings")}catch(err){log$1.warn(err)}}},_proto.updateDisplay=function(){var ttDisplay=this.player_.getChild("textTrackDisplay");ttDisplay&&ttDisplay.updateDisplay()},_proto.conditionalBlur_=function(){this.previouslyActiveEl_=null;var cb=this.player_.controlBar,subsCapsBtn=cb&&cb.subsCapsButton,ccBtn=cb&&cb.captionsButton;subsCapsBtn?subsCapsBtn.focus():ccBtn&&ccBtn.focus()},TextTrackSettings}(ModalDialog);Component$1.registerComponent("TextTrackSettings",TextTrackSettings),Component$1.registerComponent("ResizeManager",function(_Component){function ResizeManager(player,options){var _this,RESIZE_OBSERVER_AVAILABLE=options.ResizeObserver||window_default().ResizeObserver;null===options.ResizeObserver&&(RESIZE_OBSERVER_AVAILABLE=!1);var options_=mergeOptions$3({createEl:!RESIZE_OBSERVER_AVAILABLE,reportTouchActivity:!1},options);return(_this=_Component.call(this,player,options_)||this).ResizeObserver=options.ResizeObserver||window_default().ResizeObserver,_this.loadListener_=null,_this.resizeObserver_=null,_this.debouncedHandler_=function(func,wait,immediate,context){var timeout;void 0===context&&(context=window_default());var debounced=function(){var self=this,args=arguments,_later=function(){timeout=null,_later=null,func.apply(self,args)};context.clearTimeout(timeout),timeout=context.setTimeout(_later,100)};return debounced.cancel=function(){context.clearTimeout(timeout),timeout=null},debounced}(function(){_this.resizeHandler()},0,0,assertThisInitialized_default()(_this)),RESIZE_OBSERVER_AVAILABLE?(_this.resizeObserver_=new _this.ResizeObserver(_this.debouncedHandler_),_this.resizeObserver_.observe(player.el())):(_this.loadListener_=function(){if(_this.el_&&_this.el_.contentWindow){var debouncedHandler_=_this.debouncedHandler_,unloadListener_=_this.unloadListener_=function(){off(this,"resize",debouncedHandler_),off(this,"unload",unloadListener_),unloadListener_=null};on(_this.el_.contentWindow,"unload",unloadListener_),on(_this.el_.contentWindow,"resize",debouncedHandler_)}},_this.one("load",_this.loadListener_)),_this}inheritsLoose_default()(ResizeManager,_Component);var _proto=ResizeManager.prototype;return _proto.createEl=function(){return _Component.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager",tabIndex:-1},{"aria-hidden":"true"})},_proto.resizeHandler=function(){this.player_&&this.player_.trigger&&this.player_.trigger("playerresize")},_proto.dispose=function(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,_Component.prototype.dispose.call(this)},ResizeManager}(Component$1));var defaults={trackingThreshold:20,liveTolerance:15},LiveTracker=function(_Component){function LiveTracker(player,options){var _this,options_=mergeOptions$3(defaults,options,{createEl:!1});return(_this=_Component.call(this,player,options_)||this).handleVisibilityChange_=function(e){return _this.handleVisibilityChange(e)},_this.trackLiveHandler_=function(){return _this.trackLive_()},_this.handlePlay_=function(e){return _this.handlePlay(e)},_this.handleFirstTimeupdate_=function(e){return _this.handleFirstTimeupdate(e)},_this.handleSeeked_=function(e){return _this.handleSeeked(e)},_this.seekToLiveEdge_=function(e){return _this.seekToLiveEdge(e)},_this.reset_(),_this.on(_this.player_,"durationchange",function(e){return _this.handleDurationchange(e)}),_this.one(_this.player_,"canplay",function(){return _this.toggleTracking()}),IE_VERSION&&"hidden"in document_default()&&"visibilityState"in document_default()&&_this.on(document_default(),"visibilitychange",_this.handleVisibilityChange_),_this}inheritsLoose_default()(LiveTracker,_Component);var _proto=LiveTracker.prototype;return _proto.handleVisibilityChange=function(){this.player_.duration()===1/0&&(document_default().hidden?this.stopTracking():this.startTracking())},_proto.trackLive_=function(){var seekable=this.player_.seekable();if(seekable&&seekable.length){var newTime=Number(window_default().performance.now().toFixed(4)),deltaTime=-1===this.lastTime_?0:(newTime-this.lastTime_)/1e3;this.lastTime_=newTime,this.pastSeekEnd_=this.pastSeekEnd()+deltaTime;var liveCurrentTime=this.liveCurrentTime(),currentTime=this.player_.currentTime(),isBehind=this.player_.paused()||this.seekedBehindLive_||Math.abs(liveCurrentTime-currentTime)>this.options_.liveTolerance;this.timeupdateSeen_&&liveCurrentTime!==1/0||(isBehind=!1),isBehind!==this.behindLiveEdge_&&(this.behindLiveEdge_=isBehind,this.trigger("liveedgechange"))}},_proto.handleDurationchange=function(){this.toggleTracking()},_proto.toggleTracking=function(){this.player_.duration()===1/0&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())},_proto.startTracking=function(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLiveHandler_,30),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLiveHandler_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked_):(this.one(this.player_,"play",this.handlePlay_),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate_)))},_proto.handleFirstTimeupdate=function(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked_)},_proto.handleSeeked=function(){var timeDiff=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=this.nextSeekedFromUser_&&timeDiff>2,this.nextSeekedFromUser_=!1,this.trackLive_()},_proto.handlePlay=function(){this.one(this.player_,"timeupdate",this.seekToLiveEdge_)},_proto.reset_=function(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.nextSeekedFromUser_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLiveHandler_),this.off(this.player_,"seeked",this.handleSeeked_),this.off(this.player_,"play",this.handlePlay_),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate_),this.off(this.player_,"timeupdate",this.seekToLiveEdge_)},_proto.nextSeekedFromUser=function(){this.nextSeekedFromUser_=!0},_proto.stopTracking=function(){this.isTracking()&&(this.reset_(),this.trigger("liveedgechange"))},_proto.seekableEnd=function(){for(var seekable=this.player_.seekable(),seekableEnds=[],i=seekable?seekable.length:0;i--;)seekableEnds.push(seekable.end(i));return seekableEnds.length?seekableEnds.sort()[seekableEnds.length-1]:1/0},_proto.seekableStart=function(){for(var seekable=this.player_.seekable(),seekableStarts=[],i=seekable?seekable.length:0;i--;)seekableStarts.push(seekable.start(i));return seekableStarts.length?seekableStarts.sort()[0]:0},_proto.liveWindow=function(){var liveCurrentTime=this.liveCurrentTime();return liveCurrentTime===1/0?0:liveCurrentTime-this.seekableStart()},_proto.isLive=function(){return this.isTracking()},_proto.atLiveEdge=function(){return!this.behindLiveEdge()},_proto.liveCurrentTime=function(){return this.pastSeekEnd()+this.seekableEnd()},_proto.pastSeekEnd=function(){var seekableEnd=this.seekableEnd();return-1!==this.lastSeekEnd_&&seekableEnd!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=seekableEnd,this.pastSeekEnd_},_proto.behindLiveEdge=function(){return this.behindLiveEdge_},_proto.isTracking=function(){return"number"==typeof this.trackingInterval_},_proto.seekToLiveEdge=function(){this.seekedBehindLive_=!1,this.atLiveEdge()||(this.nextSeekedFromUser_=!1,this.player_.currentTime(this.liveCurrentTime()))},_proto.dispose=function(){this.off(document_default(),"visibilitychange",this.handleVisibilityChange_),this.stopTracking(),_Component.prototype.dispose.call(this)},LiveTracker}(Component$1);Component$1.registerComponent("LiveTracker",LiveTracker);var canPlayType,sourcesetLoad=function(tech){var el=tech.el();if(el.hasAttribute("src"))return tech.triggerSourceset(el.src),!0;var sources=tech.$$("source"),srcUrls=[],src="";if(!sources.length)return!1;for(var i=0;i<sources.length;i++){var url=sources[i].src;url&&-1===srcUrls.indexOf(url)&&srcUrls.push(url)}return!!srcUrls.length&&(1===srcUrls.length&&(src=srcUrls[0]),tech.triggerSourceset(src),!0)},innerHTMLDescriptorPolyfill=Object.defineProperty({},"innerHTML",{get:function(){return this.cloneNode(!0).innerHTML},set:function(v){var dummy=document_default().createElement(this.nodeName.toLowerCase());dummy.innerHTML=v;for(var docFrag=document_default().createDocumentFragment();dummy.childNodes.length;)docFrag.appendChild(dummy.childNodes[0]);return this.innerText="",window_default().Element.prototype.appendChild.call(this,docFrag),this.innerHTML}}),getDescriptor=function(priority,prop){for(var descriptor={},i=0;i<priority.length&&!((descriptor=Object.getOwnPropertyDescriptor(priority[i],prop))&&descriptor.set&&descriptor.get);i++);return descriptor.enumerable=!0,descriptor.configurable=!0,descriptor},firstSourceWatch=function(tech){var el=tech.el();if(!el.resetSourceWatch_){var old={},innerDescriptor=function(tech){return getDescriptor([tech.el(),window_default().HTMLMediaElement.prototype,window_default().Element.prototype,innerHTMLDescriptorPolyfill],"innerHTML")}(tech),appendWrapper=function(appendFn){return function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var retval=appendFn.apply(el,args);return sourcesetLoad(tech),retval}};["append","appendChild","insertAdjacentHTML"].forEach(function(k){el[k]&&(old[k]=el[k],el[k]=appendWrapper(old[k]))}),Object.defineProperty(el,"innerHTML",mergeOptions$3(innerDescriptor,{set:appendWrapper(innerDescriptor.set)})),el.resetSourceWatch_=function(){el.resetSourceWatch_=null,Object.keys(old).forEach(function(k){el[k]=old[k]}),Object.defineProperty(el,"innerHTML",innerDescriptor)},tech.one("sourceset",el.resetSourceWatch_)}},srcDescriptorPolyfill=Object.defineProperty({},"src",{get:function(){return this.hasAttribute("src")?getAbsoluteURL(window_default().Element.prototype.getAttribute.call(this,"src")):""},set:function(v){return window_default().Element.prototype.setAttribute.call(this,"src",v),v}}),defineLazyProperty=function(obj,key,getValue,setter){void 0===setter&&(setter=!0);var set=function(value){return Object.defineProperty(obj,key,{value:value,enumerable:!0,writable:!0})},options={configurable:!0,enumerable:!0,get:function(){var value=getValue();return set(value),value}};return setter&&(options.set=set),Object.defineProperty(obj,key,options)},Html5=function(_Tech){function Html5(options,ready){var _this;_this=_Tech.call(this,options,ready)||this;var source=options.source,crossoriginTracks=!1;if(source&&(_this.el_.currentSrc!==source.src||options.tag&&3===options.tag.initNetworkState_)?_this.setSource(source):_this.handleLateInit_(_this.el_),options.enableSourceset&&_this.setupSourcesetHandling_(),_this.isScrubbing_=!1,_this.el_.hasChildNodes()){for(var nodes=_this.el_.childNodes,nodesLength=nodes.length,removeNodes=[];nodesLength--;){var node=nodes[nodesLength];"track"===node.nodeName.toLowerCase()&&(_this.featuresNativeTextTracks?(_this.remoteTextTrackEls().addTrackElement_(node),_this.remoteTextTracks().addTrack(node.track),_this.textTracks().addTrack(node.track),crossoriginTracks||_this.el_.hasAttribute("crossorigin")||!isCrossOrigin(node.src)||(crossoriginTracks=!0)):removeNodes.push(node))}for(var i=0;i<removeNodes.length;i++)_this.el_.removeChild(removeNodes[i])}return _this.proxyNativeTracks_(),_this.featuresNativeTextTracks&&crossoriginTracks&&log$1.warn("Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\nThis may prevent text tracks from loading."),_this.restoreMetadataTracksInIOSNativePlayer_(),(TOUCH_ENABLED||IS_IPHONE||IS_NATIVE_ANDROID)&&!0===options.nativeControlsForTouch&&_this.setControls(!0),_this.proxyWebkitFullscreen_(),_this.triggerReady(),_this}inheritsLoose_default()(Html5,_Tech);var _proto=Html5.prototype;return _proto.dispose=function(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),Html5.disposeMediaElement(this.el_),this.options_=null,_Tech.prototype.dispose.call(this)},_proto.setupSourcesetHandling_=function(){!function(tech){if(tech.featuresSourceset){var el=tech.el();if(!el.resetSourceset_){var srcDescriptor=function(tech){return getDescriptor([tech.el(),window_default().HTMLMediaElement.prototype,srcDescriptorPolyfill],"src")}(tech),oldSetAttribute=el.setAttribute,oldLoad=el.load;Object.defineProperty(el,"src",mergeOptions$3(srcDescriptor,{set:function(v){var retval=srcDescriptor.set.call(el,v);return tech.triggerSourceset(el.src),retval}})),el.setAttribute=function(n,v){var retval=oldSetAttribute.call(el,n,v);return/src/i.test(n)&&tech.triggerSourceset(el.src),retval},el.load=function(){var retval=oldLoad.call(el);return sourcesetLoad(tech)||(tech.triggerSourceset(""),firstSourceWatch(tech)),retval},el.currentSrc?tech.triggerSourceset(el.currentSrc):sourcesetLoad(tech)||firstSourceWatch(tech),el.resetSourceset_=function(){el.resetSourceset_=null,el.load=oldLoad,el.setAttribute=oldSetAttribute,Object.defineProperty(el,"src",srcDescriptor),el.resetSourceWatch_&&el.resetSourceWatch_()}}}}(this)},_proto.restoreMetadataTracksInIOSNativePlayer_=function(){var metadataTracksPreFullscreenState,textTracks=this.textTracks(),takeMetadataTrackSnapshot=function(){metadataTracksPreFullscreenState=[];for(var i=0;i<textTracks.length;i++){var track=textTracks[i];"metadata"===track.kind&&metadataTracksPreFullscreenState.push({track:track,storedMode:track.mode})}};takeMetadataTrackSnapshot(),textTracks.addEventListener("change",takeMetadataTrackSnapshot),this.on("dispose",function(){return textTracks.removeEventListener("change",takeMetadataTrackSnapshot)});var restoreTrackMode=function restoreTrackMode(){for(var i=0;i<metadataTracksPreFullscreenState.length;i++){var storedTrack=metadataTracksPreFullscreenState[i];"disabled"===storedTrack.track.mode&&storedTrack.track.mode!==storedTrack.storedMode&&(storedTrack.track.mode=storedTrack.storedMode)}textTracks.removeEventListener("change",restoreTrackMode)};this.on("webkitbeginfullscreen",function(){textTracks.removeEventListener("change",takeMetadataTrackSnapshot),textTracks.removeEventListener("change",restoreTrackMode),textTracks.addEventListener("change",restoreTrackMode)}),this.on("webkitendfullscreen",function(){textTracks.removeEventListener("change",takeMetadataTrackSnapshot),textTracks.addEventListener("change",takeMetadataTrackSnapshot),textTracks.removeEventListener("change",restoreTrackMode)})},_proto.overrideNative_=function(type,override){var _this2=this;if(override===this["featuresNative"+type+"Tracks"]){var lowerCaseType=type.toLowerCase();this[lowerCaseType+"TracksListeners_"]&&Object.keys(this[lowerCaseType+"TracksListeners_"]).forEach(function(eventName){_this2.el()[lowerCaseType+"Tracks"].removeEventListener(eventName,_this2[lowerCaseType+"TracksListeners_"][eventName])}),this["featuresNative"+type+"Tracks"]=!override,this[lowerCaseType+"TracksListeners_"]=null,this.proxyNativeTracksForType_(lowerCaseType)}},_proto.overrideNativeAudioTracks=function(override){this.overrideNative_("Audio",override)},_proto.overrideNativeVideoTracks=function(override){this.overrideNative_("Video",override)},_proto.proxyNativeTracksForType_=function(name){var _this3=this,props=NORMAL[name],elTracks=this.el()[props.getterName],techTracks=this[props.getterName]();if(this["featuresNative"+props.capitalName+"Tracks"]&&elTracks&&elTracks.addEventListener){var listeners={change:function(e){var event={type:"change",target:techTracks,currentTarget:techTracks,srcElement:techTracks};techTracks.trigger(event),"text"===name&&_this3[REMOTE.remoteText.getterName]().trigger(event)},addtrack:function(e){techTracks.addTrack(e.track)},removetrack:function(e){techTracks.removeTrack(e.track)}},removeOldTracks=function(){for(var removeTracks=[],i=0;i<techTracks.length;i++){for(var found=!1,j=0;j<elTracks.length;j++)if(elTracks[j]===techTracks[i]){found=!0;break}found||removeTracks.push(techTracks[i])}for(;removeTracks.length;)techTracks.removeTrack(removeTracks.shift())};this[props.getterName+"Listeners_"]=listeners,Object.keys(listeners).forEach(function(eventName){var listener=listeners[eventName];elTracks.addEventListener(eventName,listener),_this3.on("dispose",function(e){return elTracks.removeEventListener(eventName,listener)})}),this.on("loadstart",removeOldTracks),this.on("dispose",function(e){return _this3.off("loadstart",removeOldTracks)})}},_proto.proxyNativeTracks_=function(){var _this4=this;NORMAL.names.forEach(function(name){_this4.proxyNativeTracksForType_(name)})},_proto.createEl=function(){var el=this.options_.tag;if(!el||!this.options_.playerElIngest&&!this.movingMediaElementInDOM){if(el){var clone=el.cloneNode(!0);el.parentNode&&el.parentNode.insertBefore(clone,el),Html5.disposeMediaElement(el),el=clone}else{el=document_default().createElement("video");var attributes=mergeOptions$3({},this.options_.tag&&getAttributes(this.options_.tag));TOUCH_ENABLED&&!0===this.options_.nativeControlsForTouch||delete attributes.controls,setAttributes(el,video_es_assign(attributes,{id:this.options_.techId,class:"vjs-tech"}))}el.playerId=this.options_.playerId}void 0!==this.options_.preload&&setAttribute(el,"preload",this.options_.preload),void 0!==this.options_.disablePictureInPicture&&(el.disablePictureInPicture=this.options_.disablePictureInPicture);for(var settingsAttrs=["loop","muted","playsinline","autoplay"],i=0;i<settingsAttrs.length;i++){var attr=settingsAttrs[i],value=this.options_[attr];void 0!==value&&(value?setAttribute(el,attr,attr):removeAttribute(el,attr),el[attr]=value)}return el},_proto.handleLateInit_=function(el){if(0!==el.networkState&&3!==el.networkState){if(0===el.readyState){var loadstartFired=!1,setLoadstartFired=function(){loadstartFired=!0};this.on("loadstart",setLoadstartFired);var triggerLoadstart=function(){loadstartFired||this.trigger("loadstart")};return this.on("loadedmetadata",triggerLoadstart),void this.ready(function(){this.off("loadstart",setLoadstartFired),this.off("loadedmetadata",triggerLoadstart),loadstartFired||this.trigger("loadstart")})}var eventsToTrigger=["loadstart"];eventsToTrigger.push("loadedmetadata"),el.readyState>=2&&eventsToTrigger.push("loadeddata"),el.readyState>=3&&eventsToTrigger.push("canplay"),el.readyState>=4&&eventsToTrigger.push("canplaythrough"),this.ready(function(){eventsToTrigger.forEach(function(type){this.trigger(type)},this)})}},_proto.setScrubbing=function(isScrubbing){this.isScrubbing_=isScrubbing},_proto.scrubbing=function(){return this.isScrubbing_},_proto.setCurrentTime=function(seconds){try{this.isScrubbing_&&this.el_.fastSeek&&IS_ANY_SAFARI?this.el_.fastSeek(seconds):this.el_.currentTime=seconds}catch(e){log$1(e,"Video is not ready. (Video.js)")}},_proto.duration=function(){var _this5=this;return this.el_.duration===1/0&&IS_ANDROID&&IS_CHROME&&0===this.el_.currentTime?(this.on("timeupdate",function checkProgress(){_this5.el_.currentTime>0&&(_this5.el_.duration===1/0&&_this5.trigger("durationchange"),_this5.off("timeupdate",checkProgress))}),NaN):this.el_.duration||NaN},_proto.width=function(){return this.el_.offsetWidth},_proto.height=function(){return this.el_.offsetHeight},_proto.proxyWebkitFullscreen_=function(){var _this6=this;if("webkitDisplayingFullscreen"in this.el_){var endFn=function(){this.trigger("fullscreenchange",{isFullscreen:!1})},beginFn=function(){"webkitPresentationMode"in this.el_&&"picture-in-picture"!==this.el_.webkitPresentationMode&&(this.one("webkitendfullscreen",endFn),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",beginFn),this.on("dispose",function(){_this6.off("webkitbeginfullscreen",beginFn),_this6.off("webkitendfullscreen",endFn)})}},_proto.supportsFullScreen=function(){if("function"==typeof this.el_.webkitEnterFullScreen){var userAgent=window_default().navigator&&window_default().navigator.userAgent||"";if(/Android/.test(userAgent)||!/Chrome|Mac OS X 10.5/.test(userAgent))return!0}return!1},_proto.enterFullScreen=function(){var video=this.el_;if(video.paused&&video.networkState<=video.HAVE_METADATA)silencePromise(this.el_.play()),this.setTimeout(function(){video.pause();try{video.webkitEnterFullScreen()}catch(e){this.trigger("fullscreenerror",e)}},0);else try{video.webkitEnterFullScreen()}catch(e){this.trigger("fullscreenerror",e)}},_proto.exitFullScreen=function(){this.el_.webkitDisplayingFullscreen?this.el_.webkitExitFullScreen():this.trigger("fullscreenerror",new Error("The video is not fullscreen"))},_proto.requestPictureInPicture=function(){return this.el_.requestPictureInPicture()},_proto.src=function(_src){if(void 0===_src)return this.el_.src;this.setSrc(_src)},_proto.reset=function(){Html5.resetMediaElement(this.el_)},_proto.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc},_proto.setControls=function(val){this.el_.controls=!!val},_proto.addTextTrack=function(kind,label,language){return this.featuresNativeTextTracks?this.el_.addTextTrack(kind,label,language):_Tech.prototype.addTextTrack.call(this,kind,label,language)},_proto.createRemoteTextTrack=function(options){if(!this.featuresNativeTextTracks)return _Tech.prototype.createRemoteTextTrack.call(this,options);var htmlTrackElement=document_default().createElement("track");return options.kind&&(htmlTrackElement.kind=options.kind),options.label&&(htmlTrackElement.label=options.label),(options.language||options.srclang)&&(htmlTrackElement.srclang=options.language||options.srclang),options.default&&(htmlTrackElement.default=options.default),options.id&&(htmlTrackElement.id=options.id),options.src&&(htmlTrackElement.src=options.src),htmlTrackElement},_proto.addRemoteTextTrack=function(options,manualCleanup){var htmlTrackElement=_Tech.prototype.addRemoteTextTrack.call(this,options,manualCleanup);return this.featuresNativeTextTracks&&this.el().appendChild(htmlTrackElement),htmlTrackElement},_proto.removeRemoteTextTrack=function(track){if(_Tech.prototype.removeRemoteTextTrack.call(this,track),this.featuresNativeTextTracks)for(var tracks=this.$$("track"),i=tracks.length;i--;)track!==tracks[i]&&track!==tracks[i].track||this.el().removeChild(tracks[i])},_proto.getVideoPlaybackQuality=function(){if("function"==typeof this.el().getVideoPlaybackQuality)return this.el().getVideoPlaybackQuality();var videoPlaybackQuality={};return void 0!==this.el().webkitDroppedFrameCount&&void 0!==this.el().webkitDecodedFrameCount&&(videoPlaybackQuality.droppedVideoFrames=this.el().webkitDroppedFrameCount,videoPlaybackQuality.totalVideoFrames=this.el().webkitDecodedFrameCount),window_default().performance&&"function"==typeof window_default().performance.now?videoPlaybackQuality.creationTime=window_default().performance.now():window_default().performance&&window_default().performance.timing&&"number"==typeof window_default().performance.timing.navigationStart&&(videoPlaybackQuality.creationTime=window_default().Date.now()-window_default().performance.timing.navigationStart),videoPlaybackQuality},Html5}(Tech);defineLazyProperty(Html5,"TEST_VID",function(){if(isReal()){var video=document_default().createElement("video"),track=document_default().createElement("track");return track.kind="captions",track.srclang="en",track.label="English",video.appendChild(track),video}}),Html5.isSupported=function(){try{Html5.TEST_VID.volume=.5}catch(e){return!1}return!(!Html5.TEST_VID||!Html5.TEST_VID.canPlayType)},Html5.canPlayType=function(type){return Html5.TEST_VID.canPlayType(type)},Html5.canPlaySource=function(srcObj,options){return Html5.canPlayType(srcObj.type)},Html5.canControlVolume=function(){try{var volume=Html5.TEST_VID.volume;return Html5.TEST_VID.volume=volume/2+.1,volume!==Html5.TEST_VID.volume}catch(e){return!1}},Html5.canMuteVolume=function(){try{var muted=Html5.TEST_VID.muted;return Html5.TEST_VID.muted=!muted,Html5.TEST_VID.muted?setAttribute(Html5.TEST_VID,"muted","muted"):removeAttribute(Html5.TEST_VID,"muted"),muted!==Html5.TEST_VID.muted}catch(e){return!1}},Html5.canControlPlaybackRate=function(){if(IS_ANDROID&&IS_CHROME&&CHROME_VERSION<58)return!1;try{var playbackRate=Html5.TEST_VID.playbackRate;return Html5.TEST_VID.playbackRate=playbackRate/2+.1,playbackRate!==Html5.TEST_VID.playbackRate}catch(e){return!1}},Html5.canOverrideAttributes=function(){try{var noop=function(){};Object.defineProperty(document_default().createElement("video"),"src",{get:noop,set:noop}),Object.defineProperty(document_default().createElement("audio"),"src",{get:noop,set:noop}),Object.defineProperty(document_default().createElement("video"),"innerHTML",{get:noop,set:noop}),Object.defineProperty(document_default().createElement("audio"),"innerHTML",{get:noop,set:noop})}catch(e){return!1}return!0},Html5.supportsNativeTextTracks=function(){return IS_ANY_SAFARI||IS_IOS&&IS_CHROME},Html5.supportsNativeVideoTracks=function(){return!(!Html5.TEST_VID||!Html5.TEST_VID.videoTracks)},Html5.supportsNativeAudioTracks=function(){return!(!Html5.TEST_VID||!Html5.TEST_VID.audioTracks)},Html5.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],[["featuresVolumeControl","canControlVolume"],["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach(function(_ref){var fn=_ref[1];defineLazyProperty(Html5.prototype,_ref[0],function(){return Html5[fn]()},!0)}),Html5.prototype.movingMediaElementInDOM=!IS_IOS,Html5.prototype.featuresFullscreenResize=!0,Html5.prototype.featuresProgressEvents=!0,Html5.prototype.featuresTimeupdateEvents=!0,Html5.patchCanPlayType=function(){ANDROID_VERSION>=4&&!IS_FIREFOX&&!IS_CHROME&&(canPlayType=Html5.TEST_VID&&Html5.TEST_VID.constructor.prototype.canPlayType,Html5.TEST_VID.constructor.prototype.canPlayType=function(type){return type&&/^application\/(?:x-|vnd\.apple\.)mpegurl/i.test(type)?"maybe":canPlayType.call(this,type)})},Html5.unpatchCanPlayType=function(){var r=Html5.TEST_VID.constructor.prototype.canPlayType;return canPlayType&&(Html5.TEST_VID.constructor.prototype.canPlayType=canPlayType),r},Html5.patchCanPlayType(),Html5.disposeMediaElement=function(el){if(el){for(el.parentNode&&el.parentNode.removeChild(el);el.hasChildNodes();)el.removeChild(el.firstChild);el.removeAttribute("src"),"function"==typeof el.load&&function(){try{el.load()}catch(e){}}()}},Html5.resetMediaElement=function(el){if(el){for(var sources=el.querySelectorAll("source"),i=sources.length;i--;)el.removeChild(sources[i]);el.removeAttribute("src"),"function"==typeof el.load&&function(){try{el.load()}catch(e){}}()}},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(prop){Html5.prototype[prop]=function(){return this.el_[prop]||this.el_.hasAttribute(prop)}}),["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(prop){Html5.prototype["set"+toTitleCase$1(prop)]=function(v){this.el_[prop]=v,v?this.el_.setAttribute(prop,prop):this.el_.removeAttribute(prop)}}),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","disablePictureInPicture","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach(function(prop){Html5.prototype[prop]=function(){return this.el_[prop]}}),["volume","src","poster","preload","playbackRate","defaultPlaybackRate","disablePictureInPicture","crossOrigin"].forEach(function(prop){Html5.prototype["set"+toTitleCase$1(prop)]=function(v){this.el_[prop]=v}}),["pause","load","play"].forEach(function(prop){Html5.prototype[prop]=function(){return this.el_[prop]()}}),Tech.withSourceHandlers(Html5),Html5.nativeSourceHandler={},Html5.nativeSourceHandler.canPlayType=function(type){try{return Html5.TEST_VID.canPlayType(type)}catch(e){return""}},Html5.nativeSourceHandler.canHandleSource=function(source,options){if(source.type)return Html5.nativeSourceHandler.canPlayType(source.type);if(source.src){var ext=getFileExtension(source.src);return Html5.nativeSourceHandler.canPlayType("video/"+ext)}return""},Html5.nativeSourceHandler.handleSource=function(source,tech,options){tech.setSrc(source.src)},Html5.nativeSourceHandler.dispose=function(){},Html5.registerSourceHandler(Html5.nativeSourceHandler),Tech.registerTech("Html5",Html5);var TECH_EVENTS_RETRIGGER=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],TECH_EVENTS_QUEUE={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},BREAKPOINT_ORDER=["tiny","xsmall","small","medium","large","xlarge","huge"],BREAKPOINT_CLASSES={};BREAKPOINT_ORDER.forEach(function(k){var v="x"===k.charAt(0)?"x-"+k.substring(1):k;BREAKPOINT_CLASSES[k]="vjs-layout-"+v});var DEFAULT_BREAKPOINTS={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0},Player=function(_Component){function Player(tag,options,ready){var _this;if(tag.id=tag.id||options.id||"vjs_video_"+newGUID(),(options=video_es_assign(Player.getTagSettings(tag),options)).initChildren=!1,options.createEl=!1,options.evented=!1,options.reportTouchActivity=!1,!options.language)if("function"==typeof tag.closest){var closest=tag.closest("[lang]");closest&&closest.getAttribute&&(options.language=closest.getAttribute("lang"))}else for(var element=tag;element&&1===element.nodeType;){if(getAttributes(element).hasOwnProperty("lang")){options.language=element.getAttribute("lang");break}element=element.parentNode}if((_this=_Component.call(this,null,options,ready)||this).boundDocumentFullscreenChange_=function(e){return _this.documentFullscreenChange_(e)},_this.boundFullWindowOnEscKey_=function(e){return _this.fullWindowOnEscKey(e)},_this.boundUpdateStyleEl_=function(e){return _this.updateStyleEl_(e)},_this.boundApplyInitTime_=function(e){return _this.applyInitTime_(e)},_this.boundUpdateCurrentBreakpoint_=function(e){return _this.updateCurrentBreakpoint_(e)},_this.boundHandleTechClick_=function(e){return _this.handleTechClick_(e)},_this.boundHandleTechDoubleClick_=function(e){return _this.handleTechDoubleClick_(e)},_this.boundHandleTechTouchStart_=function(e){return _this.handleTechTouchStart_(e)},_this.boundHandleTechTouchMove_=function(e){return _this.handleTechTouchMove_(e)},_this.boundHandleTechTouchEnd_=function(e){return _this.handleTechTouchEnd_(e)},_this.boundHandleTechTap_=function(e){return _this.handleTechTap_(e)},_this.isFullscreen_=!1,_this.log=createLogger(_this.id_),_this.fsApi_=FullscreenApi,_this.isPosterFromTech_=!1,_this.queuedCallbacks_=[],_this.isReady_=!1,_this.hasStarted_=!1,_this.userActive_=!1,_this.debugEnabled_=!1,!_this.options_||!_this.options_.techOrder||!_this.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(_this.tag=tag,_this.tagAttributes=tag&&getAttributes(tag),_this.language(_this.options_.language),options.languages){var languagesToLower={};Object.getOwnPropertyNames(options.languages).forEach(function(name){languagesToLower[name.toLowerCase()]=options.languages[name]}),_this.languages_=languagesToLower}else _this.languages_=Player.prototype.options_.languages;_this.resetCache_(),_this.poster_=options.poster||"",_this.controls_=!!options.controls,tag.controls=!1,tag.removeAttribute("controls"),_this.changingSrc_=!1,_this.playCallbacks_=[],_this.playTerminatedQueue_=[],tag.hasAttribute("autoplay")?_this.autoplay(!0):_this.autoplay(_this.options_.autoplay),options.plugins&&Object.keys(options.plugins).forEach(function(name){if("function"!=typeof _this[name])throw new Error('plugin "'+name+'" does not exist')}),_this.scrubbing_=!1,_this.el_=_this.createEl(),evented(assertThisInitialized_default()(_this),{eventBusKey:"el_"}),_this.fsApi_.requestFullscreen&&(on(document_default(),_this.fsApi_.fullscreenchange,_this.boundDocumentFullscreenChange_),_this.on(_this.fsApi_.fullscreenchange,_this.boundDocumentFullscreenChange_)),_this.fluid_&&_this.on(["playerreset","resize"],_this.boundUpdateStyleEl_);var playerOptionsCopy=mergeOptions$3(_this.options_);options.plugins&&Object.keys(options.plugins).forEach(function(name){_this[name](options.plugins[name])}),options.debug&&_this.debug(!0),_this.options_.playerOptions=playerOptionsCopy,_this.middleware_=[],_this.playbackRates(options.playbackRates),_this.initChildren(),_this.isAudio("audio"===tag.nodeName.toLowerCase()),_this.controls()?_this.addClass("vjs-controls-enabled"):_this.addClass("vjs-controls-disabled"),_this.el_.setAttribute("role","region"),_this.isAudio()?_this.el_.setAttribute("aria-label",_this.localize("Audio Player")):_this.el_.setAttribute("aria-label",_this.localize("Video Player")),_this.isAudio()&&_this.addClass("vjs-audio"),_this.flexNotSupported_()&&_this.addClass("vjs-no-flex"),TOUCH_ENABLED&&_this.addClass("vjs-touch-enabled"),IS_IOS||_this.addClass("vjs-workinghover"),Player.players[_this.id_]=assertThisInitialized_default()(_this);var majorVersion="7.17.0".split(".")[0];return _this.addClass("vjs-v"+majorVersion),_this.userActive(!0),_this.reportUserActivity(),_this.one("play",function(e){return _this.listenForUserActivity_(e)}),_this.on("stageclick",function(e){return _this.handleStageClick_(e)}),_this.on("keydown",function(e){return _this.handleKeyDown(e)}),_this.on("languagechange",function(e){return _this.handleLanguagechange(e)}),_this.breakpoints(_this.options_.breakpoints),_this.responsive(_this.options_.responsive),_this}inheritsLoose_default()(Player,_Component);var _proto=Player.prototype;return _proto.dispose=function(){var _this2=this;this.trigger("dispose"),this.off("dispose"),off(document_default(),this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),off(document_default(),"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),Player.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),middlewareInstances[this.id()]=null,ALL.names.forEach(function(name){var list=_this2[ALL[name].getterName]();list&&list.off&&list.off()}),_Component.prototype.dispose.call(this)},_proto.createEl=function(){var el,tag=this.tag,playerElIngest=this.playerElIngest_=tag.parentNode&&tag.parentNode.hasAttribute&&tag.parentNode.hasAttribute("data-vjs-player"),divEmbed="video-js"===this.tag.tagName.toLowerCase();playerElIngest?el=this.el_=tag.parentNode:divEmbed||(el=this.el_=_Component.prototype.createEl.call(this,"div"));var attrs=getAttributes(tag);if(divEmbed){for(el=this.el_=tag,tag=this.tag=document_default().createElement("video");el.children.length;)tag.appendChild(el.firstChild);hasClass(el,"video-js")||addClass(el,"video-js"),el.appendChild(tag),playerElIngest=this.playerElIngest_=el,Object.keys(el).forEach(function(k){try{tag[k]=el[k]}catch(e){}})}if(tag.setAttribute("tabindex","-1"),attrs.tabindex="-1",(IE_VERSION||IS_CHROME&&IS_WINDOWS)&&(tag.setAttribute("role","application"),attrs.role="application"),tag.removeAttribute("width"),tag.removeAttribute("height"),"width"in attrs&&delete attrs.width,"height"in attrs&&delete attrs.height,Object.getOwnPropertyNames(attrs).forEach(function(attr){divEmbed&&"class"===attr||el.setAttribute(attr,attrs[attr]),divEmbed&&tag.setAttribute(attr,attrs[attr])}),tag.playerId=tag.id,tag.id+="_html5_api",tag.className="vjs-tech",tag.player=el.player=this,this.addClass("vjs-paused"),!0!==window_default().VIDEOJS_NO_DYNAMIC_STYLE){this.styleEl_=createStyleElement("vjs-styles-dimensions");var defaultsStyleEl=$(".vjs-styles-defaults"),head=$("head");head.insertBefore(this.styleEl_,defaultsStyleEl?defaultsStyleEl.nextSibling:head.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);for(var links=tag.getElementsByTagName("a"),i=0;i<links.length;i++){var linkEl=links.item(i);addClass(linkEl,"vjs-hidden"),linkEl.setAttribute("hidden","hidden")}return tag.initNetworkState_=tag.networkState,tag.parentNode&&!playerElIngest&&tag.parentNode.insertBefore(el,tag),prependTo(tag,el),this.children_.unshift(tag),this.el_.setAttribute("lang",this.language_),this.el_.setAttribute("translate","no"),this.el_=el,el},_proto.crossOrigin=function(value){if(!value)return this.techGet_("crossOrigin");"anonymous"===value||"use-credentials"===value?this.techCall_("setCrossOrigin",value):log$1.warn('crossOrigin must be "anonymous" or "use-credentials", given "'+value+'"')},_proto.width=function(value){return this.dimension("width",value)},_proto.height=function(value){return this.dimension("height",value)},_proto.dimension=function(_dimension,value){var privDimension=_dimension+"_";if(void 0===value)return this[privDimension]||0;if(""===value||"auto"===value)return this[privDimension]=void 0,void this.updateStyleEl_();var parsedVal=parseFloat(value);isNaN(parsedVal)?log$1.error('Improper value "'+value+'" supplied for for '+_dimension):(this[privDimension]=parsedVal,this.updateStyleEl_())},_proto.fluid=function(bool){var callback,_this3=this;if(void 0===bool)return!!this.fluid_;this.fluid_=!!bool,isEvented(this)&&this.off(["playerreset","resize"],this.boundUpdateStyleEl_),bool?(this.addClass("vjs-fluid"),this.fill(!1),callback=function(){_this3.on(["playerreset","resize"],_this3.boundUpdateStyleEl_)},isEvented(this)?callback():(this.eventedCallbacks||(this.eventedCallbacks=[]),this.eventedCallbacks.push(callback))):this.removeClass("vjs-fluid"),this.updateStyleEl_()},_proto.fill=function(bool){if(void 0===bool)return!!this.fill_;this.fill_=!!bool,bool?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")},_proto.aspectRatio=function(ratio){if(void 0===ratio)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(ratio))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=ratio,this.fluid(!0),this.updateStyleEl_()},_proto.updateStyleEl_=function(){if(!0!==window_default().VIDEOJS_NO_DYNAMIC_STYLE){var width,height,idClass,ratioParts=(void 0!==this.aspectRatio_&&"auto"!==this.aspectRatio_?this.aspectRatio_:this.videoWidth()>0?this.videoWidth()+":"+this.videoHeight():"16:9").split(":"),ratioMultiplier=ratioParts[1]/ratioParts[0];width=void 0!==this.width_?this.width_:void 0!==this.height_?this.height_/ratioMultiplier:this.videoWidth()||300,height=void 0!==this.height_?this.height_:width*ratioMultiplier,idClass=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions",this.addClass(idClass),setTextContent(this.styleEl_,"\n      ."+idClass+" {\n        width: "+width+"px;\n        height: "+height+"px;\n      }\n\n      ."+idClass+".vjs-fluid {\n        padding-top: "+100*ratioMultiplier+"%;\n      }\n    ")}else{var _width="number"==typeof this.width_?this.width_:this.options_.width,_height="number"==typeof this.height_?this.height_:this.options_.height,techEl=this.tech_&&this.tech_.el();techEl&&(_width>=0&&(techEl.width=_width),_height>=0&&(techEl.height=_height))}},_proto.loadTech_=function(techName,source){var _this4=this;this.tech_&&this.unloadTech_();var titleTechName=toTitleCase$1(techName),camelTechName=techName.charAt(0).toLowerCase()+techName.slice(1);"Html5"!==titleTechName&&this.tag&&(Tech.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=titleTechName,this.isReady_=!1;var autoplay=this.autoplay();("string"==typeof this.autoplay()||!0===this.autoplay()&&this.options_.normalizeAutoplay)&&(autoplay=!1);var techOptions={source:source,autoplay:autoplay,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+camelTechName+"_api",playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,disablePictureInPicture:this.options_.disablePictureInPicture,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset,Promise:this.options_.Promise};ALL.names.forEach(function(name){var props=ALL[name];techOptions[props.getterName]=_this4[props.privateName]}),video_es_assign(techOptions,this.options_[titleTechName]),video_es_assign(techOptions,this.options_[camelTechName]),video_es_assign(techOptions,this.options_[techName.toLowerCase()]),this.tag&&(techOptions.tag=this.tag),source&&source.src===this.cache_.src&&this.cache_.currentTime>0&&(techOptions.startTime=this.cache_.currentTime);var tech,TechClass=Tech.getTech(techName);if(!TechClass)throw new Error("No Tech named '"+titleTechName+"' exists! '"+titleTechName+"' should be registered using videojs.registerTech()'");this.tech_=new TechClass(techOptions),this.tech_.ready(bind(this,this.handleTechReady_),!0),tech=this.tech_,(this.textTracksJson_||[]).forEach(function(track){var addedTrack=tech.addRemoteTextTrack(track).track;!track.src&&track.cues&&track.cues.forEach(function(cue){return addedTrack.addCue(cue)})}),tech.textTracks(),TECH_EVENTS_RETRIGGER.forEach(function(event){_this4.on(_this4.tech_,event,function(e){return _this4["handleTech"+toTitleCase$1(event)+"_"](e)})}),Object.keys(TECH_EVENTS_QUEUE).forEach(function(event){_this4.on(_this4.tech_,event,function(eventObj){0===_this4.tech_.playbackRate()&&_this4.tech_.seeking()?_this4.queuedCallbacks_.push({callback:_this4["handleTech"+TECH_EVENTS_QUEUE[event]+"_"].bind(_this4),event:eventObj}):_this4["handleTech"+TECH_EVENTS_QUEUE[event]+"_"](eventObj)})}),this.on(this.tech_,"loadstart",function(e){return _this4.handleTechLoadStart_(e)}),this.on(this.tech_,"sourceset",function(e){return _this4.handleTechSourceset_(e)}),this.on(this.tech_,"waiting",function(e){return _this4.handleTechWaiting_(e)}),this.on(this.tech_,"ended",function(e){return _this4.handleTechEnded_(e)}),this.on(this.tech_,"seeking",function(e){return _this4.handleTechSeeking_(e)}),this.on(this.tech_,"play",function(e){return _this4.handleTechPlay_(e)}),this.on(this.tech_,"firstplay",function(e){return _this4.handleTechFirstPlay_(e)}),this.on(this.tech_,"pause",function(e){return _this4.handleTechPause_(e)}),this.on(this.tech_,"durationchange",function(e){return _this4.handleTechDurationChange_(e)}),this.on(this.tech_,"fullscreenchange",function(e,data){return _this4.handleTechFullscreenChange_(e,data)}),this.on(this.tech_,"fullscreenerror",function(e,err){return _this4.handleTechFullscreenError_(e,err)}),this.on(this.tech_,"enterpictureinpicture",function(e){return _this4.handleTechEnterPictureInPicture_(e)}),this.on(this.tech_,"leavepictureinpicture",function(e){return _this4.handleTechLeavePictureInPicture_(e)}),this.on(this.tech_,"error",function(e){return _this4.handleTechError_(e)}),this.on(this.tech_,"posterchange",function(e){return _this4.handleTechPosterChange_(e)}),this.on(this.tech_,"textdata",function(e){return _this4.handleTechTextData_(e)}),this.on(this.tech_,"ratechange",function(e){return _this4.handleTechRateChange_(e)}),this.on(this.tech_,"loadedmetadata",this.boundUpdateStyleEl_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode===this.el()||"Html5"===titleTechName&&this.tag||prependTo(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)},_proto.unloadTech_=function(){var tech,trackEls,trackObjs,_this5=this;ALL.names.forEach(function(name){var props=ALL[name];_this5[props.privateName]=_this5[props.getterName]()}),this.textTracksJson_=(trackEls=(tech=this.tech_).$$("track"),trackObjs=Array.prototype.map.call(trackEls,function(t){return t.track}),Array.prototype.map.call(trackEls,function(trackEl){var json=trackToJson_(trackEl.track);return trackEl.src&&(json.src=trackEl.src),json}).concat(Array.prototype.filter.call(tech.textTracks(),function(track){return-1===trackObjs.indexOf(track)}).map(trackToJson_))),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1},_proto.tech=function(safety){return void 0===safety&&log$1.warn("Using the tech directly can be dangerous. I hope you know what you're doing.\nSee https://github.com/videojs/video.js/issues/2617 for more info.\n"),this.tech_},_proto.addTechControlsListeners_=function(){this.removeTechControlsListeners_(),this.on(this.tech_,"click",this.boundHandleTechClick_),this.on(this.tech_,"dblclick",this.boundHandleTechDoubleClick_),this.on(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.on(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.on(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.on(this.tech_,"tap",this.boundHandleTechTap_)},_proto.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.boundHandleTechTap_),this.off(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.off(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.off(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.off(this.tech_,"click",this.boundHandleTechClick_),this.off(this.tech_,"dblclick",this.boundHandleTechDoubleClick_)},_proto.handleTechReady_=function(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()},_proto.handleTechLoadStart_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay")),this.manualAutoplay_(!0===this.autoplay()&&this.options_.normalizeAutoplay?"play":this.autoplay())},_proto.manualAutoplay_=function(type){var _this6=this;if(this.tech_&&"string"==typeof type){var promise,resolveMuted=function(){var previouslyMuted=_this6.muted();_this6.muted(!0);var restoreMuted=function(){_this6.muted(previouslyMuted)};_this6.playTerminatedQueue_.push(restoreMuted);var mutedPromise=_this6.play();if(isPromise(mutedPromise))return mutedPromise.catch(function(err){throw restoreMuted(),new Error("Rejection at manualAutoplay. Restoring muted value. "+(err||""))})};if("any"!==type||this.muted()?promise="muted"!==type||this.muted()?this.play():resolveMuted():isPromise(promise=this.play())&&(promise=promise.catch(resolveMuted)),isPromise(promise))return promise.then(function(){_this6.trigger({type:"autoplay-success",autoplay:type})}).catch(function(){_this6.trigger({type:"autoplay-failure",autoplay:type})})}},_proto.updateSourceCaches_=function(srcObj){void 0===srcObj&&(srcObj="");var src=srcObj,type="";"string"!=typeof src&&(src=srcObj.src,type=srcObj.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],src&&!type&&(type=function(player,src){if(!src)return"";if(player.cache_.source.src===src&&player.cache_.source.type)return player.cache_.source.type;var matchingSources=player.cache_.sources.filter(function(s){return s.src===src});if(matchingSources.length)return matchingSources[0].type;for(var sources=player.$$("source"),i=0;i<sources.length;i++){var s=sources[i];if(s.type&&s.src&&s.src===src)return s.type}return getMimetype(src)}(this,src)),this.cache_.source=mergeOptions$3({},srcObj,{src:src,type:type});for(var matchingSources=this.cache_.sources.filter(function(s){return s.src&&s.src===src}),sourceElSources=[],sourceEls=this.$$("source"),matchingSourceEls=[],i=0;i<sourceEls.length;i++){var sourceObj=getAttributes(sourceEls[i]);sourceElSources.push(sourceObj),sourceObj.src&&sourceObj.src===src&&matchingSourceEls.push(sourceObj.src)}matchingSourceEls.length&&!matchingSources.length?this.cache_.sources=sourceElSources:matchingSources.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=src},_proto.handleTechSourceset_=function(event){var _this7=this;if(!this.changingSrc_){var updateSourceCaches=function(src){return _this7.updateSourceCaches_(src)},playerSrc=this.currentSource().src,eventSrc=event.src;playerSrc&&!/^blob:/.test(playerSrc)&&/^blob:/.test(eventSrc)&&(!this.lastSource_||this.lastSource_.tech!==eventSrc&&this.lastSource_.player!==playerSrc)&&(updateSourceCaches=function(){}),updateSourceCaches(eventSrc),event.src||this.tech_.any(["sourceset","loadstart"],function(e){if("sourceset"!==e.type){var techSrc=_this7.techGet("currentSrc");_this7.lastSource_.tech=techSrc,_this7.updateSourceCaches_(techSrc)}})}this.lastSource_={player:this.currentSource().src,tech:event.src},this.trigger({src:event.src,type:"sourceset"})},_proto.hasStarted=function(request){if(void 0===request)return this.hasStarted_;request!==this.hasStarted_&&(this.hasStarted_=request,this.hasStarted_?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started"))},_proto.handleTechPlay_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")},_proto.handleTechRateChange_=function(){this.tech_.playbackRate()>0&&0===this.cache_.lastPlaybackRate&&(this.queuedCallbacks_.forEach(function(queued){return queued.callback(queued.event)}),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")},_proto.handleTechWaiting_=function(){var _this8=this;this.addClass("vjs-waiting"),this.trigger("waiting");var timeWhenWaiting=this.currentTime();this.on("timeupdate",function timeUpdateListener(){timeWhenWaiting!==_this8.currentTime()&&(_this8.removeClass("vjs-waiting"),_this8.off("timeupdate",timeUpdateListener))})},_proto.handleTechCanPlay_=function(){this.removeClass("vjs-waiting"),this.trigger("canplay")},_proto.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")},_proto.handleTechPlaying_=function(){this.removeClass("vjs-waiting"),this.trigger("playing")},_proto.handleTechSeeking_=function(){this.addClass("vjs-seeking"),this.trigger("seeking")},_proto.handleTechSeeked_=function(){this.removeClass("vjs-seeking"),this.removeClass("vjs-ended"),this.trigger("seeked")},_proto.handleTechFirstPlay_=function(){this.options_.starttime&&(log$1.warn("Passing the `starttime` option to the player will be deprecated in 6.0"),this.currentTime(this.options_.starttime)),this.addClass("vjs-has-started"),this.trigger("firstplay")},_proto.handleTechPause_=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")},_proto.handleTechEnded_=function(){this.addClass("vjs-ended"),this.removeClass("vjs-waiting"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")},_proto.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))},_proto.handleTechClick_=function(event){this.controls_&&(void 0!==this.options_&&void 0!==this.options_.userActions&&void 0!==this.options_.userActions.click&&!1===this.options_.userActions.click||(void 0!==this.options_&&void 0!==this.options_.userActions&&"function"==typeof this.options_.userActions.click?this.options_.userActions.click.call(this,event):this.paused()?silencePromise(this.play()):this.pause()))},_proto.handleTechDoubleClick_=function(event){this.controls_&&(Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),function(el){return el.contains(event.target)})||void 0!==this.options_&&void 0!==this.options_.userActions&&void 0!==this.options_.userActions.doubleClick&&!1===this.options_.userActions.doubleClick||(void 0!==this.options_&&void 0!==this.options_.userActions&&"function"==typeof this.options_.userActions.doubleClick?this.options_.userActions.doubleClick.call(this,event):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen()))},_proto.handleTechTap_=function(){this.userActive(!this.userActive())},_proto.handleTechTouchStart_=function(){this.userWasActive=this.userActive()},_proto.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()},_proto.handleTechTouchEnd_=function(event){event.cancelable&&event.preventDefault()},_proto.handleStageClick_=function(){this.reportUserActivity()},_proto.toggleFullscreenClass_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},_proto.documentFullscreenChange_=function(e){var targetPlayer=e.target.player;if(!targetPlayer||targetPlayer===this){var el=this.el(),isFs=document_default()[this.fsApi_.fullscreenElement]===el;!isFs&&el.matches?isFs=el.matches(":"+this.fsApi_.fullscreen):!isFs&&el.msMatchesSelector&&(isFs=el.msMatchesSelector(":"+this.fsApi_.fullscreen)),this.isFullscreen(isFs)}},_proto.handleTechFullscreenChange_=function(event,data){data&&(data.nativeIOSFullscreen&&this.toggleClass("vjs-ios-native-fs"),this.isFullscreen(data.isFullscreen))},_proto.handleTechFullscreenError_=function(event,err){this.trigger("fullscreenerror",err)},_proto.togglePictureInPictureClass_=function(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")},_proto.handleTechEnterPictureInPicture_=function(event){this.isInPictureInPicture(!0)},_proto.handleTechLeavePictureInPicture_=function(event){this.isInPictureInPicture(!1)},_proto.handleTechError_=function(){var error=this.tech_.error();this.error(error)},_proto.handleTechTextData_=function(){var data=null;arguments.length>1&&(data=arguments[1]),this.trigger("textdata",data)},_proto.getCache=function(){return this.cache_},_proto.resetCache_=function(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],playbackRates:[],volume:1}},_proto.techCall_=function(method,arg){this.ready(function(){if(method in allowedSetters)return function(middleware,tech,method,arg){return tech[method](middleware.reduce(middlewareIterator(method),arg))}(this.middleware_,this.tech_,method,arg);if(method in allowedMediators)return mediate(this.middleware_,this.tech_,method,arg);try{this.tech_&&this.tech_[method](arg)}catch(e){throw log$1(e),e}},!0)},_proto.techGet_=function(method){if(this.tech_&&this.tech_.isReady_){if(method in allowedGetters)return function(middleware,tech,method){return middleware.reduceRight(middlewareIterator(method),tech[method]())}(this.middleware_,this.tech_,method);if(method in allowedMediators)return mediate(this.middleware_,this.tech_,method);try{return this.tech_[method]()}catch(e){if(void 0===this.tech_[method])throw log$1("Video.js: "+method+" method not defined for "+this.techName_+" playback technology.",e),e;if("TypeError"===e.name)throw log$1("Video.js: "+method+" unavailable on "+this.techName_+" playback technology element.",e),this.tech_.isReady_=!1,e;throw log$1(e),e}}},_proto.play=function(){var _this9=this,PromiseClass=this.options_.Promise||window_default().Promise;return PromiseClass?new PromiseClass(function(resolve){_this9.play_(resolve)}):this.play_()},_proto.play_=function(callback){var _this10=this;void 0===callback&&(callback=silencePromise),this.playCallbacks_.push(callback);var isSrcReady=Boolean(!this.changingSrc_&&(this.src()||this.currentSrc()));if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!isSrcReady)return this.waitToPlay_=function(e){_this10.play_()},this.one(["ready","loadstart"],this.waitToPlay_),void(isSrcReady||!IS_ANY_SAFARI&&!IS_IOS||this.load());var val=this.techGet_("play");null===val?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(val)},_proto.runPlayTerminatedQueue_=function(){var queue=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],queue.forEach(function(q){q()})},_proto.runPlayCallbacks_=function(val){var callbacks=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],callbacks.forEach(function(cb){cb(val)})},_proto.pause=function(){this.techCall_("pause")},_proto.paused=function(){return!1!==this.techGet_("paused")},_proto.played=function(){return this.techGet_("played")||createTimeRanges(0,0)},_proto.scrubbing=function(isScrubbing){if(void 0===isScrubbing)return this.scrubbing_;this.scrubbing_=!!isScrubbing,this.techCall_("setScrubbing",this.scrubbing_),isScrubbing?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")},_proto.currentTime=function(seconds){return void 0!==seconds?(seconds<0&&(seconds=0),this.isReady_&&!this.changingSrc_&&this.tech_&&this.tech_.isReady_?(this.techCall_("setCurrentTime",seconds),void(this.cache_.initTime=0)):(this.cache_.initTime=seconds,this.off("canplay",this.boundApplyInitTime_),void this.one("canplay",this.boundApplyInitTime_))):(this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime)},_proto.applyInitTime_=function(){this.currentTime(this.cache_.initTime)},_proto.duration=function(seconds){if(void 0===seconds)return void 0!==this.cache_.duration?this.cache_.duration:NaN;(seconds=parseFloat(seconds))<0&&(seconds=1/0),seconds!==this.cache_.duration&&(this.cache_.duration=seconds,seconds===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(seconds)||this.trigger("durationchange"))},_proto.remainingTime=function(){return this.duration()-this.currentTime()},_proto.remainingTimeDisplay=function(){return Math.floor(this.duration())-Math.floor(this.currentTime())},_proto.buffered=function(){var buffered=this.techGet_("buffered");return buffered&&buffered.length||(buffered=createTimeRanges(0,0)),buffered},_proto.bufferedPercent=function(){return bufferedPercent(this.buffered(),this.duration())},_proto.bufferedEnd=function(){var buffered=this.buffered(),duration=this.duration(),end=buffered.end(buffered.length-1);return end>duration&&(end=duration),end},_proto.volume=function(percentAsDecimal){var vol;return void 0!==percentAsDecimal?(vol=Math.max(0,Math.min(1,parseFloat(percentAsDecimal))),this.cache_.volume=vol,this.techCall_("setVolume",vol),void(vol>0&&this.lastVolume_(vol))):(vol=parseFloat(this.techGet_("volume")),isNaN(vol)?1:vol)},_proto.muted=function(_muted){if(void 0===_muted)return this.techGet_("muted")||!1;this.techCall_("setMuted",_muted)},_proto.defaultMuted=function(_defaultMuted){return void 0!==_defaultMuted?this.techCall_("setDefaultMuted",_defaultMuted):this.techGet_("defaultMuted")||!1},_proto.lastVolume_=function(percentAsDecimal){if(void 0===percentAsDecimal||0===percentAsDecimal)return this.cache_.lastVolume;this.cache_.lastVolume=percentAsDecimal},_proto.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1},_proto.isFullscreen=function(isFS){if(void 0!==isFS){var oldValue=this.isFullscreen_;return this.isFullscreen_=Boolean(isFS),this.isFullscreen_!==oldValue&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),void this.toggleFullscreenClass_()}return this.isFullscreen_},_proto.requestFullscreen=function(fullscreenOptions){var PromiseClass=this.options_.Promise||window_default().Promise;if(PromiseClass){var self=this;return new PromiseClass(function(resolve,reject){function offHandler(){self.off("fullscreenerror",errorHandler),self.off("fullscreenchange",changeHandler)}function changeHandler(){offHandler(),resolve()}function errorHandler(e,err){offHandler(),reject(err)}self.one("fullscreenchange",changeHandler),self.one("fullscreenerror",errorHandler);var promise=self.requestFullscreenHelper_(fullscreenOptions);promise&&(promise.then(offHandler,offHandler),promise.then(resolve,reject))})}return this.requestFullscreenHelper_()},_proto.requestFullscreenHelper_=function(fullscreenOptions){var fsOptions,_this11=this;if(this.fsApi_.prefixed||(fsOptions=this.options_.fullscreen&&this.options_.fullscreen.options||{},void 0!==fullscreenOptions&&(fsOptions=fullscreenOptions)),this.fsApi_.requestFullscreen){var promise=this.el_[this.fsApi_.requestFullscreen](fsOptions);return promise&&promise.then(function(){return _this11.isFullscreen(!0)},function(){return _this11.isFullscreen(!1)}),promise}this.tech_.supportsFullScreen()&&1==!this.options_.preferFullWindow?this.techCall_("enterFullScreen"):this.enterFullWindow()},_proto.exitFullscreen=function(){var PromiseClass=this.options_.Promise||window_default().Promise;if(PromiseClass){var self=this;return new PromiseClass(function(resolve,reject){function offHandler(){self.off("fullscreenerror",errorHandler),self.off("fullscreenchange",changeHandler)}function changeHandler(){offHandler(),resolve()}function errorHandler(e,err){offHandler(),reject(err)}self.one("fullscreenchange",changeHandler),self.one("fullscreenerror",errorHandler);var promise=self.exitFullscreenHelper_();promise&&(promise.then(offHandler,offHandler),promise.then(resolve,reject))})}return this.exitFullscreenHelper_()},_proto.exitFullscreenHelper_=function(){var _this12=this;if(this.fsApi_.requestFullscreen){var promise=document_default()[this.fsApi_.exitFullscreen]();return promise&&silencePromise(promise.then(function(){return _this12.isFullscreen(!1)})),promise}this.tech_.supportsFullScreen()&&1==!this.options_.preferFullWindow?this.techCall_("exitFullScreen"):this.exitFullWindow()},_proto.enterFullWindow=function(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=document_default().documentElement.style.overflow,on(document_default(),"keydown",this.boundFullWindowOnEscKey_),document_default().documentElement.style.overflow="hidden",addClass(document_default().body,"vjs-full-window"),this.trigger("enterFullWindow")},_proto.fullWindowOnEscKey=function(event){keycode_default().isEventKey(event,"Esc")&&!0===this.isFullscreen()&&(this.isFullWindow?this.exitFullWindow():this.exitFullscreen())},_proto.exitFullWindow=function(){this.isFullscreen(!1),this.isFullWindow=!1,off(document_default(),"keydown",this.boundFullWindowOnEscKey_),document_default().documentElement.style.overflow=this.docOrigOverflow,removeClass(document_default().body,"vjs-full-window"),this.trigger("exitFullWindow")},_proto.disablePictureInPicture=function(value){if(void 0===value)return this.techGet_("disablePictureInPicture");this.techCall_("setDisablePictureInPicture",value),this.options_.disablePictureInPicture=value,this.trigger("disablepictureinpicturechanged")},_proto.isInPictureInPicture=function(isPiP){return void 0!==isPiP?(this.isInPictureInPicture_=!!isPiP,void this.togglePictureInPictureClass_()):!!this.isInPictureInPicture_},_proto.requestPictureInPicture=function(){if("pictureInPictureEnabled"in document_default()&&!1===this.disablePictureInPicture())return this.techGet_("requestPictureInPicture")},_proto.exitPictureInPicture=function(){if("pictureInPictureEnabled"in document_default())return document_default().exitPictureInPicture()},_proto.handleKeyDown=function(event){var el,tagName,userActions=this.options_.userActions;userActions&&userActions.hotkeys&&(tagName=(el=this.el_.ownerDocument.activeElement).tagName.toLowerCase(),el.isContentEditable||("input"===tagName?-1===["button","checkbox","hidden","radio","reset","submit"].indexOf(el.type):-1!==["textarea"].indexOf(tagName))||("function"==typeof userActions.hotkeys?userActions.hotkeys.call(this,event):this.handleHotkeys(event)))},_proto.handleHotkeys=function(event){var hotkeys=this.options_.userActions?this.options_.userActions.hotkeys:{},_hotkeys$fullscreenKe=hotkeys.fullscreenKey,_hotkeys$muteKey=hotkeys.muteKey,muteKey=void 0===_hotkeys$muteKey?function(keydownEvent){return keycode_default().isEventKey(keydownEvent,"m")}:_hotkeys$muteKey,_hotkeys$playPauseKey=hotkeys.playPauseKey,playPauseKey=void 0===_hotkeys$playPauseKey?function(keydownEvent){return keycode_default().isEventKey(keydownEvent,"k")||keycode_default().isEventKey(keydownEvent,"Space")}:_hotkeys$playPauseKey;if((void 0===_hotkeys$fullscreenKe?function(keydownEvent){return keycode_default().isEventKey(keydownEvent,"f")}:_hotkeys$fullscreenKe).call(this,event)){event.preventDefault(),event.stopPropagation();var FSToggle=Component$1.getComponent("FullscreenToggle");!1!==document_default()[this.fsApi_.fullscreenEnabled]&&FSToggle.prototype.handleClick.call(this,event)}else muteKey.call(this,event)?(event.preventDefault(),event.stopPropagation(),Component$1.getComponent("MuteToggle").prototype.handleClick.call(this,event)):playPauseKey.call(this,event)&&(event.preventDefault(),event.stopPropagation(),Component$1.getComponent("PlayToggle").prototype.handleClick.call(this,event))},_proto.canPlayType=function(type){for(var can,i=0,j=this.options_.techOrder;i<j.length;i++){var techName=j[i],tech=Tech.getTech(techName);if(tech||(tech=Component$1.getComponent(techName)),tech){if(tech.isSupported()&&(can=tech.canPlayType(type)))return can}else log$1.error('The "'+techName+'" tech is undefined. Skipped browser support check for that tech.')}return""},_proto.selectSource=function(sources){var foundSourceAndTech,fn,_this13=this,techs=this.options_.techOrder.map(function(techName){return[techName,Tech.getTech(techName)]}).filter(function(_ref){var techName=_ref[0],tech=_ref[1];return tech?tech.isSupported():(log$1.error('The "'+techName+'" tech is undefined. Skipped browser support check for that tech.'),!1)}),findFirstPassingTechSourcePair=function(outerArray,innerArray,tester){var found;return outerArray.some(function(outerChoice){return innerArray.some(function(innerChoice){if(found=tester(outerChoice,innerChoice))return!0})}),found},finder=function(_ref2,source){var techName=_ref2[0];if(_ref2[1].canPlaySource(source,_this13.options_[techName.toLowerCase()]))return{source:source,tech:techName}};return foundSourceAndTech=this.options_.sourceOrder?findFirstPassingTechSourcePair(sources,techs,(fn=finder,function(a,b){return fn(b,a)})):findFirstPassingTechSourcePair(techs,sources,finder),foundSourceAndTech||!1},_proto.handleSrc_=function(source,isRetry){var _this14=this;if(void 0===source)return this.cache_.src||"";this.resetRetryOnError_&&this.resetRetryOnError_();var sources=filterSource(source);if(sources.length){if(this.changingSrc_=!0,isRetry||(this.cache_.sources=sources),this.updateSourceCaches_(sources[0]),setSource(this,sources[0],function(middlewareSource,mws){var tech;if(_this14.middleware_=mws,isRetry||(_this14.cache_.sources=sources),_this14.updateSourceCaches_(middlewareSource),_this14.src_(middlewareSource))return sources.length>1?_this14.handleSrc_(sources.slice(1)):(_this14.changingSrc_=!1,_this14.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0),void _this14.triggerReady());tech=_this14.tech_,mws.forEach(function(mw){return mw.setTech&&mw.setTech(tech)})}),this.options_.retryOnError&&sources.length>1){var retry=function(){_this14.error(null),_this14.handleSrc_(sources.slice(1),!0)},stopListeningForErrors=function(){_this14.off("error",retry)};this.one("error",retry),this.one("playing",stopListeningForErrors),this.resetRetryOnError_=function(){_this14.off("error",retry),_this14.off("playing",stopListeningForErrors)}}}else this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0)},_proto.src=function(source){return this.handleSrc_(source,!1)},_proto.src_=function(source){var str2,_this15=this,sourceTech=this.selectSource([source]);return!sourceTech||(str2=this.techName_,toTitleCase$1(sourceTech.tech)!==toTitleCase$1(str2)?(this.changingSrc_=!0,this.loadTech_(sourceTech.tech,sourceTech.source),this.tech_.ready(function(){_this15.changingSrc_=!1}),!1):(this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",source):this.techCall_("src",source.src),this.changingSrc_=!1},!0),!1))},_proto.load=function(){this.techCall_("load")},_proto.reset=function(){var _this16=this,PromiseClass=this.options_.Promise||window_default().Promise;this.paused()||!PromiseClass?this.doReset_():silencePromise(this.play().then(function(){return _this16.doReset_()}))},_proto.doReset_=function(){this.tech_&&this.tech_.clearTracks("text"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),isEvented(this)&&this.trigger("playerreset")},_proto.resetControlBarUI_=function(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()},_proto.resetProgressBar_=function(){this.currentTime(0);var _this$controlBar=this.controlBar,durationDisplay=_this$controlBar.durationDisplay,remainingTimeDisplay=_this$controlBar.remainingTimeDisplay;durationDisplay&&durationDisplay.updateContent(),remainingTimeDisplay&&remainingTimeDisplay.updateContent()},_proto.resetPlaybackRate_=function(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()},_proto.resetVolumeBar_=function(){this.volume(1),this.trigger("volumechange")},_proto.currentSources=function(){var source=this.currentSource(),sources=[];return 0!==Object.keys(source).length&&sources.push(source),this.cache_.sources||sources},_proto.currentSource=function(){return this.cache_.source||{}},_proto.currentSrc=function(){return this.currentSource()&&this.currentSource().src||""},_proto.currentType=function(){return this.currentSource()&&this.currentSource().type||""},_proto.preload=function(value){return void 0!==value?(this.techCall_("setPreload",value),void(this.options_.preload=value)):this.techGet_("preload")},_proto.autoplay=function(value){if(void 0===value)return this.options_.autoplay||!1;var techAutoplay;"string"==typeof value&&/(any|play|muted)/.test(value)||!0===value&&this.options_.normalizeAutoplay?(this.options_.autoplay=value,this.manualAutoplay_("string"==typeof value?value:"play"),techAutoplay=!1):this.options_.autoplay=!!value,techAutoplay=void 0===techAutoplay?this.options_.autoplay:techAutoplay,this.tech_&&this.techCall_("setAutoplay",techAutoplay)},_proto.playsinline=function(value){return void 0!==value?(this.techCall_("setPlaysinline",value),this.options_.playsinline=value,this):this.techGet_("playsinline")},_proto.loop=function(value){return void 0!==value?(this.techCall_("setLoop",value),void(this.options_.loop=value)):this.techGet_("loop")},_proto.poster=function(src){if(void 0===src)return this.poster_;src||(src=""),src!==this.poster_&&(this.poster_=src,this.techCall_("setPoster",src),this.isPosterFromTech_=!1,this.trigger("posterchange"))},_proto.handleTechPosterChange_=function(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var newPoster=this.tech_.poster()||"";newPoster!==this.poster_&&(this.poster_=newPoster,this.isPosterFromTech_=!0,this.trigger("posterchange"))}},_proto.controls=function(bool){if(void 0===bool)return!!this.controls_;this.controls_!==(bool=!!bool)&&(this.controls_=bool,this.usingNativeControls()&&this.techCall_("setControls",bool),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))},_proto.usingNativeControls=function(bool){if(void 0===bool)return!!this.usingNativeControls_;this.usingNativeControls_!==(bool=!!bool)&&(this.usingNativeControls_=bool,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))},_proto.error=function(err){var _this17=this;if(void 0===err)return this.error_||null;if(hooks("beforeerror").forEach(function(hookFunction){var newErr=hookFunction(_this17,err);video_es_isObject(newErr)&&!Array.isArray(newErr)||"string"==typeof newErr||"number"==typeof newErr||null===newErr?err=newErr:_this17.log.error("please return a value that MediaError expects in beforeerror hooks")}),this.options_.suppressNotSupportedError&&err&&4===err.code){var triggerSuppressedError=function(){this.error(err)};return this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],triggerSuppressedError),void this.one("loadstart",function(){this.off(["click","touchstart"],triggerSuppressedError)})}if(null===err)return this.error_=err,this.removeClass("vjs-error"),void(this.errorDisplay&&this.errorDisplay.close());this.error_=new MediaError(err),this.addClass("vjs-error"),log$1.error("(CODE:"+this.error_.code+" "+MediaError.errorTypes[this.error_.code]+")",this.error_.message,this.error_),this.trigger("error"),hooks("error").forEach(function(hookFunction){return hookFunction(_this17,_this17.error_)})},_proto.reportUserActivity=function(event){this.userActivity_=!0},_proto.userActive=function(bool){if(void 0===bool)return this.userActive_;if((bool=!!bool)!==this.userActive_){if(this.userActive_=bool,this.userActive_)return this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),void this.trigger("useractive");this.tech_&&this.tech_.one("mousemove",function(e){e.stopPropagation(),e.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}},_proto.listenForUserActivity_=function(){var mouseInProgress,lastMoveX,lastMoveY,handleActivity=bind(this,this.reportUserActivity),handleMouseUpAndMouseLeave=function(event){handleActivity(),this.clearInterval(mouseInProgress)};this.on("mousedown",function(){handleActivity(),this.clearInterval(mouseInProgress),mouseInProgress=this.setInterval(handleActivity,250)}),this.on("mousemove",function(e){e.screenX===lastMoveX&&e.screenY===lastMoveY||(lastMoveX=e.screenX,lastMoveY=e.screenY,handleActivity())}),this.on("mouseup",handleMouseUpAndMouseLeave),this.on("mouseleave",handleMouseUpAndMouseLeave);var inactivityTimeout,controlBar=this.getChild("controlBar");!controlBar||IS_IOS||IS_ANDROID||(controlBar.on("mouseenter",function(event){0!==this.player().options_.inactivityTimeout&&(this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout),this.player().options_.inactivityTimeout=0}),controlBar.on("mouseleave",function(event){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout})),this.on("keydown",handleActivity),this.on("keyup",handleActivity),this.setInterval(function(){if(this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(inactivityTimeout);var timeout=this.options_.inactivityTimeout;timeout<=0||(inactivityTimeout=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},timeout))}},250)},_proto.playbackRate=function(rate){if(void 0===rate)return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1;this.techCall_("setPlaybackRate",rate)},_proto.defaultPlaybackRate=function(rate){return void 0!==rate?this.techCall_("setDefaultPlaybackRate",rate):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1},_proto.isAudio=function(bool){if(void 0===bool)return!!this.isAudio_;this.isAudio_=!!bool},_proto.addTextTrack=function(kind,label,language){if(this.tech_)return this.tech_.addTextTrack(kind,label,language)},_proto.addRemoteTextTrack=function(options,manualCleanup){if(this.tech_)return this.tech_.addRemoteTextTrack(options,manualCleanup)},_proto.removeRemoteTextTrack=function(obj){void 0===obj&&(obj={});var track=obj.track;if(track||(track=obj),this.tech_)return this.tech_.removeRemoteTextTrack(track)},_proto.getVideoPlaybackQuality=function(){return this.techGet_("getVideoPlaybackQuality")},_proto.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},_proto.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},_proto.language=function(code){if(void 0===code)return this.language_;this.language_!==String(code).toLowerCase()&&(this.language_=String(code).toLowerCase(),isEvented(this)&&this.trigger("languagechange"))},_proto.languages=function(){return mergeOptions$3(Player.prototype.options_.languages,this.languages_)},_proto.toJSON=function(){var options=mergeOptions$3(this.options_),tracks=options.tracks;options.tracks=[];for(var i=0;i<tracks.length;i++){var track=tracks[i];(track=mergeOptions$3(track)).player=void 0,options.tracks[i]=track}return options},_proto.createModal=function(content,options){var _this18=this;(options=options||{}).content=content||"";var modal=new ModalDialog(this,options);return this.addChild(modal),modal.on("dispose",function(){_this18.removeChild(modal)}),modal.open(),modal},_proto.updateCurrentBreakpoint_=function(){if(this.responsive())for(var currentBreakpoint=this.currentBreakpoint(),currentWidth=this.currentWidth(),i=0;i<BREAKPOINT_ORDER.length;i++){var candidateBreakpoint=BREAKPOINT_ORDER[i];if(currentWidth<=this.breakpoints_[candidateBreakpoint]){if(currentBreakpoint===candidateBreakpoint)return;currentBreakpoint&&this.removeClass(BREAKPOINT_CLASSES[currentBreakpoint]),this.addClass(BREAKPOINT_CLASSES[candidateBreakpoint]),this.breakpoint_=candidateBreakpoint;break}}},_proto.removeCurrentBreakpoint_=function(){var className=this.currentBreakpointClass();this.breakpoint_="",className&&this.removeClass(className)},_proto.breakpoints=function(_breakpoints){return void 0===_breakpoints||(this.breakpoint_="",this.breakpoints_=video_es_assign({},DEFAULT_BREAKPOINTS,_breakpoints),this.updateCurrentBreakpoint_()),video_es_assign(this.breakpoints_)},_proto.responsive=function(value){return void 0===value?this.responsive_:(value=Boolean(value))!==this.responsive_?(this.responsive_=value,value?(this.on("playerresize",this.boundUpdateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.boundUpdateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),value):void 0},_proto.currentBreakpoint=function(){return this.breakpoint_},_proto.currentBreakpointClass=function(){return BREAKPOINT_CLASSES[this.breakpoint_]||""},_proto.loadMedia=function(media,ready){var _this19=this;if(media&&"object"==typeof media){this.reset(),this.cache_.media=mergeOptions$3(media);var _this$cache_$media=this.cache_.media,poster=_this$cache_$media.poster,src=_this$cache_$media.src,textTracks=_this$cache_$media.textTracks;!_this$cache_$media.artwork&&poster&&(this.cache_.media.artwork=[{src:poster,type:getMimetype(poster)}]),src&&this.src(src),poster&&this.poster(poster),Array.isArray(textTracks)&&textTracks.forEach(function(tt){return _this19.addRemoteTextTrack(tt,!1)}),this.ready(ready)}},_proto.getMedia=function(){if(!this.cache_.media){var poster=this.poster(),media={src:this.currentSources(),textTracks:Array.prototype.map.call(this.remoteTextTracks(),function(tt){return{kind:tt.kind,label:tt.label,language:tt.language,src:tt.src}})};return poster&&(media.poster=poster,media.artwork=[{src:media.poster,type:getMimetype(media.poster)}]),media}return mergeOptions$3(this.cache_.media)},Player.getTagSettings=function(tag){var baseOptions={sources:[],tracks:[]},tagOptions=getAttributes(tag),dataSetup=tagOptions["data-setup"];if(hasClass(tag,"vjs-fill")&&(tagOptions.fill=!0),hasClass(tag,"vjs-fluid")&&(tagOptions.fluid=!0),null!==dataSetup){var _safeParseTuple=tuple_default()(dataSetup||"{}"),err=_safeParseTuple[0],data=_safeParseTuple[1];err&&log$1.error(err),video_es_assign(tagOptions,data)}if(video_es_assign(baseOptions,tagOptions),tag.hasChildNodes())for(var children=tag.childNodes,i=0,j=children.length;i<j;i++){var child=children[i],childName=child.nodeName.toLowerCase();"source"===childName?baseOptions.sources.push(getAttributes(child)):"track"===childName&&baseOptions.tracks.push(getAttributes(child))}return baseOptions},_proto.flexNotSupported_=function(){var elem=document_default().createElement("i");return!("flexBasis"in elem.style||"webkitFlexBasis"in elem.style||"mozFlexBasis"in elem.style||"msFlexBasis"in elem.style||"msFlexOrder"in elem.style)},_proto.debug=function(enabled){if(void 0===enabled)return this.debugEnabled_;enabled?(this.trigger("debugon"),this.previousLogLevel_=this.log.level,this.log.level("debug"),this.debugEnabled_=!0):(this.trigger("debugoff"),this.log.level(this.previousLogLevel_),this.previousLogLevel_=void 0,this.debugEnabled_=!1)},_proto.playbackRates=function(newRates){if(void 0===newRates)return this.cache_.playbackRates;Array.isArray(newRates)&&newRates.every(function(rate){return"number"==typeof rate})&&(this.cache_.playbackRates=newRates,this.trigger("playbackrateschange"))},Player}(Component$1);ALL.names.forEach(function(name){var props=ALL[name];Player.prototype[props.getterName]=function(){return this.tech_?this.tech_[props.getterName]():(this[props.privateName]=this[props.privateName]||new props.ListClass,this[props.privateName])}}),Player.prototype.crossorigin=Player.prototype.crossOrigin,Player.players={};var video_es_navigator=window_default().navigator;Player.prototype.options_={techOrder:Tech.defaultTechOrder_,html5:{},inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:video_es_navigator&&(video_es_navigator.languages&&video_es_navigator.languages[0]||video_es_navigator.userLanguage||video_es_navigator.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",normalizeAutoplay:!1,fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1},["ended","seeking","seekable","networkState","readyState"].forEach(function(fn){Player.prototype[fn]=function(){return this.techGet_(fn)}}),TECH_EVENTS_RETRIGGER.forEach(function(event){Player.prototype["handleTech"+toTitleCase$1(event)+"_"]=function(){return this.trigger(event)}}),Component$1.registerComponent("Player",Player);var pluginStorage={},pluginExists=function(name){return pluginStorage.hasOwnProperty(name)},getPlugin=function(name){return pluginExists(name)?pluginStorage[name]:void 0},markPluginAsActive=function(player,name){player.activePlugins_=player.activePlugins_||{},player.activePlugins_[name]=!0},triggerSetupEvent=function(player,hash,before){var eventName=(before?"before":"")+"pluginsetup";player.trigger(eventName,hash),player.trigger(eventName+":"+hash.name,hash)},createPluginFactory=function(name,PluginSubClass){return PluginSubClass.prototype.name=name,function(){triggerSetupEvent(this,{name:name,plugin:PluginSubClass,instance:null},!0);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var instance=construct_default()(PluginSubClass,[this].concat(args));return this[name]=function(){return instance},triggerSetupEvent(this,instance.getEventHash()),instance}},Plugin=function(){function Plugin(player){if(this.constructor===Plugin)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=player,this.log||(this.log=this.player.log.createLogger(this.name)),evented(this),delete this.trigger,stateful(this,this.constructor.defaultState),markPluginAsActive(player,this.name),this.dispose=this.dispose.bind(this),player.on("dispose",this.dispose)}var _proto=Plugin.prototype;return _proto.version=function(){return this.constructor.VERSION},_proto.getEventHash=function(hash){return void 0===hash&&(hash={}),hash.name=this.name,hash.plugin=this.constructor,hash.instance=this,hash},_proto.trigger=function(event,hash){return void 0===hash&&(hash={}),trigger(this.eventBusEl_,event,this.getEventHash(hash))},_proto.handleStateChanged=function(e){},_proto.dispose=function(){var name=this.name,player=this.player;this.trigger("dispose"),this.off(),player.off("dispose",this.dispose),player.activePlugins_[name]=!1,this.player=this.state=null,player[name]=createPluginFactory(name,pluginStorage[name])},Plugin.isBasic=function(plugin){var p="string"==typeof plugin?getPlugin(plugin):plugin;return"function"==typeof p&&!Plugin.prototype.isPrototypeOf(p.prototype)},Plugin.registerPlugin=function(name,plugin){if("string"!=typeof name)throw new Error('Illegal plugin name, "'+name+'", must be a string, was '+typeof name+".");if(pluginExists(name))log$1.warn('A plugin named "'+name+'" already exists. You may want to avoid re-registering plugins!');else if(Player.prototype.hasOwnProperty(name))throw new Error('Illegal plugin name, "'+name+'", cannot share a name with an existing player method!');if("function"!=typeof plugin)throw new Error('Illegal plugin for "'+name+'", must be a function, was '+typeof plugin+".");return pluginStorage[name]=plugin,"plugin"!==name&&(Player.prototype[name]=Plugin.isBasic(plugin)?function(name,plugin){var basicPluginWrapper=function(){triggerSetupEvent(this,{name:name,plugin:plugin,instance:null},!0);var instance=plugin.apply(this,arguments);return markPluginAsActive(this,name),triggerSetupEvent(this,{name:name,plugin:plugin,instance:instance}),instance};return Object.keys(plugin).forEach(function(prop){basicPluginWrapper[prop]=plugin[prop]}),basicPluginWrapper}(name,plugin):createPluginFactory(name,plugin)),plugin},Plugin.deregisterPlugin=function(name){if("plugin"===name)throw new Error("Cannot de-register base plugin.");pluginExists(name)&&(delete pluginStorage[name],delete Player.prototype[name])},Plugin.getPlugins=function(names){var result;return void 0===names&&(names=Object.keys(pluginStorage)),names.forEach(function(name){var plugin=getPlugin(name);plugin&&((result=result||{})[name]=plugin)}),result},Plugin.getPluginVersion=function(name){var plugin=getPlugin(name);return plugin&&plugin.VERSION||""},Plugin}();Plugin.getPlugin=getPlugin,Plugin.BASE_PLUGIN_NAME="plugin",Plugin.registerPlugin("plugin",Plugin),Player.prototype.usingPlugin=function(name){return!!this.activePlugins_&&!0===this.activePlugins_[name]},Player.prototype.hasPlugin=function(name){return!!pluginExists(name)};var normalizeId=function(id){return 0===id.indexOf("#")?id.slice(1):id};function videojs(id,options,ready){var player=videojs.getPlayer(id);if(player)return options&&log$1.warn('Player "'+id+'" is already initialised. Options will not be applied.'),ready&&player.ready(ready),player;var el="string"==typeof id?$("#"+normalizeId(id)):id;if(!isEl(el))throw new TypeError("The element or ID supplied is not valid. (videojs)");el.ownerDocument.defaultView&&el.ownerDocument.body.contains(el)||log$1.warn("The element supplied is not included in the DOM"),options=options||{},hooks("beforesetup").forEach(function(hookFunction){var opts=hookFunction(el,mergeOptions$3(options));video_es_isObject(opts)&&!Array.isArray(opts)?options=mergeOptions$3(options,opts):log$1.error("please return an object in beforesetup hooks")});var PlayerComponent=Component$1.getComponent("Player");return player=new PlayerComponent(el,options,ready),hooks("setup").forEach(function(hookFunction){return hookFunction(player)}),player}if(videojs.hooks_=hooks_,videojs.hooks=hooks,videojs.hook=function(type,fn){hooks(type,fn)},videojs.hookOnce=function(type,fn){hooks(type,[].concat(fn).map(function(original){return function wrapper(){return removeHook(type,wrapper),original.apply(void 0,arguments)}}))},videojs.removeHook=removeHook,!0!==window_default().VIDEOJS_NO_DYNAMIC_STYLE&&isReal()){var style=$(".vjs-styles-defaults");if(!style){style=createStyleElement("vjs-styles-defaults");var head=$("head");head&&head.insertBefore(style,head.firstChild),setTextContent(style,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ")}}autoSetupTimeout(1,videojs),videojs.VERSION="7.17.0",videojs.options=Player.prototype.options_,videojs.getPlayers=function(){return Player.players},videojs.getPlayer=function(id){var tag,players=Player.players;if("string"==typeof id){var nId=normalizeId(id),player=players[nId];if(player)return player;tag=$("#"+nId)}else tag=id;if(isEl(tag)){var _player=tag.player,playerId=tag.playerId;if(_player||players[playerId])return _player||players[playerId]}},videojs.getAllPlayers=function(){return Object.keys(Player.players).map(function(k){return Player.players[k]}).filter(Boolean)},videojs.players=Player.players,videojs.getComponent=Component$1.getComponent,videojs.registerComponent=function(name,comp){Tech.isTech(comp)&&log$1.warn("The "+name+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"),Component$1.registerComponent.call(Component$1,name,comp)},videojs.getTech=Tech.getTech,videojs.registerTech=Tech.registerTech,videojs.use=function(type,middleware){middlewares[type]=middlewares[type]||[],middlewares[type].push(middleware)},Object.defineProperty(videojs,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(videojs.middleware,"TERMINATOR",{value:TERMINATOR,writeable:!1,enumerable:!0}),videojs.browser=browser,videojs.TOUCH_ENABLED=TOUCH_ENABLED,videojs.extend=function(superClass,subClassMethods){void 0===subClassMethods&&(subClassMethods={});var subClass=function(){superClass.apply(this,arguments)},methods={};for(var name in"object"==typeof subClassMethods?(subClassMethods.constructor!==Object.prototype.constructor&&(subClass=subClassMethods.constructor),methods=subClassMethods):"function"==typeof subClassMethods&&(subClass=subClassMethods),inherits_default()(subClass,superClass),superClass&&(subClass.super_=superClass),methods)methods.hasOwnProperty(name)&&(subClass.prototype[name]=methods[name]);return subClass},videojs.mergeOptions=mergeOptions$3,videojs.bind=bind,videojs.registerPlugin=Plugin.registerPlugin,videojs.deregisterPlugin=Plugin.deregisterPlugin,videojs.plugin=function(name,plugin){return log$1.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),Plugin.registerPlugin(name,plugin)},videojs.getPlugins=Plugin.getPlugins,videojs.getPlugin=Plugin.getPlugin,videojs.getPluginVersion=Plugin.getPluginVersion,videojs.addLanguage=function(code,data){var _mergeOptions;return code=(""+code).toLowerCase(),(videojs.options.languages=mergeOptions$3(videojs.options.languages,((_mergeOptions={})[code]=data,_mergeOptions)))[code]},videojs.log=log$1,videojs.createLogger=createLogger,videojs.createTimeRange=videojs.createTimeRanges=createTimeRanges,videojs.formatTime=formatTime,videojs.setFormatTime=function(customImplementation){implementation=customImplementation},videojs.resetFormatTime=function(){implementation=defaultImplementation},videojs.parseUrl=parseUrl,videojs.isCrossOrigin=isCrossOrigin,videojs.EventTarget=EventTarget$2,videojs.on=on,videojs.one=one,videojs.off=off,videojs.trigger=trigger,videojs.xhr=lib_default(),videojs.TextTrack=TextTrack,videojs.AudioTrack=AudioTrack,videojs.VideoTrack=VideoTrack,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(function(k){videojs[k]=function(){return log$1.warn("videojs."+k+"() is deprecated; use videojs.dom."+k+"() instead"),Dom[k].apply(null,arguments)}}),videojs.computedStyle=computedStyle,videojs.dom=Dom,videojs.url=Url,videojs.defineLazyProperty=defineLazyProperty,videojs.addLanguage("en",{"Non-Fullscreen":"Exit Fullscreen"});
/*! @name @videojs/http-streaming @version 2.12.0 @license Apache-2.0 */
var video_es_resolveUrl=resolve_url,resolveManifestRedirect=function(handleManifestRedirect,url,req){return handleManifestRedirect&&req&&req.responseURL&&url!==req.responseURL?req.responseURL:url},logger=function(source){return videojs.log.debug?videojs.log.debug.bind(videojs,"VHS:",source+" >"):function(){}},filterRanges=function(timeRanges,predicate){var i,results=[];if(timeRanges&&timeRanges.length)for(i=0;i<timeRanges.length;i++)predicate(timeRanges.start(i),timeRanges.end(i))&&results.push([timeRanges.start(i),timeRanges.end(i)]);return videojs.createTimeRanges(results)},findRange=function(buffered,time){return filterRanges(buffered,function(start,end){return start-.1<=time&&end+.1>=time})},findNextRange=function(timeRanges,time){return filterRanges(timeRanges,function(start){return start-.03333333333333333>=time})},printableRange=function(range){var strArr=[];if(!range||!range.length)return"";for(var i=0;i<range.length;i++)strArr.push(range.start(i)+" => "+range.end(i));return strArr.join(", ")},timeRangesToArray=function(timeRanges){for(var timeRangesList=[],i=0;i<timeRanges.length;i++)timeRangesList.push({start:timeRanges.start(i),end:timeRanges.end(i)});return timeRangesList},lastBufferedEnd=function(a){if(a&&a.length&&a.end)return a.end(a.length-1)},timeAheadOf=function(range,startTime){var time=0;if(!range||!range.length)return time;for(var i=0;i<range.length;i++){var start=range.start(i),end=range.end(i);startTime>end||(time+=startTime>start&&startTime<=end?end-startTime:end-start)}return time},createTimeRange=videojs.createTimeRange,segmentDurationWithParts=function(playlist,segment){if(!segment.preload)return segment.duration;var result=0;return(segment.parts||[]).forEach(function(p){result+=p.duration}),(segment.preloadHints||[]).forEach(function(p){"PART"===p.type&&(result+=playlist.partTargetDuration)}),result},getPartsAndSegments=function(playlist){return(playlist.segments||[]).reduce(function(acc,segment,si){return segment.parts?segment.parts.forEach(function(part,pi){acc.push({duration:part.duration,segmentIndex:si,partIndex:pi,part:part,segment:segment})}):acc.push({duration:segment.duration,segmentIndex:si,partIndex:null,segment:segment,part:null}),acc},[])},getLastParts=function(media){var lastSegment=media.segments&&media.segments.length&&media.segments[media.segments.length-1];return lastSegment&&lastSegment.parts||[]},getKnownPartCount=function(_ref){var preloadSegment=_ref.preloadSegment;if(preloadSegment){var parts=preloadSegment.parts;return(preloadSegment.preloadHints||[]).reduce(function(count,hint){return count+("PART"===hint.type?1:0)},0)+(parts&&parts.length?parts.length:0)}},liveEdgeDelay=function(master,media){if(media.endList)return 0;if(master&&master.suggestedPresentationDelay)return master.suggestedPresentationDelay;var hasParts=getLastParts(media).length>0;return hasParts&&media.serverControl&&media.serverControl.partHoldBack?media.serverControl.partHoldBack:hasParts&&media.partTargetDuration?3*media.partTargetDuration:media.serverControl&&media.serverControl.holdBack?media.serverControl.holdBack:media.targetDuration?3*media.targetDuration:0},intervalDuration=function(playlist,endSequence,expired){if(void 0===endSequence&&(endSequence=playlist.mediaSequence+playlist.segments.length),endSequence<playlist.mediaSequence)return 0;var backward=function(playlist,endSequence){var result=0,i=endSequence-playlist.mediaSequence,segment=playlist.segments[i];if(segment){if(void 0!==segment.start)return{result:segment.start,precise:!0};if(void 0!==segment.end)return{result:segment.end-segment.duration,precise:!0}}for(;i--;){if(void 0!==(segment=playlist.segments[i]).end)return{result:result+segment.end,precise:!0};if(result+=segmentDurationWithParts(playlist,segment),void 0!==segment.start)return{result:result+segment.start,precise:!0}}return{result:result,precise:!1}}(playlist,endSequence);if(backward.precise)return backward.result;var forward=function(playlist,endSequence){for(var segment,result=0,i=endSequence-playlist.mediaSequence;i<playlist.segments.length;i++){if(void 0!==(segment=playlist.segments[i]).start)return{result:segment.start-result,precise:!0};if(result+=segmentDurationWithParts(playlist,segment),void 0!==segment.end)return{result:segment.end-result,precise:!0}}return{result:-1,precise:!1}}(playlist,endSequence);return forward.precise?forward.result:backward.result+expired},duration=function(playlist,endSequence,expired){if(!playlist)return 0;if("number"!=typeof expired&&(expired=0),void 0===endSequence){if(playlist.totalDuration)return playlist.totalDuration;if(!playlist.endList)return window_default()[1/0]}return intervalDuration(playlist,endSequence,expired)},sumDurations=function(_ref2){var defaultDuration=_ref2.defaultDuration,durationList=_ref2.durationList,startIndex=_ref2.startIndex,endIndex=_ref2.endIndex,durations=0;if(startIndex>endIndex){var _ref3=[endIndex,startIndex];startIndex=_ref3[0],endIndex=_ref3[1]}if(startIndex<0){for(var i=startIndex;i<Math.min(0,endIndex);i++)durations+=defaultDuration;startIndex=0}for(var _i=startIndex;_i<endIndex;_i++)durations+=durationList[_i].duration;return durations},playlistEnd=function(playlist,expired,useSafeLiveEnd,liveEdgePadding){if(!playlist||!playlist.segments)return null;if(playlist.endList)return duration(playlist);if(null===expired)return null;var lastSegmentEndTime=intervalDuration(playlist,playlist.mediaSequence+playlist.segments.length,expired=expired||0);return useSafeLiveEnd&&(lastSegmentEndTime-=liveEdgePadding="number"==typeof liveEdgePadding?liveEdgePadding:liveEdgeDelay(null,playlist)),Math.max(0,lastSegmentEndTime)},isBlacklisted=function(playlist){return playlist.excludeUntil&&playlist.excludeUntil>Date.now()},isIncompatible=function(playlist){return playlist.excludeUntil&&playlist.excludeUntil===1/0},isEnabled=function(playlist){var blacklisted=isBlacklisted(playlist);return!playlist.disabled&&!blacklisted},hasAttribute=function(attr,playlist){return playlist.attributes&&playlist.attributes[attr]},isLowestEnabledRendition=function(master,media){if(1===master.playlists.length)return!0;var currentBandwidth=media.attributes.BANDWIDTH||Number.MAX_VALUE;return 0===master.playlists.filter(function(playlist){return!!isEnabled(playlist)&&(playlist.attributes.BANDWIDTH||0)<currentBandwidth}).length},playlistMatch=function(a,b){return!(!a&&!b||!a&&b||a&&!b||a!==b&&(!a.id||!b.id||a.id!==b.id)&&(!a.resolvedUri||!b.resolvedUri||a.resolvedUri!==b.resolvedUri)&&(!a.uri||!b.uri||a.uri!==b.uri))},someAudioVariant=function(master,callback){var AUDIO=master&&master.mediaGroups&&master.mediaGroups.AUDIO||{},found=!1;for(var groupName in AUDIO){for(var label in AUDIO[groupName])if(found=callback(AUDIO[groupName][label]))break;if(found)break}return!!found},isAudioOnly=function(master){if(!master||!master.playlists||!master.playlists.length)return someAudioVariant(master,function(variant){return variant.playlists&&variant.playlists.length||variant.uri});for(var _loop=function(i){var playlist=master.playlists[i],CODECS=playlist.attributes&&playlist.attributes.CODECS;return CODECS&&CODECS.split(",").every(function(c){return isAudioCodec(c)})||someAudioVariant(master,function(variant){return playlistMatch(playlist,variant)})?"continue":{v:!1}},i=0;i<master.playlists.length;i++){var _ret=_loop(i);if("continue"!==_ret&&"object"==typeof _ret)return _ret.v}return!0},Playlist={liveEdgeDelay:liveEdgeDelay,duration:duration,seekable:function(playlist,expired,liveEdgePadding){var seekableStart=expired||0,seekableEnd=playlistEnd(playlist,expired,!0,liveEdgePadding);return null===seekableEnd?createTimeRange():createTimeRange(seekableStart,seekableEnd)},getMediaInfoForTime:function(_ref4){for(var playlist=_ref4.playlist,currentTime=_ref4.currentTime,startingSegmentIndex=_ref4.startingSegmentIndex,startingPartIndex=_ref4.startingPartIndex,startTime=_ref4.startTime,experimentalExactManifestTimings=_ref4.experimentalExactManifestTimings,time=currentTime-startTime,partsAndSegments=getPartsAndSegments(playlist),startIndex=0,i=0;i<partsAndSegments.length;i++){var partAndSegment=partsAndSegments[i];if(startingSegmentIndex===partAndSegment.segmentIndex&&("number"!=typeof startingPartIndex||"number"!=typeof partAndSegment.partIndex||startingPartIndex===partAndSegment.partIndex)){startIndex=i;break}}if(time<0){if(startIndex>0)for(var _i2=startIndex-1;_i2>=0;_i2--){var _partAndSegment=partsAndSegments[_i2];if(time+=_partAndSegment.duration,experimentalExactManifestTimings){if(time<0)continue}else if(time+.03333333333333333<=0)continue;return{partIndex:_partAndSegment.partIndex,segmentIndex:_partAndSegment.segmentIndex,startTime:startTime-sumDurations({defaultDuration:playlist.targetDuration,durationList:partsAndSegments,startIndex:startIndex,endIndex:_i2})}}return{partIndex:partsAndSegments[0]&&partsAndSegments[0].partIndex||null,segmentIndex:partsAndSegments[0]&&partsAndSegments[0].segmentIndex||0,startTime:currentTime}}if(startIndex<0){for(var _i3=startIndex;_i3<0;_i3++)if((time-=playlist.targetDuration)<0)return{partIndex:partsAndSegments[0]&&partsAndSegments[0].partIndex||null,segmentIndex:partsAndSegments[0]&&partsAndSegments[0].segmentIndex||0,startTime:currentTime};startIndex=0}for(var _i4=startIndex;_i4<partsAndSegments.length;_i4++){var _partAndSegment2=partsAndSegments[_i4];if(time-=_partAndSegment2.duration,experimentalExactManifestTimings){if(time>0)continue}else if(time-.03333333333333333>=0)continue;return{partIndex:_partAndSegment2.partIndex,segmentIndex:_partAndSegment2.segmentIndex,startTime:startTime+sumDurations({defaultDuration:playlist.targetDuration,durationList:partsAndSegments,startIndex:startIndex,endIndex:_i4})}}return{segmentIndex:partsAndSegments[partsAndSegments.length-1].segmentIndex,partIndex:partsAndSegments[partsAndSegments.length-1].partIndex,startTime:currentTime}},isEnabled:isEnabled,isDisabled:function(playlist){return playlist.disabled},isBlacklisted:isBlacklisted,isIncompatible:isIncompatible,playlistEnd:playlistEnd,isAes:function(media){for(var i=0;i<media.segments.length;i++)if(media.segments[i].key)return!0;return!1},hasAttribute:hasAttribute,estimateSegmentRequestTime:function(segmentDuration,bandwidth,playlist,bytesReceived){return void 0===bytesReceived&&(bytesReceived=0),hasAttribute("BANDWIDTH",playlist)?(segmentDuration*playlist.attributes.BANDWIDTH-8*bytesReceived)/bandwidth:NaN},isLowestEnabledRendition:isLowestEnabledRendition,isAudioOnly:isAudioOnly,playlistMatch:playlistMatch,segmentDurationWithParts:segmentDurationWithParts},log=videojs.log,createPlaylistID=function(index,uri){return index+"-"+uri},forEachMediaGroup=function(master,callback){master.mediaGroups&&["AUDIO","SUBTITLES"].forEach(function(mediaType){if(master.mediaGroups[mediaType])for(var groupKey in master.mediaGroups[mediaType])for(var labelKey in master.mediaGroups[mediaType][groupKey])callback(master.mediaGroups[mediaType][groupKey][labelKey],mediaType,groupKey,labelKey)})},setupMediaPlaylist=function(_ref2){var playlist=_ref2.playlist,uri=_ref2.uri;playlist.id=_ref2.id,playlist.playlistErrors_=0,uri&&(playlist.uri=uri),playlist.attributes=playlist.attributes||{}},addPropertiesToMaster=function(master,uri){master.uri=uri;for(var i=0;i<master.playlists.length;i++)master.playlists[i].uri||(master.playlists[i].uri="placeholder-uri-"+i);var audioOnlyMaster=isAudioOnly(master);forEachMediaGroup(master,function(properties,mediaType,groupKey,labelKey){var groupId="placeholder-uri-"+mediaType+"-"+groupKey+"-"+labelKey;if(!properties.playlists||!properties.playlists.length){if(audioOnlyMaster&&"AUDIO"===mediaType&&!properties.uri)for(var _i=0;_i<master.playlists.length;_i++){var p=master.playlists[_i];if(p.attributes&&p.attributes.AUDIO&&p.attributes.AUDIO===groupKey)return}properties.playlists=[extends_default()({},properties)]}properties.playlists.forEach(function(p,i){var id=createPlaylistID(i,groupId);p.uri?p.resolvedUri=p.resolvedUri||video_es_resolveUrl(master.uri,p.uri):(p.uri=0===i?groupId:id,p.resolvedUri=p.uri),p.id=p.id||id,p.attributes=p.attributes||{},master.playlists[p.id]=p,master.playlists[p.uri]=p})}),function(master){for(var i=master.playlists.length;i--;){var playlist=master.playlists[i];setupMediaPlaylist({playlist:playlist,id:createPlaylistID(i,playlist.uri)}),playlist.resolvedUri=video_es_resolveUrl(master.uri,playlist.uri),master.playlists[playlist.id]=playlist,master.playlists[playlist.uri]=playlist,playlist.attributes.BANDWIDTH||log.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}}(master),function(master){forEachMediaGroup(master,function(properties){properties.uri&&(properties.resolvedUri=video_es_resolveUrl(master.uri,properties.uri))})}(master)},mergeOptions$2=videojs.mergeOptions,updateSegment=function(a,b){if(!a)return b;var result=mergeOptions$2(a,b);if(a.preloadHints&&!b.preloadHints&&delete result.preloadHints,a.parts&&!b.parts)delete result.parts;else if(a.parts&&b.parts)for(var i=0;i<b.parts.length;i++)a.parts&&a.parts[i]&&(result.parts[i]=mergeOptions$2(a.parts[i],b.parts[i]));return!a.skipped&&b.skipped&&(result.skipped=!1),a.preload&&!b.preload&&(result.preload=!1),result},resolveSegmentUris=function(segment,baseUri){!segment.resolvedUri&&segment.uri&&(segment.resolvedUri=video_es_resolveUrl(baseUri,segment.uri)),segment.key&&!segment.key.resolvedUri&&(segment.key.resolvedUri=video_es_resolveUrl(baseUri,segment.key.uri)),segment.map&&!segment.map.resolvedUri&&(segment.map.resolvedUri=video_es_resolveUrl(baseUri,segment.map.uri)),segment.map&&segment.map.key&&!segment.map.key.resolvedUri&&(segment.map.key.resolvedUri=video_es_resolveUrl(baseUri,segment.map.key.uri)),segment.parts&&segment.parts.length&&segment.parts.forEach(function(p){p.resolvedUri||(p.resolvedUri=video_es_resolveUrl(baseUri,p.uri))}),segment.preloadHints&&segment.preloadHints.length&&segment.preloadHints.forEach(function(p){p.resolvedUri||(p.resolvedUri=video_es_resolveUrl(baseUri,p.uri))})},getAllSegments=function(media){var segments=media.segments||[],preloadSegment=media.preloadSegment;if(preloadSegment&&preloadSegment.parts&&preloadSegment.parts.length){if(preloadSegment.preloadHints)for(var i=0;i<preloadSegment.preloadHints.length;i++)if("MAP"===preloadSegment.preloadHints[i].type)return segments;preloadSegment.duration=media.targetDuration,preloadSegment.preload=!0,segments.push(preloadSegment)}return segments},isPlaylistUnchanged=function(a,b){return a===b||a.segments&&b.segments&&a.segments.length===b.segments.length&&a.endList===b.endList&&a.mediaSequence===b.mediaSequence&&a.preloadSegment===b.preloadSegment},updateMaster$1=function(master,newMedia,unchangedCheck){void 0===unchangedCheck&&(unchangedCheck=isPlaylistUnchanged);var result=mergeOptions$2(master,{}),oldMedia=result.playlists[newMedia.id];if(!oldMedia)return null;if(unchangedCheck(oldMedia,newMedia))return null;newMedia.segments=getAllSegments(newMedia);var mergedPlaylist=mergeOptions$2(oldMedia,newMedia);if(mergedPlaylist.preloadSegment&&!newMedia.preloadSegment&&delete mergedPlaylist.preloadSegment,oldMedia.segments){if(newMedia.skip){newMedia.segments=newMedia.segments||[];for(var i=0;i<newMedia.skip.skippedSegments;i++)newMedia.segments.unshift({skipped:!0})}mergedPlaylist.segments=function(original,update,offset){var oldSegments=original.slice(),newSegments=update.slice();offset=offset||0;for(var currentMap,result=[],newIndex=0;newIndex<newSegments.length;newIndex++){var oldSegment=oldSegments[newIndex+offset],newSegment=newSegments[newIndex];oldSegment?(currentMap=oldSegment.map||currentMap,result.push(updateSegment(oldSegment,newSegment))):(currentMap&&!newSegment.map&&(newSegment.map=currentMap),result.push(newSegment))}return result}(oldMedia.segments,newMedia.segments,newMedia.mediaSequence-oldMedia.mediaSequence)}mergedPlaylist.segments.forEach(function(segment){resolveSegmentUris(segment,mergedPlaylist.resolvedUri)});for(var _i=0;_i<result.playlists.length;_i++)result.playlists[_i].id===newMedia.id&&(result.playlists[_i]=mergedPlaylist);return result.playlists[newMedia.id]=mergedPlaylist,result.playlists[newMedia.uri]=mergedPlaylist,forEachMediaGroup(master,function(properties,mediaType,groupKey,labelKey){if(properties.playlists)for(var _i2=0;_i2<properties.playlists.length;_i2++)newMedia.id===properties.playlists[_i2].id&&(properties.playlists[_i2]=newMedia)}),result},refreshDelay=function(media,update){var segments=media.segments||[],lastSegment=segments[segments.length-1],lastPart=lastSegment&&lastSegment.parts&&lastSegment.parts[lastSegment.parts.length-1],lastDuration=lastPart&&lastPart.duration||lastSegment&&lastSegment.duration;return update&&lastDuration?1e3*lastDuration:500*(media.partTargetDuration||media.targetDuration||10)},PlaylistLoader=function(_EventTarget){function PlaylistLoader(src,vhs,options){var _this;if(void 0===options&&(options={}),_this=_EventTarget.call(this)||this,!src)throw new Error("A non-empty playlist URL or object is required");_this.logger_=logger("PlaylistLoader");var _options$withCredenti=options.withCredentials,withCredentials=void 0!==_options$withCredenti&&_options$withCredenti,_options$handleManife=options.handleManifestRedirects,handleManifestRedirects=void 0!==_options$handleManife&&_options$handleManife;_this.src=src,_this.vhs_=vhs,_this.withCredentials=withCredentials,_this.handleManifestRedirects=handleManifestRedirects;var vhsOptions=vhs.options_;return _this.customTagParsers=vhsOptions&&vhsOptions.customTagParsers||[],_this.customTagMappers=vhsOptions&&vhsOptions.customTagMappers||[],_this.experimentalLLHLS=vhsOptions&&vhsOptions.experimentalLLHLS||!1,videojs.browser.IE_VERSION&&(_this.experimentalLLHLS=!1),_this.state="HAVE_NOTHING",_this.handleMediaupdatetimeout_=_this.handleMediaupdatetimeout_.bind(assertThisInitialized_default()(_this)),_this.on("mediaupdatetimeout",_this.handleMediaupdatetimeout_),_this}inheritsLoose_default()(PlaylistLoader,_EventTarget);var _proto=PlaylistLoader.prototype;return _proto.handleMediaupdatetimeout_=function(){var _this2=this;if("HAVE_METADATA"===this.state){var media=this.media(),uri=video_es_resolveUrl(this.master.uri,media.uri);this.experimentalLLHLS&&(uri=function(uri,media){if(media.endList||!media.serverControl)return uri;var parameters={};if(media.serverControl.canBlockReload){var preloadSegment=media.preloadSegment,nextMSN=media.mediaSequence+media.segments.length;if(preloadSegment){var parts=preloadSegment.parts||[],nextPart=getKnownPartCount(media)-1;nextPart>-1&&nextPart!==parts.length-1&&(parameters._HLS_part=nextPart),(nextPart>-1||parts.length)&&nextMSN--}parameters._HLS_msn=nextMSN}if(media.serverControl&&media.serverControl.canSkipUntil&&(parameters._HLS_skip=media.serverControl.canSkipDateranges?"v2":"YES"),Object.keys(parameters).length){var parsedUri=new(window_default().URL)(uri);["_HLS_skip","_HLS_msn","_HLS_part"].forEach(function(name){parameters.hasOwnProperty(name)&&parsedUri.searchParams.set(name,parameters[name])}),uri=parsedUri.toString()}return uri}(uri,media)),this.state="HAVE_CURRENT_METADATA",this.request=this.vhs_.xhr({uri:uri,withCredentials:this.withCredentials},function(error,req){if(_this2.request)return error?_this2.playlistRequestError(_this2.request,_this2.media(),"HAVE_METADATA"):void _this2.haveMetadata({playlistString:_this2.request.responseText,url:_this2.media().uri,id:_this2.media().id})})}},_proto.playlistRequestError=function(xhr,playlist,startingState){var uri=playlist.uri,id=playlist.id;this.request=null,startingState&&(this.state=startingState),this.error={playlist:this.master.playlists[id],status:xhr.status,message:"HLS playlist request error at URL: "+uri+".",responseText:xhr.responseText,code:xhr.status>=500?4:2},this.trigger("error")},_proto.parseManifest_=function(_ref){var _this3=this,url=_ref.url;return function(_ref){var onwarn=_ref.onwarn,oninfo=_ref.oninfo,manifestString=_ref.manifestString,_ref$customTagParsers=_ref.customTagParsers,customTagParsers=void 0===_ref$customTagParsers?[]:_ref$customTagParsers,_ref$customTagMappers=_ref.customTagMappers,customTagMappers=void 0===_ref$customTagMappers?[]:_ref$customTagMappers,experimentalLLHLS=_ref.experimentalLLHLS,parser=new Parser;onwarn&&parser.on("warn",onwarn),oninfo&&parser.on("info",oninfo),customTagParsers.forEach(function(customParser){return parser.addParser(customParser)}),customTagMappers.forEach(function(mapper){return parser.addTagMapper(mapper)}),parser.push(manifestString),parser.end();var manifest=parser.manifest;if(experimentalLLHLS||(["preloadSegment","skip","serverControl","renditionReports","partInf","partTargetDuration"].forEach(function(k){manifest.hasOwnProperty(k)&&delete manifest[k]}),manifest.segments&&manifest.segments.forEach(function(segment){["parts","preloadHints"].forEach(function(k){segment.hasOwnProperty(k)&&delete segment[k]})})),!manifest.targetDuration){var targetDuration=10;manifest.segments&&manifest.segments.length&&(targetDuration=manifest.segments.reduce(function(acc,s){return Math.max(acc,s.duration)},0)),onwarn&&onwarn("manifest has no targetDuration defaulting to "+targetDuration),manifest.targetDuration=targetDuration}var parts=getLastParts(manifest);if(parts.length&&!manifest.partTargetDuration){var partTargetDuration=parts.reduce(function(acc,p){return Math.max(acc,p.duration)},0);onwarn&&(onwarn("manifest has no partTargetDuration defaulting to "+partTargetDuration),log.error("LL-HLS manifest has parts but lacks required #EXT-X-PART-INF:PART-TARGET value. See https://datatracker.ietf.org/doc/html/draft-pantos-hls-rfc8216bis-09#section-4.4.3.7. Playback is not guaranteed.")),manifest.partTargetDuration=partTargetDuration}return manifest}({onwarn:function(_ref2){return _this3.logger_("m3u8-parser warn for "+url+": "+_ref2.message)},oninfo:function(_ref3){return _this3.logger_("m3u8-parser info for "+url+": "+_ref3.message)},manifestString:_ref.manifestString,customTagParsers:this.customTagParsers,customTagMappers:this.customTagMappers,experimentalLLHLS:this.experimentalLLHLS})},_proto.haveMetadata=function(_ref4){var playlistString=_ref4.playlistString,playlistObject=_ref4.playlistObject,url=_ref4.url,id=_ref4.id;this.request=null,this.state="HAVE_METADATA";var playlist=playlistObject||this.parseManifest_({url:url,manifestString:playlistString});playlist.lastRequest=Date.now(),setupMediaPlaylist({playlist:playlist,uri:url,id:id});var update=updateMaster$1(this.master,playlist);this.targetDuration=playlist.partTargetDuration||playlist.targetDuration,this.pendingMedia_=null,update?(this.master=update,this.media_=this.master.playlists[id]):this.trigger("playlistunchanged"),this.updateMediaUpdateTimeout_(refreshDelay(this.media(),!!update)),this.trigger("loadedplaylist")},_proto.dispose=function(){this.trigger("dispose"),this.stopRequest(),window_default().clearTimeout(this.mediaUpdateTimeout),window_default().clearTimeout(this.finalRenditionTimeout),this.off()},_proto.stopRequest=function(){if(this.request){var oldRequest=this.request;this.request=null,oldRequest.onreadystatechange=null,oldRequest.abort()}},_proto.media=function(playlist,shouldDelay){var _this4=this;if(!playlist)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);if("string"==typeof playlist){if(!this.master.playlists[playlist])throw new Error("Unknown playlist URI: "+playlist);playlist=this.master.playlists[playlist]}if(window_default().clearTimeout(this.finalRenditionTimeout),shouldDelay){var delay=(playlist.partTargetDuration||playlist.targetDuration)/2*1e3||5e3;this.finalRenditionTimeout=window_default().setTimeout(this.media.bind(this,playlist,!1),delay)}else{var startingState=this.state,mediaChange=!this.media_||playlist.id!==this.media_.id,masterPlaylistRef=this.master.playlists[playlist.id];if(masterPlaylistRef&&masterPlaylistRef.endList||playlist.endList&&playlist.segments.length)return this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=playlist,void(mediaChange&&(this.trigger("mediachanging"),this.trigger("HAVE_MASTER"===startingState?"loadedmetadata":"mediachange")));if(this.updateMediaUpdateTimeout_(refreshDelay(playlist,!0)),mediaChange){if(this.state="SWITCHING_MEDIA",this.request){if(playlist.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.pendingMedia_=playlist,this.request=this.vhs_.xhr({uri:playlist.resolvedUri,withCredentials:this.withCredentials},function(error,req){if(_this4.request){if(playlist.lastRequest=Date.now(),playlist.resolvedUri=resolveManifestRedirect(_this4.handleManifestRedirects,playlist.resolvedUri,req),error)return _this4.playlistRequestError(_this4.request,playlist,startingState);_this4.haveMetadata({playlistString:req.responseText,url:playlist.uri,id:playlist.id}),_this4.trigger("HAVE_MASTER"===startingState?"loadedmetadata":"mediachange")}})}}},_proto.pause=function(){this.mediaUpdateTimeout&&(window_default().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.stopRequest(),"HAVE_NOTHING"===this.state&&(this.started=!1),"SWITCHING_MEDIA"===this.state?this.state=this.media_?"HAVE_METADATA":"HAVE_MASTER":"HAVE_CURRENT_METADATA"===this.state&&(this.state="HAVE_METADATA")},_proto.load=function(shouldDelay){var _this5=this;this.mediaUpdateTimeout&&(window_default().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null);var media=this.media();if(shouldDelay){var delay=media?(media.partTargetDuration||media.targetDuration)/2*1e3:5e3;this.mediaUpdateTimeout=window_default().setTimeout(function(){_this5.mediaUpdateTimeout=null,_this5.load()},delay)}else this.started?this.trigger(media&&!media.endList?"mediaupdatetimeout":"loadedplaylist"):this.start()},_proto.updateMediaUpdateTimeout_=function(delay){var _this6=this;this.mediaUpdateTimeout&&(window_default().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.media()&&!this.media().endList&&(this.mediaUpdateTimeout=window_default().setTimeout(function(){_this6.mediaUpdateTimeout=null,_this6.trigger("mediaupdatetimeout"),_this6.updateMediaUpdateTimeout_(delay)},delay))},_proto.start=function(){var _this7=this;if(this.started=!0,"object"==typeof this.src)return this.src.uri||(this.src.uri=window_default().location.href),this.src.resolvedUri=this.src.uri,void setTimeout(function(){_this7.setupInitialPlaylist(_this7.src)},0);this.request=this.vhs_.xhr({uri:this.src,withCredentials:this.withCredentials},function(error,req){if(_this7.request){if(_this7.request=null,error)return _this7.error={status:req.status,message:"HLS playlist request error at URL: "+_this7.src+".",responseText:req.responseText,code:2},"HAVE_NOTHING"===_this7.state&&(_this7.started=!1),_this7.trigger("error");_this7.src=resolveManifestRedirect(_this7.handleManifestRedirects,_this7.src,req);var manifest=_this7.parseManifest_({manifestString:req.responseText,url:_this7.src});_this7.setupInitialPlaylist(manifest)}})},_proto.srcUri=function(){return"string"==typeof this.src?this.src:this.src.uri},_proto.setupInitialPlaylist=function(manifest){if(this.state="HAVE_MASTER",manifest.playlists)return this.master=manifest,addPropertiesToMaster(this.master,this.srcUri()),manifest.playlists.forEach(function(playlist){playlist.segments=getAllSegments(playlist),playlist.segments.forEach(function(segment){resolveSegmentUris(segment,playlist.resolvedUri)})}),this.trigger("loadedplaylist"),void(this.request||this.media(this.master.playlists[0]));var uri=this.srcUri()||window_default().location.href;this.master=function(media,uri){var id=createPlaylistID(0,uri),master={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:window_default().location.href,resolvedUri:window_default().location.href,playlists:[{uri:uri,id:id,resolvedUri:uri,attributes:{}}]};return master.playlists[id]=master.playlists[0],master.playlists[uri]=master.playlists[0],master}(0,uri),this.haveMetadata({playlistObject:manifest,url:uri,id:this.master.playlists[0].id}),this.trigger("loadedmetadata")},PlaylistLoader}(videojs.EventTarget),videojsXHR=videojs.xhr,mergeOptions$1=videojs.mergeOptions,callbackWrapper=function(request,error,response,callback){var reqResponse="arraybuffer"===request.responseType?request.response:request.responseText;!error&&reqResponse&&(request.responseTime=Date.now(),request.roundTripTime=request.responseTime-request.requestTime,request.bytesReceived=reqResponse.byteLength||reqResponse.length,request.bandwidth||(request.bandwidth=Math.floor(request.bytesReceived/request.roundTripTime*8*1e3))),response.headers&&(request.responseHeaders=response.headers),error&&"ETIMEDOUT"===error.code&&(request.timedout=!0),error||request.aborted||200===response.statusCode||206===response.statusCode||0===response.statusCode||(error=new Error("XHR Failed with a response of: "+(request&&(reqResponse||request.responseText)))),callback(error,request)},xhrFactory=function(){var xhr=function XhrFunction(options,callback){options=mergeOptions$1({timeout:45e3},options);var beforeRequest=XhrFunction.beforeRequest||videojs.Vhs.xhr.beforeRequest;if(beforeRequest&&"function"==typeof beforeRequest){var newOptions=beforeRequest(options);newOptions&&(options=newOptions)}var request=(!0===videojs.Vhs.xhr.original?videojsXHR:videojs.Vhs.xhr)(options,function(error,response){return callbackWrapper(request,error,response,callback)}),originalAbort=request.abort;return request.abort=function(){return request.aborted=!0,originalAbort.apply(request,arguments)},request.uri=options.uri,request.requestTime=Date.now(),request};return xhr.original=!0,xhr},segmentXhrHeaders=function(segment){var byterange,headers={};return segment.byterange&&(headers.Range="bytes="+(byterange=segment.byterange).offset+"-"+(byterange.offset+byterange.length-1)),headers},textRange=function(range,i){return range.start(i)+"-"+range.end(i)},formatHexString=function(e,i){var value=e.toString(16);return"00".substring(0,2-value.length)+value+(i%2?" ":"")},formatAsciiString=function(e){return e>=32&&e<126?String.fromCharCode(e):"."},createTransferableMessage=function(message){var transferable={};return Object.keys(message).forEach(function(key){var value=message[key];transferable[key]=ArrayBuffer.isView(value)?{bytes:value.buffer,byteOffset:value.byteOffset,byteLength:value.byteLength}:value}),transferable},initSegmentId=function(initSegment){var byterange=initSegment.byterange||{length:1/0,offset:0};return[byterange.length,byterange.offset,initSegment.resolvedUri].join(",")},segmentKeyId=function(key){return key.resolvedUri},hexDump=function(data){for(var bytes=Array.prototype.slice.call(data),result="",j=0;j<bytes.length/16;j++)result+=bytes.slice(16*j,16*j+16).map(formatHexString).join("")+" "+bytes.slice(16*j,16*j+16).map(formatAsciiString).join("")+"\n";return result},utils=Object.freeze({__proto__:null,createTransferableMessage:createTransferableMessage,initSegmentId:initSegmentId,segmentKeyId:segmentKeyId,hexDump:hexDump,tagDump:function(_ref){return hexDump(_ref.bytes)},textRanges:function(ranges){var i,result="";for(i=0;i<ranges.length;i++)result+=textRange(ranges,i)+" ";return result}}),seekToProgramTime=function seekToProgramTime(_ref2){var programTime=_ref2.programTime,playlist=_ref2.playlist,_ref2$retryCount=_ref2.retryCount,retryCount=void 0===_ref2$retryCount?2:_ref2$retryCount,seekTo=_ref2.seekTo,_ref2$pauseAfterSeek=_ref2.pauseAfterSeek,pauseAfterSeek=void 0===_ref2$pauseAfterSeek||_ref2$pauseAfterSeek,tech=_ref2.tech,callback=_ref2.callback;if(!callback)throw new Error("seekToProgramTime: callback must be provided");if(void 0===programTime||!playlist||!seekTo)return callback({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!playlist.endList&&!tech.hasStarted_)return callback({message:"player must be playing a live stream to start buffering"});if(!function(playlist){if(!playlist.segments||0===playlist.segments.length)return!1;for(var i=0;i<playlist.segments.length;i++)if(!playlist.segments[i].dateTimeObject)return!1;return!0}(playlist))return callback({message:"programDateTime tags must be provided in the manifest "+playlist.resolvedUri});var matchedSegment=function(programTime,playlist){var dateTimeObject;try{dateTimeObject=new Date(programTime)}catch(e){return null}if(!playlist||!playlist.segments||0===playlist.segments.length)return null;var segment=playlist.segments[0];if(dateTimeObject<segment.dateTimeObject)return null;for(var i=0;i<playlist.segments.length-1&&(segment=playlist.segments[i],!(dateTimeObject<playlist.segments[i+1].dateTimeObject));i++);var videoTimingInfo,lastSegment=playlist.segments[playlist.segments.length-1],lastSegmentStart=lastSegment.dateTimeObject,lastSegmentDuration=lastSegment.videoTimingInfo?(videoTimingInfo=lastSegment.videoTimingInfo).transmuxedPresentationEnd-videoTimingInfo.transmuxedPresentationStart-videoTimingInfo.transmuxerPrependedSeconds:lastSegment.duration+.25*lastSegment.duration;return dateTimeObject>new Date(lastSegmentStart.getTime()+1e3*lastSegmentDuration)?null:(dateTimeObject>lastSegmentStart&&(segment=lastSegment),{segment:segment,estimatedStart:segment.videoTimingInfo?segment.videoTimingInfo.transmuxedPresentationStart:Playlist.duration(playlist,playlist.mediaSequence+playlist.segments.indexOf(segment)),type:segment.videoTimingInfo?"accurate":"estimate"})}(programTime,playlist);if(!matchedSegment)return callback({message:programTime+" was not found in the stream"});var segment=matchedSegment.segment,mediaOffset=function(comparisonTimeStamp,programTime){var segmentDateTime,programDateTime;try{segmentDateTime=new Date(comparisonTimeStamp),programDateTime=new Date(programTime)}catch(e){}var segmentTimeEpoch=segmentDateTime.getTime();return(programDateTime.getTime()-segmentTimeEpoch)/1e3}(segment.dateTimeObject,programTime);if("estimate"===matchedSegment.type)return 0===retryCount?callback({message:programTime+" is not buffered yet. Try again"}):(seekTo(matchedSegment.estimatedStart+mediaOffset),void tech.one("seeked",function(){seekToProgramTime({programTime:programTime,playlist:playlist,retryCount:retryCount-1,seekTo:seekTo,pauseAfterSeek:pauseAfterSeek,tech:tech,callback:callback})}));var seekToTime=segment.start+mediaOffset;tech.one("seeked",function(){return callback(null,tech.currentTime())}),pauseAfterSeek&&tech.pause(),seekTo(seekToTime)},callbackOnCompleted=function(request,cb){if(4===request.readyState)return cb()},mergeOptions=videojs.mergeOptions,dashPlaylistUnchanged=function(a,b){if(!isPlaylistUnchanged(a,b))return!1;if(a.sidx&&b.sidx&&(a.sidx.offset!==b.sidx.offset||a.sidx.length!==b.sidx.length))return!1;if(!a.sidx&&b.sidx||a.sidx&&!b.sidx)return!1;if(a.segments&&!b.segments||!a.segments&&b.segments)return!1;if(!a.segments&&!b.segments)return!0;for(var i=0;i<a.segments.length;i++){var aSegment=a.segments[i],bSegment=b.segments[i];if(aSegment.uri!==bSegment.uri)return!1;if(aSegment.byterange||bSegment.byterange){var aByterange=aSegment.byterange,bByterange=bSegment.byterange;if(aByterange&&!bByterange||!aByterange&&bByterange)return!1;if(aByterange.offset!==bByterange.offset||aByterange.length!==bByterange.length)return!1}}return!0},equivalentSidx=function(a,b){return(Boolean(!a.map&&!b.map)||Boolean(a.map&&b.map&&a.map.byterange.offset===b.map.byterange.offset&&a.map.byterange.length===b.map.byterange.length))&&a.uri===b.uri&&a.byterange.offset===b.byterange.offset&&a.byterange.length===b.byterange.length},compareSidxEntry=function(playlists,oldSidxMapping){var newSidxMapping={};for(var id in playlists){var currentSidxInfo=playlists[id].sidx;if(currentSidxInfo){var key=generateSidxKey(currentSidxInfo);if(!oldSidxMapping[key])break;equivalentSidx(oldSidxMapping[key].sidxInfo,currentSidxInfo)&&(newSidxMapping[key]=oldSidxMapping[key])}}return newSidxMapping},DashPlaylistLoader=function(_EventTarget){function DashPlaylistLoader(srcUrlOrPlaylist,vhs,options,masterPlaylistLoader){var _this;void 0===options&&(options={}),(_this=_EventTarget.call(this)||this).masterPlaylistLoader_=masterPlaylistLoader||assertThisInitialized_default()(_this),masterPlaylistLoader||(_this.isMaster_=!0);var _options$withCredenti=options.withCredentials,withCredentials=void 0!==_options$withCredenti&&_options$withCredenti,_options$handleManife=options.handleManifestRedirects,handleManifestRedirects=void 0!==_options$handleManife&&_options$handleManife;if(_this.vhs_=vhs,_this.withCredentials=withCredentials,_this.handleManifestRedirects=handleManifestRedirects,!srcUrlOrPlaylist)throw new Error("A non-empty playlist URL or object is required");return _this.on("minimumUpdatePeriod",function(){_this.refreshXml_()}),_this.on("mediaupdatetimeout",function(){_this.refreshMedia_(_this.media().id)}),_this.state="HAVE_NOTHING",_this.loadedPlaylists_={},_this.logger_=logger("DashPlaylistLoader"),_this.isMaster_?(_this.masterPlaylistLoader_.srcUrl=srcUrlOrPlaylist,_this.masterPlaylistLoader_.sidxMapping_={}):_this.childPlaylist_=srcUrlOrPlaylist,_this}inheritsLoose_default()(DashPlaylistLoader,_EventTarget);var _proto=DashPlaylistLoader.prototype;return _proto.requestErrored_=function(err,request,startingState){return!this.request||(this.request=null,err?(this.error="object"!=typeof err||err instanceof Error?{status:request.status,message:"DASH request error at URL: "+request.uri,response:request.response,code:2}:err,startingState&&(this.state=startingState),this.trigger("error"),!0):void 0)},_proto.addSidxSegments_=function(playlist,startingState,cb){var _this2=this,sidxKey=playlist.sidx&&generateSidxKey(playlist.sidx);if(playlist.sidx&&sidxKey&&!this.masterPlaylistLoader_.sidxMapping_[sidxKey]){var uri=resolveManifestRedirect(this.handleManifestRedirects,playlist.sidx.resolvedUri),fin=function(err,request){if(!_this2.requestErrored_(err,request,startingState)){var sidx,sidxMapping=_this2.masterPlaylistLoader_.sidxMapping_;try{sidx=parse_sidx_default()(byte_helpers_toUint8(request.response).subarray(8))}catch(e){return void _this2.requestErrored_(e,request,startingState)}return sidxMapping[sidxKey]={sidxInfo:playlist.sidx,sidx:sidx},addSidxSegmentsToPlaylist(playlist,sidx,playlist.sidx.resolvedUri),cb(!0)}};this.request=function(uri,xhr,cb){var id3Offset,bytes=[],finished=!1,endRequestAndCallback=function(err,req,type,_bytes){return req.abort(),finished=!0,cb(err,req,type,_bytes)},progressListener=function(error,request){if(!finished){if(error)return endRequestAndCallback(error,request,"",bytes);var newPart=request.responseText.substring(bytes&&bytes.byteLength||0,request.responseText.length);if(bytes=function(){for(var _len=arguments.length,buffers=new Array(_len),_key=0;_key<_len;_key++)buffers[_key]=arguments[_key];if(buffers=buffers.filter(function(b){return b&&(b.byteLength||b.length)&&"string"!=typeof b}),buffers.length<=1)return byte_helpers_toUint8(buffers[0]);var totalLen=buffers.reduce(function(total,buf,i){return total+(buf.byteLength||buf.length)},0),tempBuffer=new Uint8Array(totalLen),offset=0;return buffers.forEach(function(buf){buf=byte_helpers_toUint8(buf),tempBuffer.set(buf,offset),offset+=buf.byteLength}),tempBuffer}(bytes,stringToBytes(newPart,!0)),id3Offset=id3Offset||getId3Offset(bytes),bytes.length<10||id3Offset&&bytes.length<id3Offset+2)return callbackOnCompleted(request,function(){return endRequestAndCallback(error,request,"",bytes)});var type=detectContainerForBytes(bytes);return"ts"===type&&bytes.length<188||!type&&bytes.length<376?callbackOnCompleted(request,function(){return endRequestAndCallback(error,request,"",bytes)}):endRequestAndCallback(null,request,type,bytes)}},options={uri:uri,beforeSend:function(request){request.overrideMimeType("text/plain; charset=x-user-defined"),request.addEventListener("progress",function(_ref){return callbackWrapper(request,null,{statusCode:request.status},progressListener)})}},request=xhr(options,function(error,response){return callbackWrapper(request,error,response,progressListener)});return request}(uri,this.vhs_.xhr,function(err,request,container,bytes){if(err)return fin(err,request);if(!container||"mp4"!==container)return fin({status:request.status,message:"Unsupported "+(container||"unknown")+" container type for sidx segment at URL: "+uri,response:"",playlist:playlist,internal:!0,blacklistDuration:1/0,code:2},request);var _playlist$sidx$bytera=playlist.sidx.byterange,offset=_playlist$sidx$bytera.offset,length=_playlist$sidx$bytera.length;if(bytes.length>=length+offset)return fin(err,{response:bytes.subarray(offset,offset+length),status:request.status,uri:request.uri});_this2.request=_this2.vhs_.xhr({uri:uri,responseType:"arraybuffer",headers:segmentXhrHeaders({byterange:playlist.sidx.byterange})},fin)})}else this.mediaRequest_=window_default().setTimeout(function(){return cb(!1)},0)},_proto.dispose=function(){this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},window_default().clearTimeout(this.minimumUpdatePeriodTimeout_),window_default().clearTimeout(this.mediaRequest_),window_default().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.mediaRequest_=null,this.minimumUpdatePeriodTimeout_=null,this.masterPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.masterPlaylistLoader_.createMupOnMedia_),this.masterPlaylistLoader_.createMupOnMedia_=null),this.off()},_proto.hasPendingRequest=function(){return this.request||this.mediaRequest_},_proto.stopRequest=function(){if(this.request){var oldRequest=this.request;this.request=null,oldRequest.onreadystatechange=null,oldRequest.abort()}},_proto.media=function(playlist){var _this3=this;if(!playlist)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);var startingState=this.state;if("string"==typeof playlist){if(!this.masterPlaylistLoader_.master.playlists[playlist])throw new Error("Unknown playlist URI: "+playlist);playlist=this.masterPlaylistLoader_.master.playlists[playlist]}var mediaChange=!this.media_||playlist.id!==this.media_.id;if(mediaChange&&this.loadedPlaylists_[playlist.id]&&this.loadedPlaylists_[playlist.id].endList)return this.state="HAVE_METADATA",this.media_=playlist,void(mediaChange&&(this.trigger("mediachanging"),this.trigger("mediachange")));mediaChange&&(this.media_&&this.trigger("mediachanging"),this.addSidxSegments_(playlist,startingState,function(sidxChanged){_this3.haveMetadata({startingState:startingState,playlist:playlist})}))},_proto.haveMetadata=function(_ref2){var startingState=_ref2.startingState,playlist=_ref2.playlist;this.state="HAVE_METADATA",this.loadedPlaylists_[playlist.id]=playlist,this.mediaRequest_=null,this.refreshMedia_(playlist.id),this.trigger("HAVE_MASTER"===startingState?"loadedmetadata":"mediachange")},_proto.pause=function(){this.masterPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.masterPlaylistLoader_.createMupOnMedia_),this.masterPlaylistLoader_.createMupOnMedia_=null),this.stopRequest(),window_default().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.isMaster_&&(window_default().clearTimeout(this.masterPlaylistLoader_.minimumUpdatePeriodTimeout_),this.masterPlaylistLoader_.minimumUpdatePeriodTimeout_=null),"HAVE_NOTHING"===this.state&&(this.started=!1)},_proto.load=function(isFinalRendition){var _this4=this;window_default().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null;var media=this.media();if(isFinalRendition){var delay=media?media.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=window_default().setTimeout(function(){return _this4.load()},delay)}else this.started?media&&!media.endList?(this.isMaster_&&!this.minimumUpdatePeriodTimeout_&&(this.trigger("minimumUpdatePeriod"),this.updateMinimumUpdatePeriodTimeout_()),this.trigger("mediaupdatetimeout")):this.trigger("loadedplaylist"):this.start()},_proto.start=function(){var _this5=this;this.started=!0,this.isMaster_?this.requestMaster_(function(req,masterChanged){_this5.haveMaster_(),_this5.hasPendingRequest()||_this5.media_||_this5.media(_this5.masterPlaylistLoader_.master.playlists[0])}):this.mediaRequest_=window_default().setTimeout(function(){return _this5.haveMaster_()},0)},_proto.requestMaster_=function(cb){var _this6=this;this.request=this.vhs_.xhr({uri:this.masterPlaylistLoader_.srcUrl,withCredentials:this.withCredentials},function(error,req){if(!_this6.requestErrored_(error,req)){var masterChanged=req.responseText!==_this6.masterPlaylistLoader_.masterXml_;return _this6.masterPlaylistLoader_.masterXml_=req.responseText,_this6.masterLoaded_=req.responseHeaders&&req.responseHeaders.date?Date.parse(req.responseHeaders.date):Date.now(),_this6.masterPlaylistLoader_.srcUrl=resolveManifestRedirect(_this6.handleManifestRedirects,_this6.masterPlaylistLoader_.srcUrl,req),masterChanged?(_this6.handleMaster_(),void _this6.syncClientServerClock_(function(){return cb(req,masterChanged)})):cb(req,masterChanged)}"HAVE_NOTHING"===_this6.state&&(_this6.started=!1)})},_proto.syncClientServerClock_=function(done){var _this7=this,utcTiming=function(mpd){var UTCTimingNode=findChildren(mpd,"UTCTiming")[0];if(!UTCTimingNode)return null;var attributes=mpd_parser_es_parseAttributes(UTCTimingNode);switch(attributes.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":attributes.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":attributes.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":attributes.method="DIRECT",attributes.value=Date.parse(attributes.value);break;default:throw new Error("UNSUPPORTED_UTC_TIMING_SCHEME")}return attributes}(stringToMpdXml(this.masterPlaylistLoader_.masterXml_));return null===utcTiming?(this.masterPlaylistLoader_.clientOffset_=this.masterLoaded_-Date.now(),done()):"DIRECT"===utcTiming.method?(this.masterPlaylistLoader_.clientOffset_=utcTiming.value-Date.now(),done()):void(this.request=this.vhs_.xhr({uri:video_es_resolveUrl(this.masterPlaylistLoader_.srcUrl,utcTiming.value),method:utcTiming.method,withCredentials:this.withCredentials},function(error,req){if(_this7.request){if(error)return _this7.masterPlaylistLoader_.clientOffset_=_this7.masterLoaded_-Date.now(),done();var serverTime;serverTime="HEAD"===utcTiming.method?req.responseHeaders&&req.responseHeaders.date?Date.parse(req.responseHeaders.date):_this7.masterLoaded_:Date.parse(req.responseText),_this7.masterPlaylistLoader_.clientOffset_=serverTime-Date.now(),done()}}))},_proto.haveMaster_=function(){this.state="HAVE_MASTER",this.isMaster_?this.trigger("loadedplaylist"):this.media_||this.media(this.childPlaylist_)},_proto.handleMaster_=function(){this.mediaRequest_=null;var _ref,srcUrl,master,newMaster=(master=parse((_ref={masterXml:this.masterPlaylistLoader_.masterXml_,srcUrl:this.masterPlaylistLoader_.srcUrl,clientOffset:this.masterPlaylistLoader_.clientOffset_,sidxMapping:this.masterPlaylistLoader_.sidxMapping_}).masterXml,{manifestUri:srcUrl=_ref.srcUrl,clientOffset:_ref.clientOffset,sidxMapping:_ref.sidxMapping}),addPropertiesToMaster(master,srcUrl),master),oldMaster=this.masterPlaylistLoader_.master;oldMaster&&(newMaster=function(oldMaster,newMaster,sidxMapping){for(var noChanges=!0,update=mergeOptions(oldMaster,{duration:newMaster.duration,minimumUpdatePeriod:newMaster.minimumUpdatePeriod}),i=0;i<newMaster.playlists.length;i++){var playlist=newMaster.playlists[i];if(playlist.sidx){var sidxKey=generateSidxKey(playlist.sidx);sidxMapping&&sidxMapping[sidxKey]&&sidxMapping[sidxKey].sidx&&addSidxSegmentsToPlaylist(playlist,sidxMapping[sidxKey].sidx,playlist.sidx.resolvedUri)}var playlistUpdate=updateMaster$1(update,playlist,dashPlaylistUnchanged);playlistUpdate&&(update=playlistUpdate,noChanges=!1)}return forEachMediaGroup(newMaster,function(properties,type,group,label){if(properties.playlists&&properties.playlists.length){var id=properties.playlists[0].id,_playlistUpdate=updateMaster$1(update,properties.playlists[0],dashPlaylistUnchanged);_playlistUpdate&&((update=_playlistUpdate).mediaGroups[type][group][label].playlists[0]=update.playlists[id],noChanges=!1)}}),newMaster.minimumUpdatePeriod!==oldMaster.minimumUpdatePeriod&&(noChanges=!1),noChanges?null:update}(oldMaster,newMaster,this.masterPlaylistLoader_.sidxMapping_)),this.masterPlaylistLoader_.master=newMaster||oldMaster;var location=this.masterPlaylistLoader_.master.locations&&this.masterPlaylistLoader_.master.locations[0];return location&&location!==this.masterPlaylistLoader_.srcUrl&&(this.masterPlaylistLoader_.srcUrl=location),(!oldMaster||newMaster&&newMaster.minimumUpdatePeriod!==oldMaster.minimumUpdatePeriod)&&this.updateMinimumUpdatePeriodTimeout_(),Boolean(newMaster)},_proto.updateMinimumUpdatePeriodTimeout_=function(){var mpl=this.masterPlaylistLoader_;mpl.createMupOnMedia_&&(mpl.off("loadedmetadata",mpl.createMupOnMedia_),mpl.createMupOnMedia_=null),mpl.minimumUpdatePeriodTimeout_&&(window_default().clearTimeout(mpl.minimumUpdatePeriodTimeout_),mpl.minimumUpdatePeriodTimeout_=null);var mup=mpl.master&&mpl.master.minimumUpdatePeriod;0===mup&&(mpl.media()?mup=1e3*mpl.media().targetDuration:(mpl.createMupOnMedia_=mpl.updateMinimumUpdatePeriodTimeout_,mpl.one("loadedmetadata",mpl.createMupOnMedia_))),"number"!=typeof mup||mup<=0?mup<0&&this.logger_("found invalid minimumUpdatePeriod of "+mup+", not setting a timeout"):this.createMUPTimeout_(mup)},_proto.createMUPTimeout_=function(mup){var mpl=this.masterPlaylistLoader_;mpl.minimumUpdatePeriodTimeout_=window_default().setTimeout(function(){mpl.minimumUpdatePeriodTimeout_=null,mpl.trigger("minimumUpdatePeriod"),mpl.createMUPTimeout_(mup)},mup)},_proto.refreshXml_=function(){var _this8=this;this.requestMaster_(function(req,masterChanged){var master,oldSidxMapping,mediaGroupSidx;masterChanged&&(_this8.media_&&(_this8.media_=_this8.masterPlaylistLoader_.master.playlists[_this8.media_.id]),_this8.masterPlaylistLoader_.sidxMapping_=(mediaGroupSidx=compareSidxEntry((master=_this8.masterPlaylistLoader_.master).playlists,oldSidxMapping=_this8.masterPlaylistLoader_.sidxMapping_),forEachMediaGroup(master,function(properties,mediaType,groupKey,labelKey){properties.playlists&&properties.playlists.length&&(mediaGroupSidx=mergeOptions(mediaGroupSidx,compareSidxEntry(properties.playlists,oldSidxMapping)))}),mediaGroupSidx),_this8.addSidxSegments_(_this8.media(),_this8.state,function(sidxChanged){_this8.refreshMedia_(_this8.media().id)}))})},_proto.refreshMedia_=function(mediaID){var _this9=this;if(!mediaID)throw new Error("refreshMedia_ must take a media id");this.media_&&this.isMaster_&&this.handleMaster_();var playlists=this.masterPlaylistLoader_.master.playlists,mediaChanged=!this.media_||this.media_!==playlists[mediaID];mediaChanged?this.media_=playlists[mediaID]:this.trigger("playlistunchanged"),this.mediaUpdateTimeout||function createMediaUpdateTimeout(){_this9.media().endList||(_this9.mediaUpdateTimeout=window_default().setTimeout(function(){_this9.trigger("mediaupdatetimeout"),createMediaUpdateTimeout()},refreshDelay(_this9.media(),Boolean(mediaChanged))))}(),this.trigger("loadedplaylist")},DashPlaylistLoader}(videojs.EventTarget),Config={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,BACK_BUFFER_LENGTH:30,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:16,BUFFER_LOW_WATER_LINE_RATE:1,BUFFER_HIGH_WATER_LINE:30},browserWorkerPolyFill=function(workerObj){return workerObj.on=workerObj.addEventListener,workerObj.off=workerObj.removeEventListener,workerObj},factory=function(code){return function(){var objectUrl=function(str){try{return URL.createObjectURL(new Blob([str],{type:"application/javascript"}))}catch(e){var blob=new BlobBuilder;return blob.append(str),URL.createObjectURL(blob.getBlob())}}(code),worker=browserWorkerPolyFill(new Worker(objectUrl));worker.objURL=objectUrl;var terminate=worker.terminate;return worker.on=worker.addEventListener,worker.off=worker.removeEventListener,worker.terminate=function(){return URL.revokeObjectURL(objectUrl),terminate.call(this)},worker}},transform=function(code){return"var browserWorkerPolyFill = "+browserWorkerPolyFill.toString()+";\nbrowserWorkerPolyFill(self);\n"+code},getWorkerString=function(fn){return fn.toString().replace(/^function.+?{/,"").slice(0,-1)},workerCode$1=transform(getWorkerString(function(){var Stream=function(){this.init=function(){var listeners={};this.on=function(type,listener){listeners[type]||(listeners[type]=[]),listeners[type]=listeners[type].concat(listener)},this.off=function(type,listener){var index;return!!listeners[type]&&(index=listeners[type].indexOf(listener),listeners[type]=listeners[type].slice(),listeners[type].splice(index,1),index>-1)},this.trigger=function(type){var callbacks,i,length,args;if(callbacks=listeners[type])if(2===arguments.length)for(length=callbacks.length,i=0;i<length;++i)callbacks[i].call(this,arguments[1]);else{for(args=[],i=arguments.length,i=1;i<arguments.length;++i)args.push(arguments[i]);for(length=callbacks.length,i=0;i<length;++i)callbacks[i].apply(this,args)}},this.dispose=function(){listeners={}}}};Stream.prototype.pipe=function(destination){return this.on("data",function(data){destination.push(data)}),this.on("done",function(flushSource){destination.flush(flushSource)}),this.on("partialdone",function(flushSource){destination.partialFlush(flushSource)}),this.on("endedtimeline",function(flushSource){destination.endTimeline(flushSource)}),this.on("reset",function(flushSource){destination.reset(flushSource)}),destination},Stream.prototype.push=function(data){this.trigger("data",data)},Stream.prototype.flush=function(flushSource){this.trigger("done",flushSource)},Stream.prototype.partialFlush=function(flushSource){this.trigger("partialdone",flushSource)},Stream.prototype.endTimeline=function(flushSource){this.trigger("endedtimeline",flushSource)},Stream.prototype.reset=function(flushSource){this.trigger("reset",flushSource)};var box,dinf,esds,ftyp,mfhd,minf,moof,moov,mvex,mvhd,trak,tkhd,mdia,mdhd,hdlr,sdtp,stbl,stsd,traf,trex,trun$1,types,MAJOR_BRAND,MINOR_VERSION,AVC1_BRAND,VIDEO_HDLR,AUDIO_HDLR,HDLR_TYPES,VMHD,SMHD,DREF,STCO,STSC,STSZ,STTS,videoSample,audioSample,audioTrun,videoTrun,trunHeader,stream=Stream,UINT32_MAX=Math.pow(2,32)-1;!function(){var i;if(types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},"undefined"!=typeof Uint8Array){for(i in types)types.hasOwnProperty(i)&&(types[i]=[i.charCodeAt(0),i.charCodeAt(1),i.charCodeAt(2),i.charCodeAt(3)]);MAJOR_BRAND=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),AVC1_BRAND=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),MINOR_VERSION=new Uint8Array([0,0,0,1]),VIDEO_HDLR=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),AUDIO_HDLR=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),HDLR_TYPES={video:VIDEO_HDLR,audio:AUDIO_HDLR},DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),STCO=new Uint8Array([0,0,0,0,0,0,0,0]),STSC=STCO,STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),STTS=STCO,VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}}(),box=function(type){var i,result,payload=[],size=0;for(i=1;i<arguments.length;i++)payload.push(arguments[i]);for(i=payload.length;i--;)size+=payload[i].byteLength;for(result=new Uint8Array(size+8),new DataView(result.buffer,result.byteOffset,result.byteLength).setUint32(0,result.byteLength),result.set(type,4),i=0,size=8;i<payload.length;i++)result.set(payload[i],size),size+=payload[i].byteLength;return result},dinf=function(){return box(types.dinf,box(types.dref,DREF))},esds=function(track){return box(types.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,track.audioobjecttype<<3|track.samplingfrequencyindex>>>1,track.samplingfrequencyindex<<7|track.channelcount<<3,6,1,2]))},hdlr=function(type){return box(types.hdlr,HDLR_TYPES[type])},mdhd=function(track){var result=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,track.duration>>>24&255,track.duration>>>16&255,track.duration>>>8&255,255&track.duration,85,196,0,0]);return track.samplerate&&(result[12]=track.samplerate>>>24&255,result[13]=track.samplerate>>>16&255,result[14]=track.samplerate>>>8&255,result[15]=255&track.samplerate),box(types.mdhd,result)},mdia=function(track){return box(types.mdia,mdhd(track),hdlr(track.type),minf(track))},mfhd=function(sequenceNumber){return box(types.mfhd,new Uint8Array([0,0,0,0,(4278190080&sequenceNumber)>>24,(16711680&sequenceNumber)>>16,(65280&sequenceNumber)>>8,255&sequenceNumber]))},minf=function(track){return box(types.minf,"video"===track.type?box(types.vmhd,VMHD):box(types.smhd,SMHD),dinf(),stbl(track))},moof=function(sequenceNumber,tracks){for(var trackFragments=[],i=tracks.length;i--;)trackFragments[i]=traf(tracks[i]);return box.apply(null,[types.moof,mfhd(sequenceNumber)].concat(trackFragments))},moov=function(tracks){for(var i=tracks.length,boxes=[];i--;)boxes[i]=trak(tracks[i]);return box.apply(null,[types.moov,mvhd(4294967295)].concat(boxes).concat(mvex(tracks)))},mvex=function(tracks){for(var i=tracks.length,boxes=[];i--;)boxes[i]=trex(tracks[i]);return box.apply(null,[types.mvex].concat(boxes))},mvhd=function(duration){var bytes=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&duration)>>24,(16711680&duration)>>16,(65280&duration)>>8,255&duration,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return box(types.mvhd,bytes)},sdtp=function(track){var flags,i,samples=track.samples||[],bytes=new Uint8Array(4+samples.length);for(i=0;i<samples.length;i++)bytes[i+4]=(flags=samples[i].flags).dependsOn<<4|flags.isDependedOn<<2|flags.hasRedundancy;return box(types.sdtp,bytes)},stbl=function(track){return box(types.stbl,stsd(track),box(types.stts,STTS),box(types.stsc,STSC),box(types.stsz,STSZ),box(types.stco,STCO))},stsd=function(track){return box(types.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===track.type?videoSample(track):audioSample(track))},videoSample=function(track){var i,avc1Box,sps=track.sps||[],pps=track.pps||[],sequenceParameterSets=[],pictureParameterSets=[];for(i=0;i<sps.length;i++)sequenceParameterSets.push((65280&sps[i].byteLength)>>>8),sequenceParameterSets.push(255&sps[i].byteLength),sequenceParameterSets=sequenceParameterSets.concat(Array.prototype.slice.call(sps[i]));for(i=0;i<pps.length;i++)pictureParameterSets.push((65280&pps[i].byteLength)>>>8),pictureParameterSets.push(255&pps[i].byteLength),pictureParameterSets=pictureParameterSets.concat(Array.prototype.slice.call(pps[i]));if(avc1Box=[types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&track.width)>>8,255&track.width,(65280&track.height)>>8,255&track.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),box(types.avcC,new Uint8Array([1,track.profileIdc,track.profileCompatibility,track.levelIdc,255].concat([sps.length],sequenceParameterSets,[pps.length],pictureParameterSets))),box(types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],track.sarRatio){var hSpacing=track.sarRatio[0],vSpacing=track.sarRatio[1];avc1Box.push(box(types.pasp,new Uint8Array([(4278190080&hSpacing)>>24,(16711680&hSpacing)>>16,(65280&hSpacing)>>8,255&hSpacing,(4278190080&vSpacing)>>24,(16711680&vSpacing)>>16,(65280&vSpacing)>>8,255&vSpacing])))}return box.apply(null,avc1Box)},audioSample=function(track){return box(types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&track.channelcount)>>8,255&track.channelcount,(65280&track.samplesize)>>8,255&track.samplesize,0,0,0,0,(65280&track.samplerate)>>8,255&track.samplerate,0,0]),esds(track))},tkhd=function(track){var result=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&track.id)>>24,(16711680&track.id)>>16,(65280&track.id)>>8,255&track.id,0,0,0,0,(4278190080&track.duration)>>24,(16711680&track.duration)>>16,(65280&track.duration)>>8,255&track.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&track.width)>>8,255&track.width,0,0,(65280&track.height)>>8,255&track.height,0,0]);return box(types.tkhd,result)},traf=function(track){var trackFragmentHeader,trackFragmentDecodeTime,trackFragmentRun,sampleDependencyTable,upperWordBaseMediaDecodeTime,lowerWordBaseMediaDecodeTime;return trackFragmentHeader=box(types.tfhd,new Uint8Array([0,0,0,58,(4278190080&track.id)>>24,(16711680&track.id)>>16,(65280&track.id)>>8,255&track.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),upperWordBaseMediaDecodeTime=Math.floor(track.baseMediaDecodeTime/(UINT32_MAX+1)),lowerWordBaseMediaDecodeTime=Math.floor(track.baseMediaDecodeTime%(UINT32_MAX+1)),trackFragmentDecodeTime=box(types.tfdt,new Uint8Array([1,0,0,0,upperWordBaseMediaDecodeTime>>>24&255,upperWordBaseMediaDecodeTime>>>16&255,upperWordBaseMediaDecodeTime>>>8&255,255&upperWordBaseMediaDecodeTime,lowerWordBaseMediaDecodeTime>>>24&255,lowerWordBaseMediaDecodeTime>>>16&255,lowerWordBaseMediaDecodeTime>>>8&255,255&lowerWordBaseMediaDecodeTime])),"audio"===track.type?(trackFragmentRun=trun$1(track,92),box(types.traf,trackFragmentHeader,trackFragmentDecodeTime,trackFragmentRun)):(sampleDependencyTable=sdtp(track),trackFragmentRun=trun$1(track,sampleDependencyTable.length+92),box(types.traf,trackFragmentHeader,trackFragmentDecodeTime,trackFragmentRun,sampleDependencyTable))},trak=function(track){return track.duration=track.duration||4294967295,box(types.trak,tkhd(track),mdia(track))},trex=function(track){var result=new Uint8Array([0,0,0,0,(4278190080&track.id)>>24,(16711680&track.id)>>16,(65280&track.id)>>8,255&track.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==track.type&&(result[result.length-1]=0),box(types.trex,result)},trunHeader=function(samples,offset){var durationPresent=0,sizePresent=0,flagsPresent=0,compositionTimeOffset=0;return samples.length&&(void 0!==samples[0].duration&&(durationPresent=1),void 0!==samples[0].size&&(sizePresent=2),void 0!==samples[0].flags&&(flagsPresent=4),void 0!==samples[0].compositionTimeOffset&&(compositionTimeOffset=8)),[0,0,durationPresent|sizePresent|flagsPresent|compositionTimeOffset,1,(4278190080&samples.length)>>>24,(16711680&samples.length)>>>16,(65280&samples.length)>>>8,255&samples.length,(4278190080&offset)>>>24,(16711680&offset)>>>16,(65280&offset)>>>8,255&offset]},videoTrun=function(track,offset){var bytesOffest,bytes,header,samples,sample,i;for(header=trunHeader(samples=track.samples||[],offset+=20+16*samples.length),(bytes=new Uint8Array(header.length+16*samples.length)).set(header),bytesOffest=header.length,i=0;i<samples.length;i++)bytes[bytesOffest++]=(4278190080&(sample=samples[i]).duration)>>>24,bytes[bytesOffest++]=(16711680&sample.duration)>>>16,bytes[bytesOffest++]=(65280&sample.duration)>>>8,bytes[bytesOffest++]=255&sample.duration,bytes[bytesOffest++]=(4278190080&sample.size)>>>24,bytes[bytesOffest++]=(16711680&sample.size)>>>16,bytes[bytesOffest++]=(65280&sample.size)>>>8,bytes[bytesOffest++]=255&sample.size,bytes[bytesOffest++]=sample.flags.isLeading<<2|sample.flags.dependsOn,bytes[bytesOffest++]=sample.flags.isDependedOn<<6|sample.flags.hasRedundancy<<4|sample.flags.paddingValue<<1|sample.flags.isNonSyncSample,bytes[bytesOffest++]=61440&sample.flags.degradationPriority,bytes[bytesOffest++]=15&sample.flags.degradationPriority,bytes[bytesOffest++]=(4278190080&sample.compositionTimeOffset)>>>24,bytes[bytesOffest++]=(16711680&sample.compositionTimeOffset)>>>16,bytes[bytesOffest++]=(65280&sample.compositionTimeOffset)>>>8,bytes[bytesOffest++]=255&sample.compositionTimeOffset;return box(types.trun,bytes)},audioTrun=function(track,offset){var bytes,bytesOffest,header,samples,sample,i;for(header=trunHeader(samples=track.samples||[],offset+=20+8*samples.length),(bytes=new Uint8Array(header.length+8*samples.length)).set(header),bytesOffest=header.length,i=0;i<samples.length;i++)bytes[bytesOffest++]=(4278190080&(sample=samples[i]).duration)>>>24,bytes[bytesOffest++]=(16711680&sample.duration)>>>16,bytes[bytesOffest++]=(65280&sample.duration)>>>8,bytes[bytesOffest++]=255&sample.duration,bytes[bytesOffest++]=(4278190080&sample.size)>>>24,bytes[bytesOffest++]=(16711680&sample.size)>>>16,bytes[bytesOffest++]=(65280&sample.size)>>>8,bytes[bytesOffest++]=255&sample.size;return box(types.trun,bytes)},trun$1=function(track,offset){return"audio"===track.type?audioTrun(track,offset):videoTrun(track,offset)},ftyp=function(){return box(types.ftyp,MAJOR_BRAND,MINOR_VERSION,MAJOR_BRAND,AVC1_BRAND)};var silence,secondsToVideoTs,secondsToAudioTs,videoTsToSeconds,audioTsToSeconds,audioTsToVideoTs,videoTsToAudioTs,metadataTsToSeconds,mp4Generator_mdat=function(data){return box(types.mdat,data)},mp4Generator_moof=moof,sampleForFrame=function(frame,dataOffset){var sample={size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}};return sample.dataOffset=dataOffset,sample.compositionTimeOffset=frame.pts-frame.dts,sample.duration=frame.duration,sample.size=4*frame.length,sample.size+=frame.byteLength,frame.keyFrame&&(sample.flags.dependsOn=2,sample.flags.isNonSyncSample=0),sample},highPrefix=[33,16,5,32,164,27],lowPrefix=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],zeroFill=function(count){for(var a=[];count--;)a.push(0);return a};audioTsToVideoTs=function(timestamp,sampleRate){return secondsToVideoTs(audioTsToSeconds(timestamp,sampleRate))},videoTsToAudioTs=function(timestamp,sampleRate){return secondsToAudioTs(videoTsToSeconds(timestamp),sampleRate)},metadataTsToSeconds=function(timestamp,timelineStartPts,keepOriginalTimestamps){return videoTsToSeconds(keepOriginalTimestamps?timestamp:timestamp-timelineStartPts)};var clock_secondsToVideoTs=secondsToVideoTs=function(seconds){return 9e4*seconds},clock_videoTsToSeconds=(secondsToAudioTs=function(seconds,sampleRate){return seconds*sampleRate},videoTsToSeconds=function(timestamp){return timestamp/9e4}),clock_audioTsToVideoTs=(audioTsToSeconds=function(timestamp,sampleRate){return timestamp/sampleRate},audioTsToVideoTs),clock_videoTsToAudioTs=videoTsToAudioTs,clock_metadataTsToSeconds=metadataTsToSeconds,audioFrameUtils_prefixWithSilence=function(track,frames,audioAppendStartTs,videoBaseMediaDecodeTime){var baseMediaDecodeTimeTs,frameDuration,silentFrame,i,firstFrame,audioGapDuration=0,audioFillFrameCount=0,audioFillDuration=0;if(frames.length&&(baseMediaDecodeTimeTs=clock_audioTsToVideoTs(track.baseMediaDecodeTime,track.samplerate),frameDuration=Math.ceil(9e4/(track.samplerate/1024)),audioAppendStartTs&&videoBaseMediaDecodeTime&&(audioGapDuration=baseMediaDecodeTimeTs-Math.max(audioAppendStartTs,videoBaseMediaDecodeTime),audioFillDuration=(audioFillFrameCount=Math.floor(audioGapDuration/frameDuration))*frameDuration),!(audioFillFrameCount<1||audioFillDuration>45e3))){for((silentFrame=function(){if(!silence){var coneOfSilence={96e3:[highPrefix,[227,64],zeroFill(154),[56]],88200:[highPrefix,[231],zeroFill(170),[56]],64e3:[highPrefix,[248,192],zeroFill(240),[56]],48e3:[highPrefix,[255,192],zeroFill(268),[55,148,128],zeroFill(54),[112]],44100:[highPrefix,[255,192],zeroFill(268),[55,163,128],zeroFill(84),[112]],32e3:[highPrefix,[255,192],zeroFill(268),[55,234],zeroFill(226),[112]],24e3:[highPrefix,[255,192],zeroFill(268),[55,255,128],zeroFill(268),[111,112],zeroFill(126),[224]],16e3:[highPrefix,[255,192],zeroFill(268),[55,255,128],zeroFill(268),[111,255],zeroFill(269),[223,108],zeroFill(195),[1,192]],12e3:[lowPrefix,zeroFill(268),[3,127,248],zeroFill(268),[6,255,240],zeroFill(268),[13,255,224],zeroFill(268),[27,253,128],zeroFill(259),[56]],11025:[lowPrefix,zeroFill(268),[3,127,248],zeroFill(268),[6,255,240],zeroFill(268),[13,255,224],zeroFill(268),[27,255,192],zeroFill(268),[55,175,128],zeroFill(108),[112]],8e3:[lowPrefix,zeroFill(268),[3,121,16],zeroFill(47),[7]]};metaTable=coneOfSilence,silence=Object.keys(metaTable).reduce(function(obj,key){return obj[key]=new Uint8Array(metaTable[key].reduce(function(arr,part){return arr.concat(part)},[])),obj},{})}var metaTable;return silence}()[track.samplerate])||(silentFrame=frames[0].data),i=0;i<audioFillFrameCount;i++)frames.splice(0,0,{data:silentFrame,dts:(firstFrame=frames[0]).dts-frameDuration,pts:firstFrame.pts-frameDuration});return track.baseMediaDecodeTime-=Math.floor(clock_videoTsToAudioTs(audioFillDuration,track.samplerate)),audioFillDuration}},trackDecodeInfo_clearDtsInfo=function(track){delete track.minSegmentDts,delete track.maxSegmentDts,delete track.minSegmentPts,delete track.maxSegmentPts},trackDecodeInfo_calculateTrackBaseMediaDecodeTime=function(track,keepOriginalTimestamps){var baseMediaDecodeTime,minSegmentDts=track.minSegmentDts;return keepOriginalTimestamps||(minSegmentDts-=track.timelineStartInfo.dts),baseMediaDecodeTime=track.timelineStartInfo.baseMediaDecodeTime,baseMediaDecodeTime+=minSegmentDts,baseMediaDecodeTime=Math.max(0,baseMediaDecodeTime),"audio"===track.type&&(baseMediaDecodeTime*=track.samplerate/9e4,baseMediaDecodeTime=Math.floor(baseMediaDecodeTime)),baseMediaDecodeTime},trackDecodeInfo_collectDtsInfo=function(track,data){"number"==typeof data.pts&&(void 0===track.timelineStartInfo.pts&&(track.timelineStartInfo.pts=data.pts),track.minSegmentPts=void 0===track.minSegmentPts?data.pts:Math.min(track.minSegmentPts,data.pts),track.maxSegmentPts=void 0===track.maxSegmentPts?data.pts:Math.max(track.maxSegmentPts,data.pts)),"number"==typeof data.dts&&(void 0===track.timelineStartInfo.dts&&(track.timelineStartInfo.dts=data.dts),track.minSegmentDts=void 0===track.minSegmentDts?data.dts:Math.min(track.minSegmentDts,data.dts),track.maxSegmentDts=void 0===track.maxSegmentDts?data.dts:Math.max(track.maxSegmentDts,data.dts))},CaptionStream$1=function CaptionStream(options){options=options||{},CaptionStream.prototype.init.call(this),this.parse708captions_="boolean"!=typeof options.parse708captions||options.parse708captions,this.captionPackets_=[],this.ccStreams_=[new Cea608Stream(0,0),new Cea608Stream(0,1),new Cea608Stream(1,0),new Cea608Stream(1,1)],this.parse708captions_&&(this.cc708Stream_=new Cea708Stream({captionServices:options.captionServices})),this.reset(),this.ccStreams_.forEach(function(cc){cc.on("data",this.trigger.bind(this,"data")),cc.on("partialdone",this.trigger.bind(this,"partialdone")),cc.on("done",this.trigger.bind(this,"done"))},this),this.parse708captions_&&(this.cc708Stream_.on("data",this.trigger.bind(this,"data")),this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone")),this.cc708Stream_.on("done",this.trigger.bind(this,"done")))};(CaptionStream$1.prototype=new stream).push=function(event){var sei,userData,newCaptionPackets;if("sei_rbsp"===event.nalUnitType&&(sei=function(bytes){for(var i=0,result={payloadType:-1,payloadSize:0},payloadType=0,payloadSize=0;i<bytes.byteLength&&128!==bytes[i];){for(;255===bytes[i];)payloadType+=255,i++;for(payloadType+=bytes[i++];255===bytes[i];)payloadSize+=255,i++;if(payloadSize+=bytes[i++],!result.payload&&4===payloadType){if("GA94"===String.fromCharCode(bytes[i+3],bytes[i+4],bytes[i+5],bytes[i+6])){result.payloadType=payloadType,result.payloadSize=payloadSize,result.payload=bytes.subarray(i,i+payloadSize);break}result.payload=void 0}i+=payloadSize,payloadType=0,payloadSize=0}return result}(event.escapedRBSP)).payload&&4===sei.payloadType&&(userData=function(sei){return 181!==sei.payload[0]||49!=(sei.payload[1]<<8|sei.payload[2])||"GA94"!==String.fromCharCode(sei.payload[3],sei.payload[4],sei.payload[5],sei.payload[6])||3!==sei.payload[7]?null:sei.payload.subarray(8,sei.payload.length-1)}(sei)))if(event.dts<this.latestDts_)this.ignoreNextEqualDts_=!0;else{if(event.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));newCaptionPackets=function(pts,userData){var i,count,offset,data,results=[];if(!(64&userData[0]))return results;for(count=31&userData[0],i=0;i<count;i++)data={type:3&userData[2+(offset=3*i)],pts:pts},4&userData[offset+2]&&(data.ccData=userData[offset+3]<<8|userData[offset+4],results.push(data));return results}(event.pts,userData),this.captionPackets_=this.captionPackets_.concat(newCaptionPackets),this.latestDts_!==event.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=event.dts}},CaptionStream$1.prototype.flushCCStreams=function(flushType){this.ccStreams_.forEach(function(cc){return"flush"===flushType?cc.flush():cc.partialFlush()},this)},CaptionStream$1.prototype.flushStream=function(flushType){this.captionPackets_.length?(this.captionPackets_.forEach(function(elem,idx){elem.presortIndex=idx}),this.captionPackets_.sort(function(a,b){return a.pts===b.pts?a.presortIndex-b.presortIndex:a.pts-b.pts}),this.captionPackets_.forEach(function(packet){packet.type<2?this.dispatchCea608Packet(packet):this.dispatchCea708Packet(packet)},this),this.captionPackets_.length=0,this.flushCCStreams(flushType)):this.flushCCStreams(flushType)},CaptionStream$1.prototype.flush=function(){return this.flushStream("flush")},CaptionStream$1.prototype.partialFlush=function(){return this.flushStream("partialFlush")},CaptionStream$1.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(ccStream){ccStream.reset()})},CaptionStream$1.prototype.dispatchCea608Packet=function(packet){this.setsTextOrXDSActive(packet)?this.activeCea608Channel_[packet.type]=null:this.setsChannel1Active(packet)?this.activeCea608Channel_[packet.type]=0:this.setsChannel2Active(packet)&&(this.activeCea608Channel_[packet.type]=1),null!==this.activeCea608Channel_[packet.type]&&this.ccStreams_[(packet.type<<1)+this.activeCea608Channel_[packet.type]].push(packet)},CaptionStream$1.prototype.setsChannel1Active=function(packet){return 4096==(30720&packet.ccData)},CaptionStream$1.prototype.setsChannel2Active=function(packet){return 6144==(30720&packet.ccData)},CaptionStream$1.prototype.setsTextOrXDSActive=function(packet){return 256==(28928&packet.ccData)||4138==(30974&packet.ccData)||6186==(30974&packet.ccData)},CaptionStream$1.prototype.dispatchCea708Packet=function(packet){this.parse708captions_&&this.cc708Stream_.push(packet)};var CHARACTER_TRANSLATION_708={127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600},within708TextBlock=function(b){return 32<=b&&b<=127||160<=b&&b<=255},Cea708Window=function(windowNum){this.windowNum=windowNum,this.reset()};Cea708Window.prototype.reset=function(){this.clearText(),this.pendingNewLine=!1,this.winAttr={},this.penAttr={},this.penLoc={},this.penColor={},this.visible=0,this.rowLock=0,this.columnLock=0,this.priority=0,this.relativePositioning=0,this.anchorVertical=0,this.anchorHorizontal=0,this.anchorPoint=0,this.rowCount=1,this.virtualRowCount=this.rowCount+1,this.columnCount=41,this.windowStyle=0,this.penStyle=0},Cea708Window.prototype.getText=function(){return this.rows.join("\n")},Cea708Window.prototype.clearText=function(){this.rows=[""],this.rowIdx=0},Cea708Window.prototype.newLine=function(pts){for(this.rows.length>=this.virtualRowCount&&"function"==typeof this.beforeRowOverflow&&this.beforeRowOverflow(pts),this.rows.length>0&&(this.rows.push(""),this.rowIdx++);this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--},Cea708Window.prototype.isEmpty=function(){return 0===this.rows.length||1===this.rows.length&&""===this.rows[0]},Cea708Window.prototype.addText=function(text){this.rows[this.rowIdx]+=text},Cea708Window.prototype.backspace=function(){if(!this.isEmpty()){var row=this.rows[this.rowIdx];this.rows[this.rowIdx]=row.substr(0,row.length-1)}};var Cea708Service=function(serviceNum,encoding,stream){this.serviceNum=serviceNum,this.text="",this.currentWindow=new Cea708Window(-1),this.windows=[],this.stream=stream,"string"==typeof encoding&&this.createTextDecoder(encoding)};Cea708Service.prototype.init=function(pts,beforeRowOverflow){this.startPts=pts;for(var win=0;win<8;win++)this.windows[win]=new Cea708Window(win),"function"==typeof beforeRowOverflow&&(this.windows[win].beforeRowOverflow=beforeRowOverflow)},Cea708Service.prototype.setCurrentWindow=function(windowNum){this.currentWindow=this.windows[windowNum]},Cea708Service.prototype.createTextDecoder=function(encoding){if("undefined"==typeof TextDecoder)this.stream.trigger("log",{level:"warn",message:"The `encoding` option is unsupported without TextDecoder support"});else try{this.textDecoder_=new TextDecoder(encoding)}catch(error){this.stream.trigger("log",{level:"warn",message:"TextDecoder could not be created with "+encoding+" encoding. "+error})}};var Cea708Stream=function Cea708Stream(options){options=options||{},Cea708Stream.prototype.init.call(this);var serviceProps,self=this,captionServices=options.captionServices||{},captionServiceEncodings={};Object.keys(captionServices).forEach(function(serviceName){serviceProps=captionServices[serviceName],/^SERVICE/.test(serviceName)&&(captionServiceEncodings[serviceName]=serviceProps.encoding)}),this.serviceEncodings=captionServiceEncodings,this.current708Packet=null,this.services={},this.push=function(packet){3===packet.type?(self.new708Packet(),self.add708Bytes(packet)):(null===self.current708Packet&&self.new708Packet(),self.add708Bytes(packet))}};Cea708Stream.prototype=new stream,Cea708Stream.prototype.new708Packet=function(){null!==this.current708Packet&&this.push708Packet(),this.current708Packet={data:[],ptsVals:[]}},Cea708Stream.prototype.add708Bytes=function(packet){var data=packet.ccData,byte0=data>>>8,byte1=255&data;this.current708Packet.ptsVals.push(packet.pts),this.current708Packet.data.push(byte0),this.current708Packet.data.push(byte1)},Cea708Stream.prototype.push708Packet=function(){var packet708=this.current708Packet,packetData=packet708.data,serviceNum=null,blockSize=null,i=0,b=packetData[i++];for(packet708.seq=b>>6,packet708.sizeCode=63&b;i<packetData.length;i++)blockSize=31&(b=packetData[i++]),7==(serviceNum=b>>5)&&blockSize>0&&(serviceNum=b=packetData[i++]),this.pushServiceBlock(serviceNum,i,blockSize),blockSize>0&&(i+=blockSize-1)},Cea708Stream.prototype.pushServiceBlock=function(serviceNum,start,size){var b,i=start,packetData=this.current708Packet.data,service=this.services[serviceNum];for(service||(service=this.initService(serviceNum,i));i<start+size&&i<packetData.length;i++)within708TextBlock(b=packetData[i])?i=this.handleText(i,service):24===b?i=this.multiByteCharacter(i,service):16===b?i=this.extendedCommands(i,service):128<=b&&b<=135?i=this.setCurrentWindow(i,service):152<=b&&b<=159?i=this.defineWindow(i,service):136===b?i=this.clearWindows(i,service):140===b?i=this.deleteWindows(i,service):137===b?i=this.displayWindows(i,service):138===b?i=this.hideWindows(i,service):139===b?i=this.toggleWindows(i,service):151===b?i=this.setWindowAttributes(i,service):144===b?i=this.setPenAttributes(i,service):145===b?i=this.setPenColor(i,service):146===b?i=this.setPenLocation(i,service):143===b?service=this.reset(i,service):8===b?service.currentWindow.backspace():12===b?service.currentWindow.clearText():13===b?service.currentWindow.pendingNewLine=!0:14===b?service.currentWindow.clearText():141===b&&i++},Cea708Stream.prototype.extendedCommands=function(i,service){var b=this.current708Packet.data[++i];return within708TextBlock(b)&&(i=this.handleText(i,service,{isExtended:!0})),i},Cea708Stream.prototype.getPts=function(byteIndex){return this.current708Packet.ptsVals[Math.floor(byteIndex/2)]},Cea708Stream.prototype.initService=function(serviceNum,i){var serviceName,encoding,self=this;return(serviceName="SERVICE"+serviceNum)in this.serviceEncodings&&(encoding=this.serviceEncodings[serviceName]),this.services[serviceNum]=new Cea708Service(serviceNum,encoding,self),this.services[serviceNum].init(this.getPts(i),function(pts){self.flushDisplayed(pts,self.services[serviceNum])}),this.services[serviceNum]},Cea708Stream.prototype.handleText=function(i,service,options){var _char,charCodeArray,code,newCode,isExtended=options&&options.isExtended,packetData=this.current708Packet.data,extended=isExtended?4096:0,currentByte=packetData[i],win=service.currentWindow;return service.textDecoder_&&!isExtended?(options&&options.isMultiByte?(charCodeArray=[currentByte,packetData[i+1]],i++):charCodeArray=[currentByte],_char=service.textDecoder_.decode(new Uint8Array(charCodeArray))):(newCode=CHARACTER_TRANSLATION_708[code=extended|currentByte]||code,_char=4096&code&&code===newCode?"":String.fromCharCode(newCode)),win.pendingNewLine&&!win.isEmpty()&&win.newLine(this.getPts(i)),win.pendingNewLine=!1,win.addText(_char),i},Cea708Stream.prototype.multiByteCharacter=function(i,service){var packetData=this.current708Packet.data,secondByte=packetData[i+2];return within708TextBlock(packetData[i+1])&&within708TextBlock(secondByte)&&(i=this.handleText(++i,service,{isMultiByte:!0})),i},Cea708Stream.prototype.setCurrentWindow=function(i,service){return service.setCurrentWindow(7&this.current708Packet.data[i]),i},Cea708Stream.prototype.defineWindow=function(i,service){var packetData=this.current708Packet.data,b=packetData[i];service.setCurrentWindow(7&b);var win=service.currentWindow;return b=packetData[++i],win.visible=(32&b)>>5,win.rowLock=(16&b)>>4,win.columnLock=(8&b)>>3,win.priority=7&b,b=packetData[++i],win.relativePositioning=(128&b)>>7,win.anchorVertical=127&b,b=packetData[++i],win.anchorHorizontal=b,b=packetData[++i],win.anchorPoint=(240&b)>>4,win.rowCount=15&b,b=packetData[++i],win.columnCount=63&b,b=packetData[++i],win.windowStyle=(56&b)>>3,win.penStyle=7&b,win.virtualRowCount=win.rowCount+1,i},Cea708Stream.prototype.setWindowAttributes=function(i,service){var packetData=this.current708Packet.data,b=packetData[i],winAttr=service.currentWindow.winAttr;return b=packetData[++i],winAttr.fillOpacity=(192&b)>>6,winAttr.fillRed=(48&b)>>4,winAttr.fillGreen=(12&b)>>2,winAttr.fillBlue=3&b,b=packetData[++i],winAttr.borderType=(192&b)>>6,winAttr.borderRed=(48&b)>>4,winAttr.borderGreen=(12&b)>>2,winAttr.borderBlue=3&b,b=packetData[++i],winAttr.borderType+=(128&b)>>5,winAttr.wordWrap=(64&b)>>6,winAttr.printDirection=(48&b)>>4,winAttr.scrollDirection=(12&b)>>2,winAttr.justify=3&b,b=packetData[++i],winAttr.effectSpeed=(240&b)>>4,winAttr.effectDirection=(12&b)>>2,winAttr.displayEffect=3&b,i},Cea708Stream.prototype.flushDisplayed=function(pts,service){for(var displayedText=[],winId=0;winId<8;winId++)service.windows[winId].visible&&!service.windows[winId].isEmpty()&&displayedText.push(service.windows[winId].getText());service.endPts=pts,service.text=displayedText.join("\n\n"),this.pushCaption(service),service.startPts=pts},Cea708Stream.prototype.pushCaption=function(service){""!==service.text&&(this.trigger("data",{startPts:service.startPts,endPts:service.endPts,text:service.text,stream:"cc708_"+service.serviceNum}),service.text="",service.startPts=service.endPts)},Cea708Stream.prototype.displayWindows=function(i,service){var b=this.current708Packet.data[++i],pts=this.getPts(i);this.flushDisplayed(pts,service);for(var winId=0;winId<8;winId++)b&1<<winId&&(service.windows[winId].visible=1);return i},Cea708Stream.prototype.hideWindows=function(i,service){var b=this.current708Packet.data[++i],pts=this.getPts(i);this.flushDisplayed(pts,service);for(var winId=0;winId<8;winId++)b&1<<winId&&(service.windows[winId].visible=0);return i},Cea708Stream.prototype.toggleWindows=function(i,service){var b=this.current708Packet.data[++i],pts=this.getPts(i);this.flushDisplayed(pts,service);for(var winId=0;winId<8;winId++)b&1<<winId&&(service.windows[winId].visible^=1);return i},Cea708Stream.prototype.clearWindows=function(i,service){var b=this.current708Packet.data[++i],pts=this.getPts(i);this.flushDisplayed(pts,service);for(var winId=0;winId<8;winId++)b&1<<winId&&service.windows[winId].clearText();return i},Cea708Stream.prototype.deleteWindows=function(i,service){var b=this.current708Packet.data[++i],pts=this.getPts(i);this.flushDisplayed(pts,service);for(var winId=0;winId<8;winId++)b&1<<winId&&service.windows[winId].reset();return i},Cea708Stream.prototype.setPenAttributes=function(i,service){var packetData=this.current708Packet.data,b=packetData[i],penAttr=service.currentWindow.penAttr;return b=packetData[++i],penAttr.textTag=(240&b)>>4,penAttr.offset=(12&b)>>2,penAttr.penSize=3&b,b=packetData[++i],penAttr.italics=(128&b)>>7,penAttr.underline=(64&b)>>6,penAttr.edgeType=(56&b)>>3,penAttr.fontStyle=7&b,i},Cea708Stream.prototype.setPenColor=function(i,service){var packetData=this.current708Packet.data,b=packetData[i],penColor=service.currentWindow.penColor;return b=packetData[++i],penColor.fgOpacity=(192&b)>>6,penColor.fgRed=(48&b)>>4,penColor.fgGreen=(12&b)>>2,penColor.fgBlue=3&b,b=packetData[++i],penColor.bgOpacity=(192&b)>>6,penColor.bgRed=(48&b)>>4,penColor.bgGreen=(12&b)>>2,penColor.bgBlue=3&b,b=packetData[++i],penColor.edgeRed=(48&b)>>4,penColor.edgeGreen=(12&b)>>2,penColor.edgeBlue=3&b,i},Cea708Stream.prototype.setPenLocation=function(i,service){var packetData=this.current708Packet.data,b=packetData[i],penLoc=service.currentWindow.penLoc;return service.currentWindow.pendingNewLine=!0,b=packetData[++i],penLoc.row=15&b,b=packetData[++i],penLoc.column=63&b,i},Cea708Stream.prototype.reset=function(i,service){var pts=this.getPts(i);return this.flushDisplayed(pts,service),this.initService(service.serviceNum,i)};var CHARACTER_TRANSLATION={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},getCharFromCode=function(code){return null===code?"":(code=CHARACTER_TRANSLATION[code]||code,String.fromCharCode(code))},ROWS=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],createDisplayBuffer=function(){for(var result=[],i=15;i--;)result.push("");return result},Cea608Stream=function Cea608Stream(field,dataChannel){Cea608Stream.prototype.init.call(this),this.field_=field||0,this.dataChannel_=dataChannel||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(packet){var data,swap,char0,char1,text;if((data=32639&packet.ccData)!==this.lastControlCode_){if(4096==(61440&data)?this.lastControlCode_=data:data!==this.PADDING_&&(this.lastControlCode_=null),char0=data>>>8,char1=255&data,data!==this.PADDING_)if(data===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(data===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(packet.pts),this.flushDisplayed(packet.pts),swap=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=swap,this.startPts_=packet.pts;else if(data===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(packet.pts);else if(data===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(packet.pts);else if(data===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(packet.pts);else if(data===this.CARRIAGE_RETURN_)this.clearFormatting(packet.pts),this.flushDisplayed(packet.pts),this.shiftRowsUp_(),this.startPts_=packet.pts;else if(data===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(data===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(packet.pts),this.displayed_=createDisplayBuffer();else if(data===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=createDisplayBuffer();else if(data===this.RESUME_DIRECT_CAPTIONING_)"paintOn"!==this.mode_&&(this.flushDisplayed(packet.pts),this.displayed_=createDisplayBuffer()),this.mode_="paintOn",this.startPts_=packet.pts;else if(this.isSpecialCharacter(char0,char1))text=getCharFromCode((char0=(3&char0)<<8)|char1),this[this.mode_](packet.pts,text),this.column_++;else if(this.isExtCharacter(char0,char1))"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),text=getCharFromCode((char0=(3&char0)<<8)|char1),this[this.mode_](packet.pts,text),this.column_++;else if(this.isMidRowCode(char0,char1))this.clearFormatting(packet.pts),this[this.mode_](packet.pts," "),this.column_++,14==(14&char1)&&this.addFormatting(packet.pts,["i"]),1==(1&char1)&&this.addFormatting(packet.pts,["u"]);else if(this.isOffsetControlCode(char0,char1))this.column_+=3&char1;else if(this.isPAC(char0,char1)){var row=ROWS.indexOf(7968&data);"rollUp"===this.mode_&&(row-this.rollUpRows_+1<0&&(row=this.rollUpRows_-1),this.setRollUp(packet.pts,row)),row!==this.row_&&(this.clearFormatting(packet.pts),this.row_=row),1&char1&&-1===this.formatting_.indexOf("u")&&this.addFormatting(packet.pts,["u"]),16==(16&data)&&(this.column_=4*((14&data)>>1)),this.isColorPAC(char1)&&14==(14&char1)&&this.addFormatting(packet.pts,["i"])}else this.isNormalChar(char0)&&(0===char1&&(char1=null),text=getCharFromCode(char0),text+=getCharFromCode(char1),this[this.mode_](packet.pts,text),this.column_+=text.length)}else this.lastControlCode_=null}};Cea608Stream.prototype=new stream,Cea608Stream.prototype.flushDisplayed=function(pts){var content=this.displayed_.map(function(row,index){try{return row.trim()}catch(e){return this.trigger("log",{level:"warn",message:"Skipping a malformed 608 caption at index "+index+"."}),""}},this).join("\n").replace(/^\n+|\n+$/g,"");content.length&&this.trigger("data",{startPts:this.startPts_,endPts:pts,text:content,stream:this.name_})},Cea608Stream.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=createDisplayBuffer(),this.nonDisplayed_=createDisplayBuffer(),this.lastControlCode_=null,this.column_=0,this.row_=14,this.rollUpRows_=2,this.formatting_=[]},Cea608Stream.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},Cea608Stream.prototype.isSpecialCharacter=function(char0,char1){return char0===this.EXT_&&char1>=48&&char1<=63},Cea608Stream.prototype.isExtCharacter=function(char0,char1){return(char0===this.EXT_+1||char0===this.EXT_+2)&&char1>=32&&char1<=63},Cea608Stream.prototype.isMidRowCode=function(char0,char1){return char0===this.EXT_&&char1>=32&&char1<=47},Cea608Stream.prototype.isOffsetControlCode=function(char0,char1){return char0===this.OFFSET_&&char1>=33&&char1<=35},Cea608Stream.prototype.isPAC=function(char0,char1){return char0>=this.BASE_&&char0<this.BASE_+8&&char1>=64&&char1<=127},Cea608Stream.prototype.isColorPAC=function(char1){return char1>=64&&char1<=79||char1>=96&&char1<=127},Cea608Stream.prototype.isNormalChar=function(_char2){return _char2>=32&&_char2<=127},Cea608Stream.prototype.setRollUp=function(pts,newBaseRow){if("rollUp"!==this.mode_&&(this.row_=14,this.mode_="rollUp",this.flushDisplayed(pts),this.nonDisplayed_=createDisplayBuffer(),this.displayed_=createDisplayBuffer()),void 0!==newBaseRow&&newBaseRow!==this.row_)for(var i=0;i<this.rollUpRows_;i++)this.displayed_[newBaseRow-i]=this.displayed_[this.row_-i],this.displayed_[this.row_-i]="";void 0===newBaseRow&&(newBaseRow=this.row_),this.topRow_=newBaseRow-this.rollUpRows_+1},Cea608Stream.prototype.addFormatting=function(pts,format){this.formatting_=this.formatting_.concat(format);var text=format.reduce(function(text,format){return text+"<"+format+">"},"");this[this.mode_](pts,text)},Cea608Stream.prototype.clearFormatting=function(pts){if(this.formatting_.length){var text=this.formatting_.reverse().reduce(function(text,format){return text+"</"+format+">"},"");this.formatting_=[],this[this.mode_](pts,text)}},Cea608Stream.prototype.popOn=function(pts,text){var baseRow=this.nonDisplayed_[this.row_];this.nonDisplayed_[this.row_]=baseRow+=text},Cea608Stream.prototype.rollUp=function(pts,text){var baseRow=this.displayed_[this.row_];this.displayed_[this.row_]=baseRow+=text},Cea608Stream.prototype.shiftRowsUp_=function(){var i;for(i=0;i<this.topRow_;i++)this.displayed_[i]="";for(i=this.row_+1;i<15;i++)this.displayed_[i]="";for(i=this.topRow_;i<this.row_;i++)this.displayed_[i]=this.displayed_[i+1];this.displayed_[this.row_]=""},Cea608Stream.prototype.paintOn=function(pts,text){var baseRow=this.displayed_[this.row_];this.displayed_[this.row_]=baseRow+=text};var captionStream={CaptionStream:CaptionStream$1,Cea608Stream:Cea608Stream,Cea708Stream:Cea708Stream},streamTypes={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},handleRollover$1=function(value,reference){var direction=1;for(value>reference&&(direction=-1);Math.abs(reference-value)>4294967296;)value+=8589934592*direction;return value},TimestampRolloverStream$1=function TimestampRolloverStream(type){var lastDTS,referenceDTS;TimestampRolloverStream.prototype.init.call(this),this.type_=type||"shared",this.push=function(data){"shared"!==this.type_&&data.type!==this.type_||(void 0===referenceDTS&&(referenceDTS=data.dts),data.dts=handleRollover$1(data.dts,referenceDTS),data.pts=handleRollover$1(data.pts,referenceDTS),lastDTS=data.dts,this.trigger("data",data))},this.flush=function(){referenceDTS=lastDTS,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){referenceDTS=void 0,lastDTS=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};TimestampRolloverStream$1.prototype=new stream;var _MetadataStream,timestampRolloverStream_TimestampRolloverStream=TimestampRolloverStream$1,timestampRolloverStream_handleRollover=handleRollover$1,percentEncode$1=function(bytes,start,end){var i,result="";for(i=start;i<end;i++)result+="%"+("00"+bytes[i].toString(16)).slice(-2);return result},parseUtf8=function(bytes,start,end){return decodeURIComponent(percentEncode$1(bytes,start,end))},parseSyncSafeInteger$1=function(data){return data[0]<<21|data[1]<<14|data[2]<<7|data[3]},tagParsers={TXXX:function(tag){var i;if(3===tag.data[0]){for(i=1;i<tag.data.length;i++)if(0===tag.data[i]){tag.description=parseUtf8(tag.data,1,i),tag.value=parseUtf8(tag.data,i+1,tag.data.length).replace(/\0*$/,"");break}tag.data=tag.value}},WXXX:function(tag){var i;if(3===tag.data[0])for(i=1;i<tag.data.length;i++)if(0===tag.data[i]){tag.description=parseUtf8(tag.data,1,i),tag.url=parseUtf8(tag.data,i+1,tag.data.length);break}},PRIV:function(tag){var i;for(i=0;i<tag.data.length;i++)if(0===tag.data[i]){tag.owner=unescape(percentEncode$1(tag.data,0,i));break}tag.privateData=tag.data.subarray(i+1),tag.data=tag.privateData}};_MetadataStream=function(options){var i,settings={descriptor:options&&options.descriptor},tagSize=0,buffer=[],bufferSize=0;if(_MetadataStream.prototype.init.call(this),this.dispatchType=streamTypes.METADATA_STREAM_TYPE.toString(16),settings.descriptor)for(i=0;i<settings.descriptor.length;i++)this.dispatchType+=("00"+settings.descriptor[i].toString(16)).slice(-2);this.push=function(chunk){var tag,frameStart,frameSize,frame,i;if("timed-metadata"===chunk.type)if(chunk.dataAlignmentIndicator&&(bufferSize=0,buffer.length=0),0===buffer.length&&(chunk.data.length<10||chunk.data[0]!=="I".charCodeAt(0)||chunk.data[1]!=="D".charCodeAt(0)||chunk.data[2]!=="3".charCodeAt(0)))this.trigger("log",{level:"warn",message:"Skipping unrecognized metadata packet"});else if(buffer.push(chunk),bufferSize+=chunk.data.byteLength,1===buffer.length&&(tagSize=parseSyncSafeInteger$1(chunk.data.subarray(6,10)),tagSize+=10),!(bufferSize<tagSize)){for(tag={data:new Uint8Array(tagSize),frames:[],pts:buffer[0].pts,dts:buffer[0].dts},i=0;i<tagSize;)tag.data.set(buffer[0].data.subarray(0,tagSize-i),i),i+=buffer[0].data.byteLength,bufferSize-=buffer[0].data.byteLength,buffer.shift();frameStart=10,64&tag.data[5]&&(frameStart+=4,frameStart+=parseSyncSafeInteger$1(tag.data.subarray(10,14)),tagSize-=parseSyncSafeInteger$1(tag.data.subarray(16,20)));do{if((frameSize=parseSyncSafeInteger$1(tag.data.subarray(frameStart+4,frameStart+8)))<1)return void this.trigger("log",{level:"warn",message:"Malformed ID3 frame encountered. Skipping metadata parsing."});if((frame={id:String.fromCharCode(tag.data[frameStart],tag.data[frameStart+1],tag.data[frameStart+2],tag.data[frameStart+3]),data:tag.data.subarray(frameStart+10,frameStart+frameSize+10)}).key=frame.id,tagParsers[frame.id]&&(tagParsers[frame.id](frame),"com.apple.streaming.transportStreamTimestamp"===frame.owner)){var d=frame.data,size=(1&d[3])<<30|d[4]<<22|d[5]<<14|d[6]<<6|d[7]>>>2;size*=4,frame.timeStamp=size+=3&d[7],void 0===tag.pts&&void 0===tag.dts&&(tag.pts=frame.timeStamp,tag.dts=frame.timeStamp),this.trigger("timestamp",frame)}tag.frames.push(frame),frameStart+=10,frameStart+=frameSize}while(frameStart<tagSize);this.trigger("data",tag)}}},_MetadataStream.prototype=new stream;var _TransportPacketStream,_TransportParseStream,_ElementaryStream,metadataStream=_MetadataStream,TimestampRolloverStream=timestampRolloverStream_TimestampRolloverStream;(_TransportPacketStream=function(){var buffer=new Uint8Array(188),bytesInBuffer=0;_TransportPacketStream.prototype.init.call(this),this.push=function(bytes){var everything,startIndex=0,endIndex=188;for(bytesInBuffer?((everything=new Uint8Array(bytes.byteLength+bytesInBuffer)).set(buffer.subarray(0,bytesInBuffer)),everything.set(bytes,bytesInBuffer),bytesInBuffer=0):everything=bytes;endIndex<everything.byteLength;)71!==everything[startIndex]||71!==everything[endIndex]?(startIndex++,endIndex++):(this.trigger("data",everything.subarray(startIndex,endIndex)),startIndex+=188,endIndex+=188);startIndex<everything.byteLength&&(buffer.set(everything.subarray(startIndex),0),bytesInBuffer=everything.byteLength-startIndex)},this.flush=function(){188===bytesInBuffer&&71===buffer[0]&&(this.trigger("data",buffer),bytesInBuffer=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){bytesInBuffer=0,this.trigger("reset")}}).prototype=new stream,_TransportParseStream=function(){var parsePsi,parsePat,parsePmt,self;_TransportParseStream.prototype.init.call(this),self=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,parsePsi=function(payload,psi){var offset=0;psi.payloadUnitStartIndicator&&(offset+=payload[offset]+1),"pat"===psi.type?parsePat(payload.subarray(offset),psi):parsePmt(payload.subarray(offset),psi)},parsePat=function(payload,pat){pat.section_number=payload[7],pat.last_section_number=payload[8],self.pmtPid=(31&payload[10])<<8|payload[11],pat.pmtPid=self.pmtPid},parsePmt=function(payload,pmt){var tableEnd,offset;if(1&payload[5]){for(self.programMapTable={video:null,audio:null,"timed-metadata":{}},tableEnd=3+((15&payload[1])<<8|payload[2])-4,offset=12+((15&payload[10])<<8|payload[11]);offset<tableEnd;){var streamType=payload[offset],pid=(31&payload[offset+1])<<8|payload[offset+2];streamType===streamTypes.H264_STREAM_TYPE&&null===self.programMapTable.video?self.programMapTable.video=pid:streamType===streamTypes.ADTS_STREAM_TYPE&&null===self.programMapTable.audio?self.programMapTable.audio=pid:streamType===streamTypes.METADATA_STREAM_TYPE&&(self.programMapTable["timed-metadata"][pid]=streamType),offset+=5+((15&payload[offset+3])<<8|payload[offset+4])}pmt.programMapTable=self.programMapTable}},this.push=function(packet){var result={},offset=4;if(result.payloadUnitStartIndicator=!!(64&packet[1]),result.pid=31&packet[1],result.pid<<=8,result.pid|=packet[2],(48&packet[3])>>>4>1&&(offset+=packet[offset]+1),0===result.pid)result.type="pat",parsePsi(packet.subarray(offset),result),this.trigger("data",result);else if(result.pid===this.pmtPid)for(result.type="pmt",parsePsi(packet.subarray(offset),result),this.trigger("data",result);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else void 0===this.programMapTable?this.packetsWaitingForPmt.push([packet,offset,result]):this.processPes_(packet,offset,result)},this.processPes_=function(packet,offset,result){result.streamType=result.pid===this.programMapTable.video?streamTypes.H264_STREAM_TYPE:result.pid===this.programMapTable.audio?streamTypes.ADTS_STREAM_TYPE:this.programMapTable["timed-metadata"][result.pid],result.type="pes",result.data=packet.subarray(offset),this.trigger("data",result)}},_TransportParseStream.prototype=new stream,_TransportParseStream.STREAM_TYPES={h264:27,adts:15},_ElementaryStream=function(){var programMapTable,self=this,segmentHadPmt=!1,video={data:[],size:0},audio={data:[],size:0},timedMetadata={data:[],size:0},flushStream=function(stream,type,forceFlush){var packetFlushable,fragment,packetData=new Uint8Array(stream.size),event={type:type},i=0,offset=0;if(stream.data.length&&!(stream.size<9)){for(event.trackId=stream.data[0].pid,i=0;i<stream.data.length;i++)packetData.set((fragment=stream.data[i]).data,offset),offset+=fragment.data.byteLength;var payload,pes,ptsDtsFlags,startPrefix;startPrefix=(payload=packetData)[0]<<16|payload[1]<<8|payload[2],(pes=event).data=new Uint8Array,1===startPrefix&&(pes.packetLength=6+(payload[4]<<8|payload[5]),pes.dataAlignmentIndicator=0!=(4&payload[6]),192&(ptsDtsFlags=payload[7])&&(pes.pts=(14&payload[9])<<27|(255&payload[10])<<20|(254&payload[11])<<12|(255&payload[12])<<5|(254&payload[13])>>>3,pes.pts*=4,pes.pts+=(6&payload[13])>>>1,pes.dts=pes.pts,64&ptsDtsFlags&&(pes.dts=(14&payload[14])<<27|(255&payload[15])<<20|(254&payload[16])<<12|(255&payload[17])<<5|(254&payload[18])>>>3,pes.dts*=4,pes.dts+=(6&payload[18])>>>1)),pes.data=payload.subarray(9+payload[8])),packetFlushable="video"===type||event.packetLength<=stream.size,(forceFlush||packetFlushable)&&(stream.size=0,stream.data.length=0),packetFlushable&&self.trigger("data",event)}};_ElementaryStream.prototype.init.call(this),this.push=function(data){({pat:function(){},pes:function(){var stream,streamType;switch(data.streamType){case streamTypes.H264_STREAM_TYPE:stream=video,streamType="video";break;case streamTypes.ADTS_STREAM_TYPE:stream=audio,streamType="audio";break;case streamTypes.METADATA_STREAM_TYPE:stream=timedMetadata,streamType="timed-metadata";break;default:return}data.payloadUnitStartIndicator&&flushStream(stream,streamType,!0),stream.data.push(data),stream.size+=data.data.byteLength},pmt:function(){var event={type:"metadata",tracks:[]};null!==(programMapTable=data.programMapTable).video&&event.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+programMapTable.video,codec:"avc",type:"video"}),null!==programMapTable.audio&&event.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+programMapTable.audio,codec:"adts",type:"audio"}),segmentHadPmt=!0,self.trigger("data",event)}})[data.type]()},this.reset=function(){video.size=0,video.data.length=0,audio.size=0,audio.data.length=0,this.trigger("reset")},this.flushStreams_=function(){flushStream(video,"video"),flushStream(audio,"audio"),flushStream(timedMetadata,"timed-metadata")},this.flush=function(){if(!segmentHadPmt&&programMapTable){var pmt={type:"metadata",tracks:[]};null!==programMapTable.video&&pmt.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+programMapTable.video,codec:"avc",type:"video"}),null!==programMapTable.audio&&pmt.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+programMapTable.audio,codec:"adts",type:"audio"}),self.trigger("data",pmt)}segmentHadPmt=!1,this.flushStreams_(),this.trigger("done")}},_ElementaryStream.prototype=new stream;var m2ts={PAT_PID:0,MP2T_PACKET_LENGTH:188,TransportPacketStream:_TransportPacketStream,TransportParseStream:_TransportParseStream,ElementaryStream:_ElementaryStream,TimestampRolloverStream:TimestampRolloverStream,CaptionStream:captionStream.CaptionStream,Cea608Stream:captionStream.Cea608Stream,Cea708Stream:captionStream.Cea708Stream,MetadataStream:metadataStream};for(var type in streamTypes)streamTypes.hasOwnProperty(type)&&(m2ts[type]=streamTypes[type]);var _AdtsStream,m2ts_1=m2ts,ADTS_SAMPLING_FREQUENCIES$1=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];_AdtsStream=function(handlePartialSegments){var buffer,frameNum=0;_AdtsStream.prototype.init.call(this),this.skipWarn_=function(start,end){this.trigger("log",{level:"warn",message:"adts skiping bytes "+start+" to "+end+" in frame "+frameNum+" outside syncword"})},this.push=function(packet){var frameLength,protectionSkipBytes,oldBuffer,sampleCount,adtsFrameDuration,i=0;if(handlePartialSegments||(frameNum=0),"audio"===packet.type){var skip;for(buffer&&buffer.length?(oldBuffer=buffer,(buffer=new Uint8Array(oldBuffer.byteLength+packet.data.byteLength)).set(oldBuffer),buffer.set(packet.data,oldBuffer.byteLength)):buffer=packet.data;i+7<buffer.length;)if(255===buffer[i]&&240==(246&buffer[i+1])){if("number"==typeof skip&&(this.skipWarn_(skip,i),skip=null),protectionSkipBytes=2*(1&~buffer[i+1]),adtsFrameDuration=9e4*(sampleCount=1024*(1+(3&buffer[i+6])))/ADTS_SAMPLING_FREQUENCIES$1[(60&buffer[i+2])>>>2],buffer.byteLength-i<(frameLength=(3&buffer[i+3])<<11|buffer[i+4]<<3|(224&buffer[i+5])>>5))break;this.trigger("data",{pts:packet.pts+frameNum*adtsFrameDuration,dts:packet.dts+frameNum*adtsFrameDuration,sampleCount:sampleCount,audioobjecttype:1+(buffer[i+2]>>>6&3),channelcount:(1&buffer[i+2])<<2|(192&buffer[i+3])>>>6,samplerate:ADTS_SAMPLING_FREQUENCIES$1[(60&buffer[i+2])>>>2],samplingfrequencyindex:(60&buffer[i+2])>>>2,samplesize:16,data:buffer.subarray(i+7+protectionSkipBytes,i+frameLength)}),frameNum++,i+=frameLength}else"number"!=typeof skip&&(skip=i),i++;"number"==typeof skip&&(this.skipWarn_(skip,i),skip=null),buffer=buffer.subarray(i)}},this.flush=function(){frameNum=0,this.trigger("done")},this.reset=function(){buffer=void 0,this.trigger("reset")},this.endTimeline=function(){buffer=void 0,this.trigger("endedtimeline")}},_AdtsStream.prototype=new stream;var _H264Stream,_NalByteStream,PROFILES_WITH_OPTIONAL_SPS_DATA,adts=_AdtsStream,expGolomb=function(workingData){var workingBytesAvailable=workingData.byteLength,workingWord=0,workingBitsAvailable=0;this.length=function(){return 8*workingBytesAvailable},this.bitsAvailable=function(){return 8*workingBytesAvailable+workingBitsAvailable},this.loadWord=function(){var position=workingData.byteLength-workingBytesAvailable,workingBytes=new Uint8Array(4),availableBytes=Math.min(4,workingBytesAvailable);if(0===availableBytes)throw new Error("no bytes available");workingBytes.set(workingData.subarray(position,position+availableBytes)),workingWord=new DataView(workingBytes.buffer).getUint32(0),workingBitsAvailable=8*availableBytes,workingBytesAvailable-=availableBytes},this.skipBits=function(count){var skipBytes;workingBitsAvailable>count?(workingWord<<=count,workingBitsAvailable-=count):(count-=workingBitsAvailable,count-=8*(skipBytes=Math.floor(count/8)),workingBytesAvailable-=skipBytes,this.loadWord(),workingWord<<=count,workingBitsAvailable-=count)},this.readBits=function(size){var bits=Math.min(workingBitsAvailable,size),valu=workingWord>>>32-bits;return(workingBitsAvailable-=bits)>0?workingWord<<=bits:workingBytesAvailable>0&&this.loadWord(),(bits=size-bits)>0?valu<<bits|this.readBits(bits):valu},this.skipLeadingZeros=function(){var leadingZeroCount;for(leadingZeroCount=0;leadingZeroCount<workingBitsAvailable;++leadingZeroCount)if(0!=(workingWord&2147483648>>>leadingZeroCount))return workingWord<<=leadingZeroCount,workingBitsAvailable-=leadingZeroCount,leadingZeroCount;return this.loadWord(),leadingZeroCount+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var clz=this.skipLeadingZeros();return this.readBits(clz+1)-1},this.readExpGolomb=function(){var valu=this.readUnsignedExpGolomb();return 1&valu?1+valu>>>1:-1*(valu>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};_NalByteStream=function(){var i,buffer,syncPoint=0;_NalByteStream.prototype.init.call(this),this.push=function(data){var swapBuffer;buffer?((swapBuffer=new Uint8Array(buffer.byteLength+data.data.byteLength)).set(buffer),swapBuffer.set(data.data,buffer.byteLength),buffer=swapBuffer):buffer=data.data;for(var len=buffer.byteLength;syncPoint<len-3;syncPoint++)if(1===buffer[syncPoint+2]){i=syncPoint+5;break}for(;i<len;)switch(buffer[i]){case 0:if(0!==buffer[i-1]){i+=2;break}if(0!==buffer[i-2]){i++;break}syncPoint+3!==i-2&&this.trigger("data",buffer.subarray(syncPoint+3,i-2));do{i++}while(1!==buffer[i]&&i<len);syncPoint=i-2,i+=3;break;case 1:if(0!==buffer[i-1]||0!==buffer[i-2]){i+=3;break}this.trigger("data",buffer.subarray(syncPoint+3,i-2)),syncPoint=i-2,i+=3;break;default:i+=3}buffer=buffer.subarray(syncPoint),i-=syncPoint,syncPoint=0},this.reset=function(){buffer=null,syncPoint=0,this.trigger("reset")},this.flush=function(){buffer&&buffer.byteLength>3&&this.trigger("data",buffer.subarray(syncPoint+3)),buffer=null,syncPoint=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}},_NalByteStream.prototype=new stream,PROFILES_WITH_OPTIONAL_SPS_DATA={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},_H264Stream=function(){var self,trackId,currentPts,currentDts,discardEmulationPreventionBytes,readSequenceParameterSet,skipScalingList,nalByteStream=new _NalByteStream;_H264Stream.prototype.init.call(this),self=this,this.push=function(packet){"video"===packet.type&&(trackId=packet.trackId,currentPts=packet.pts,currentDts=packet.dts,nalByteStream.push(packet))},nalByteStream.on("data",function(data){var event={trackId:trackId,pts:currentPts,dts:currentDts,data:data,nalUnitTypeCode:31&data[0]};switch(event.nalUnitTypeCode){case 5:event.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:event.nalUnitType="sei_rbsp",event.escapedRBSP=discardEmulationPreventionBytes(data.subarray(1));break;case 7:event.nalUnitType="seq_parameter_set_rbsp",event.escapedRBSP=discardEmulationPreventionBytes(data.subarray(1)),event.config=readSequenceParameterSet(event.escapedRBSP);break;case 8:event.nalUnitType="pic_parameter_set_rbsp";break;case 9:event.nalUnitType="access_unit_delimiter_rbsp"}self.trigger("data",event)}),nalByteStream.on("done",function(){self.trigger("done")}),nalByteStream.on("partialdone",function(){self.trigger("partialdone")}),nalByteStream.on("reset",function(){self.trigger("reset")}),nalByteStream.on("endedtimeline",function(){self.trigger("endedtimeline")}),this.flush=function(){nalByteStream.flush()},this.partialFlush=function(){nalByteStream.partialFlush()},this.reset=function(){nalByteStream.reset()},this.endTimeline=function(){nalByteStream.endTimeline()},skipScalingList=function(count,expGolombDecoder){var j,lastScale=8,nextScale=8;for(j=0;j<count;j++)0!==nextScale&&(nextScale=(lastScale+expGolombDecoder.readExpGolomb()+256)%256),lastScale=0===nextScale?lastScale:nextScale},discardEmulationPreventionBytes=function(data){for(var newLength,newData,length=data.byteLength,emulationPreventionBytesPositions=[],i=1;i<length-2;)0===data[i]&&0===data[i+1]&&3===data[i+2]?(emulationPreventionBytesPositions.push(i+2),i+=2):i++;if(0===emulationPreventionBytesPositions.length)return data;newLength=length-emulationPreventionBytesPositions.length,newData=new Uint8Array(newLength);var sourceIndex=0;for(i=0;i<newLength;sourceIndex++,i++)sourceIndex===emulationPreventionBytesPositions[0]&&(sourceIndex++,emulationPreventionBytesPositions.shift()),newData[i]=data[sourceIndex];return newData},readSequenceParameterSet=function(data){var expGolombDecoder,profileIdc,levelIdc,profileCompatibility,chromaFormatIdc,picOrderCntType,numRefFramesInPicOrderCntCycle,picWidthInMbsMinus1,picHeightInMapUnitsMinus1,frameMbsOnlyFlag,scalingListCount,i,frameCropLeftOffset=0,frameCropRightOffset=0,frameCropTopOffset=0,frameCropBottomOffset=0,sarRatio=[1,1];if(profileIdc=(expGolombDecoder=new expGolomb(data)).readUnsignedByte(),profileCompatibility=expGolombDecoder.readUnsignedByte(),levelIdc=expGolombDecoder.readUnsignedByte(),expGolombDecoder.skipUnsignedExpGolomb(),PROFILES_WITH_OPTIONAL_SPS_DATA[profileIdc]&&(3===(chromaFormatIdc=expGolombDecoder.readUnsignedExpGolomb())&&expGolombDecoder.skipBits(1),expGolombDecoder.skipUnsignedExpGolomb(),expGolombDecoder.skipUnsignedExpGolomb(),expGolombDecoder.skipBits(1),expGolombDecoder.readBoolean()))for(scalingListCount=3!==chromaFormatIdc?8:12,i=0;i<scalingListCount;i++)expGolombDecoder.readBoolean()&&skipScalingList(i<6?16:64,expGolombDecoder);if(expGolombDecoder.skipUnsignedExpGolomb(),0===(picOrderCntType=expGolombDecoder.readUnsignedExpGolomb()))expGolombDecoder.readUnsignedExpGolomb();else if(1===picOrderCntType)for(expGolombDecoder.skipBits(1),expGolombDecoder.skipExpGolomb(),expGolombDecoder.skipExpGolomb(),numRefFramesInPicOrderCntCycle=expGolombDecoder.readUnsignedExpGolomb(),i=0;i<numRefFramesInPicOrderCntCycle;i++)expGolombDecoder.skipExpGolomb();if(expGolombDecoder.skipUnsignedExpGolomb(),expGolombDecoder.skipBits(1),picWidthInMbsMinus1=expGolombDecoder.readUnsignedExpGolomb(),picHeightInMapUnitsMinus1=expGolombDecoder.readUnsignedExpGolomb(),0===(frameMbsOnlyFlag=expGolombDecoder.readBits(1))&&expGolombDecoder.skipBits(1),expGolombDecoder.skipBits(1),expGolombDecoder.readBoolean()&&(frameCropLeftOffset=expGolombDecoder.readUnsignedExpGolomb(),frameCropRightOffset=expGolombDecoder.readUnsignedExpGolomb(),frameCropTopOffset=expGolombDecoder.readUnsignedExpGolomb(),frameCropBottomOffset=expGolombDecoder.readUnsignedExpGolomb()),expGolombDecoder.readBoolean()&&expGolombDecoder.readBoolean())switch(expGolombDecoder.readUnsignedByte()){case 1:sarRatio=[1,1];break;case 2:sarRatio=[12,11];break;case 3:sarRatio=[10,11];break;case 4:sarRatio=[16,11];break;case 5:sarRatio=[40,33];break;case 6:sarRatio=[24,11];break;case 7:sarRatio=[20,11];break;case 8:sarRatio=[32,11];break;case 9:sarRatio=[80,33];break;case 10:sarRatio=[18,11];break;case 11:sarRatio=[15,11];break;case 12:sarRatio=[64,33];break;case 13:sarRatio=[160,99];break;case 14:sarRatio=[4,3];break;case 15:sarRatio=[3,2];break;case 16:sarRatio=[2,1];break;case 255:sarRatio=[expGolombDecoder.readUnsignedByte()<<8|expGolombDecoder.readUnsignedByte(),expGolombDecoder.readUnsignedByte()<<8|expGolombDecoder.readUnsignedByte()]}return{profileIdc:profileIdc,levelIdc:levelIdc,profileCompatibility:profileCompatibility,width:16*(picWidthInMbsMinus1+1)-2*frameCropLeftOffset-2*frameCropRightOffset,height:(2-frameMbsOnlyFlag)*(picHeightInMapUnitsMinus1+1)*16-2*frameCropTopOffset-2*frameCropBottomOffset,sarRatio:sarRatio}}},_H264Stream.prototype=new stream;var _AacStream,h264={H264Stream:_H264Stream,NalByteStream:_NalByteStream},ADTS_SAMPLING_FREQUENCIES=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],parseId3TagSize=function(header,byteIndex){var returnSize=header[byteIndex+6]<<21|header[byteIndex+7]<<14|header[byteIndex+8]<<7|header[byteIndex+9];return returnSize=returnSize>=0?returnSize:0,(16&header[byteIndex+5])>>4?returnSize+20:returnSize+10},getId3Offset=function getId3Offset(data,offset){return data.length-offset<10||data[offset]!=="I".charCodeAt(0)||data[offset+1]!=="D".charCodeAt(0)||data[offset+2]!=="3".charCodeAt(0)?offset:getId3Offset(data,offset+=parseId3TagSize(data,offset))},parseSyncSafeInteger=function(data){return data[0]<<21|data[1]<<14|data[2]<<7|data[3]},utils={isLikelyAacData:function(data){var offset=getId3Offset(data,0);return data.length>=offset+2&&255==(255&data[offset])&&240==(240&data[offset+1])&&16==(22&data[offset+1])},parseId3TagSize:parseId3TagSize,parseAdtsSize:function(header,byteIndex){return 6144&header[byteIndex+3]|header[byteIndex+4]<<3|(224&header[byteIndex+5])>>5},parseType:function(header,byteIndex){return header[byteIndex]==="I".charCodeAt(0)&&header[byteIndex+1]==="D".charCodeAt(0)&&header[byteIndex+2]==="3".charCodeAt(0)?"timed-metadata":!0&header[byteIndex]&&240==(240&header[byteIndex+1])?"audio":null},parseSampleRate:function(packet){for(var i=0;i+5<packet.length;){if(255===packet[i]&&240==(246&packet[i+1]))return ADTS_SAMPLING_FREQUENCIES[(60&packet[i+2])>>>2];i++}return null},parseAacTimestamp:function(packet){var frameStart,frameSize,frame;frameStart=10,64&packet[5]&&(frameStart+=4,frameStart+=parseSyncSafeInteger(packet.subarray(10,14)));do{if((frameSize=parseSyncSafeInteger(packet.subarray(frameStart+4,frameStart+8)))<1)return null;if("PRIV"===String.fromCharCode(packet[frameStart],packet[frameStart+1],packet[frameStart+2],packet[frameStart+3])){frame=packet.subarray(frameStart+10,frameStart+frameSize+10);for(var i=0;i<frame.byteLength;i++)if(0===frame[i]){var owner=unescape(function(bytes,start,end){var i,result="";for(i=0;i<end;i++)result+="%"+("00"+bytes[i].toString(16)).slice(-2);return result}(frame,0,i));if("com.apple.streaming.transportStreamTimestamp"===owner){var d=frame.subarray(i+1),size=(1&d[3])<<30|d[4]<<22|d[5]<<14|d[6]<<6|d[7]>>>2;return(size*=4)+(3&d[7])}break}}frameStart+=10,frameStart+=frameSize}while(frameStart<packet.byteLength);return null}};(_AacStream=function(){var everything=new Uint8Array,timeStamp=0;_AacStream.prototype.init.call(this),this.setTimestamp=function(timestamp){timeStamp=timestamp},this.push=function(bytes){var chunk,packet,tempLength,frameSize=0,byteIndex=0;for(everything.length?(tempLength=everything.length,(everything=new Uint8Array(bytes.byteLength+tempLength)).set(everything.subarray(0,tempLength)),everything.set(bytes,tempLength)):everything=bytes;everything.length-byteIndex>=3;)if(everything[byteIndex]!=="I".charCodeAt(0)||everything[byteIndex+1]!=="D".charCodeAt(0)||everything[byteIndex+2]!=="3".charCodeAt(0))if(255!=(255&everything[byteIndex])||240!=(240&everything[byteIndex+1]))byteIndex++;else{if(everything.length-byteIndex<7)break;if(byteIndex+(frameSize=utils.parseAdtsSize(everything,byteIndex))>everything.length)break;packet={type:"audio",data:everything.subarray(byteIndex,byteIndex+frameSize),pts:timeStamp,dts:timeStamp},this.trigger("data",packet),byteIndex+=frameSize}else{if(everything.length-byteIndex<10)break;if(byteIndex+(frameSize=utils.parseId3TagSize(everything,byteIndex))>everything.length)break;chunk={type:"timed-metadata",data:everything.subarray(byteIndex,byteIndex+frameSize)},this.trigger("data",chunk),byteIndex+=frameSize}everything=everything.length-byteIndex>0?everything.subarray(byteIndex):new Uint8Array},this.reset=function(){everything=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){everything=new Uint8Array,this.trigger("endedtimeline")}}).prototype=new stream;var _VideoSegmentStream,_AudioSegmentStream,_Transmuxer,_CoalesceStream,aac=_AacStream,audioProperties=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],videoProperties=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],H264Stream=h264.H264Stream,isLikelyAacData=utils.isLikelyAacData,retriggerForStream=function(key,event){event.stream=key,this.trigger("log",event)},addPipelineLogRetriggers=function(transmuxer,pipeline){for(var keys=Object.keys(pipeline),i=0;i<keys.length;i++){var key=keys[i];"headOfPipeline"!==key&&pipeline[key].on&&pipeline[key].on("log",retriggerForStream.bind(transmuxer,key))}},arrayEquals=function(a,b){var i;if(a.length!==b.length)return!1;for(i=0;i<a.length;i++)if(a[i]!==b[i])return!1;return!0},generateSegmentTimingInfo=function(baseMediaDecodeTime,startDts,startPts,endDts,endPts,prependedContentDuration){return{start:{dts:baseMediaDecodeTime,pts:baseMediaDecodeTime+(startPts-startDts)},end:{dts:baseMediaDecodeTime+(endDts-startDts),pts:baseMediaDecodeTime+(endPts-startPts)},prependedContentDuration:prependedContentDuration,baseMediaDecodeTime:baseMediaDecodeTime}};_AudioSegmentStream=function(track,options){var sequenceNumber,adtsFrames=[],earliestAllowedDts=0,audioAppendStartTs=0,videoBaseMediaDecodeTime=1/0;sequenceNumber=(options=options||{}).firstSequenceNumber||0,_AudioSegmentStream.prototype.init.call(this),this.push=function(data){trackDecodeInfo_collectDtsInfo(track,data),track&&audioProperties.forEach(function(prop){track[prop]=data[prop]}),adtsFrames.push(data)},this.setEarliestDts=function(earliestDts){earliestAllowedDts=earliestDts},this.setVideoBaseMediaDecodeTime=function(baseMediaDecodeTime){videoBaseMediaDecodeTime=baseMediaDecodeTime},this.setAudioAppendStart=function(timestamp){audioAppendStartTs=timestamp},this.flush=function(){var frames,moof,mdat,boxes,frameDuration,segmentDuration,videoClockCyclesOfSilencePrefixed;0!==adtsFrames.length?(frames=function(adtsFrames,track,earliestAllowedDts){return track.minSegmentDts>=earliestAllowedDts?adtsFrames:(track.minSegmentDts=1/0,adtsFrames.filter(function(currentFrame){return currentFrame.dts>=earliestAllowedDts&&(track.minSegmentDts=Math.min(track.minSegmentDts,currentFrame.dts),track.minSegmentPts=track.minSegmentDts,!0)}))}(adtsFrames,track,earliestAllowedDts),track.baseMediaDecodeTime=trackDecodeInfo_calculateTrackBaseMediaDecodeTime(track,options.keepOriginalTimestamps),videoClockCyclesOfSilencePrefixed=audioFrameUtils_prefixWithSilence(track,frames,audioAppendStartTs,videoBaseMediaDecodeTime),track.samples=function(frames){var i,samples=[];for(i=0;i<frames.length;i++)samples.push({size:frames[i].data.byteLength,duration:1024});return samples}(frames),mdat=mp4Generator_mdat(function(frames){var i,currentFrame,dataOffset=0,data=new Uint8Array(function(array){var i,sum=0;for(i=0;i<array.length;i++)sum+=array[i].data.byteLength;return sum}(frames));for(i=0;i<frames.length;i++)data.set((currentFrame=frames[i]).data,dataOffset),dataOffset+=currentFrame.data.byteLength;return data}(frames)),adtsFrames=[],moof=mp4Generator_moof(sequenceNumber,[track]),boxes=new Uint8Array(moof.byteLength+mdat.byteLength),sequenceNumber++,boxes.set(moof),boxes.set(mdat,moof.byteLength),trackDecodeInfo_clearDtsInfo(track),frameDuration=Math.ceil(9216e4/track.samplerate),frames.length&&(segmentDuration=frames.length*frameDuration,this.trigger("segmentTimingInfo",generateSegmentTimingInfo(clock_audioTsToVideoTs(track.baseMediaDecodeTime,track.samplerate),frames[0].dts,frames[0].pts,frames[0].dts+segmentDuration,frames[0].pts+segmentDuration,videoClockCyclesOfSilencePrefixed||0)),this.trigger("timingInfo",{start:frames[0].pts,end:frames[0].pts+segmentDuration})),this.trigger("data",{track:track,boxes:boxes}),this.trigger("done","AudioSegmentStream")):this.trigger("done","AudioSegmentStream")},this.reset=function(){trackDecodeInfo_clearDtsInfo(track),adtsFrames=[],this.trigger("reset")}},_AudioSegmentStream.prototype=new stream,_VideoSegmentStream=function(track,options){var sequenceNumber,config,pps,nalUnits=[],gopsToAlignWith=[];sequenceNumber=(options=options||{}).firstSequenceNumber||0,_VideoSegmentStream.prototype.init.call(this),delete track.minPTS,this.gopCache_=[],this.push=function(nalUnit){trackDecodeInfo_collectDtsInfo(track,nalUnit),"seq_parameter_set_rbsp"!==nalUnit.nalUnitType||config||(config=nalUnit.config,track.sps=[nalUnit.data],videoProperties.forEach(function(prop){track[prop]=config[prop]},this)),"pic_parameter_set_rbsp"!==nalUnit.nalUnitType||pps||(pps=nalUnit.data,track.pps=[nalUnit.data]),nalUnits.push(nalUnit)},this.flush=function(){for(var frames,gopForFusion,gops,moof,mdat,boxes,firstGop,lastGop,prependedContentDuration=0;nalUnits.length&&"access_unit_delimiter_rbsp"!==nalUnits[0].nalUnitType;)nalUnits.shift();if(0===nalUnits.length)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");if(frames=function(nalUnits){var i,currentNal,currentFrame=[],frames=[];for(frames.byteLength=0,frames.nalCount=0,frames.duration=0,currentFrame.byteLength=0,i=0;i<nalUnits.length;i++)"access_unit_delimiter_rbsp"===(currentNal=nalUnits[i]).nalUnitType?(currentFrame.length&&(currentFrame.duration=currentNal.dts-currentFrame.dts,frames.byteLength+=currentFrame.byteLength,frames.nalCount+=currentFrame.length,frames.duration+=currentFrame.duration,frames.push(currentFrame)),(currentFrame=[currentNal]).byteLength=currentNal.data.byteLength,currentFrame.pts=currentNal.pts,currentFrame.dts=currentNal.dts):("slice_layer_without_partitioning_rbsp_idr"===currentNal.nalUnitType&&(currentFrame.keyFrame=!0),currentFrame.duration=currentNal.dts-currentFrame.dts,currentFrame.byteLength+=currentNal.data.byteLength,currentFrame.push(currentNal));return frames.length&&(!currentFrame.duration||currentFrame.duration<=0)&&(currentFrame.duration=frames[frames.length-1].duration),frames.byteLength+=currentFrame.byteLength,frames.nalCount+=currentFrame.length,frames.duration+=currentFrame.duration,frames.push(currentFrame),frames}(nalUnits),(gops=function(frames){var i,currentFrame,currentGop=[],gops=[];for(currentGop.byteLength=0,currentGop.nalCount=0,currentGop.duration=0,currentGop.pts=frames[0].pts,currentGop.dts=frames[0].dts,gops.byteLength=0,gops.nalCount=0,gops.duration=0,gops.pts=frames[0].pts,gops.dts=frames[0].dts,i=0;i<frames.length;i++)(currentFrame=frames[i]).keyFrame?(currentGop.length&&(gops.push(currentGop),gops.byteLength+=currentGop.byteLength,gops.nalCount+=currentGop.nalCount,gops.duration+=currentGop.duration),(currentGop=[currentFrame]).nalCount=currentFrame.length,currentGop.byteLength=currentFrame.byteLength,currentGop.pts=currentFrame.pts,currentGop.dts=currentFrame.dts,currentGop.duration=currentFrame.duration):(currentGop.duration+=currentFrame.duration,currentGop.nalCount+=currentFrame.length,currentGop.byteLength+=currentFrame.byteLength,currentGop.push(currentFrame));return gops.length&&currentGop.duration<=0&&(currentGop.duration=gops[gops.length-1].duration),gops.byteLength+=currentGop.byteLength,gops.nalCount+=currentGop.nalCount,gops.duration+=currentGop.duration,gops.push(currentGop),gops}(frames))[0][0].keyFrame||((gopForFusion=this.getGopForFusion_(nalUnits[0],track))?(prependedContentDuration=gopForFusion.duration,gops.unshift(gopForFusion),gops.byteLength+=gopForFusion.byteLength,gops.nalCount+=gopForFusion.nalCount,gops.pts=gopForFusion.pts,gops.dts=gopForFusion.dts,gops.duration+=gopForFusion.duration):gops=function(gops){var currentGop;return!gops[0][0].keyFrame&&gops.length>1&&(currentGop=gops.shift(),gops.byteLength-=currentGop.byteLength,gops.nalCount-=currentGop.nalCount,gops[0][0].dts=currentGop.dts,gops[0][0].pts=currentGop.pts,gops[0][0].duration+=currentGop.duration),gops}(gops)),gopsToAlignWith.length){var alignedGops;if(!(alignedGops=options.alignGopsAtEnd?this.alignGopsAtEnd_(gops):this.alignGopsAtStart_(gops)))return this.gopCache_.unshift({gop:gops.pop(),pps:track.pps,sps:track.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),nalUnits=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");trackDecodeInfo_clearDtsInfo(track),gops=alignedGops}trackDecodeInfo_collectDtsInfo(track,gops),track.samples=function(gops,baseDataOffset){var h,i,sample,currentGop,dataOffset=baseDataOffset||0,samples=[];for(h=0;h<gops.length;h++)for(currentGop=gops[h],i=0;i<currentGop.length;i++)dataOffset+=(sample=sampleForFrame(currentGop[i],dataOffset)).size,samples.push(sample);return samples}(gops),mdat=mp4Generator_mdat(function(gops){var h,i,j,currentGop,currentFrame,currentNal,dataOffset=0,data=new Uint8Array(gops.byteLength+4*gops.nalCount),view=new DataView(data.buffer);for(h=0;h<gops.length;h++)for(currentGop=gops[h],i=0;i<currentGop.length;i++)for(currentFrame=currentGop[i],j=0;j<currentFrame.length;j++)view.setUint32(dataOffset,(currentNal=currentFrame[j]).data.byteLength),data.set(currentNal.data,dataOffset+=4),dataOffset+=currentNal.data.byteLength;return data}(gops)),track.baseMediaDecodeTime=trackDecodeInfo_calculateTrackBaseMediaDecodeTime(track,options.keepOriginalTimestamps),this.trigger("processedGopsInfo",gops.map(function(gop){return{pts:gop.pts,dts:gop.dts,byteLength:gop.byteLength}})),this.trigger("segmentTimingInfo",generateSegmentTimingInfo(track.baseMediaDecodeTime,(firstGop=gops[0]).dts,firstGop.pts,(lastGop=gops[gops.length-1]).dts+lastGop.duration,lastGop.pts+lastGop.duration,prependedContentDuration)),this.trigger("timingInfo",{start:gops[0].pts,end:gops[gops.length-1].pts+gops[gops.length-1].duration}),this.gopCache_.unshift({gop:gops.pop(),pps:track.pps,sps:track.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),nalUnits=[],this.trigger("baseMediaDecodeTime",track.baseMediaDecodeTime),this.trigger("timelineStartInfo",track.timelineStartInfo),moof=mp4Generator_moof(sequenceNumber,[track]),boxes=new Uint8Array(moof.byteLength+mdat.byteLength),sequenceNumber++,boxes.set(moof),boxes.set(mdat,moof.byteLength),this.trigger("data",{track:track,boxes:boxes}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),nalUnits=[],this.gopCache_.length=0,gopsToAlignWith.length=0,this.trigger("reset")},this.resetStream_=function(){trackDecodeInfo_clearDtsInfo(track),config=void 0,pps=void 0},this.getGopForFusion_=function(nalUnit){var dtsDistance,nearestGopObj,currentGop,currentGopObj,i,nearestDistance=1/0;for(i=0;i<this.gopCache_.length;i++)currentGop=(currentGopObj=this.gopCache_[i]).gop,track.pps&&arrayEquals(track.pps[0],currentGopObj.pps[0])&&track.sps&&arrayEquals(track.sps[0],currentGopObj.sps[0])&&(currentGop.dts<track.timelineStartInfo.dts||(dtsDistance=nalUnit.dts-currentGop.dts-currentGop.duration)>=-1e4&&dtsDistance<=45e3&&(!nearestGopObj||nearestDistance>dtsDistance)&&(nearestGopObj=currentGopObj,nearestDistance=dtsDistance));return nearestGopObj?nearestGopObj.gop:null},this.alignGopsAtStart_=function(gops){var alignIndex,gopIndex,align,gop,byteLength,nalCount,duration,alignedGops;for(byteLength=gops.byteLength,nalCount=gops.nalCount,duration=gops.duration,alignIndex=gopIndex=0;alignIndex<gopsToAlignWith.length&&gopIndex<gops.length&&(align=gopsToAlignWith[alignIndex]).pts!==(gop=gops[gopIndex]).pts;)gop.pts>align.pts?alignIndex++:(gopIndex++,byteLength-=gop.byteLength,nalCount-=gop.nalCount,duration-=gop.duration);return 0===gopIndex?gops:gopIndex===gops.length?null:((alignedGops=gops.slice(gopIndex)).byteLength=byteLength,alignedGops.duration=duration,alignedGops.nalCount=nalCount,alignedGops.pts=alignedGops[0].pts,alignedGops.dts=alignedGops[0].dts,alignedGops)},this.alignGopsAtEnd_=function(gops){var alignIndex,gopIndex,align,gop,alignEndIndex,matchFound,trimIndex;for(alignIndex=gopsToAlignWith.length-1,gopIndex=gops.length-1,alignEndIndex=null,matchFound=!1;alignIndex>=0&&gopIndex>=0;){if((align=gopsToAlignWith[alignIndex]).pts===(gop=gops[gopIndex]).pts){matchFound=!0;break}align.pts>gop.pts?alignIndex--:(alignIndex===gopsToAlignWith.length-1&&(alignEndIndex=gopIndex),gopIndex--)}if(!matchFound&&null===alignEndIndex)return null;if(0===(trimIndex=matchFound?gopIndex:alignEndIndex))return gops;var alignedGops=gops.slice(trimIndex),metadata=alignedGops.reduce(function(total,gop){return total.byteLength+=gop.byteLength,total.duration+=gop.duration,total.nalCount+=gop.nalCount,total},{byteLength:0,duration:0,nalCount:0});return alignedGops.byteLength=metadata.byteLength,alignedGops.duration=metadata.duration,alignedGops.nalCount=metadata.nalCount,alignedGops.pts=alignedGops[0].pts,alignedGops.dts=alignedGops[0].dts,alignedGops},this.alignGopsWith=function(newGopsToAlignWith){gopsToAlignWith=newGopsToAlignWith}},_VideoSegmentStream.prototype=new stream,_CoalesceStream=function(options,metadataStream){this.numberOfTracks=0,this.metadataStream=metadataStream,this.remuxTracks=void 0===(options=options||{}).remux||!!options.remux,this.keepOriginalTimestamps="boolean"==typeof options.keepOriginalTimestamps&&options.keepOriginalTimestamps,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,_CoalesceStream.prototype.init.call(this),this.push=function(output){return output.text?this.pendingCaptions.push(output):output.frames?this.pendingMetadata.push(output):(this.pendingTracks.push(output.track),this.pendingBytes+=output.boxes.byteLength,"video"===output.track.type&&(this.videoTrack=output.track,this.pendingBoxes.push(output.boxes)),void("audio"===output.track.type&&(this.audioTrack=output.track,this.pendingBoxes.unshift(output.boxes))))}},_CoalesceStream.prototype=new stream,_CoalesceStream.prototype.flush=function(flushSource){var caption,id3,initSegment,i,offset=0,event={captions:[],captionStreams:{},metadata:[],info:{}},timelineStartPts=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==flushSource&&"AudioSegmentStream"!==flushSource)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}if(this.videoTrack?(timelineStartPts=this.videoTrack.timelineStartInfo.pts,videoProperties.forEach(function(prop){event.info[prop]=this.videoTrack[prop]},this)):this.audioTrack&&(timelineStartPts=this.audioTrack.timelineStartInfo.pts,audioProperties.forEach(function(prop){event.info[prop]=this.audioTrack[prop]},this)),this.videoTrack||this.audioTrack){for(event.type=1===this.pendingTracks.length?this.pendingTracks[0].type:"combined",this.emittedTracks+=this.pendingTracks.length,initSegment=function(tracks){var result,fileType=ftyp(),movie=moov(tracks);return(result=new Uint8Array(fileType.byteLength+movie.byteLength)).set(fileType),result.set(movie,fileType.byteLength),result}(this.pendingTracks),event.initSegment=new Uint8Array(initSegment.byteLength),event.initSegment.set(initSegment),event.data=new Uint8Array(this.pendingBytes),i=0;i<this.pendingBoxes.length;i++)event.data.set(this.pendingBoxes[i],offset),offset+=this.pendingBoxes[i].byteLength;for(i=0;i<this.pendingCaptions.length;i++)(caption=this.pendingCaptions[i]).startTime=clock_metadataTsToSeconds(caption.startPts,timelineStartPts,this.keepOriginalTimestamps),caption.endTime=clock_metadataTsToSeconds(caption.endPts,timelineStartPts,this.keepOriginalTimestamps),event.captionStreams[caption.stream]=!0,event.captions.push(caption);for(i=0;i<this.pendingMetadata.length;i++)(id3=this.pendingMetadata[i]).cueTime=clock_metadataTsToSeconds(id3.pts,timelineStartPts,this.keepOriginalTimestamps),event.metadata.push(id3);for(event.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",event),i=0;i<event.captions.length;i++)this.trigger("caption",caption=event.captions[i]);for(i=0;i<event.metadata.length;i++)this.trigger("id3Frame",id3=event.metadata[i])}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},_CoalesceStream.prototype.setRemux=function(val){this.remuxTracks=val},_Transmuxer=function(options){var videoTrack,audioTrack,self=this,hasFlushed=!0;_Transmuxer.prototype.init.call(this),this.baseMediaDecodeTime=(options=options||{}).baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var pipeline={};this.transmuxPipeline_=pipeline,pipeline.type="aac",pipeline.metadataStream=new m2ts_1.MetadataStream,pipeline.aacStream=new aac,pipeline.audioTimestampRolloverStream=new m2ts_1.TimestampRolloverStream("audio"),pipeline.timedMetadataTimestampRolloverStream=new m2ts_1.TimestampRolloverStream("timed-metadata"),pipeline.adtsStream=new adts,pipeline.coalesceStream=new _CoalesceStream(options,pipeline.metadataStream),pipeline.headOfPipeline=pipeline.aacStream,pipeline.aacStream.pipe(pipeline.audioTimestampRolloverStream).pipe(pipeline.adtsStream),pipeline.aacStream.pipe(pipeline.timedMetadataTimestampRolloverStream).pipe(pipeline.metadataStream).pipe(pipeline.coalesceStream),pipeline.metadataStream.on("timestamp",function(frame){pipeline.aacStream.setTimestamp(frame.timeStamp)}),pipeline.aacStream.on("data",function(data){"timed-metadata"!==data.type&&"audio"!==data.type||pipeline.audioSegmentStream||(audioTrack=audioTrack||{timelineStartInfo:{baseMediaDecodeTime:self.baseMediaDecodeTime},codec:"adts",type:"audio"},pipeline.coalesceStream.numberOfTracks++,pipeline.audioSegmentStream=new _AudioSegmentStream(audioTrack,options),pipeline.audioSegmentStream.on("log",self.getLogTrigger_("audioSegmentStream")),pipeline.audioSegmentStream.on("timingInfo",self.trigger.bind(self,"audioTimingInfo")),pipeline.adtsStream.pipe(pipeline.audioSegmentStream).pipe(pipeline.coalesceStream),self.trigger("trackinfo",{hasAudio:!!audioTrack,hasVideo:!!videoTrack}))}),pipeline.coalesceStream.on("data",this.trigger.bind(this,"data")),pipeline.coalesceStream.on("done",this.trigger.bind(this,"done")),addPipelineLogRetriggers(this,pipeline)},this.setupTsPipeline=function(){var pipeline={};this.transmuxPipeline_=pipeline,pipeline.type="ts",pipeline.metadataStream=new m2ts_1.MetadataStream,pipeline.packetStream=new m2ts_1.TransportPacketStream,pipeline.parseStream=new m2ts_1.TransportParseStream,pipeline.elementaryStream=new m2ts_1.ElementaryStream,pipeline.timestampRolloverStream=new m2ts_1.TimestampRolloverStream,pipeline.adtsStream=new adts,pipeline.h264Stream=new H264Stream,pipeline.captionStream=new m2ts_1.CaptionStream(options),pipeline.coalesceStream=new _CoalesceStream(options,pipeline.metadataStream),pipeline.headOfPipeline=pipeline.packetStream,pipeline.packetStream.pipe(pipeline.parseStream).pipe(pipeline.elementaryStream).pipe(pipeline.timestampRolloverStream),pipeline.timestampRolloverStream.pipe(pipeline.h264Stream),pipeline.timestampRolloverStream.pipe(pipeline.adtsStream),pipeline.timestampRolloverStream.pipe(pipeline.metadataStream).pipe(pipeline.coalesceStream),pipeline.h264Stream.pipe(pipeline.captionStream).pipe(pipeline.coalesceStream),pipeline.elementaryStream.on("data",function(data){var i;if("metadata"===data.type){for(i=data.tracks.length;i--;)videoTrack||"video"!==data.tracks[i].type?audioTrack||"audio"!==data.tracks[i].type||((audioTrack=data.tracks[i]).timelineStartInfo.baseMediaDecodeTime=self.baseMediaDecodeTime):(videoTrack=data.tracks[i]).timelineStartInfo.baseMediaDecodeTime=self.baseMediaDecodeTime;videoTrack&&!pipeline.videoSegmentStream&&(pipeline.coalesceStream.numberOfTracks++,pipeline.videoSegmentStream=new _VideoSegmentStream(videoTrack,options),pipeline.videoSegmentStream.on("log",self.getLogTrigger_("videoSegmentStream")),pipeline.videoSegmentStream.on("timelineStartInfo",function(timelineStartInfo){audioTrack&&!options.keepOriginalTimestamps&&(audioTrack.timelineStartInfo=timelineStartInfo,pipeline.audioSegmentStream.setEarliestDts(timelineStartInfo.dts-self.baseMediaDecodeTime))}),pipeline.videoSegmentStream.on("processedGopsInfo",self.trigger.bind(self,"gopInfo")),pipeline.videoSegmentStream.on("segmentTimingInfo",self.trigger.bind(self,"videoSegmentTimingInfo")),pipeline.videoSegmentStream.on("baseMediaDecodeTime",function(baseMediaDecodeTime){audioTrack&&pipeline.audioSegmentStream.setVideoBaseMediaDecodeTime(baseMediaDecodeTime)}),pipeline.videoSegmentStream.on("timingInfo",self.trigger.bind(self,"videoTimingInfo")),pipeline.h264Stream.pipe(pipeline.videoSegmentStream).pipe(pipeline.coalesceStream)),audioTrack&&!pipeline.audioSegmentStream&&(pipeline.coalesceStream.numberOfTracks++,pipeline.audioSegmentStream=new _AudioSegmentStream(audioTrack,options),pipeline.audioSegmentStream.on("log",self.getLogTrigger_("audioSegmentStream")),pipeline.audioSegmentStream.on("timingInfo",self.trigger.bind(self,"audioTimingInfo")),pipeline.audioSegmentStream.on("segmentTimingInfo",self.trigger.bind(self,"audioSegmentTimingInfo")),pipeline.adtsStream.pipe(pipeline.audioSegmentStream).pipe(pipeline.coalesceStream)),self.trigger("trackinfo",{hasAudio:!!audioTrack,hasVideo:!!videoTrack})}}),pipeline.coalesceStream.on("data",this.trigger.bind(this,"data")),pipeline.coalesceStream.on("id3Frame",function(id3Frame){id3Frame.dispatchType=pipeline.metadataStream.dispatchType,self.trigger("id3Frame",id3Frame)}),pipeline.coalesceStream.on("caption",this.trigger.bind(this,"caption")),pipeline.coalesceStream.on("done",this.trigger.bind(this,"done")),addPipelineLogRetriggers(this,pipeline)},this.setBaseMediaDecodeTime=function(baseMediaDecodeTime){var pipeline=this.transmuxPipeline_;options.keepOriginalTimestamps||(this.baseMediaDecodeTime=baseMediaDecodeTime),audioTrack&&(audioTrack.timelineStartInfo.dts=void 0,audioTrack.timelineStartInfo.pts=void 0,trackDecodeInfo_clearDtsInfo(audioTrack),pipeline.audioTimestampRolloverStream&&pipeline.audioTimestampRolloverStream.discontinuity()),videoTrack&&(pipeline.videoSegmentStream&&(pipeline.videoSegmentStream.gopCache_=[]),videoTrack.timelineStartInfo.dts=void 0,videoTrack.timelineStartInfo.pts=void 0,trackDecodeInfo_clearDtsInfo(videoTrack),pipeline.captionStream.reset()),pipeline.timestampRolloverStream&&pipeline.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(timestamp){audioTrack&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(timestamp)},this.setRemux=function(val){var pipeline=this.transmuxPipeline_;options.remux=val,pipeline&&pipeline.coalesceStream&&pipeline.coalesceStream.setRemux(val)},this.alignGopsWith=function(gopsToAlignWith){videoTrack&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(gopsToAlignWith)},this.getLogTrigger_=function(key){var self=this;return function(event){event.stream=key,self.trigger("log",event)}},this.push=function(data){if(hasFlushed){var isAac=isLikelyAacData(data);isAac&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():isAac||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline(),hasFlushed=!1}this.transmuxPipeline_.headOfPipeline.push(data)},this.flush=function(){hasFlushed=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}},_Transmuxer.prototype=new stream;var startTime,getTracks,getTimescaleFromMediaHeader,transmuxer={Transmuxer:_Transmuxer,VideoSegmentStream:_VideoSegmentStream,AudioSegmentStream:_AudioSegmentStream,AUDIO_PROPERTIES:audioProperties,VIDEO_PROPERTIES:videoProperties,generateSegmentTimingInfo:generateSegmentTimingInfo},bin_toUnsigned=function(value){return value>>>0},parseType_1=function(buffer){var result="";return result+=String.fromCharCode(buffer[0]),result+=String.fromCharCode(buffer[1]),(result+=String.fromCharCode(buffer[2]))+String.fromCharCode(buffer[3])},toUnsigned$2=bin_toUnsigned,findBox_1=function findBox(data,path){var i,size,type,end,subresults,results=[];if(!path.length)return null;for(i=0;i<data.byteLength;)size=toUnsigned$2(data[i]<<24|data[i+1]<<16|data[i+2]<<8|data[i+3]),type=parseType_1(data.subarray(i+4,i+8)),end=size>1?i+size:data.byteLength,type===path[0]&&(1===path.length?results.push(data.subarray(i+8,end)):(subresults=findBox(data.subarray(i+8,end),path.slice(1))).length&&(results=results.concat(subresults))),i=end;return results},toUnsigned$1=bin_toUnsigned,parseSampleFlags_1=function(flags){return{isLeading:(12&flags[0])>>>2,dependsOn:3&flags[0],isDependedOn:(192&flags[1])>>>6,hasRedundancy:(48&flags[1])>>>4,paddingValue:(14&flags[1])>>>1,isNonSyncSample:1&flags[1],degradationPriority:flags[2]<<8|flags[3]}},discardEmulationPreventionBytes=function(data){for(var newLength,newData,length=data.byteLength,emulationPreventionBytesPositions=[],i=1;i<length-2;)0===data[i]&&0===data[i+1]&&3===data[i+2]?(emulationPreventionBytesPositions.push(i+2),i+=2):i++;if(0===emulationPreventionBytesPositions.length)return data;newLength=length-emulationPreventionBytesPositions.length,newData=new Uint8Array(newLength);var sourceIndex=0;for(i=0;i<newLength;sourceIndex++,i++)sourceIndex===emulationPreventionBytesPositions[0]&&(sourceIndex++,emulationPreventionBytesPositions.shift()),newData[i]=data[sourceIndex];return newData},CaptionStream=captionStream.CaptionStream,mapToSample=function(offset,samples){for(var approximateOffset=offset,i=0;i<samples.length;i++){var sample=samples[i];if(approximateOffset<sample.size)return sample;approximateOffset-=sample.size}return null},parseCaptionNals=function(segment,videoTrackId){var trafs=findBox_1(segment,["moof","traf"]),mdats=findBox_1(segment,["mdat"]),captionNals={},mdatTrafPairs=[];return mdats.forEach(function(mdat,index){mdatTrafPairs.push({mdat:mdat,traf:trafs[index]})}),mdatTrafPairs.forEach(function(pair){var samples,result,mdat=pair.mdat,traf=pair.traf,headerInfo=function(data){var i,view=new DataView(data.buffer,data.byteOffset,data.byteLength),result={version:data[0],flags:new Uint8Array(data.subarray(1,4)),trackId:view.getUint32(4)},baseDataOffsetPresent=1&result.flags[2],sampleDescriptionIndexPresent=2&result.flags[2],defaultSampleDurationPresent=8&result.flags[2],defaultSampleSizePresent=16&result.flags[2],defaultSampleFlagsPresent=32&result.flags[2],durationIsEmpty=65536&result.flags[0],defaultBaseIsMoof=131072&result.flags[0];return i=8,baseDataOffsetPresent&&(i+=4,result.baseDataOffset=view.getUint32(12),i+=4),sampleDescriptionIndexPresent&&(result.sampleDescriptionIndex=view.getUint32(i),i+=4),defaultSampleDurationPresent&&(result.defaultSampleDuration=view.getUint32(i),i+=4),defaultSampleSizePresent&&(result.defaultSampleSize=view.getUint32(i),i+=4),defaultSampleFlagsPresent&&(result.defaultSampleFlags=view.getUint32(i)),durationIsEmpty&&(result.durationIsEmpty=!0),!baseDataOffsetPresent&&defaultBaseIsMoof&&(result.baseDataOffsetIsMoof=!0),result}(findBox_1(traf,["tfhd"])[0]),trackId=headerInfo.trackId,tfdt=findBox_1(traf,["tfdt"]),baseMediaDecodeTime=tfdt.length>0?function(data){var result={version:data[0],flags:new Uint8Array(data.subarray(1,4)),baseMediaDecodeTime:toUnsigned$1(data[4]<<24|data[5]<<16|data[6]<<8|data[7])};return 1===result.version&&(result.baseMediaDecodeTime*=Math.pow(2,32),result.baseMediaDecodeTime+=toUnsigned$1(data[8]<<24|data[9]<<16|data[10]<<8|data[11])),result}(tfdt[0]).baseMediaDecodeTime:0,truns=findBox_1(traf,["trun"]);videoTrackId===trackId&&truns.length>0&&(samples=function(truns,baseMediaDecodeTime,tfhd){var currentDts=baseMediaDecodeTime,defaultSampleDuration=tfhd.defaultSampleDuration||0,defaultSampleSize=tfhd.defaultSampleSize||0,trackId=tfhd.trackId,allSamples=[];return truns.forEach(function(trun){var samples=function(data){var sample,result={version:data[0],flags:new Uint8Array(data.subarray(1,4)),samples:[]},view=new DataView(data.buffer,data.byteOffset,data.byteLength),dataOffsetPresent=1&result.flags[2],firstSampleFlagsPresent=4&result.flags[2],sampleDurationPresent=1&result.flags[1],sampleSizePresent=2&result.flags[1],sampleFlagsPresent=4&result.flags[1],sampleCompositionTimeOffsetPresent=8&result.flags[1],sampleCount=view.getUint32(4),offset=8;for(dataOffsetPresent&&(result.dataOffset=view.getInt32(offset),offset+=4),firstSampleFlagsPresent&&sampleCount&&(sample={flags:parseSampleFlags_1(data.subarray(offset,offset+4))},offset+=4,sampleDurationPresent&&(sample.duration=view.getUint32(offset),offset+=4),sampleSizePresent&&(sample.size=view.getUint32(offset),offset+=4),sampleCompositionTimeOffsetPresent&&(sample.compositionTimeOffset=1===result.version?view.getInt32(offset):view.getUint32(offset),offset+=4),result.samples.push(sample),sampleCount--);sampleCount--;)sample={},sampleDurationPresent&&(sample.duration=view.getUint32(offset),offset+=4),sampleSizePresent&&(sample.size=view.getUint32(offset),offset+=4),sampleFlagsPresent&&(sample.flags=parseSampleFlags_1(data.subarray(offset,offset+4)),offset+=4),sampleCompositionTimeOffsetPresent&&(sample.compositionTimeOffset=1===result.version?view.getInt32(offset):view.getUint32(offset),offset+=4),result.samples.push(sample);return result}(trun).samples;samples.forEach(function(sample){void 0===sample.duration&&(sample.duration=defaultSampleDuration),void 0===sample.size&&(sample.size=defaultSampleSize),sample.trackId=trackId,sample.dts=currentDts,void 0===sample.compositionTimeOffset&&(sample.compositionTimeOffset=0),sample.pts=currentDts+sample.compositionTimeOffset,currentDts+=sample.duration}),allSamples=allSamples.concat(samples)}),allSamples}(truns,baseMediaDecodeTime,headerInfo),result=function(avcStream,samples,trackId){var seiNal,i,length,lastMatchedSample,avcView=new DataView(avcStream.buffer,avcStream.byteOffset,avcStream.byteLength),result={logs:[],seiNals:[]};for(i=0;i+4<avcStream.length;i+=length)if(length=avcView.getUint32(i),i+=4,!(length<=0))switch(31&avcStream[i]){case 6:var data=avcStream.subarray(i+1,i+1+length),matchingSample=mapToSample(i,samples);if(seiNal={nalUnitType:"sei_rbsp",size:length,data:data,escapedRBSP:discardEmulationPreventionBytes(data),trackId:trackId},matchingSample)seiNal.pts=matchingSample.pts,seiNal.dts=matchingSample.dts,lastMatchedSample=matchingSample;else{if(!lastMatchedSample){result.logs.push({level:"warn",message:"We've encountered a nal unit without data at "+i+" for trackId "+trackId+". See mux.js#223."});break}seiNal.pts=lastMatchedSample.pts,seiNal.dts=lastMatchedSample.dts}result.seiNals.push(seiNal)}return result}(mdat,samples,trackId),captionNals[trackId]||(captionNals[trackId]={seiNals:[],logs:[]}),captionNals[trackId].seiNals=captionNals[trackId].seiNals.concat(result.seiNals),captionNals[trackId].logs=captionNals[trackId].logs.concat(result.logs))}),captionNals},captionParser=function(){var captionStream,segmentCache,trackId,timescale,parsedCaptions,parsingPartial,isInitialized=!1;this.isInitialized=function(){return isInitialized},this.init=function(options){captionStream=new CaptionStream,isInitialized=!0,parsingPartial=!!options&&options.isPartial,captionStream.on("data",function(event){event.startTime=event.startPts/timescale,event.endTime=event.endPts/timescale,parsedCaptions.captions.push(event),parsedCaptions.captionStreams[event.stream]=!0}),captionStream.on("log",function(log){parsedCaptions.logs.push(log)})},this.isNewInit=function(videoTrackIds,timescales){return!(videoTrackIds&&0===videoTrackIds.length||timescales&&"object"==typeof timescales&&0===Object.keys(timescales).length||trackId===videoTrackIds[0]&&timescale===timescales[trackId])},this.parse=function(segment,videoTrackIds,timescales){var parsedData;if(!this.isInitialized())return null;if(!videoTrackIds||!timescales)return null;if(this.isNewInit(videoTrackIds,timescales))timescale=timescales[trackId=videoTrackIds[0]];else if(null===trackId||!timescale)return segmentCache.push(segment),null;for(;segmentCache.length>0;){var cachedSegment=segmentCache.shift();this.parse(cachedSegment,videoTrackIds,timescales)}return parsedData=function(segment,trackId,timescale){if(null===trackId)return null;var trackNals=parseCaptionNals(segment,trackId)[trackId]||{};return{seiNals:trackNals.seiNals,logs:trackNals.logs,timescale:timescale}}(segment,trackId,timescale),parsedData&&parsedData.logs&&(parsedCaptions.logs=parsedCaptions.logs.concat(parsedData.logs)),null!==parsedData&&parsedData.seiNals?(this.pushNals(parsedData.seiNals),this.flushStream(),parsedCaptions):parsedCaptions.logs.length?{logs:parsedCaptions.logs,captions:[],captionStreams:[]}:null},this.pushNals=function(nals){if(!this.isInitialized()||!nals||0===nals.length)return null;nals.forEach(function(nal){captionStream.push(nal)})},this.flushStream=function(){if(!this.isInitialized())return null;parsingPartial?captionStream.partialFlush():captionStream.flush()},this.clearParsedCaptions=function(){parsedCaptions.captions=[],parsedCaptions.captionStreams={},parsedCaptions.logs=[]},this.resetCaptionStream=function(){if(!this.isInitialized())return null;captionStream.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){segmentCache=[],trackId=null,timescale=null,parsedCaptions?this.clearParsedCaptions():parsedCaptions={captions:[],captionStreams:{},logs:[]},this.resetCaptionStream()},this.reset()},toUnsigned=bin_toUnsigned,toHexString=function(value){return("00"+value.toString(16)).slice(-2)};startTime=function(timescale,fragment){var trafs,baseTimes,result;return trafs=findBox_1(fragment,["moof","traf"]),baseTimes=[].concat.apply([],trafs.map(function(traf){return findBox_1(traf,["tfhd"]).map(function(tfhd){var id,scale,baseTime;return id=toUnsigned(tfhd[4]<<24|tfhd[5]<<16|tfhd[6]<<8|tfhd[7]),scale=timescale[id]||9e4,baseTime=findBox_1(traf,["tfdt"]).map(function(tfdt){var version,result;return version=tfdt[0],result=toUnsigned(tfdt[4]<<24|tfdt[5]<<16|tfdt[6]<<8|tfdt[7]),1===version&&(result*=Math.pow(2,32),result+=toUnsigned(tfdt[8]<<24|tfdt[9]<<16|tfdt[10]<<8|tfdt[11])),result})[0],(baseTime="number"!=typeof baseTime||isNaN(baseTime)?1/0:baseTime)/scale})})),result=Math.min.apply(null,baseTimes),isFinite(result)?result:0},getTimescaleFromMediaHeader=function(mdhd){var index=0===mdhd[0]?12:20;return toUnsigned(mdhd[index]<<24|mdhd[index+1]<<16|mdhd[index+2]<<8|mdhd[index+3])},getTracks=function(init){var traks=findBox_1(init,["moov","trak"]),tracks=[];return traks.forEach(function(trak){var view,tkhdVersion,track={},tkhd=findBox_1(trak,["tkhd"])[0];tkhd&&(tkhdVersion=(view=new DataView(tkhd.buffer,tkhd.byteOffset,tkhd.byteLength)).getUint8(0),track.id=view.getUint32(0===tkhdVersion?12:20));var hdlr=findBox_1(trak,["mdia","hdlr"])[0];if(hdlr){var type=parseType_1(hdlr.subarray(8,12));track.type="vide"===type?"video":"soun"===type?"audio":type}var stsd=findBox_1(trak,["mdia","minf","stbl","stsd"])[0];if(stsd){var sampleDescriptions=stsd.subarray(8);track.codec=parseType_1(sampleDescriptions.subarray(4,8));var codecConfig,codecBox=findBox_1(sampleDescriptions,[track.codec])[0];codecBox&&(/^[asm]vc[1-9]$/i.test(track.codec)?(codecConfig=codecBox.subarray(78),"avcC"===parseType_1(codecConfig.subarray(4,8))&&codecConfig.length>11?(track.codec+=".",track.codec+=toHexString(codecConfig[9]),track.codec+=toHexString(codecConfig[10]),track.codec+=toHexString(codecConfig[11])):track.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(track.codec)?(codecConfig=codecBox.subarray(28),"esds"===parseType_1(codecConfig.subarray(4,8))&&codecConfig.length>20&&0!==codecConfig[19]?(track.codec+="."+toHexString(codecConfig[19]),track.codec+="."+toHexString(codecConfig[20]>>>2&63).replace(/^0/,"")):track.codec="mp4a.40.2"):track.codec=track.codec.toLowerCase())}var mdhd=findBox_1(trak,["mdia","mdhd"])[0];mdhd&&(track.timescale=getTimescaleFromMediaHeader(mdhd)),tracks.push(track)}),tracks};var probe$2_startTime=startTime,probe$2_tracks=getTracks,parsePid=function(packet){var pid=31&packet[1];return(pid<<=8)|packet[2]},parsePayloadUnitStartIndicator=function(packet){return!!(64&packet[1])},parseAdaptionField=function(packet){var offset=0;return(48&packet[3])>>>4>1&&(offset+=packet[4]+1),offset},parseNalUnitType=function(type){switch(type){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},probe$1={parseType:function(packet,pmtPid){var pid=parsePid(packet);return 0===pid?"pat":pid===pmtPid?"pmt":pmtPid?"pes":null},parsePat:function(packet){var pusi=parsePayloadUnitStartIndicator(packet),offset=4+parseAdaptionField(packet);return pusi&&(offset+=packet[offset]+1),(31&packet[offset+10])<<8|packet[offset+11]},parsePmt:function(packet){var programMapTable={},pusi=parsePayloadUnitStartIndicator(packet),payloadOffset=4+parseAdaptionField(packet);if(pusi&&(payloadOffset+=packet[payloadOffset]+1),1&packet[payloadOffset+5]){var tableEnd;tableEnd=3+((15&packet[payloadOffset+1])<<8|packet[payloadOffset+2])-4;for(var offset=12+((15&packet[payloadOffset+10])<<8|packet[payloadOffset+11]);offset<tableEnd;){var i=payloadOffset+offset;programMapTable[(31&packet[i+1])<<8|packet[i+2]]=packet[i],offset+=5+((15&packet[i+3])<<8|packet[i+4])}return programMapTable}},parsePayloadUnitStartIndicator:parsePayloadUnitStartIndicator,parsePesType:function(packet,programMapTable){switch(programMapTable[parsePid(packet)]){case streamTypes.H264_STREAM_TYPE:return"video";case streamTypes.ADTS_STREAM_TYPE:return"audio";case streamTypes.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},parsePesTime:function(packet){if(!parsePayloadUnitStartIndicator(packet))return null;var offset=4+parseAdaptionField(packet);if(offset>=packet.byteLength)return null;var ptsDtsFlags,pes=null;return 192&(ptsDtsFlags=packet[offset+7])&&((pes={}).pts=(14&packet[offset+9])<<27|(255&packet[offset+10])<<20|(254&packet[offset+11])<<12|(255&packet[offset+12])<<5|(254&packet[offset+13])>>>3,pes.pts*=4,pes.pts+=(6&packet[offset+13])>>>1,pes.dts=pes.pts,64&ptsDtsFlags&&(pes.dts=(14&packet[offset+14])<<27|(255&packet[offset+15])<<20|(254&packet[offset+16])<<12|(255&packet[offset+17])<<5|(254&packet[offset+18])>>>3,pes.dts*=4,pes.dts+=(6&packet[offset+18])>>>1)),pes},videoPacketContainsKeyFrame:function(packet){for(var offset=4+parseAdaptionField(packet),frameBuffer=packet.subarray(offset),frameI=0,frameSyncPoint=0,foundKeyFrame=!1;frameSyncPoint<frameBuffer.byteLength-3;frameSyncPoint++)if(1===frameBuffer[frameSyncPoint+2]){frameI=frameSyncPoint+5;break}for(;frameI<frameBuffer.byteLength;)switch(frameBuffer[frameI]){case 0:if(0!==frameBuffer[frameI-1]){frameI+=2;break}if(0!==frameBuffer[frameI-2]){frameI++;break}frameSyncPoint+3!==frameI-2&&"slice_layer_without_partitioning_rbsp_idr"===parseNalUnitType(31&frameBuffer[frameSyncPoint+3])&&(foundKeyFrame=!0);do{frameI++}while(1!==frameBuffer[frameI]&&frameI<frameBuffer.length);frameSyncPoint=frameI-2,frameI+=3;break;case 1:if(0!==frameBuffer[frameI-1]||0!==frameBuffer[frameI-2]){frameI+=3;break}"slice_layer_without_partitioning_rbsp_idr"===parseNalUnitType(31&frameBuffer[frameSyncPoint+3])&&(foundKeyFrame=!0),frameSyncPoint=frameI-2,frameI+=3;break;default:frameI+=3}return frameBuffer=frameBuffer.subarray(frameSyncPoint),frameI-=frameSyncPoint,frameSyncPoint=0,frameBuffer&&frameBuffer.byteLength>3&&"slice_layer_without_partitioning_rbsp_idr"===parseNalUnitType(31&frameBuffer[frameSyncPoint+3])&&(foundKeyFrame=!0),foundKeyFrame}},handleRollover=timestampRolloverStream_handleRollover,probe={};probe.ts=probe$1,probe.aac=utils;var parseAudioPes_=function(bytes,pmt,result){for(var packet,pesType,pusi,parsed,startIndex=0,endIndex=188,endLoop=!1;endIndex<=bytes.byteLength;)if(71!==bytes[startIndex]||71!==bytes[endIndex]&&endIndex!==bytes.byteLength)startIndex++,endIndex++;else{if(packet=bytes.subarray(startIndex,endIndex),"pes"===probe.ts.parseType(packet,pmt.pid)&&(pesType=probe.ts.parsePesType(packet,pmt.table),pusi=probe.ts.parsePayloadUnitStartIndicator(packet),"audio"===pesType&&pusi&&(parsed=probe.ts.parsePesTime(packet))&&(parsed.type="audio",result.audio.push(parsed),endLoop=!0)),endLoop)break;startIndex+=188,endIndex+=188}for(startIndex=(endIndex=bytes.byteLength)-188,endLoop=!1;startIndex>=0;)if(71!==bytes[startIndex]||71!==bytes[endIndex]&&endIndex!==bytes.byteLength)startIndex--,endIndex--;else{if(packet=bytes.subarray(startIndex,endIndex),"pes"===probe.ts.parseType(packet,pmt.pid)&&(pesType=probe.ts.parsePesType(packet,pmt.table),pusi=probe.ts.parsePayloadUnitStartIndicator(packet),"audio"===pesType&&pusi&&(parsed=probe.ts.parsePesTime(packet))&&(parsed.type="audio",result.audio.push(parsed),endLoop=!0)),endLoop)break;startIndex-=188,endIndex-=188}},parseVideoPes_=function(bytes,pmt,result){for(var packet,pesType,pusi,parsed,frame,i,pes,startIndex=0,endIndex=188,endLoop=!1,currentFrame={data:[],size:0};endIndex<bytes.byteLength;)if(71!==bytes[startIndex]||71!==bytes[endIndex])startIndex++,endIndex++;else{if(packet=bytes.subarray(startIndex,endIndex),"pes"===probe.ts.parseType(packet,pmt.pid)&&(pesType=probe.ts.parsePesType(packet,pmt.table),pusi=probe.ts.parsePayloadUnitStartIndicator(packet),"video"===pesType&&(pusi&&!endLoop&&(parsed=probe.ts.parsePesTime(packet))&&(parsed.type="video",result.video.push(parsed),endLoop=!0),!result.firstKeyFrame))){if(pusi&&0!==currentFrame.size){for(frame=new Uint8Array(currentFrame.size),i=0;currentFrame.data.length;)pes=currentFrame.data.shift(),frame.set(pes,i),i+=pes.byteLength;if(probe.ts.videoPacketContainsKeyFrame(frame)){var firstKeyFrame=probe.ts.parsePesTime(frame);firstKeyFrame?(result.firstKeyFrame=firstKeyFrame,result.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}currentFrame.size=0}currentFrame.data.push(packet),currentFrame.size+=packet.byteLength}if(endLoop&&result.firstKeyFrame)break;startIndex+=188,endIndex+=188}for(startIndex=(endIndex=bytes.byteLength)-188,endLoop=!1;startIndex>=0;)if(71!==bytes[startIndex]||71!==bytes[endIndex])startIndex--,endIndex--;else{if(packet=bytes.subarray(startIndex,endIndex),"pes"===probe.ts.parseType(packet,pmt.pid)&&(pesType=probe.ts.parsePesType(packet,pmt.table),pusi=probe.ts.parsePayloadUnitStartIndicator(packet),"video"===pesType&&pusi&&(parsed=probe.ts.parsePesTime(packet))&&(parsed.type="video",result.video.push(parsed),endLoop=!0)),endLoop)break;startIndex-=188,endIndex-=188}},tsInspector_inspect=function(bytes,baseTimestamp){var result;return result=probe.aac.isLikelyAacData(bytes)?function(bytes){for(var packet,endLoop=!1,audioCount=0,sampleRate=null,timestamp=null,frameSize=0,byteIndex=0;bytes.length-byteIndex>=3;){switch(probe.aac.parseType(bytes,byteIndex)){case"timed-metadata":if(bytes.length-byteIndex<10){endLoop=!0;break}if((frameSize=probe.aac.parseId3TagSize(bytes,byteIndex))>bytes.length){endLoop=!0;break}null===timestamp&&(packet=bytes.subarray(byteIndex,byteIndex+frameSize),timestamp=probe.aac.parseAacTimestamp(packet)),byteIndex+=frameSize;break;case"audio":if(bytes.length-byteIndex<7){endLoop=!0;break}if((frameSize=probe.aac.parseAdtsSize(bytes,byteIndex))>bytes.length){endLoop=!0;break}null===sampleRate&&(packet=bytes.subarray(byteIndex,byteIndex+frameSize),sampleRate=probe.aac.parseSampleRate(packet)),audioCount++,byteIndex+=frameSize;break;default:byteIndex++}if(endLoop)return null}if(null===sampleRate||null===timestamp)return null;var audioTimescale=9e4/sampleRate;return{audio:[{type:"audio",dts:timestamp,pts:timestamp},{type:"audio",dts:timestamp+1024*audioCount*audioTimescale,pts:timestamp+1024*audioCount*audioTimescale}]}}(bytes):function(bytes){var pmt={pid:null,table:null},result={};for(var pid in function(bytes,pmt){for(var packet,startIndex=0,endIndex=188;endIndex<bytes.byteLength;)if(71!==bytes[startIndex]||71!==bytes[endIndex])startIndex++,endIndex++;else{switch(packet=bytes.subarray(startIndex,endIndex),probe.ts.parseType(packet,pmt.pid)){case"pat":pmt.pid=probe.ts.parsePat(packet);break;case"pmt":var table=probe.ts.parsePmt(packet);pmt.table=pmt.table||{},Object.keys(table).forEach(function(key){pmt.table[key]=table[key]})}startIndex+=188,endIndex+=188}}(bytes,pmt),pmt.table)if(pmt.table.hasOwnProperty(pid))switch(pmt.table[pid]){case streamTypes.H264_STREAM_TYPE:result.video=[],parseVideoPes_(bytes,pmt,result),0===result.video.length&&delete result.video;break;case streamTypes.ADTS_STREAM_TYPE:result.audio=[],parseAudioPes_(bytes,pmt,result),0===result.audio.length&&delete result.audio}return result}(bytes),result&&(result.audio||result.video)?(function(segmentInfo,baseTimestamp){if(segmentInfo.audio&&segmentInfo.audio.length){var audioBaseTimestamp=baseTimestamp;(void 0===audioBaseTimestamp||isNaN(audioBaseTimestamp))&&(audioBaseTimestamp=segmentInfo.audio[0].dts),segmentInfo.audio.forEach(function(info){info.dts=handleRollover(info.dts,audioBaseTimestamp),info.pts=handleRollover(info.pts,audioBaseTimestamp),info.dtsTime=info.dts/9e4,info.ptsTime=info.pts/9e4})}if(segmentInfo.video&&segmentInfo.video.length){var videoBaseTimestamp=baseTimestamp;if((void 0===videoBaseTimestamp||isNaN(videoBaseTimestamp))&&(videoBaseTimestamp=segmentInfo.video[0].dts),segmentInfo.video.forEach(function(info){info.dts=handleRollover(info.dts,videoBaseTimestamp),info.pts=handleRollover(info.pts,videoBaseTimestamp),info.dtsTime=info.dts/9e4,info.ptsTime=info.pts/9e4}),segmentInfo.firstKeyFrame){var frame=segmentInfo.firstKeyFrame;frame.dts=handleRollover(frame.dts,videoBaseTimestamp),frame.pts=handleRollover(frame.pts,videoBaseTimestamp),frame.dtsTime=frame.dts/9e4,frame.ptsTime=frame.pts/9e4}}}(result,baseTimestamp),result):null},MessageHandlers=function(){function MessageHandlers(self,options){this.options=options||{},this.self=self,this.init()}var _proto=MessageHandlers.prototype;return _proto.init=function(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new transmuxer.Transmuxer(this.options),function(self,transmuxer){transmuxer.on("data",function(segment){var initArray=segment.initSegment;segment.initSegment={data:initArray.buffer,byteOffset:initArray.byteOffset,byteLength:initArray.byteLength};var typedArray=segment.data;segment.data=typedArray.buffer,self.postMessage({action:"data",segment:segment,byteOffset:typedArray.byteOffset,byteLength:typedArray.byteLength},[segment.data])}),transmuxer.on("done",function(data){self.postMessage({action:"done"})}),transmuxer.on("gopInfo",function(gopInfo){self.postMessage({action:"gopInfo",gopInfo:gopInfo})}),transmuxer.on("videoSegmentTimingInfo",function(timingInfo){var videoSegmentTimingInfo={start:{decode:clock_videoTsToSeconds(timingInfo.start.dts),presentation:clock_videoTsToSeconds(timingInfo.start.pts)},end:{decode:clock_videoTsToSeconds(timingInfo.end.dts),presentation:clock_videoTsToSeconds(timingInfo.end.pts)},baseMediaDecodeTime:clock_videoTsToSeconds(timingInfo.baseMediaDecodeTime)};timingInfo.prependedContentDuration&&(videoSegmentTimingInfo.prependedContentDuration=clock_videoTsToSeconds(timingInfo.prependedContentDuration)),self.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:videoSegmentTimingInfo})}),transmuxer.on("audioSegmentTimingInfo",function(timingInfo){var audioSegmentTimingInfo={start:{decode:clock_videoTsToSeconds(timingInfo.start.dts),presentation:clock_videoTsToSeconds(timingInfo.start.pts)},end:{decode:clock_videoTsToSeconds(timingInfo.end.dts),presentation:clock_videoTsToSeconds(timingInfo.end.pts)},baseMediaDecodeTime:clock_videoTsToSeconds(timingInfo.baseMediaDecodeTime)};timingInfo.prependedContentDuration&&(audioSegmentTimingInfo.prependedContentDuration=clock_videoTsToSeconds(timingInfo.prependedContentDuration)),self.postMessage({action:"audioSegmentTimingInfo",audioSegmentTimingInfo:audioSegmentTimingInfo})}),transmuxer.on("id3Frame",function(id3Frame){self.postMessage({action:"id3Frame",id3Frame:id3Frame})}),transmuxer.on("caption",function(caption){self.postMessage({action:"caption",caption:caption})}),transmuxer.on("trackinfo",function(trackInfo){self.postMessage({action:"trackinfo",trackInfo:trackInfo})}),transmuxer.on("audioTimingInfo",function(audioTimingInfo){self.postMessage({action:"audioTimingInfo",audioTimingInfo:{start:clock_videoTsToSeconds(audioTimingInfo.start),end:clock_videoTsToSeconds(audioTimingInfo.end)}})}),transmuxer.on("videoTimingInfo",function(videoTimingInfo){self.postMessage({action:"videoTimingInfo",videoTimingInfo:{start:clock_videoTsToSeconds(videoTimingInfo.start),end:clock_videoTsToSeconds(videoTimingInfo.end)}})}),transmuxer.on("log",function(log){self.postMessage({action:"log",log:log})})}(this.self,this.transmuxer)},_proto.pushMp4Captions=function(data){this.captionParser||(this.captionParser=new captionParser,this.captionParser.init());var segment=new Uint8Array(data.data,data.byteOffset,data.byteLength),parsed=this.captionParser.parse(segment,data.trackIds,data.timescales);this.self.postMessage({action:"mp4Captions",captions:parsed&&parsed.captions||[],logs:parsed&&parsed.logs||[],data:segment.buffer},[segment.buffer])},_proto.probeMp4StartTime=function(_ref){var data=_ref.data,startTime=probe$2_startTime(_ref.timescales,data);this.self.postMessage({action:"probeMp4StartTime",startTime:startTime,data:data},[data.buffer])},_proto.probeMp4Tracks=function(_ref2){var data=_ref2.data,tracks=probe$2_tracks(data);this.self.postMessage({action:"probeMp4Tracks",tracks:tracks,data:data},[data.buffer])},_proto.probeTs=function(_ref3){var data=_ref3.data,baseStartTime=_ref3.baseStartTime,tsStartTime="number"!=typeof baseStartTime||isNaN(baseStartTime)?void 0:9e4*baseStartTime,timeInfo=tsInspector_inspect(data,tsStartTime),result=null;timeInfo&&((result={hasVideo:timeInfo.video&&2===timeInfo.video.length||!1,hasAudio:timeInfo.audio&&2===timeInfo.audio.length||!1}).hasVideo&&(result.videoStart=timeInfo.video[0].ptsTime),result.hasAudio&&(result.audioStart=timeInfo.audio[0].ptsTime)),this.self.postMessage({action:"probeTs",result:result,data:data},[data.buffer])},_proto.clearAllMp4Captions=function(){this.captionParser&&this.captionParser.clearAllCaptions()},_proto.clearParsedMp4Captions=function(){this.captionParser&&this.captionParser.clearParsedCaptions()},_proto.push=function(data){var segment=new Uint8Array(data.data,data.byteOffset,data.byteLength);this.transmuxer.push(segment)},_proto.reset=function(){this.transmuxer.reset()},_proto.setTimestampOffset=function(data){this.transmuxer.setBaseMediaDecodeTime(Math.round(clock_secondsToVideoTs(data.timestampOffset||0)))},_proto.setAudioAppendStart=function(data){this.transmuxer.setAudioAppendStart(Math.ceil(clock_secondsToVideoTs(data.appendStart)))},_proto.setRemux=function(data){this.transmuxer.setRemux(data.remux)},_proto.flush=function(data){this.transmuxer.flush(),self.postMessage({action:"done",type:"transmuxed"})},_proto.endTimeline=function(){this.transmuxer.endTimeline(),self.postMessage({action:"endedtimeline",type:"transmuxed"})},_proto.alignGopsWith=function(data){this.transmuxer.alignGopsWith(data.gopsToAlignWith.slice())},MessageHandlers}();self.onmessage=function(event){"init"===event.data.action&&event.data.options?this.messageHandlers=new MessageHandlers(self,event.data.options):(this.messageHandlers||(this.messageHandlers=new MessageHandlers(self)),event.data&&event.data.action&&"init"!==event.data.action&&this.messageHandlers[event.data.action]&&this.messageHandlers[event.data.action](event.data))}})),TransmuxWorker=factory(workerCode$1),processTransmux=function(options){var transmuxer=options.transmuxer,bytes=options.bytes,audioAppendStart=options.audioAppendStart,gopsToAlignWith=options.gopsToAlignWith,remux=options.remux,onData=options.onData,onTrackInfo=options.onTrackInfo,onAudioTimingInfo=options.onAudioTimingInfo,onVideoTimingInfo=options.onVideoTimingInfo,onVideoSegmentTimingInfo=options.onVideoSegmentTimingInfo,onAudioSegmentTimingInfo=options.onAudioSegmentTimingInfo,onId3=options.onId3,onCaptions=options.onCaptions,onDone=options.onDone,onEndedTimeline=options.onEndedTimeline,onTransmuxerLog=options.onTransmuxerLog,isEndOfTimeline=options.isEndOfTimeline,transmuxedData={buffer:[]},waitForEndedTimelineEvent=isEndOfTimeline;if(transmuxer.onmessage=function(event){transmuxer.currentTransmux===options&&("data"===event.data.action&&function(event,transmuxedData,callback){var _event$data$segment=event.data.segment,type=_event$data$segment.type,initSegment=_event$data$segment.initSegment,videoFrameDtsTime=_event$data$segment.videoFrameDtsTime,videoFramePtsTime=_event$data$segment.videoFramePtsTime;transmuxedData.buffer.push({captions:_event$data$segment.captions,captionStreams:_event$data$segment.captionStreams,metadata:_event$data$segment.metadata});var boxes=event.data.segment.boxes||{data:event.data.segment.data},result={type:type,data:new Uint8Array(boxes.data,boxes.data.byteOffset,boxes.data.byteLength),initSegment:new Uint8Array(initSegment.data,initSegment.byteOffset,initSegment.byteLength)};void 0!==videoFrameDtsTime&&(result.videoFrameDtsTime=videoFrameDtsTime),void 0!==videoFramePtsTime&&(result.videoFramePtsTime=videoFramePtsTime),callback(result)}(event,transmuxedData,onData),"trackinfo"===event.data.action&&onTrackInfo(event.data.trackInfo),"gopInfo"===event.data.action&&function(event,transmuxedData){transmuxedData.gopInfo=event.data.gopInfo}(event,transmuxedData),"audioTimingInfo"===event.data.action&&onAudioTimingInfo(event.data.audioTimingInfo),"videoTimingInfo"===event.data.action&&onVideoTimingInfo(event.data.videoTimingInfo),"videoSegmentTimingInfo"===event.data.action&&onVideoSegmentTimingInfo(event.data.videoSegmentTimingInfo),"audioSegmentTimingInfo"===event.data.action&&onAudioSegmentTimingInfo(event.data.audioSegmentTimingInfo),"id3Frame"===event.data.action&&onId3([event.data.id3Frame],event.data.id3Frame.dispatchType),"caption"===event.data.action&&onCaptions(event.data.caption),"endedtimeline"===event.data.action&&(waitForEndedTimelineEvent=!1,onEndedTimeline()),"log"===event.data.action&&onTransmuxerLog(event.data.log),"transmuxed"===event.data.type&&(waitForEndedTimelineEvent||(transmuxer.onmessage=null,function(_ref){var transmuxedData=_ref.transmuxedData,callback=_ref.callback;transmuxedData.buffer=[],callback(transmuxedData)}({transmuxedData:transmuxedData,callback:onDone}),dequeue(transmuxer))))},audioAppendStart&&transmuxer.postMessage({action:"setAudioAppendStart",appendStart:audioAppendStart}),Array.isArray(gopsToAlignWith)&&transmuxer.postMessage({action:"alignGopsWith",gopsToAlignWith:gopsToAlignWith}),void 0!==remux&&transmuxer.postMessage({action:"setRemux",remux:remux}),bytes.byteLength){var buffer=bytes instanceof ArrayBuffer?bytes:bytes.buffer,byteOffset=bytes instanceof ArrayBuffer?0:bytes.byteOffset;transmuxer.postMessage({action:"push",data:buffer,byteOffset:byteOffset,byteLength:bytes.byteLength},[buffer])}isEndOfTimeline&&transmuxer.postMessage({action:"endTimeline"}),transmuxer.postMessage({action:"flush"})},dequeue=function(transmuxer){transmuxer.currentTransmux=null,transmuxer.transmuxQueue.length&&(transmuxer.currentTransmux=transmuxer.transmuxQueue.shift(),"function"==typeof transmuxer.currentTransmux?transmuxer.currentTransmux():processTransmux(transmuxer.currentTransmux))},processAction=function(transmuxer,action){transmuxer.postMessage({action:action}),dequeue(transmuxer)},segmentTransmuxer_reset=function(transmuxer){!function(action,transmuxer){if(!transmuxer.currentTransmux)return transmuxer.currentTransmux=action,void processAction(transmuxer,action);transmuxer.transmuxQueue.push(processAction.bind(null,transmuxer,action))}("reset",transmuxer)},workerCallback=function(options){var transmuxer=options.transmuxer,endAction=options.endAction||options.action,callback=options.callback,message=extends_default()({},options,{endAction:null,transmuxer:null,callback:null});if(transmuxer.addEventListener("message",function listenForEndEvent(event){event.data.action===endAction&&(transmuxer.removeEventListener("message",listenForEndEvent),event.data.data&&(event.data.data=new Uint8Array(event.data.data,options.byteOffset||0,options.byteLength||event.data.data.byteLength),options.data&&(options.data=event.data.data)),callback(event.data))}),options.data){var isArrayBuffer=options.data instanceof ArrayBuffer;message.byteOffset=isArrayBuffer?0:options.data.byteOffset,message.byteLength=options.data.byteLength,transmuxer.postMessage(message,[isArrayBuffer?options.data:options.data.buffer])}else transmuxer.postMessage(message)},abortAll=function(activeXhrs){activeXhrs.forEach(function(xhr){xhr.abort()})},handleErrors=function(error,request){return request.timedout?{status:request.status,message:"HLS request timed-out at URL: "+request.uri,code:-101,xhr:request}:request.aborted?{status:request.status,message:"HLS request aborted at URL: "+request.uri,code:-102,xhr:request}:error?{status:request.status,message:"HLS request errored at URL: "+request.uri,code:2,xhr:request}:"arraybuffer"===request.responseType&&0===request.response.byteLength?{status:request.status,message:"Empty HLS response at URL: "+request.uri,code:2,xhr:request}:null},handleKeyResponse=function(segment,objects,finishProcessingFn){return function(error,request){var response=request.response,errorObj=handleErrors(error,request);if(errorObj)return finishProcessingFn(errorObj,segment);if(16!==response.byteLength)return finishProcessingFn({status:request.status,message:"Invalid HLS key at URL: "+request.uri,code:2,xhr:request},segment);for(var view=new DataView(response),bytes=new Uint32Array([view.getUint32(0),view.getUint32(4),view.getUint32(8),view.getUint32(12)]),i=0;i<objects.length;i++)objects[i].bytes=bytes;return finishProcessingFn(null,segment)}},parseInitSegment=function(segment,_callback){var type=detectContainerForBytes(segment.map.bytes);if("mp4"!==type)return _callback({internal:!0,message:"Found unsupported "+(type||"unknown")+" container for initialization segment at URL: "+(segment.map.resolvedUri||segment.map.uri),code:2});workerCallback({action:"probeMp4Tracks",data:segment.map.bytes,transmuxer:segment.transmuxer,callback:function(_ref){var tracks=_ref.tracks;return segment.map.bytes=_ref.data,tracks.forEach(function(track){segment.map.tracks=segment.map.tracks||{},segment.map.tracks[track.type]||(segment.map.tracks[track.type]=track,"number"==typeof track.id&&track.timescale&&(segment.map.timescales=segment.map.timescales||{},segment.map.timescales[track.id]=track.timescale))}),_callback(null)}})},transmuxAndNotify=function(_ref4){var segment=_ref4.segment,bytes=_ref4.bytes,trackInfoFn=_ref4.trackInfoFn,timingInfoFn=_ref4.timingInfoFn,videoSegmentTimingInfoFn=_ref4.videoSegmentTimingInfoFn,audioSegmentTimingInfoFn=_ref4.audioSegmentTimingInfoFn,id3Fn=_ref4.id3Fn,captionsFn=_ref4.captionsFn,isEndOfTimeline=_ref4.isEndOfTimeline,endedTimelineFn=_ref4.endedTimelineFn,dataFn=_ref4.dataFn,doneFn=_ref4.doneFn,onTransmuxerLog=_ref4.onTransmuxerLog,fmp4Tracks=segment.map&&segment.map.tracks||{},isMuxed=Boolean(fmp4Tracks.audio&&fmp4Tracks.video),audioStartFn=timingInfoFn.bind(null,segment,"audio","start"),audioEndFn=timingInfoFn.bind(null,segment,"audio","end"),videoStartFn=timingInfoFn.bind(null,segment,"video","start"),videoEndFn=timingInfoFn.bind(null,segment,"video","end");workerCallback({action:"probeTs",transmuxer:segment.transmuxer,data:bytes,baseStartTime:segment.baseStartTime,callback:function(data){segment.bytes=bytes=data.data;var probeResult=data.result;probeResult&&(trackInfoFn(segment,{hasAudio:probeResult.hasAudio,hasVideo:probeResult.hasVideo,isMuxed:isMuxed}),trackInfoFn=null,probeResult.hasAudio&&!isMuxed&&audioStartFn(probeResult.audioStart),probeResult.hasVideo&&videoStartFn(probeResult.videoStart),audioStartFn=null,videoStartFn=null),function(options){if(!options.transmuxer.currentTransmux)return options.transmuxer.currentTransmux=options,void processTransmux(options);options.transmuxer.transmuxQueue.push(options)}({bytes:bytes,transmuxer:segment.transmuxer,audioAppendStart:segment.audioAppendStart,gopsToAlignWith:segment.gopsToAlignWith,remux:isMuxed,onData:function(result){result.type="combined"===result.type?"video":result.type,dataFn(segment,result)},onTrackInfo:function(trackInfo){trackInfoFn&&(isMuxed&&(trackInfo.isMuxed=!0),trackInfoFn(segment,trackInfo))},onAudioTimingInfo:function(audioTimingInfo){audioStartFn&&void 0!==audioTimingInfo.start&&(audioStartFn(audioTimingInfo.start),audioStartFn=null),audioEndFn&&void 0!==audioTimingInfo.end&&audioEndFn(audioTimingInfo.end)},onVideoTimingInfo:function(videoTimingInfo){videoStartFn&&void 0!==videoTimingInfo.start&&(videoStartFn(videoTimingInfo.start),videoStartFn=null),videoEndFn&&void 0!==videoTimingInfo.end&&videoEndFn(videoTimingInfo.end)},onVideoSegmentTimingInfo:function(videoSegmentTimingInfo){videoSegmentTimingInfoFn(videoSegmentTimingInfo)},onAudioSegmentTimingInfo:function(audioSegmentTimingInfo){audioSegmentTimingInfoFn(audioSegmentTimingInfo)},onId3:function(id3Frames,dispatchType){id3Fn(segment,id3Frames,dispatchType)},onCaptions:function(captions){captionsFn(segment,[captions])},isEndOfTimeline:isEndOfTimeline,onEndedTimeline:function(){endedTimelineFn()},onTransmuxerLog:onTransmuxerLog,onDone:function(result){doneFn&&(result.type="combined"===result.type?"video":result.type,doneFn(null,segment,result))}})}})},handleSegmentBytes=function(_ref5){var segment=_ref5.segment,bytes=_ref5.bytes,trackInfoFn=_ref5.trackInfoFn,timingInfoFn=_ref5.timingInfoFn,videoSegmentTimingInfoFn=_ref5.videoSegmentTimingInfoFn,audioSegmentTimingInfoFn=_ref5.audioSegmentTimingInfoFn,id3Fn=_ref5.id3Fn,captionsFn=_ref5.captionsFn,isEndOfTimeline=_ref5.isEndOfTimeline,endedTimelineFn=_ref5.endedTimelineFn,dataFn=_ref5.dataFn,doneFn=_ref5.doneFn,onTransmuxerLog=_ref5.onTransmuxerLog,bytesAsUint8Array=new Uint8Array(bytes);if(function(bytes){return findBox(bytes,["moof"]).length>0}(bytesAsUint8Array)){segment.isFmp4=!0;var tracks=segment.map.tracks,trackInfo={isFmp4:!0,hasVideo:!!tracks.video,hasAudio:!!tracks.audio};tracks.audio&&tracks.audio.codec&&"enca"!==tracks.audio.codec&&(trackInfo.audioCodec=tracks.audio.codec),tracks.video&&tracks.video.codec&&"encv"!==tracks.video.codec&&(trackInfo.videoCodec=tracks.video.codec),tracks.video&&tracks.audio&&(trackInfo.isMuxed=!0),trackInfoFn(segment,trackInfo);var finishLoading=function(captions){dataFn(segment,{data:bytesAsUint8Array,type:trackInfo.hasAudio&&!trackInfo.isMuxed?"audio":"video"}),captions&&captions.length&&captionsFn(segment,captions),doneFn(null,segment,{})};workerCallback({action:"probeMp4StartTime",timescales:segment.map.timescales,data:bytesAsUint8Array,transmuxer:segment.transmuxer,callback:function(_ref6){var data=_ref6.data,startTime=_ref6.startTime;bytes=data.buffer,segment.bytes=bytesAsUint8Array=data,trackInfo.hasAudio&&!trackInfo.isMuxed&&timingInfoFn(segment,"audio","start",startTime),trackInfo.hasVideo&&timingInfoFn(segment,"video","start",startTime),tracks.video&&data.byteLength&&segment.transmuxer?workerCallback({action:"pushMp4Captions",endAction:"mp4Captions",transmuxer:segment.transmuxer,data:bytesAsUint8Array,timescales:segment.map.timescales,trackIds:[tracks.video.id],callback:function(message){bytes=message.data.buffer,segment.bytes=bytesAsUint8Array=message.data,message.logs.forEach(function(log){onTransmuxerLog(videojs.mergeOptions(log,{stream:"mp4CaptionParser"}))}),finishLoading(message.captions)}}):finishLoading()}})}else if(segment.transmuxer){if(void 0===segment.container&&(segment.container=detectContainerForBytes(bytesAsUint8Array)),"ts"!==segment.container&&"aac"!==segment.container)return trackInfoFn(segment,{hasAudio:!1,hasVideo:!1}),void doneFn(null,segment,{});transmuxAndNotify({segment:segment,bytes:bytes,trackInfoFn:trackInfoFn,timingInfoFn:timingInfoFn,videoSegmentTimingInfoFn:videoSegmentTimingInfoFn,audioSegmentTimingInfoFn:audioSegmentTimingInfoFn,id3Fn:id3Fn,captionsFn:captionsFn,isEndOfTimeline:isEndOfTimeline,endedTimelineFn:endedTimelineFn,dataFn:dataFn,doneFn:doneFn,onTransmuxerLog:onTransmuxerLog})}else doneFn(null,segment,{})},decrypt=function(_ref7,callback){var keyBytes,id=_ref7.id,key=_ref7.key,encryptedBytes=_ref7.encryptedBytes,decryptionWorker=_ref7.decryptionWorker;decryptionWorker.addEventListener("message",function decryptionHandler(event){if(event.data.source===id){decryptionWorker.removeEventListener("message",decryptionHandler);var decrypted=event.data.decrypted;callback(new Uint8Array(decrypted.bytes,decrypted.byteOffset,decrypted.byteLength))}}),keyBytes=key.bytes.slice?key.bytes.slice():new Uint32Array(Array.prototype.slice.call(key.bytes)),decryptionWorker.postMessage(createTransferableMessage({source:id,encrypted:encryptedBytes,key:keyBytes,iv:key.iv}),[encryptedBytes.buffer,keyBytes.buffer])},mediaSegmentRequest=function(_ref12){var xhr=_ref12.xhr,xhrOptions=_ref12.xhrOptions,segment=_ref12.segment,abortFn=_ref12.abortFn,progressFn=_ref12.progressFn,trackInfoFn=_ref12.trackInfoFn,timingInfoFn=_ref12.timingInfoFn,videoSegmentTimingInfoFn=_ref12.videoSegmentTimingInfoFn,audioSegmentTimingInfoFn=_ref12.audioSegmentTimingInfoFn,id3Fn=_ref12.id3Fn,captionsFn=_ref12.captionsFn,isEndOfTimeline=_ref12.isEndOfTimeline,endedTimelineFn=_ref12.endedTimelineFn,dataFn=_ref12.dataFn,activeXhrs=[],finishProcessingFn=function(_ref9){var activeXhrs=_ref9.activeXhrs,decryptionWorker=_ref9.decryptionWorker,trackInfoFn=_ref9.trackInfoFn,timingInfoFn=_ref9.timingInfoFn,videoSegmentTimingInfoFn=_ref9.videoSegmentTimingInfoFn,audioSegmentTimingInfoFn=_ref9.audioSegmentTimingInfoFn,id3Fn=_ref9.id3Fn,captionsFn=_ref9.captionsFn,isEndOfTimeline=_ref9.isEndOfTimeline,endedTimelineFn=_ref9.endedTimelineFn,dataFn=_ref9.dataFn,doneFn=_ref9.doneFn,onTransmuxerLog=_ref9.onTransmuxerLog,count=0,didError=!1;return function(error,segment){if(!didError){if(error)return didError=!0,abortAll(activeXhrs),doneFn(error,segment);if((count+=1)===activeXhrs.length){var segmentFinish=function(){if(segment.encryptedBytes)return function(_ref8){var segment=_ref8.segment,trackInfoFn=_ref8.trackInfoFn,timingInfoFn=_ref8.timingInfoFn,videoSegmentTimingInfoFn=_ref8.videoSegmentTimingInfoFn,audioSegmentTimingInfoFn=_ref8.audioSegmentTimingInfoFn,id3Fn=_ref8.id3Fn,captionsFn=_ref8.captionsFn,isEndOfTimeline=_ref8.isEndOfTimeline,endedTimelineFn=_ref8.endedTimelineFn,dataFn=_ref8.dataFn,doneFn=_ref8.doneFn,onTransmuxerLog=_ref8.onTransmuxerLog;decrypt({id:segment.requestId,key:segment.key,encryptedBytes:segment.encryptedBytes,decryptionWorker:_ref8.decryptionWorker},function(decryptedBytes){segment.bytes=decryptedBytes,handleSegmentBytes({segment:segment,bytes:segment.bytes,trackInfoFn:trackInfoFn,timingInfoFn:timingInfoFn,videoSegmentTimingInfoFn:videoSegmentTimingInfoFn,audioSegmentTimingInfoFn:audioSegmentTimingInfoFn,id3Fn:id3Fn,captionsFn:captionsFn,isEndOfTimeline:isEndOfTimeline,endedTimelineFn:endedTimelineFn,dataFn:dataFn,doneFn:doneFn,onTransmuxerLog:onTransmuxerLog})})}({decryptionWorker:decryptionWorker,segment:segment,trackInfoFn:trackInfoFn,timingInfoFn:timingInfoFn,videoSegmentTimingInfoFn:videoSegmentTimingInfoFn,audioSegmentTimingInfoFn:audioSegmentTimingInfoFn,id3Fn:id3Fn,captionsFn:captionsFn,isEndOfTimeline:isEndOfTimeline,endedTimelineFn:endedTimelineFn,dataFn:dataFn,doneFn:doneFn,onTransmuxerLog:onTransmuxerLog});handleSegmentBytes({segment:segment,bytes:segment.bytes,trackInfoFn:trackInfoFn,timingInfoFn:timingInfoFn,videoSegmentTimingInfoFn:videoSegmentTimingInfoFn,audioSegmentTimingInfoFn:audioSegmentTimingInfoFn,id3Fn:id3Fn,captionsFn:captionsFn,isEndOfTimeline:isEndOfTimeline,endedTimelineFn:endedTimelineFn,dataFn:dataFn,doneFn:doneFn,onTransmuxerLog:onTransmuxerLog})};if(segment.endOfAllRequests=Date.now(),segment.map&&segment.map.encryptedBytes&&!segment.map.bytes)return decrypt({decryptionWorker:decryptionWorker,id:segment.requestId+"-init",encryptedBytes:segment.map.encryptedBytes,key:segment.map.key},function(decryptedBytes){segment.map.bytes=decryptedBytes,parseInitSegment(segment,function(parseError){if(parseError)return abortAll(activeXhrs),doneFn(parseError,segment);segmentFinish()})});segmentFinish()}}}}({activeXhrs:activeXhrs,decryptionWorker:_ref12.decryptionWorker,trackInfoFn:trackInfoFn,timingInfoFn:timingInfoFn,videoSegmentTimingInfoFn:videoSegmentTimingInfoFn,audioSegmentTimingInfoFn:audioSegmentTimingInfoFn,id3Fn:id3Fn,captionsFn:captionsFn,isEndOfTimeline:isEndOfTimeline,endedTimelineFn:endedTimelineFn,dataFn:dataFn,doneFn:_ref12.doneFn,onTransmuxerLog:_ref12.onTransmuxerLog});if(segment.key&&!segment.key.bytes){var objects=[segment.key];segment.map&&!segment.map.bytes&&segment.map.key&&segment.map.key.resolvedUri===segment.key.resolvedUri&&objects.push(segment.map.key);var keyXhr=xhr(videojs.mergeOptions(xhrOptions,{uri:segment.key.resolvedUri,responseType:"arraybuffer"}),handleKeyResponse(segment,objects,finishProcessingFn));activeXhrs.push(keyXhr)}if(segment.map&&!segment.map.bytes){if(segment.map.key&&(!segment.key||segment.key.resolvedUri!==segment.map.key.resolvedUri)){var mapKeyXhr=xhr(videojs.mergeOptions(xhrOptions,{uri:segment.map.key.resolvedUri,responseType:"arraybuffer"}),handleKeyResponse(segment,[segment.map.key],finishProcessingFn));activeXhrs.push(mapKeyXhr)}var initSegmentOptions=videojs.mergeOptions(xhrOptions,{uri:segment.map.resolvedUri,responseType:"arraybuffer",headers:segmentXhrHeaders(segment.map)}),initSegmentRequestCallback=function(_ref2){var segment=_ref2.segment,finishProcessingFn=_ref2.finishProcessingFn;return function(error,request){var errorObj=handleErrors(error,request);if(errorObj)return finishProcessingFn(errorObj,segment);var bytes=new Uint8Array(request.response);if(segment.map.key)return segment.map.encryptedBytes=bytes,finishProcessingFn(null,segment);segment.map.bytes=bytes,parseInitSegment(segment,function(parseError){if(parseError)return parseError.xhr=request,parseError.status=request.status,finishProcessingFn(parseError,segment);finishProcessingFn(null,segment)})}}({segment:segment,finishProcessingFn:finishProcessingFn}),initSegmentXhr=xhr(initSegmentOptions,initSegmentRequestCallback);activeXhrs.push(initSegmentXhr)}var segmentRequestOptions=videojs.mergeOptions(xhrOptions,{uri:segment.part&&segment.part.resolvedUri||segment.resolvedUri,responseType:"arraybuffer",headers:segmentXhrHeaders(segment)}),segmentXhr=xhr(segmentRequestOptions,function(_ref3){var segment=_ref3.segment,finishProcessingFn=_ref3.finishProcessingFn,responseType=_ref3.responseType;return function(error,request){var errorObj=handleErrors(error,request);if(errorObj)return finishProcessingFn(errorObj,segment);var newBytes="arraybuffer"!==responseType&&request.responseText?function(string){for(var view=new Uint8Array(new ArrayBuffer(string.length)),i=0;i<string.length;i++)view[i]=string.charCodeAt(i);return view.buffer}(request.responseText.substring(segment.lastReachedChar||0)):request.response;return segment.stats=function(request){return{bandwidth:request.bandwidth,bytesReceived:request.bytesReceived||0,roundTripTime:request.roundTripTime||0}}(request),segment.key?segment.encryptedBytes=new Uint8Array(newBytes):segment.bytes=new Uint8Array(newBytes),finishProcessingFn(null,segment)}}({segment:segment,finishProcessingFn:finishProcessingFn,responseType:segmentRequestOptions.responseType}));segmentXhr.addEventListener("progress",function(_ref11){var segment=_ref11.segment,progressFn=_ref11.progressFn;return function(event){if(!event.target.aborted)return segment.stats=videojs.mergeOptions(segment.stats,(request=(progressEvent=event).target,(stats={bandwidth:1/0,bytesReceived:0,roundTripTime:Date.now()-request.requestTime||0}).bytesReceived=progressEvent.loaded,stats.bandwidth=Math.floor(stats.bytesReceived/stats.roundTripTime*8*1e3),stats)),!segment.stats.firstBytesReceivedAt&&segment.stats.bytesReceived&&(segment.stats.firstBytesReceivedAt=Date.now()),progressFn(event,segment);var progressEvent,request,stats}}({segment:segment,progressFn:progressFn,trackInfoFn:trackInfoFn,timingInfoFn:timingInfoFn,videoSegmentTimingInfoFn:videoSegmentTimingInfoFn,audioSegmentTimingInfoFn:audioSegmentTimingInfoFn,id3Fn:id3Fn,captionsFn:captionsFn,isEndOfTimeline:isEndOfTimeline,endedTimelineFn:endedTimelineFn,dataFn:dataFn})),activeXhrs.push(segmentXhr);var loadendState={};return activeXhrs.forEach(function(activeXhr){activeXhr.addEventListener("loadend",function(_ref10){var loadendState=_ref10.loadendState,abortFn=_ref10.abortFn;return function(event){event.target.aborted&&abortFn&&!loadendState.calledAbortFn&&(abortFn(),loadendState.calledAbortFn=!0)}}({loadendState:loadendState,abortFn:abortFn}))}),function(){return abortAll(activeXhrs)}},logFn$1=logger("CodecUtils"),isMaat=function(master,media){var mediaAttributes=media.attributes||{};return master&&master.mediaGroups&&master.mediaGroups.AUDIO&&mediaAttributes.AUDIO&&master.mediaGroups.AUDIO[mediaAttributes.AUDIO]},unwrapCodecList=function(codecList){var codecs={};return codecList.forEach(function(_ref){var mediaType=_ref.mediaType,type=_ref.type,details=_ref.details;codecs[mediaType]=codecs[mediaType]||[],codecs[mediaType].push(translateLegacyCodec(""+type+details))}),Object.keys(codecs).forEach(function(mediaType){if(codecs[mediaType].length>1)return logFn$1("multiple "+mediaType+" codecs found as attributes: "+codecs[mediaType].join(", ")+". Setting playlist codecs to null so that we wait for mux.js to probe segments for real codecs."),void(codecs[mediaType]=null);codecs[mediaType]=codecs[mediaType][0]}),codecs},codecCount=function(codecObj){var count=0;return codecObj.audio&&count++,codecObj.video&&count++,count},codecsForPlaylist=function(master,media){var mediaAttributes=media.attributes||{},codecInfo=unwrapCodecList(function(media){var mediaAttributes=media.attributes||{};if(mediaAttributes.CODECS)return parseCodecs(mediaAttributes.CODECS)}(media)||[]);if(isMaat(master,media)&&!codecInfo.audio&&!function(master,media){if(!isMaat(master,media))return!0;var audioGroup=master.mediaGroups.AUDIO[(media.attributes||{}).AUDIO];for(var groupId in audioGroup)if(!audioGroup[groupId].uri&&!audioGroup[groupId].playlists)return!0;return!1}(master,media)){var defaultCodecs=unwrapCodecList(function(master,audioGroupId){if(!master.mediaGroups.AUDIO||!audioGroupId)return null;var audioGroup=master.mediaGroups.AUDIO[audioGroupId];if(!audioGroup)return null;for(var name in audioGroup){var audioType=audioGroup[name];if(audioType.default&&audioType.playlists)return parseCodecs(audioType.playlists[0].attributes.CODECS)}return null}(master,mediaAttributes.AUDIO)||[]);defaultCodecs.audio&&(codecInfo.audio=defaultCodecs.audio)}return codecInfo},logFn=logger("PlaylistSelector"),representationToString=function(representation){if(representation&&representation.playlist){var playlist=representation.playlist;return JSON.stringify({id:playlist.id,bandwidth:representation.bandwidth,width:representation.width,height:representation.height,codecs:playlist.attributes&&playlist.attributes.CODECS||""})}},safeGetComputedStyle=function(el,property){if(!el)return"";var result=window_default().getComputedStyle(el);return result?result[property]:""},stableSort=function(array,sortFn){var newArray=array.slice();array.sort(function(left,right){var cmp=sortFn(left,right);return 0===cmp?newArray.indexOf(left)-newArray.indexOf(right):cmp})},comparePlaylistBandwidth=function(left,right){var leftBandwidth,rightBandwidth;return left.attributes.BANDWIDTH&&(leftBandwidth=left.attributes.BANDWIDTH),leftBandwidth=leftBandwidth||window_default().Number.MAX_VALUE,right.attributes.BANDWIDTH&&(rightBandwidth=right.attributes.BANDWIDTH),leftBandwidth-(rightBandwidth||window_default().Number.MAX_VALUE)},simpleSelector=function(master,playerBandwidth,playerWidth,playerHeight,limitRenditionByPlayerDimensions,masterPlaylistController){if(master){var options={bandwidth:playerBandwidth,width:playerWidth,height:playerHeight,limitRenditionByPlayerDimensions:limitRenditionByPlayerDimensions},playlists=master.playlists;Playlist.isAudioOnly(master)&&(playlists=masterPlaylistController.getAudioTrackPlaylists_(),options.audioOnly=!0);var sortedPlaylistReps=playlists.map(function(playlist){var width=playlist.attributes&&playlist.attributes.RESOLUTION&&playlist.attributes.RESOLUTION.width,height=playlist.attributes&&playlist.attributes.RESOLUTION&&playlist.attributes.RESOLUTION.height;return{bandwidth:playlist.attributes&&playlist.attributes.BANDWIDTH||window_default().Number.MAX_VALUE,width:width,height:height,playlist:playlist}});stableSort(sortedPlaylistReps,function(left,right){return left.bandwidth-right.bandwidth});var enabledPlaylistReps=(sortedPlaylistReps=sortedPlaylistReps.filter(function(rep){return!Playlist.isIncompatible(rep.playlist)})).filter(function(rep){return Playlist.isEnabled(rep.playlist)});enabledPlaylistReps.length||(enabledPlaylistReps=sortedPlaylistReps.filter(function(rep){return!Playlist.isDisabled(rep.playlist)}));var bandwidthPlaylistReps=enabledPlaylistReps.filter(function(rep){return rep.bandwidth*Config.BANDWIDTH_VARIANCE<playerBandwidth}),highestRemainingBandwidthRep=bandwidthPlaylistReps[bandwidthPlaylistReps.length-1],bandwidthBestRep=bandwidthPlaylistReps.filter(function(rep){return rep.bandwidth===highestRemainingBandwidthRep.bandwidth})[0];if(!1===limitRenditionByPlayerDimensions){var _chosenRep=bandwidthBestRep||enabledPlaylistReps[0]||sortedPlaylistReps[0];if(_chosenRep&&_chosenRep.playlist){var type="sortedPlaylistReps";return bandwidthBestRep&&(type="bandwidthBestRep"),enabledPlaylistReps[0]&&(type="enabledPlaylistReps"),logFn("choosing "+representationToString(_chosenRep)+" using "+type+" with options",options),_chosenRep.playlist}return logFn("could not choose a playlist with options",options),null}var haveResolution=bandwidthPlaylistReps.filter(function(rep){return rep.width&&rep.height});stableSort(haveResolution,function(left,right){return left.width-right.width});var resolutionBestRepList=haveResolution.filter(function(rep){return rep.width===playerWidth&&rep.height===playerHeight});highestRemainingBandwidthRep=resolutionBestRepList[resolutionBestRepList.length-1];var resolutionPlusOneList,resolutionPlusOneSmallest,resolutionPlusOneRep,leastPixelDiffRep,resolutionBestRep=resolutionBestRepList.filter(function(rep){return rep.bandwidth===highestRemainingBandwidthRep.bandwidth})[0];if(resolutionBestRep||(resolutionPlusOneSmallest=(resolutionPlusOneList=haveResolution.filter(function(rep){return rep.width>playerWidth||rep.height>playerHeight})).filter(function(rep){return rep.width===resolutionPlusOneList[0].width&&rep.height===resolutionPlusOneList[0].height}),highestRemainingBandwidthRep=resolutionPlusOneSmallest[resolutionPlusOneSmallest.length-1],resolutionPlusOneRep=resolutionPlusOneSmallest.filter(function(rep){return rep.bandwidth===highestRemainingBandwidthRep.bandwidth})[0]),masterPlaylistController.experimentalLeastPixelDiffSelector){var leastPixelDiffList=haveResolution.map(function(rep){return rep.pixelDiff=Math.abs(rep.width-playerWidth)+Math.abs(rep.height-playerHeight),rep});stableSort(leastPixelDiffList,function(left,right){return left.pixelDiff===right.pixelDiff?right.bandwidth-left.bandwidth:left.pixelDiff-right.pixelDiff}),leastPixelDiffRep=leastPixelDiffList[0]}var chosenRep=leastPixelDiffRep||resolutionPlusOneRep||resolutionBestRep||bandwidthBestRep||enabledPlaylistReps[0]||sortedPlaylistReps[0];if(chosenRep&&chosenRep.playlist){var _type="sortedPlaylistReps";return leastPixelDiffRep?_type="leastPixelDiffRep":resolutionPlusOneRep?_type="resolutionPlusOneRep":resolutionBestRep?_type="resolutionBestRep":bandwidthBestRep?_type="bandwidthBestRep":enabledPlaylistReps[0]&&(_type="enabledPlaylistReps"),logFn("choosing "+representationToString(chosenRep)+" using "+_type+" with options",options),chosenRep.playlist}return logFn("could not choose a playlist with options",options),null}},lastBandwidthSelector=function(){var pixelRatio=this.useDevicePixelRatio&&window_default().devicePixelRatio||1;return simpleSelector(this.playlists.master,this.systemBandwidth,parseInt(safeGetComputedStyle(this.tech_.el(),"width"),10)*pixelRatio,parseInt(safeGetComputedStyle(this.tech_.el(),"height"),10)*pixelRatio,this.limitRenditionByPlayerDimensions,this.masterPlaylistController_)},removeCuesFromTrack=function(start,end,track){var i,cue;if(track&&track.cues)for(i=track.cues.length;i--;)(cue=track.cues[i]).startTime>=start&&cue.endTime<=end&&track.removeCue(cue)},finite=function(num){return"number"==typeof num&&isFinite(num)},segmentInfoString=function(segmentInfo){var startOfSegment=segmentInfo.startOfSegment,duration=segmentInfo.duration,segment=segmentInfo.segment,part=segmentInfo.part,_segmentInfo$playlist=segmentInfo.playlist,seq=_segmentInfo$playlist.mediaSequence,id=_segmentInfo$playlist.id,_segmentInfo$playlist2=_segmentInfo$playlist.segments,index=segmentInfo.mediaIndex,partIndex=segmentInfo.partIndex,timeline=segmentInfo.timeline,segmentLen=(void 0===_segmentInfo$playlist2?[]:_segmentInfo$playlist2).length-1,selection="mediaIndex/partIndex increment";segmentInfo.getMediaInfoForTime?selection="getMediaInfoForTime ("+segmentInfo.getMediaInfoForTime+")":segmentInfo.isSyncRequest&&(selection="getSyncSegmentCandidate (isSyncRequest)"),segmentInfo.independent&&(selection+=" with independent "+segmentInfo.independent);var hasPartIndex="number"==typeof partIndex,name=segmentInfo.segment.uri?"segment":"pre-segment",zeroBasedPartCount=hasPartIndex?getKnownPartCount({preloadSegment:segment})-1:0;return name+" ["+(seq+index)+"/"+(seq+segmentLen)+"]"+(hasPartIndex?" part ["+partIndex+"/"+zeroBasedPartCount+"]":"")+" segment start/end ["+segment.start+" => "+segment.end+"]"+(hasPartIndex?" part start/end ["+part.start+" => "+part.end+"]":"")+" startOfSegment ["+startOfSegment+"] duration ["+duration+"] timeline ["+timeline+"] selected by ["+selection+"] playlist ["+id+"]"},timingInfoPropertyForMedia=function(mediaType){return mediaType+"TimingInfo"},shouldWaitForTimelineChange=function(_ref2){var timelineChangeController=_ref2.timelineChangeController,segmentTimeline=_ref2.segmentTimeline,loaderType=_ref2.loaderType,audioDisabled=_ref2.audioDisabled;if(_ref2.currentTimeline===segmentTimeline)return!1;if("audio"===loaderType){var lastMainTimelineChange=timelineChangeController.lastTimelineChange({type:"main"});return!lastMainTimelineChange||lastMainTimelineChange.to!==segmentTimeline}if("main"===loaderType&&audioDisabled){var pendingAudioTimelineChange=timelineChangeController.pendingTimelineChange({type:"audio"});return!pendingAudioTimelineChange||pendingAudioTimelineChange.to!==segmentTimeline}return!1},segmentTooLong=function(_ref3){var segmentDuration=_ref3.segmentDuration,maxDuration=_ref3.maxDuration;return!!segmentDuration&&Math.round(segmentDuration)>maxDuration+.03333333333333333},SegmentLoader=function(_videojs$EventTarget){function SegmentLoader(settings,options){var _this;if(_this=_videojs$EventTarget.call(this)||this,!settings)throw new TypeError("Initialization settings are required");if("function"!=typeof settings.currentTime)throw new TypeError("No currentTime getter specified");if(!settings.mediaSource)throw new TypeError("No MediaSource specified");return _this.bandwidth=settings.bandwidth,_this.throughput={rate:0,count:0},_this.roundTrip=NaN,_this.resetStats_(),_this.mediaIndex=null,_this.partIndex=null,_this.hasPlayed_=settings.hasPlayed,_this.currentTime_=settings.currentTime,_this.seekable_=settings.seekable,_this.seeking_=settings.seeking,_this.duration_=settings.duration,_this.mediaSource_=settings.mediaSource,_this.vhs_=settings.vhs,_this.loaderType_=settings.loaderType,_this.currentMediaInfo_=void 0,_this.startingMediaInfo_=void 0,_this.segmentMetadataTrack_=settings.segmentMetadataTrack,_this.goalBufferLength_=settings.goalBufferLength,_this.sourceType_=settings.sourceType,_this.sourceUpdater_=settings.sourceUpdater,_this.inbandTextTracks_=settings.inbandTextTracks,_this.state_="INIT",_this.timelineChangeController_=settings.timelineChangeController,_this.shouldSaveSegmentTimingInfo_=!0,_this.parse708captions_=settings.parse708captions,_this.captionServices_=settings.captionServices,_this.experimentalExactManifestTimings=settings.experimentalExactManifestTimings,_this.checkBufferTimeout_=null,_this.error_=void 0,_this.currentTimeline_=-1,_this.pendingSegment_=null,_this.xhrOptions_=null,_this.pendingSegments_=[],_this.audioDisabled_=!1,_this.isPendingTimestampOffset_=!1,_this.gopBuffer_=[],_this.timeMapping_=0,_this.safeAppend_=videojs.browser.IE_VERSION>=11,_this.appendInitSegment_={audio:!0,video:!0},_this.playlistOfLastInitSegment_={audio:null,video:null},_this.callQueue_=[],_this.loadQueue_=[],_this.metadataQueue_={id3:[],caption:[]},_this.waitingOnRemove_=!1,_this.quotaExceededErrorRetryTimeout_=null,_this.activeInitSegmentId_=null,_this.initSegments_={},_this.cacheEncryptionKeys_=settings.cacheEncryptionKeys,_this.keyCache_={},_this.decrypter_=settings.decrypter,_this.syncController_=settings.syncController,_this.syncPoint_={segmentIndex:0,time:0},_this.transmuxer_=_this.createTransmuxer_(),_this.triggerSyncInfoUpdate_=function(){return _this.trigger("syncinfoupdate")},_this.syncController_.on("syncinfoupdate",_this.triggerSyncInfoUpdate_),_this.mediaSource_.addEventListener("sourceopen",function(){_this.isEndOfStream_()||(_this.ended_=!1)}),_this.fetchAtBuffer_=!1,_this.logger_=logger("SegmentLoader["+_this.loaderType_+"]"),Object.defineProperty(assertThisInitialized_default()(_this),"state",{get:function(){return this.state_},set:function(newState){newState!==this.state_&&(this.logger_(this.state_+" -> "+newState),this.state_=newState,this.trigger("statechange"))}}),_this.sourceUpdater_.on("ready",function(){_this.hasEnoughInfoToAppend_()&&_this.processCallQueue_()}),"main"===_this.loaderType_&&_this.timelineChangeController_.on("pendingtimelinechange",function(){_this.hasEnoughInfoToAppend_()&&_this.processCallQueue_()}),"audio"===_this.loaderType_&&_this.timelineChangeController_.on("timelinechange",function(){_this.hasEnoughInfoToLoad_()&&_this.processLoadQueue_(),_this.hasEnoughInfoToAppend_()&&_this.processCallQueue_()}),_this}inheritsLoose_default()(SegmentLoader,_videojs$EventTarget);var _proto=SegmentLoader.prototype;return _proto.createTransmuxer_=function(){return function(options){var transmuxer=new TransmuxWorker;transmuxer.currentTransmux=null,transmuxer.transmuxQueue=[];var term=transmuxer.terminate;return transmuxer.terminate=function(){return transmuxer.currentTransmux=null,transmuxer.transmuxQueue.length=0,term.call(transmuxer)},transmuxer.postMessage({action:"init",options:options}),transmuxer}({remux:!1,alignGopsAtEnd:this.safeAppend_,keepOriginalTimestamps:!0,parse708captions:this.parse708captions_,captionServices:this.captionServices_})},_proto.resetStats_=function(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0,this.mediaAppends=0},_proto.dispose=function(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.transmuxer_&&this.transmuxer_.terminate(),this.resetStats_(),this.checkBufferTimeout_&&window_default().clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()},_proto.setAudio=function(enable){this.audioDisabled_=!enable,enable?this.appendInitSegment_.audio=!0:this.sourceUpdater_.removeAudio(0,this.duration_())},_proto.abort=function(){"WAITING"===this.state?(this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()):this.pendingSegment_&&(this.pendingSegment_=null)},_proto.abort_=function(){this.pendingSegment_&&this.pendingSegment_.abortRequests&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_),this.waitingOnRemove_=!1,window_default().clearTimeout(this.quotaExceededErrorRetryTimeout_),this.quotaExceededErrorRetryTimeout_=null},_proto.checkForAbort_=function(requestId){return"APPENDING"!==this.state||this.pendingSegment_?!this.pendingSegment_||this.pendingSegment_.requestId!==requestId:(this.state="READY",!0)},_proto.error=function(_error){return void 0!==_error&&(this.logger_("error occurred:",_error),this.error_=_error),this.pendingSegment_=null,this.error_},_proto.endOfStream=function(){this.ended_=!0,this.transmuxer_&&segmentTransmuxer_reset(this.transmuxer_),this.gopBuffer_.length=0,this.pause(),this.trigger("ended")},_proto.buffered_=function(){var trackInfo=this.getMediaInfo_();if(!this.sourceUpdater_||!trackInfo)return videojs.createTimeRanges();if("main"===this.loaderType_){var hasVideo=trackInfo.hasVideo;if(hasVideo&&trackInfo.hasAudio&&!this.audioDisabled_&&!trackInfo.isMuxed)return this.sourceUpdater_.buffered();if(hasVideo)return this.sourceUpdater_.videoBuffered()}return this.sourceUpdater_.audioBuffered()},_proto.initSegmentForMap=function(map,set){if(void 0===set&&(set=!1),!map)return null;var id=initSegmentId(map),storedMap=this.initSegments_[id];return set&&!storedMap&&map.bytes&&(this.initSegments_[id]=storedMap={resolvedUri:map.resolvedUri,byterange:map.byterange,bytes:map.bytes,tracks:map.tracks,timescales:map.timescales}),storedMap||map},_proto.segmentKey=function(key,set){if(void 0===set&&(set=!1),!key)return null;var id=segmentKeyId(key),storedKey=this.keyCache_[id];this.cacheEncryptionKeys_&&set&&!storedKey&&key.bytes&&(this.keyCache_[id]=storedKey={resolvedUri:key.resolvedUri,bytes:key.bytes});var result={resolvedUri:(storedKey||key).resolvedUri};return storedKey&&(result.bytes=storedKey.bytes),result},_proto.couldBeginLoading_=function(){return this.playlist_&&!this.paused()},_proto.load=function(){if(this.monitorBuffer_(),this.playlist_)return"INIT"===this.state&&this.couldBeginLoading_()?this.init_():void(!this.couldBeginLoading_()||"READY"!==this.state&&"INIT"!==this.state||(this.state="READY"))},_proto.init_=function(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()},_proto.playlist=function(newPlaylist,options){if(void 0===options&&(options={}),newPlaylist){var oldPlaylist=this.playlist_,segmentInfo=this.pendingSegment_;this.playlist_=newPlaylist,this.xhrOptions_=options,"INIT"===this.state&&(newPlaylist.syncInfo={mediaSequence:newPlaylist.mediaSequence,time:0},"main"===this.loaderType_&&this.syncController_.setDateTimeMappingForStart(newPlaylist));var oldId=null;if(oldPlaylist&&(oldPlaylist.id?oldId=oldPlaylist.id:oldPlaylist.uri&&(oldId=oldPlaylist.uri)),this.logger_("playlist update ["+oldId+" => "+(newPlaylist.id||newPlaylist.uri)+"]"),this.trigger("syncinfoupdate"),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();if(!oldPlaylist||oldPlaylist.uri!==newPlaylist.uri)return null!==this.mediaIndex&&(newPlaylist.endList?this.resyncLoader():this.resetLoader()),this.currentMediaInfo_=void 0,void this.trigger("playlistupdate");var mediaSequenceDiff=newPlaylist.mediaSequence-oldPlaylist.mediaSequence;if(this.logger_("live window shift ["+mediaSequenceDiff+"]"),null!==this.mediaIndex)if(this.mediaIndex-=mediaSequenceDiff,this.mediaIndex<0)this.mediaIndex=null,this.partIndex=null;else{var segment=this.playlist_.segments[this.mediaIndex];if(this.partIndex&&(!segment.parts||!segment.parts.length||!segment.parts[this.partIndex])){var mediaIndex=this.mediaIndex;this.logger_("currently processing part (index "+this.partIndex+") no longer exists."),this.resetLoader(),this.mediaIndex=mediaIndex}}segmentInfo&&(segmentInfo.mediaIndex-=mediaSequenceDiff,segmentInfo.mediaIndex<0?(segmentInfo.mediaIndex=null,segmentInfo.partIndex=null):(segmentInfo.mediaIndex>=0&&(segmentInfo.segment=newPlaylist.segments[segmentInfo.mediaIndex]),segmentInfo.partIndex>=0&&segmentInfo.segment.parts&&(segmentInfo.part=segmentInfo.segment.parts[segmentInfo.partIndex]))),this.syncController_.saveExpiredSegmentInfo(oldPlaylist,newPlaylist)}},_proto.pause=function(){this.checkBufferTimeout_&&(window_default().clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)},_proto.paused=function(){return null===this.checkBufferTimeout_},_proto.resetEverything=function(done){this.ended_=!1,this.appendInitSegment_={audio:!0,video:!0},this.resetLoader(),this.remove(0,1/0,done),this.transmuxer_&&(this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.transmuxer_.postMessage({action:"reset"}))},_proto.resetLoader=function(){this.fetchAtBuffer_=!1,this.resyncLoader()},_proto.resyncLoader=function(){this.transmuxer_&&segmentTransmuxer_reset(this.transmuxer_),this.mediaIndex=null,this.partIndex=null,this.syncPoint_=null,this.isPendingTimestampOffset_=!1,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})},_proto.remove=function(start,end,done,force){if(void 0===done&&(done=function(){}),void 0===force&&(force=!1),end===1/0&&(end=this.duration_()),end<=start)this.logger_("skipping remove because end ${end} is <= start ${start}");else if(this.sourceUpdater_&&this.getMediaInfo_()){var removesRemaining=1,removeFinished=function(){0==--removesRemaining&&done()};for(var track in!force&&this.audioDisabled_||(removesRemaining++,this.sourceUpdater_.removeAudio(start,end,removeFinished)),(force||"main"===this.loaderType_)&&(this.gopBuffer_=function(buffer,start,end,mapping){for(var startPts=Math.ceil((start-mapping)*clock.ONE_SECOND_IN_TS),endPts=Math.ceil((end-mapping)*clock.ONE_SECOND_IN_TS),updatedBuffer=buffer.slice(),i=buffer.length;i--&&!(buffer[i].pts<=endPts););if(-1===i)return updatedBuffer;for(var j=i+1;j--&&!(buffer[j].pts<=startPts););return j=Math.max(j,0),updatedBuffer.splice(j,i-j+1),updatedBuffer}(this.gopBuffer_,start,end,this.timeMapping_),removesRemaining++,this.sourceUpdater_.removeVideo(start,end,removeFinished)),this.inbandTextTracks_)removeCuesFromTrack(start,end,this.inbandTextTracks_[track]);removeCuesFromTrack(start,end,this.segmentMetadataTrack_),removeFinished()}else this.logger_("skipping remove because no source updater or starting media info")},_proto.monitorBuffer_=function(){this.checkBufferTimeout_&&window_default().clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=window_default().setTimeout(this.monitorBufferTick_.bind(this),1)},_proto.monitorBufferTick_=function(){"READY"===this.state&&this.fillBuffer_(),this.checkBufferTimeout_&&window_default().clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=window_default().setTimeout(this.monitorBufferTick_.bind(this),500)},_proto.fillBuffer_=function(){if(!this.sourceUpdater_.updating()){var segmentInfo=this.chooseNextRequest_();segmentInfo&&("number"==typeof segmentInfo.timestampOffset&&(this.isPendingTimestampOffset_=!1,this.timelineChangeController_.pendingTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:segmentInfo.timeline})),this.loadSegment_(segmentInfo))}},_proto.isEndOfStream_=function(mediaIndex,playlist,partIndex){if(void 0===mediaIndex&&(mediaIndex=this.mediaIndex),void 0===playlist&&(playlist=this.playlist_),void 0===partIndex&&(partIndex=this.partIndex),!playlist||!this.mediaSource_)return!1;var segment="number"==typeof mediaIndex&&playlist.segments[mediaIndex];return playlist.endList&&"open"===this.mediaSource_.readyState&&mediaIndex+1===playlist.segments.length&&(!segment||!segment.parts||partIndex+1===segment.parts.length)},_proto.chooseNextRequest_=function(){var buffered=this.buffered_(),bufferedEnd=lastBufferedEnd(buffered)||0,bufferedTime=timeAheadOf(buffered,this.currentTime_()),preloaded=!this.hasPlayed_()&&bufferedTime>=1,haveEnoughBuffer=bufferedTime>=this.goalBufferLength_(),segments=this.playlist_.segments;if(!segments.length||preloaded||haveEnoughBuffer)return null;this.syncPoint_=this.syncPoint_||this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_());var next={partIndex:null,mediaIndex:null,startOfSegment:null,playlist:this.playlist_,isSyncRequest:Boolean(!this.syncPoint_)};if(next.isSyncRequest)next.mediaIndex=function(currentTimeline,segments,targetTime){segments=segments||[];for(var timelineSegments=[],time=0,i=0;i<segments.length;i++){var segment=segments[i];if(currentTimeline===segment.timeline&&(timelineSegments.push(i),(time+=segment.duration)>targetTime))return i}return 0===timelineSegments.length?0:timelineSegments[timelineSegments.length-1]}(this.currentTimeline_,segments,bufferedEnd);else if(null!==this.mediaIndex){var segment=segments[this.mediaIndex],partIndex="number"==typeof this.partIndex?this.partIndex:-1;next.startOfSegment=segment.end?segment.end:bufferedEnd,segment.parts&&segment.parts[partIndex+1]?(next.mediaIndex=this.mediaIndex,next.partIndex=partIndex+1):next.mediaIndex=this.mediaIndex+1}else{var _Playlist$getMediaInf=Playlist.getMediaInfoForTime({experimentalExactManifestTimings:this.experimentalExactManifestTimings,playlist:this.playlist_,currentTime:this.fetchAtBuffer_?bufferedEnd:this.currentTime_(),startingPartIndex:this.syncPoint_.partIndex,startingSegmentIndex:this.syncPoint_.segmentIndex,startTime:this.syncPoint_.time}),segmentIndex=_Playlist$getMediaInf.segmentIndex,startTime=_Playlist$getMediaInf.startTime,_partIndex=_Playlist$getMediaInf.partIndex;next.getMediaInfoForTime=this.fetchAtBuffer_?"bufferedEnd "+bufferedEnd:"currentTime "+this.currentTime_(),next.mediaIndex=segmentIndex,next.startOfSegment=startTime,next.partIndex=_partIndex}var nextSegment=segments[next.mediaIndex],nextPart=nextSegment&&"number"==typeof next.partIndex&&nextSegment.parts&&nextSegment.parts[next.partIndex];if(!nextSegment||"number"==typeof next.partIndex&&!nextPart)return null;if("number"!=typeof next.partIndex&&nextSegment.parts&&(next.partIndex=0,nextPart=nextSegment.parts[0]),!bufferedTime&&nextPart&&!nextPart.independent)if(0===next.partIndex){var lastSegment=segments[next.mediaIndex-1],lastSegmentLastPart=lastSegment.parts&&lastSegment.parts.length&&lastSegment.parts[lastSegment.parts.length-1];lastSegmentLastPart&&lastSegmentLastPart.independent&&(next.mediaIndex-=1,next.partIndex=lastSegment.parts.length-1,next.independent="previous segment")}else nextSegment.parts[next.partIndex-1].independent&&(next.partIndex-=1,next.independent="previous part");return next.mediaIndex>=segments.length-1&&this.mediaSource_&&"ended"===this.mediaSource_.readyState&&!this.seeking_()?null:this.generateSegmentInfo_(next)},_proto.generateSegmentInfo_=function(options){var independent=options.independent,playlist=options.playlist,mediaIndex=options.mediaIndex,startOfSegment=options.startOfSegment,isSyncRequest=options.isSyncRequest,partIndex=options.partIndex,forceTimestampOffset=options.forceTimestampOffset,getMediaInfoForTime=options.getMediaInfoForTime,segment=playlist.segments[mediaIndex],part="number"==typeof partIndex&&segment.parts[partIndex],segmentInfo={requestId:"segment-loader-"+Math.random(),uri:part&&part.resolvedUri||segment.resolvedUri,mediaIndex:mediaIndex,partIndex:part?partIndex:null,isSyncRequest:isSyncRequest,startOfSegment:startOfSegment,playlist:playlist,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:segment.timeline,duration:part&&part.duration||segment.duration,segment:segment,part:part,byteLength:0,transmuxer:this.transmuxer_,getMediaInfoForTime:getMediaInfoForTime,independent:independent},overrideCheck=void 0!==forceTimestampOffset?forceTimestampOffset:this.isPendingTimestampOffset_;segmentInfo.timestampOffset=this.timestampOffsetForSegment_({segmentTimeline:segment.timeline,currentTimeline:this.currentTimeline_,startOfSegment:startOfSegment,buffered:this.buffered_(),overrideCheck:overrideCheck});var audioBufferedEnd=lastBufferedEnd(this.sourceUpdater_.audioBuffered());return"number"==typeof audioBufferedEnd&&(segmentInfo.audioAppendStart=audioBufferedEnd-this.sourceUpdater_.audioTimestampOffset()),this.sourceUpdater_.videoBuffered().length&&(segmentInfo.gopsToAlignWith=function(buffer,currentTime,mapping){if(null==currentTime||!buffer.length)return[];var i,currentTimePts=Math.ceil((currentTime-mapping+3)*clock.ONE_SECOND_IN_TS);for(i=0;i<buffer.length&&!(buffer[i].pts>currentTimePts);i++);return buffer.slice(i)}(this.gopBuffer_,this.currentTime_()-this.sourceUpdater_.videoTimestampOffset(),this.timeMapping_)),segmentInfo},_proto.timestampOffsetForSegment_=function(options){return segmentTimeline=(_ref=options).segmentTimeline,currentTimeline=_ref.currentTimeline,startOfSegment=_ref.startOfSegment,buffered=_ref.buffered,_ref.overrideCheck||segmentTimeline!==currentTimeline?segmentTimeline<currentTimeline?startOfSegment:buffered.length?buffered.end(buffered.length-1):startOfSegment:null;var _ref,segmentTimeline,currentTimeline,startOfSegment,buffered},_proto.earlyAbortWhenNeeded_=function(stats){if(!this.vhs_.tech_.paused()&&this.xhrOptions_.timeout&&this.playlist_.attributes.BANDWIDTH&&!(Date.now()-(stats.firstBytesReceivedAt||Date.now())<1e3)){var currentTime=this.currentTime_(),measuredBandwidth=stats.bandwidth,segmentDuration=this.pendingSegment_.duration,requestTimeRemaining=Playlist.estimateSegmentRequestTime(segmentDuration,measuredBandwidth,this.playlist_,stats.bytesReceived),timeUntilRebuffer$1=function(buffered,currentTime,playbackRate){return void 0===playbackRate&&(playbackRate=1),((buffered.length?buffered.end(buffered.length-1):0)-currentTime)/playbackRate}(this.buffered_(),currentTime,this.vhs_.tech_.playbackRate())-1;if(!(requestTimeRemaining<=timeUntilRebuffer$1)){var switchCandidate=function(settings){var currentTime=settings.currentTime,bandwidth=settings.bandwidth,duration=settings.duration,segmentDuration=settings.segmentDuration,timeUntilRebuffer=settings.timeUntilRebuffer,currentTimeline=settings.currentTimeline,syncController=settings.syncController,compatiblePlaylists=settings.master.playlists.filter(function(playlist){return!Playlist.isIncompatible(playlist)}),enabledPlaylists=compatiblePlaylists.filter(Playlist.isEnabled);enabledPlaylists.length||(enabledPlaylists=compatiblePlaylists.filter(function(playlist){return!Playlist.isDisabled(playlist)}));var rebufferingEstimates=enabledPlaylists.filter(Playlist.hasAttribute.bind(null,"BANDWIDTH")).map(function(playlist){var numRequests=syncController.getSyncPoint(playlist,duration,currentTimeline,currentTime)?1:2;return{playlist:playlist,rebufferingImpact:Playlist.estimateSegmentRequestTime(segmentDuration,bandwidth,playlist)*numRequests-timeUntilRebuffer}}),noRebufferingPlaylists=rebufferingEstimates.filter(function(estimate){return estimate.rebufferingImpact<=0});return stableSort(noRebufferingPlaylists,function(a,b){return comparePlaylistBandwidth(b.playlist,a.playlist)}),noRebufferingPlaylists.length?noRebufferingPlaylists[0]:(stableSort(rebufferingEstimates,function(a,b){return a.rebufferingImpact-b.rebufferingImpact}),rebufferingEstimates[0]||null)}({master:this.vhs_.playlists.master,currentTime:currentTime,bandwidth:measuredBandwidth,duration:this.duration_(),segmentDuration:segmentDuration,timeUntilRebuffer:timeUntilRebuffer$1,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(switchCandidate){var minimumTimeSaving=.5;timeUntilRebuffer$1<=.03333333333333333&&(minimumTimeSaving=1),!switchCandidate.playlist||switchCandidate.playlist.uri===this.playlist_.uri||requestTimeRemaining-timeUntilRebuffer$1-switchCandidate.rebufferingImpact<minimumTimeSaving||(this.bandwidth=switchCandidate.playlist.attributes.BANDWIDTH*Config.BANDWIDTH_VARIANCE+1,this.trigger("earlyabort"))}}}},_proto.handleAbort_=function(segmentInfo){this.logger_("Aborting "+segmentInfoString(segmentInfo)),this.mediaRequestsAborted+=1},_proto.handleProgress_=function(event,simpleSegment){this.earlyAbortWhenNeeded_(simpleSegment.stats),this.checkForAbort_(simpleSegment.requestId)||this.trigger("progress")},_proto.handleTrackInfo_=function(simpleSegment,trackInfo){this.earlyAbortWhenNeeded_(simpleSegment.stats),this.checkForAbort_(simpleSegment.requestId)||this.checkForIllegalMediaSwitch(trackInfo)||(function(a,b){if(!a&&!b||!a&&b||a&&!b)return!1;if(a===b)return!0;var akeys=Object.keys(a).sort(),bkeys=Object.keys(b).sort();if(akeys.length!==bkeys.length)return!1;for(var i=0;i<akeys.length;i++){var key=akeys[i];if(key!==bkeys[i])return!1;if(a[key]!==b[key])return!1}return!0}(this.currentMediaInfo_,trackInfo=trackInfo||{})||(this.appendInitSegment_={audio:!0,video:!0},this.startingMediaInfo_=trackInfo,this.currentMediaInfo_=trackInfo,this.logger_("trackinfo update",trackInfo),this.trigger("trackinfo")),this.checkForAbort_(simpleSegment.requestId)||(this.pendingSegment_.trackInfo=trackInfo,this.hasEnoughInfoToAppend_()&&this.processCallQueue_()))},_proto.handleTimingInfo_=function(simpleSegment,mediaType,timeType,time){if(this.earlyAbortWhenNeeded_(simpleSegment.stats),!this.checkForAbort_(simpleSegment.requestId)){var segmentInfo=this.pendingSegment_,timingInfoProperty=timingInfoPropertyForMedia(mediaType);segmentInfo[timingInfoProperty]=segmentInfo[timingInfoProperty]||{},segmentInfo[timingInfoProperty][timeType]=time,this.logger_("timinginfo: "+mediaType+" - "+timeType+" - "+time),this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}},_proto.handleCaptions_=function(simpleSegment,captionData){var _this2=this;if(this.earlyAbortWhenNeeded_(simpleSegment.stats),!this.checkForAbort_(simpleSegment.requestId))if(0!==captionData.length)if(this.pendingSegment_.hasAppendedData_){var timestampOffset=null===this.sourceUpdater_.videoTimestampOffset()?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset(),captionTracks={};captionData.forEach(function(caption){captionTracks[caption.stream]=captionTracks[caption.stream]||{startTime:1/0,captions:[],endTime:0};var captionTrack=captionTracks[caption.stream];captionTrack.startTime=Math.min(captionTrack.startTime,caption.startTime+timestampOffset),captionTrack.endTime=Math.max(captionTrack.endTime,caption.endTime+timestampOffset),captionTrack.captions.push(caption)}),Object.keys(captionTracks).forEach(function(trackName){var _captionTracks$trackN=captionTracks[trackName],startTime=_captionTracks$trackN.startTime,endTime=_captionTracks$trackN.endTime,captions=_captionTracks$trackN.captions,inbandTextTracks=_this2.inbandTextTracks_;_this2.logger_("adding cues from "+startTime+" -> "+endTime+" for "+trackName),function(inbandTextTracks,tech,captionStream){if(!inbandTextTracks[captionStream]){tech.trigger({type:"usage",name:"vhs-608"}),tech.trigger({type:"usage",name:"hls-608"});var instreamId=captionStream;/^cc708_/.test(captionStream)&&(instreamId="SERVICE"+captionStream.split("_")[1]);var track=tech.textTracks().getTrackById(instreamId);if(track)inbandTextTracks[captionStream]=track;else{var label=captionStream,language=captionStream,def=!1,captionService=(tech.options_.vhs&&tech.options_.vhs.captionServices||{})[instreamId];captionService&&(label=captionService.label,language=captionService.language,def=captionService.default),inbandTextTracks[captionStream]=tech.addRemoteTextTrack({kind:"captions",id:instreamId,default:def,label:label,language:language},!1).track}}}(inbandTextTracks,_this2.vhs_.tech_,trackName),removeCuesFromTrack(startTime,endTime,inbandTextTracks[trackName]),function(_ref){var inbandTextTracks=_ref.inbandTextTracks,captionArray=_ref.captionArray,timestampOffset=_ref.timestampOffset;if(captionArray){var Cue=window_default().WebKitDataCue||window_default().VTTCue;captionArray.forEach(function(caption){inbandTextTracks[caption.stream].addCue(new Cue(caption.startTime+timestampOffset,caption.endTime+timestampOffset,caption.text))})}}({captionArray:captions,inbandTextTracks:inbandTextTracks,timestampOffset:timestampOffset})}),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}else this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,simpleSegment,captionData));else this.logger_("SegmentLoader received no captions from a caption event")},_proto.handleId3_=function(simpleSegment,id3Frames,dispatchType){if(this.earlyAbortWhenNeeded_(simpleSegment.stats),!this.checkForAbort_(simpleSegment.requestId))if(this.pendingSegment_.hasAppendedData_){var timestampOffset=null===this.sourceUpdater_.videoTimestampOffset()?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset();!function(inbandTextTracks,dispatchType,tech){inbandTextTracks.metadataTrack_||(inbandTextTracks.metadataTrack_=tech.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,inbandTextTracks.metadataTrack_.inBandMetadataTrackDispatchType=dispatchType)}(this.inbandTextTracks_,dispatchType,this.vhs_.tech_),function(_ref2){var inbandTextTracks=_ref2.inbandTextTracks,metadataArray=_ref2.metadataArray,timestampOffset=_ref2.timestampOffset,videoDuration=_ref2.videoDuration;if(metadataArray){var Cue=window_default().WebKitDataCue||window_default().VTTCue,metadataTrack=inbandTextTracks.metadataTrack_;if(metadataTrack&&(metadataArray.forEach(function(metadata){var time=metadata.cueTime+timestampOffset;!("number"!=typeof time||window_default().isNaN(time)||time<0)&&time<1/0&&metadata.frames.forEach(function(frame){var cue=new Cue(time,time,frame.value||frame.url||frame.data||"");cue.frame=frame,cue.value=frame,function(cue){Object.defineProperties(cue.frame,{id:{get:function(){return videojs.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),cue.value.key}},value:{get:function(){return videojs.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),cue.value.data}},privateData:{get:function(){return videojs.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),cue.value.data}}})}(cue),metadataTrack.addCue(cue)})}),metadataTrack.cues&&metadataTrack.cues.length)){for(var cues=metadataTrack.cues,cuesArray=[],i=0;i<cues.length;i++)cues[i]&&cuesArray.push(cues[i]);var cuesGroupedByStartTime=cuesArray.reduce(function(obj,cue){var timeSlot=obj[cue.startTime]||[];return timeSlot.push(cue),obj[cue.startTime]=timeSlot,obj},{}),sortedStartTimes=Object.keys(cuesGroupedByStartTime).sort(function(a,b){return Number(a)-Number(b)});sortedStartTimes.forEach(function(startTime,idx){var cueGroup=cuesGroupedByStartTime[startTime],nextTime=Number(sortedStartTimes[idx+1])||videoDuration;cueGroup.forEach(function(cue){cue.endTime=nextTime})})}}}({inbandTextTracks:this.inbandTextTracks_,metadataArray:id3Frames,timestampOffset:timestampOffset,videoDuration:this.duration_()})}else this.metadataQueue_.id3.push(this.handleId3_.bind(this,simpleSegment,id3Frames,dispatchType))},_proto.processMetadataQueue_=function(){this.metadataQueue_.id3.forEach(function(fn){return fn()}),this.metadataQueue_.caption.forEach(function(fn){return fn()}),this.metadataQueue_.id3=[],this.metadataQueue_.caption=[]},_proto.processCallQueue_=function(){var callQueue=this.callQueue_;this.callQueue_=[],callQueue.forEach(function(fun){return fun()})},_proto.processLoadQueue_=function(){var loadQueue=this.loadQueue_;this.loadQueue_=[],loadQueue.forEach(function(fun){return fun()})},_proto.hasEnoughInfoToLoad_=function(){if("audio"!==this.loaderType_)return!0;var segmentInfo=this.pendingSegment_;return!(!segmentInfo||this.getCurrentMediaInfo_()&&shouldWaitForTimelineChange({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:segmentInfo.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))},_proto.getCurrentMediaInfo_=function(segmentInfo){return void 0===segmentInfo&&(segmentInfo=this.pendingSegment_),segmentInfo&&segmentInfo.trackInfo||this.currentMediaInfo_},_proto.getMediaInfo_=function(segmentInfo){return void 0===segmentInfo&&(segmentInfo=this.pendingSegment_),this.getCurrentMediaInfo_(segmentInfo)||this.startingMediaInfo_},_proto.hasEnoughInfoToAppend_=function(){if(!this.sourceUpdater_.ready())return!1;if(this.waitingOnRemove_||this.quotaExceededErrorRetryTimeout_)return!1;var segmentInfo=this.pendingSegment_,trackInfo=this.getCurrentMediaInfo_();return!(!segmentInfo||!trackInfo||trackInfo.hasVideo&&!segmentInfo.videoTimingInfo||trackInfo.hasAudio&&!this.audioDisabled_&&!trackInfo.isMuxed&&!segmentInfo.audioTimingInfo||shouldWaitForTimelineChange({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:segmentInfo.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))},_proto.handleData_=function(simpleSegment,result){if(this.earlyAbortWhenNeeded_(simpleSegment.stats),!this.checkForAbort_(simpleSegment.requestId))if(!this.callQueue_.length&&this.hasEnoughInfoToAppend_()){var segmentInfo=this.pendingSegment_;if(this.setTimeMapping_(segmentInfo.timeline),this.updateMediaSecondsLoaded_(segmentInfo.part||segmentInfo.segment),"closed"!==this.mediaSource_.readyState){if(simpleSegment.map&&(simpleSegment.map=this.initSegmentForMap(simpleSegment.map,!0),segmentInfo.segment.map=simpleSegment.map),simpleSegment.key&&this.segmentKey(simpleSegment.key,!0),segmentInfo.isFmp4=simpleSegment.isFmp4,segmentInfo.timingInfo=segmentInfo.timingInfo||{},segmentInfo.isFmp4)this.trigger("fmp4"),segmentInfo.timingInfo.start=segmentInfo[timingInfoPropertyForMedia(result.type)].start;else{var firstVideoFrameTimeForData,trackInfo=this.getCurrentMediaInfo_(),useVideoTimingInfo="main"===this.loaderType_&&trackInfo&&trackInfo.hasVideo;useVideoTimingInfo&&(firstVideoFrameTimeForData=segmentInfo.videoTimingInfo.start),segmentInfo.timingInfo.start=this.trueSegmentStart_({currentStart:segmentInfo.timingInfo.start,playlist:segmentInfo.playlist,mediaIndex:segmentInfo.mediaIndex,currentVideoTimestampOffset:this.sourceUpdater_.videoTimestampOffset(),useVideoTimingInfo:useVideoTimingInfo,firstVideoFrameTimeForData:firstVideoFrameTimeForData,videoTimingInfo:segmentInfo.videoTimingInfo,audioTimingInfo:segmentInfo.audioTimingInfo})}if(this.updateAppendInitSegmentStatus(segmentInfo,result.type),this.updateSourceBufferTimestampOffset_(segmentInfo),segmentInfo.isSyncRequest){this.updateTimingInfoEnd_(segmentInfo),this.syncController_.saveSegmentTimingInfo({segmentInfo:segmentInfo,shouldSaveTimelineMapping:"main"===this.loaderType_});var next=this.chooseNextRequest_();if(next.mediaIndex!==segmentInfo.mediaIndex||next.partIndex!==segmentInfo.partIndex)return void this.logger_("sync segment was incorrect, not appending");this.logger_("sync segment was correct, appending")}segmentInfo.hasAppendedData_=!0,this.processMetadataQueue_(),this.appendData_(segmentInfo,result)}}else this.callQueue_.push(this.handleData_.bind(this,simpleSegment,result))},_proto.updateAppendInitSegmentStatus=function(segmentInfo,type){"main"!==this.loaderType_||"number"!=typeof segmentInfo.timestampOffset||segmentInfo.changedTimestampOffset||(this.appendInitSegment_={audio:!0,video:!0}),this.playlistOfLastInitSegment_[type]!==segmentInfo.playlist&&(this.appendInitSegment_[type]=!0)},_proto.getInitSegmentAndUpdateState_=function(_ref4){var type=_ref4.type,initSegment=_ref4.initSegment,map=_ref4.map,playlist=_ref4.playlist;if(map){var id=initSegmentId(map);if(this.activeInitSegmentId_===id)return null;initSegment=this.initSegmentForMap(map,!0).bytes,this.activeInitSegmentId_=id}return initSegment&&this.appendInitSegment_[type]?(this.playlistOfLastInitSegment_[type]=playlist,this.appendInitSegment_[type]=!1,this.activeInitSegmentId_=null,initSegment):null},_proto.handleQuotaExceededError_=function(_ref5,error){var _this3=this,segmentInfo=_ref5.segmentInfo,type=_ref5.type,bytes=_ref5.bytes,audioBuffered=this.sourceUpdater_.audioBuffered(),videoBuffered=this.sourceUpdater_.videoBuffered();audioBuffered.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the audio buffer: "+timeRangesToArray(audioBuffered).join(", ")),videoBuffered.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the video buffer: "+timeRangesToArray(videoBuffered).join(", "));var audioBufferStart=audioBuffered.length?audioBuffered.start(0):0,audioBufferEnd=audioBuffered.length?audioBuffered.end(audioBuffered.length-1):0,videoBufferStart=videoBuffered.length?videoBuffered.start(0):0,videoBufferEnd=videoBuffered.length?videoBuffered.end(videoBuffered.length-1):0;if(audioBufferEnd-audioBufferStart<=1&&videoBufferEnd-videoBufferStart<=1)return this.logger_("On QUOTA_EXCEEDED_ERR, single segment too large to append to buffer, triggering an error. Appended byte length: "+bytes.byteLength+", audio buffer: "+timeRangesToArray(audioBuffered).join(", ")+", video buffer: "+timeRangesToArray(videoBuffered).join(", ")+", "),this.error({message:"Quota exceeded error with append of a single segment of content",excludeUntil:1/0}),void this.trigger("error");this.waitingOnRemove_=!0,this.callQueue_.push(this.appendToSourceBuffer_.bind(this,{segmentInfo:segmentInfo,type:type,bytes:bytes}));var timeToRemoveUntil=this.currentTime_()-1;this.logger_("On QUOTA_EXCEEDED_ERR, removing audio/video from 0 to "+timeToRemoveUntil),this.remove(0,timeToRemoveUntil,function(){_this3.logger_("On QUOTA_EXCEEDED_ERR, retrying append in 1s"),_this3.waitingOnRemove_=!1,_this3.quotaExceededErrorRetryTimeout_=window_default().setTimeout(function(){_this3.logger_("On QUOTA_EXCEEDED_ERR, re-processing call queue"),_this3.quotaExceededErrorRetryTimeout_=null,_this3.processCallQueue_()},1e3)},!0)},_proto.handleAppendError_=function(_ref6,error){var segmentInfo=_ref6.segmentInfo,type=_ref6.type,bytes=_ref6.bytes;error&&(22!==error.code?(this.logger_("Received non QUOTA_EXCEEDED_ERR on append",error),this.error(type+" append of "+bytes.length+"b failed for segment #"+segmentInfo.mediaIndex+" in playlist "+segmentInfo.playlist.id),this.trigger("appenderror")):this.handleQuotaExceededError_({segmentInfo:segmentInfo,type:type,bytes:bytes}))},_proto.appendToSourceBuffer_=function(_ref7){var segmentObj,tempBuffer,offset,segmentInfo=_ref7.segmentInfo,type=_ref7.type,initSegment=_ref7.initSegment,data=_ref7.data,bytes=_ref7.bytes;if(!bytes){var segments=[data],byteLength=data.byteLength;initSegment&&(segments.unshift(initSegment),byteLength+=initSegment.byteLength),offset=0,(segmentObj={bytes:byteLength,segments:segments}).bytes&&(tempBuffer=new Uint8Array(segmentObj.bytes),segmentObj.segments.forEach(function(segment){tempBuffer.set(segment,offset),offset+=segment.byteLength})),bytes=tempBuffer}this.sourceUpdater_.appendBuffer({segmentInfo:segmentInfo,type:type,bytes:bytes},this.handleAppendError_.bind(this,{segmentInfo:segmentInfo,type:type,bytes:bytes}))},_proto.handleSegmentTimingInfo_=function(type,requestId,segmentTimingInfo){if(this.pendingSegment_&&requestId===this.pendingSegment_.requestId){var segment=this.pendingSegment_.segment,timingInfoProperty=type+"TimingInfo";segment[timingInfoProperty]||(segment[timingInfoProperty]={}),segment[timingInfoProperty].transmuxerPrependedSeconds=segmentTimingInfo.prependedContentDuration||0,segment[timingInfoProperty].transmuxedPresentationStart=segmentTimingInfo.start.presentation,segment[timingInfoProperty].transmuxedDecodeStart=segmentTimingInfo.start.decode,segment[timingInfoProperty].transmuxedPresentationEnd=segmentTimingInfo.end.presentation,segment[timingInfoProperty].transmuxedDecodeEnd=segmentTimingInfo.end.decode,segment[timingInfoProperty].baseMediaDecodeTime=segmentTimingInfo.baseMediaDecodeTime}},_proto.appendData_=function(segmentInfo,result){var type=result.type,data=result.data;if(data&&data.byteLength&&("audio"!==type||!this.audioDisabled_)){var initSegment=this.getInitSegmentAndUpdateState_({type:type,initSegment:result.initSegment,playlist:segmentInfo.playlist,map:segmentInfo.isFmp4?segmentInfo.segment.map:null});this.appendToSourceBuffer_({segmentInfo:segmentInfo,type:type,initSegment:initSegment,data:data})}},_proto.loadSegment_=function(segmentInfo){var _this4=this;this.state="WAITING",this.pendingSegment_=segmentInfo,this.trimBackBuffer_(segmentInfo),"number"==typeof segmentInfo.timestampOffset&&this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.hasEnoughInfoToLoad_()?this.updateTransmuxerAndRequestSegment_(segmentInfo):this.loadQueue_.push(function(){var options=extends_default()({},segmentInfo,{forceTimestampOffset:!0});extends_default()(segmentInfo,_this4.generateSegmentInfo_(options)),_this4.isPendingTimestampOffset_=!1,_this4.updateTransmuxerAndRequestSegment_(segmentInfo)})},_proto.updateTransmuxerAndRequestSegment_=function(segmentInfo){var _this5=this;this.shouldUpdateTransmuxerTimestampOffset_(segmentInfo.timestampOffset)&&(this.gopBuffer_.length=0,segmentInfo.gopsToAlignWith=[],this.timeMapping_=0,this.transmuxer_.postMessage({action:"reset"}),this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:segmentInfo.timestampOffset}));var simpleSegment=this.createSimplifiedSegmentObj_(segmentInfo),isEndOfTimeline=this.isEndOfStream_(segmentInfo.mediaIndex,segmentInfo.playlist,segmentInfo.partIndex)||null!==this.mediaIndex&&segmentInfo.timeline!==this.currentTimeline_&&segmentInfo.timeline>0;this.logger_("Requesting "+segmentInfoString(segmentInfo)),simpleSegment.map&&!simpleSegment.map.bytes&&(this.logger_("going to request init segment."),this.appendInitSegment_={video:!0,audio:!0}),segmentInfo.abortRequests=mediaSegmentRequest({xhr:this.vhs_.xhr,xhrOptions:this.xhrOptions_,decryptionWorker:this.decrypter_,segment:simpleSegment,abortFn:this.handleAbort_.bind(this,segmentInfo),progressFn:this.handleProgress_.bind(this),trackInfoFn:this.handleTrackInfo_.bind(this),timingInfoFn:this.handleTimingInfo_.bind(this),videoSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"video",segmentInfo.requestId),audioSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"audio",segmentInfo.requestId),captionsFn:this.handleCaptions_.bind(this),isEndOfTimeline:isEndOfTimeline,endedTimelineFn:function(){_this5.logger_("received endedtimeline callback")},id3Fn:this.handleId3_.bind(this),dataFn:this.handleData_.bind(this),doneFn:this.segmentRequestFinished_.bind(this),onTransmuxerLog:function(_ref8){var message=_ref8.message,level=_ref8.level,stream=_ref8.stream;_this5.logger_(segmentInfoString(segmentInfo)+" logged from transmuxer stream "+stream+" as a "+level+": "+message)}})},_proto.trimBackBuffer_=function(segmentInfo){var seekable,currentTime,targetDuration,trimTime,removeToTime=(seekable=this.seekable_(),currentTime=this.currentTime_(),targetDuration=this.playlist_.targetDuration||10,trimTime=currentTime-Config.BACK_BUFFER_LENGTH,seekable.length&&(trimTime=Math.max(trimTime,seekable.start(0))),Math.min(currentTime-targetDuration,trimTime));removeToTime>0&&this.remove(0,removeToTime)},_proto.createSimplifiedSegmentObj_=function(segmentInfo){var segment=segmentInfo.segment,part=segmentInfo.part,simpleSegment={resolvedUri:part?part.resolvedUri:segment.resolvedUri,byterange:part?part.byterange:segment.byterange,requestId:segmentInfo.requestId,transmuxer:segmentInfo.transmuxer,audioAppendStart:segmentInfo.audioAppendStart,gopsToAlignWith:segmentInfo.gopsToAlignWith,part:segmentInfo.part},previousSegment=segmentInfo.playlist.segments[segmentInfo.mediaIndex-1];if(previousSegment&&previousSegment.timeline===segment.timeline&&(previousSegment.videoTimingInfo?simpleSegment.baseStartTime=previousSegment.videoTimingInfo.transmuxedDecodeEnd:previousSegment.audioTimingInfo&&(simpleSegment.baseStartTime=previousSegment.audioTimingInfo.transmuxedDecodeEnd)),segment.key){var iv=segment.key.iv||new Uint32Array([0,0,0,segmentInfo.mediaIndex+segmentInfo.playlist.mediaSequence]);simpleSegment.key=this.segmentKey(segment.key),simpleSegment.key.iv=iv}return segment.map&&(simpleSegment.map=this.initSegmentForMap(segment.map)),simpleSegment},_proto.saveTransferStats_=function(stats){this.mediaRequests+=1,stats&&(this.mediaBytesTransferred+=stats.bytesReceived,this.mediaTransferDuration+=stats.roundTripTime)},_proto.saveBandwidthRelatedStats_=function(duration,stats){this.pendingSegment_.byteLength=stats.bytesReceived,duration<.016666666666666666?this.logger_("Ignoring segment's bandwidth because its duration of "+duration+" is less than the min to record 0.016666666666666666"):(this.bandwidth=stats.bandwidth,this.roundTrip=stats.roundTripTime)},_proto.handleTimeout_=function(){this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,this.trigger("bandwidthupdate")},_proto.segmentRequestFinished_=function(error,simpleSegment,result){if(this.callQueue_.length)this.callQueue_.push(this.segmentRequestFinished_.bind(this,error,simpleSegment,result));else if(this.saveTransferStats_(simpleSegment.stats),this.pendingSegment_&&simpleSegment.requestId===this.pendingSegment_.requestId){if(error){if(this.pendingSegment_=null,this.state="READY",-102===error.code)return;return this.pause(),-101===error.code?void this.handleTimeout_():(this.mediaRequestsErrored+=1,this.error(error),void this.trigger("error"))}var segmentInfo=this.pendingSegment_;this.saveBandwidthRelatedStats_(segmentInfo.duration,simpleSegment.stats),segmentInfo.endOfAllRequests=simpleSegment.endOfAllRequests,result.gopInfo&&(this.gopBuffer_=function(buffer,gops,replace){if(!gops.length)return buffer;if(replace)return gops.slice();for(var start=gops[0].pts,i=0;i<buffer.length&&!(buffer[i].pts>=start);i++);return buffer.slice(0,i).concat(gops)}(this.gopBuffer_,result.gopInfo,this.safeAppend_)),this.state="APPENDING",this.trigger("appending"),this.waitForAppendsToComplete_(segmentInfo)}},_proto.setTimeMapping_=function(timeline){var timelineMapping=this.syncController_.mappingForTimeline(timeline);null!==timelineMapping&&(this.timeMapping_=timelineMapping)},_proto.updateMediaSecondsLoaded_=function(segment){this.mediaSecondsLoaded+="number"==typeof segment.start&&"number"==typeof segment.end?segment.end-segment.start:segment.duration},_proto.shouldUpdateTransmuxerTimestampOffset_=function(timestampOffset){return null!==timestampOffset&&("main"===this.loaderType_&&timestampOffset!==this.sourceUpdater_.videoTimestampOffset()||!this.audioDisabled_&&timestampOffset!==this.sourceUpdater_.audioTimestampOffset())},_proto.trueSegmentStart_=function(_ref9){var currentStart=_ref9.currentStart,mediaIndex=_ref9.mediaIndex,firstVideoFrameTimeForData=_ref9.firstVideoFrameTimeForData;if(void 0!==currentStart)return currentStart;if(!_ref9.useVideoTimingInfo)return _ref9.audioTimingInfo.start;var previousSegment=_ref9.playlist.segments[mediaIndex-1];return 0!==mediaIndex&&previousSegment&&void 0!==previousSegment.start&&previousSegment.end===firstVideoFrameTimeForData+_ref9.currentVideoTimestampOffset?_ref9.videoTimingInfo.start:firstVideoFrameTimeForData},_proto.waitForAppendsToComplete_=function(segmentInfo){var trackInfo=this.getCurrentMediaInfo_(segmentInfo);if(!trackInfo)return this.error({message:"No starting media returned, likely due to an unsupported media format.",blacklistDuration:1/0}),void this.trigger("error");var waitForVideo="main"===this.loaderType_&&trackInfo.hasVideo,waitForAudio=!this.audioDisabled_&&trackInfo.hasAudio&&!trackInfo.isMuxed;if(segmentInfo.waitingOnAppends=0,!segmentInfo.hasAppendedData_)return segmentInfo.timingInfo||"number"!=typeof segmentInfo.timestampOffset||(this.isPendingTimestampOffset_=!0),segmentInfo.timingInfo={start:0},segmentInfo.waitingOnAppends++,this.isPendingTimestampOffset_||(this.updateSourceBufferTimestampOffset_(segmentInfo),this.processMetadataQueue_()),void this.checkAppendsDone_(segmentInfo);waitForVideo&&segmentInfo.waitingOnAppends++,waitForAudio&&segmentInfo.waitingOnAppends++,waitForVideo&&this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,segmentInfo)),waitForAudio&&this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,segmentInfo))},_proto.checkAppendsDone_=function(segmentInfo){this.checkForAbort_(segmentInfo.requestId)||(segmentInfo.waitingOnAppends--,0===segmentInfo.waitingOnAppends&&this.handleAppendsDone_())},_proto.checkForIllegalMediaSwitch=function(trackInfo){var illegalMediaSwitchError=function(loaderType,startingMedia,trackInfo){return"main"===loaderType&&startingMedia&&trackInfo?trackInfo.hasAudio||trackInfo.hasVideo?startingMedia.hasVideo&&!trackInfo.hasVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!startingMedia.hasVideo&&trackInfo.hasVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null:"Neither audio nor video found in segment.":null}(this.loaderType_,this.getCurrentMediaInfo_(),trackInfo);return!!illegalMediaSwitchError&&(this.error({message:illegalMediaSwitchError,blacklistDuration:1/0}),this.trigger("error"),!0)},_proto.updateSourceBufferTimestampOffset_=function(segmentInfo){if(null!==segmentInfo.timestampOffset&&"number"==typeof segmentInfo.timingInfo.start&&!segmentInfo.changedTimestampOffset&&"main"===this.loaderType_){var didChange=!1;segmentInfo.timestampOffset-=segmentInfo.timingInfo.start,segmentInfo.changedTimestampOffset=!0,segmentInfo.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()&&(this.sourceUpdater_.videoTimestampOffset(segmentInfo.timestampOffset),didChange=!0),segmentInfo.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()&&(this.sourceUpdater_.audioTimestampOffset(segmentInfo.timestampOffset),didChange=!0),didChange&&this.trigger("timestampoffset")}},_proto.updateTimingInfoEnd_=function(segmentInfo){segmentInfo.timingInfo=segmentInfo.timingInfo||{};var trackInfo=this.getMediaInfo_(),prioritizedTimingInfo="main"===this.loaderType_&&trackInfo&&trackInfo.hasVideo&&segmentInfo.videoTimingInfo?segmentInfo.videoTimingInfo:segmentInfo.audioTimingInfo;prioritizedTimingInfo&&(segmentInfo.timingInfo.end="number"==typeof prioritizedTimingInfo.end?prioritizedTimingInfo.end:prioritizedTimingInfo.start+segmentInfo.duration)},_proto.handleAppendsDone_=function(){if(this.pendingSegment_&&this.trigger("appendsdone"),!this.pendingSegment_)return this.state="READY",void(this.paused()||this.monitorBuffer_());var segmentInfo=this.pendingSegment_;this.updateTimingInfoEnd_(segmentInfo),this.shouldSaveSegmentTimingInfo_&&this.syncController_.saveSegmentTimingInfo({segmentInfo:segmentInfo,shouldSaveTimelineMapping:"main"===this.loaderType_});var segmentDurationMessage=function(segmentInfo,sourceType){if("hls"!==sourceType)return null;var audioTimingInfo,videoTimingInfo,segmentDuration=(audioTimingInfo=segmentInfo.audioTimingInfo,videoTimingInfo=segmentInfo.videoTimingInfo,Math.max(audioTimingInfo&&"number"==typeof audioTimingInfo.start&&"number"==typeof audioTimingInfo.end?audioTimingInfo.end-audioTimingInfo.start:0,videoTimingInfo&&"number"==typeof videoTimingInfo.start&&"number"==typeof videoTimingInfo.end?videoTimingInfo.end-videoTimingInfo.start:0));if(!segmentDuration)return null;var targetDuration=segmentInfo.playlist.targetDuration,isSegmentWayTooLong=segmentTooLong({segmentDuration:segmentDuration,maxDuration:2*targetDuration}),isSegmentSlightlyTooLong=segmentTooLong({segmentDuration:segmentDuration,maxDuration:targetDuration});return isSegmentWayTooLong||isSegmentSlightlyTooLong?{severity:isSegmentWayTooLong?"warn":"info",message:"Segment with index "+segmentInfo.mediaIndex+" from playlist "+segmentInfo.playlist.id+" has a duration of "+segmentDuration+" when the reported duration is "+segmentInfo.duration+" and the target duration is "+targetDuration+". For HLS content, a duration in excess of the target duration may result in playback issues. See the HLS specification section on EXT-X-TARGETDURATION for more details: https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.3.1"}:null}(segmentInfo,this.sourceType_);if(segmentDurationMessage&&("warn"===segmentDurationMessage.severity?videojs.log.warn(segmentDurationMessage.message):this.logger_(segmentDurationMessage.message)),this.recordThroughput_(segmentInfo),this.pendingSegment_=null,this.state="READY",!segmentInfo.isSyncRequest||(this.trigger("syncinfoupdate"),segmentInfo.hasAppendedData_)){this.logger_("Appended "+segmentInfoString(segmentInfo)),this.addSegmentMetadataCue_(segmentInfo),this.fetchAtBuffer_=!0,this.currentTimeline_!==segmentInfo.timeline&&(this.timelineChangeController_.lastTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:segmentInfo.timeline}),"main"!==this.loaderType_||this.audioDisabled_||this.timelineChangeController_.lastTimelineChange({type:"audio",from:this.currentTimeline_,to:segmentInfo.timeline})),this.currentTimeline_=segmentInfo.timeline,this.trigger("syncinfoupdate");var segment=segmentInfo.segment,part=segmentInfo.part,badSegmentGuess=segment.end&&this.currentTime_()-segment.end>3*segmentInfo.playlist.targetDuration,badPartGuess=part&&part.end&&this.currentTime_()-part.end>3*segmentInfo.playlist.partTargetDuration;if(badSegmentGuess||badPartGuess)return this.logger_("bad "+(badSegmentGuess?"segment":"part")+" "+segmentInfoString(segmentInfo)),void this.resetEverything();null!==this.mediaIndex&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.mediaIndex=segmentInfo.mediaIndex,this.partIndex=segmentInfo.partIndex,this.isEndOfStream_(segmentInfo.mediaIndex,segmentInfo.playlist,segmentInfo.partIndex)&&this.endOfStream(),this.trigger("appended"),segmentInfo.hasAppendedData_&&this.mediaAppends++,this.paused()||this.monitorBuffer_()}else this.logger_("Throwing away un-appended sync request "+segmentInfoString(segmentInfo))},_proto.recordThroughput_=function(segmentInfo){if(segmentInfo.duration<.016666666666666666)this.logger_("Ignoring segment's throughput because its duration of "+segmentInfo.duration+" is less than the min to record 0.016666666666666666");else{var rate=this.throughput.rate,segmentProcessingTime=Date.now()-segmentInfo.endOfAllRequests+1,segmentProcessingThroughput=Math.floor(segmentInfo.byteLength/segmentProcessingTime*8*1e3);this.throughput.rate+=(segmentProcessingThroughput-rate)/++this.throughput.count}},_proto.addSegmentMetadataCue_=function(segmentInfo){if(this.segmentMetadataTrack_){var segment=segmentInfo.segment,start=segment.start,end=segment.end;if(finite(start)&&finite(end)){removeCuesFromTrack(start,end,this.segmentMetadataTrack_);var Cue=window_default().WebKitDataCue||window_default().VTTCue,value={custom:segment.custom,dateTimeObject:segment.dateTimeObject,dateTimeString:segment.dateTimeString,bandwidth:segmentInfo.playlist.attributes.BANDWIDTH,resolution:segmentInfo.playlist.attributes.RESOLUTION,codecs:segmentInfo.playlist.attributes.CODECS,byteLength:segmentInfo.byteLength,uri:segmentInfo.uri,timeline:segmentInfo.timeline,playlist:segmentInfo.playlist.id,start:start,end:end},cue=new Cue(start,end,JSON.stringify(value));cue.value=value,this.segmentMetadataTrack_.addCue(cue)}}},SegmentLoader}(videojs.EventTarget);function noop(){}var Vhs$1,toTitleCase=function(string){return"string"!=typeof string?string:string.replace(/./,function(w){return w.toUpperCase()})},bufferTypes=["video","audio"],_updating=function(type,sourceUpdater){var sourceBuffer=sourceUpdater[type+"Buffer"];return sourceBuffer&&sourceBuffer.updating||sourceUpdater.queuePending[type]},shiftQueue=function shiftQueue(type,sourceUpdater){if(0!==sourceUpdater.queue.length){var queueIndex=0,queueEntry=sourceUpdater.queue[queueIndex];if("mediaSource"!==queueEntry.type){if("mediaSource"!==type&&sourceUpdater.ready()&&"closed"!==sourceUpdater.mediaSource.readyState&&!_updating(type,sourceUpdater)){if(queueEntry.type!==type){if(queueIndex=function(type,queue){for(var i=0;i<queue.length;i++){var queueEntry=queue[i];if("mediaSource"===queueEntry.type)return null;if(queueEntry.type===type)return i}return null}(type,sourceUpdater.queue),null===queueIndex)return;queueEntry=sourceUpdater.queue[queueIndex]}return sourceUpdater.queue.splice(queueIndex,1),sourceUpdater.queuePending[type]=queueEntry,queueEntry.action(type,sourceUpdater),queueEntry.doneFn?void 0:(sourceUpdater.queuePending[type]=null,void shiftQueue(type,sourceUpdater))}}else sourceUpdater.updating()||"closed"===sourceUpdater.mediaSource.readyState||(sourceUpdater.queue.shift(),queueEntry.action(sourceUpdater),queueEntry.doneFn&&queueEntry.doneFn(),shiftQueue("audio",sourceUpdater),shiftQueue("video",sourceUpdater))}},cleanupBuffer=function(type,sourceUpdater){var buffer=sourceUpdater[type+"Buffer"],titleType=toTitleCase(type);buffer&&(buffer.removeEventListener("updateend",sourceUpdater["on"+titleType+"UpdateEnd_"]),buffer.removeEventListener("error",sourceUpdater["on"+titleType+"Error_"]),sourceUpdater.codecs[type]=null,sourceUpdater[type+"Buffer"]=null)},inSourceBuffers=function(mediaSource,sourceBuffer){return mediaSource&&sourceBuffer&&-1!==Array.prototype.indexOf.call(mediaSource.sourceBuffers,sourceBuffer)},actions_appendBuffer=function(bytes,segmentInfo,onError){return function(type,sourceUpdater){var sourceBuffer=sourceUpdater[type+"Buffer"];if(inSourceBuffers(sourceUpdater.mediaSource,sourceBuffer)){sourceUpdater.logger_("Appending segment "+segmentInfo.mediaIndex+"'s "+bytes.length+" bytes to "+type+"Buffer");try{sourceBuffer.appendBuffer(bytes)}catch(e){sourceUpdater.logger_("Error with code "+e.code+" "+(22===e.code?"(QUOTA_EXCEEDED_ERR) ":"")+"when appending segment "+segmentInfo.mediaIndex+" to "+type+"Buffer"),sourceUpdater.queuePending[type]=null,onError(e)}}}},actions_remove=function(start,end){return function(type,sourceUpdater){var sourceBuffer=sourceUpdater[type+"Buffer"];if(inSourceBuffers(sourceUpdater.mediaSource,sourceBuffer)){sourceUpdater.logger_("Removing "+start+" to "+end+" from "+type+"Buffer");try{sourceBuffer.remove(start,end)}catch(e){sourceUpdater.logger_("Remove "+start+" to "+end+" from "+type+"Buffer failed")}}}},actions_timestampOffset=function(offset){return function(type,sourceUpdater){var sourceBuffer=sourceUpdater[type+"Buffer"];inSourceBuffers(sourceUpdater.mediaSource,sourceBuffer)&&(sourceUpdater.logger_("Setting "+type+"timestampOffset to "+offset),sourceBuffer.timestampOffset=offset)}},actions_callback=function(_callback){return function(type,sourceUpdater){_callback()}},actions_endOfStream=function(error){return function(sourceUpdater){if("open"===sourceUpdater.mediaSource.readyState){sourceUpdater.logger_("Calling mediaSource endOfStream("+(error||"")+")");try{sourceUpdater.mediaSource.endOfStream(error)}catch(e){videojs.log.warn("Failed to call media source endOfStream",e)}}}},actions_addSourceBuffer=function(type,codec){return function(sourceUpdater){var titleType=toTitleCase(type),mime=getMimeForCodec(codec);sourceUpdater.logger_("Adding "+type+"Buffer with codec "+codec+" to mediaSource");var sourceBuffer=sourceUpdater.mediaSource.addSourceBuffer(mime);sourceBuffer.addEventListener("updateend",sourceUpdater["on"+titleType+"UpdateEnd_"]),sourceBuffer.addEventListener("error",sourceUpdater["on"+titleType+"Error_"]),sourceUpdater.codecs[type]=codec,sourceUpdater[type+"Buffer"]=sourceBuffer}},actions_removeSourceBuffer=function(type){return function(sourceUpdater){var sourceBuffer=sourceUpdater[type+"Buffer"];if(cleanupBuffer(type,sourceUpdater),inSourceBuffers(sourceUpdater.mediaSource,sourceBuffer)){sourceUpdater.logger_("Removing "+type+"Buffer with codec "+sourceUpdater.codecs[type]+" from mediaSource");try{sourceUpdater.mediaSource.removeSourceBuffer(sourceBuffer)}catch(e){videojs.log.warn("Failed to removeSourceBuffer "+type+"Buffer",e)}}}},actions_changeType=function(codec){return function(type,sourceUpdater){var sourceBuffer=sourceUpdater[type+"Buffer"],mime=getMimeForCodec(codec);inSourceBuffers(sourceUpdater.mediaSource,sourceBuffer)&&sourceUpdater.codecs[type]!==codec&&(sourceUpdater.logger_("changing "+type+"Buffer codec from "+sourceUpdater.codecs[type]+" to "+codec),sourceBuffer.changeType(mime),sourceUpdater.codecs[type]=codec)}},pushQueue=function(_ref){var type=_ref.type,sourceUpdater=_ref.sourceUpdater;sourceUpdater.queue.push({type:type,action:_ref.action,doneFn:_ref.doneFn,name:_ref.name}),shiftQueue(type,sourceUpdater)},onUpdateend=function(type,sourceUpdater){return function(e){if(sourceUpdater.queuePending[type]){var doneFn=sourceUpdater.queuePending[type].doneFn;sourceUpdater.queuePending[type]=null,doneFn&&doneFn(sourceUpdater[type+"Error_"])}shiftQueue(type,sourceUpdater)}},SourceUpdater=function(_videojs$EventTarget){function SourceUpdater(mediaSource){var _this;return(_this=_videojs$EventTarget.call(this)||this).mediaSource=mediaSource,_this.sourceopenListener_=function(){return shiftQueue("mediaSource",assertThisInitialized_default()(_this))},_this.mediaSource.addEventListener("sourceopen",_this.sourceopenListener_),_this.logger_=logger("SourceUpdater"),_this.audioTimestampOffset_=0,_this.videoTimestampOffset_=0,_this.queue=[],_this.queuePending={audio:null,video:null},_this.delayedAudioAppendQueue_=[],_this.videoAppendQueued_=!1,_this.codecs={},_this.onVideoUpdateEnd_=onUpdateend("video",assertThisInitialized_default()(_this)),_this.onAudioUpdateEnd_=onUpdateend("audio",assertThisInitialized_default()(_this)),_this.onVideoError_=function(e){_this.videoError_=e},_this.onAudioError_=function(e){_this.audioError_=e},_this.createdSourceBuffers_=!1,_this.initializedEme_=!1,_this.triggeredReady_=!1,_this}inheritsLoose_default()(SourceUpdater,_videojs$EventTarget);var _proto=SourceUpdater.prototype;return _proto.initializedEme=function(){this.initializedEme_=!0,this.triggerReady()},_proto.hasCreatedSourceBuffers=function(){return this.createdSourceBuffers_},_proto.hasInitializedAnyEme=function(){return this.initializedEme_},_proto.ready=function(){return this.hasCreatedSourceBuffers()&&this.hasInitializedAnyEme()},_proto.createSourceBuffers=function(codecs){this.hasCreatedSourceBuffers()||(this.addOrChangeSourceBuffers(codecs),this.createdSourceBuffers_=!0,this.trigger("createdsourcebuffers"),this.triggerReady())},_proto.triggerReady=function(){this.ready()&&!this.triggeredReady_&&(this.triggeredReady_=!0,this.trigger("ready"))},_proto.addSourceBuffer=function(type,codec){pushQueue({type:"mediaSource",sourceUpdater:this,action:actions_addSourceBuffer(type,codec),name:"addSourceBuffer"})},_proto.abort=function(type){pushQueue({type:type,sourceUpdater:this,action:function(type,sourceUpdater){if("open"===sourceUpdater.mediaSource.readyState){var sourceBuffer=sourceUpdater[type+"Buffer"];if(inSourceBuffers(sourceUpdater.mediaSource,sourceBuffer)){sourceUpdater.logger_("calling abort on "+type+"Buffer");try{sourceBuffer.abort()}catch(e){videojs.log.warn("Failed to abort on "+type+"Buffer",e)}}}},name:"abort"})},_proto.removeSourceBuffer=function(type){this.canRemoveSourceBuffer()?pushQueue({type:"mediaSource",sourceUpdater:this,action:actions_removeSourceBuffer(type),name:"removeSourceBuffer"}):videojs.log.error("removeSourceBuffer is not supported!")},_proto.canRemoveSourceBuffer=function(){return!videojs.browser.IE_VERSION&&!videojs.browser.IS_FIREFOX&&window_default().MediaSource&&window_default().MediaSource.prototype&&"function"==typeof window_default().MediaSource.prototype.removeSourceBuffer},SourceUpdater.canChangeType=function(){return window_default().SourceBuffer&&window_default().SourceBuffer.prototype&&"function"==typeof window_default().SourceBuffer.prototype.changeType},_proto.canChangeType=function(){return this.constructor.canChangeType()},_proto.changeType=function(type,codec){this.canChangeType()?pushQueue({type:type,sourceUpdater:this,action:actions_changeType(codec),name:"changeType"}):videojs.log.error("changeType is not supported!")},_proto.addOrChangeSourceBuffers=function(codecs){var _this2=this;if(!codecs||"object"!=typeof codecs||0===Object.keys(codecs).length)throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs");Object.keys(codecs).forEach(function(type){var codec=codecs[type];if(!_this2.hasCreatedSourceBuffers())return _this2.addSourceBuffer(type,codec);_this2.canChangeType()&&_this2.changeType(type,codec)})},_proto.appendBuffer=function(options,doneFn){var _this3=this,segmentInfo=options.segmentInfo,type=options.type,bytes=options.bytes;if(this.processedAppend_=!0,"audio"===type&&this.videoBuffer&&!this.videoAppendQueued_)return this.delayedAudioAppendQueue_.push([options,doneFn]),void this.logger_("delayed audio append of "+bytes.length+" until video append");if(pushQueue({type:type,sourceUpdater:this,action:actions_appendBuffer(bytes,segmentInfo||{mediaIndex:-1},doneFn),doneFn:doneFn,name:"appendBuffer"}),"video"===type){if(this.videoAppendQueued_=!0,!this.delayedAudioAppendQueue_.length)return;var queue=this.delayedAudioAppendQueue_.slice();this.logger_("queuing delayed audio "+queue.length+" appendBuffers"),this.delayedAudioAppendQueue_.length=0,queue.forEach(function(que){_this3.appendBuffer.apply(_this3,que)})}},_proto.audioBuffered=function(){return inSourceBuffers(this.mediaSource,this.audioBuffer)&&this.audioBuffer.buffered?this.audioBuffer.buffered:videojs.createTimeRange()},_proto.videoBuffered=function(){return inSourceBuffers(this.mediaSource,this.videoBuffer)&&this.videoBuffer.buffered?this.videoBuffer.buffered:videojs.createTimeRange()},_proto.buffered=function(){var video=inSourceBuffers(this.mediaSource,this.videoBuffer)?this.videoBuffer:null,audio=inSourceBuffers(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;return audio&&!video?this.audioBuffered():video&&!audio?this.videoBuffered():function(bufferA,bufferB){var start=null,end=null,arity=0,extents=[],ranges=[];if(!(bufferA&&bufferA.length&&bufferB&&bufferB.length))return videojs.createTimeRange();for(var count=bufferA.length;count--;)extents.push({time:bufferA.start(count),type:"start"}),extents.push({time:bufferA.end(count),type:"end"});for(count=bufferB.length;count--;)extents.push({time:bufferB.start(count),type:"start"}),extents.push({time:bufferB.end(count),type:"end"});for(extents.sort(function(a,b){return a.time-b.time}),count=0;count<extents.length;count++)"start"===extents[count].type?2==++arity&&(start=extents[count].time):"end"===extents[count].type&&1==--arity&&(end=extents[count].time),null!==start&&null!==end&&(ranges.push([start,end]),start=null,end=null);return videojs.createTimeRanges(ranges)}(this.audioBuffered(),this.videoBuffered())},_proto.setDuration=function(duration,doneFn){var _duration;void 0===doneFn&&(doneFn=noop),pushQueue({type:"mediaSource",sourceUpdater:this,action:(_duration=duration,function(sourceUpdater){sourceUpdater.logger_("Setting mediaSource duration to "+_duration);try{sourceUpdater.mediaSource.duration=_duration}catch(e){videojs.log.warn("Failed to set media source duration",e)}}),name:"duration",doneFn:doneFn})},_proto.endOfStream=function(error,doneFn){void 0===error&&(error=null),void 0===doneFn&&(doneFn=noop),"string"!=typeof error&&(error=void 0),pushQueue({type:"mediaSource",sourceUpdater:this,action:actions_endOfStream(error),name:"endOfStream",doneFn:doneFn})},_proto.removeAudio=function(start,end,done){void 0===done&&(done=noop),this.audioBuffered().length&&0!==this.audioBuffered().end(0)?pushQueue({type:"audio",sourceUpdater:this,action:actions_remove(start,end),doneFn:done,name:"remove"}):done()},_proto.removeVideo=function(start,end,done){void 0===done&&(done=noop),this.videoBuffered().length&&0!==this.videoBuffered().end(0)?pushQueue({type:"video",sourceUpdater:this,action:actions_remove(start,end),doneFn:done,name:"remove"}):done()},_proto.updating=function(){return!(!_updating("audio",this)&&!_updating("video",this))},_proto.audioTimestampOffset=function(offset){return void 0!==offset&&this.audioBuffer&&this.audioTimestampOffset_!==offset&&(pushQueue({type:"audio",sourceUpdater:this,action:actions_timestampOffset(offset),name:"timestampOffset"}),this.audioTimestampOffset_=offset),this.audioTimestampOffset_},_proto.videoTimestampOffset=function(offset){return void 0!==offset&&this.videoBuffer&&this.videoTimestampOffset!==offset&&(pushQueue({type:"video",sourceUpdater:this,action:actions_timestampOffset(offset),name:"timestampOffset"}),this.videoTimestampOffset_=offset),this.videoTimestampOffset_},_proto.audioQueueCallback=function(callback){this.audioBuffer&&pushQueue({type:"audio",sourceUpdater:this,action:actions_callback(callback),name:"callback"})},_proto.videoQueueCallback=function(callback){this.videoBuffer&&pushQueue({type:"video",sourceUpdater:this,action:actions_callback(callback),name:"callback"})},_proto.dispose=function(){var _this4=this;this.trigger("dispose"),bufferTypes.forEach(function(type){_this4.abort(type),_this4.canRemoveSourceBuffer()?_this4.removeSourceBuffer(type):_this4[type+"QueueCallback"](function(){return cleanupBuffer(type,_this4)})}),this.videoAppendQueued_=!1,this.delayedAudioAppendQueue_.length=0,this.sourceopenListener_&&this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_),this.off()},SourceUpdater}(videojs.EventTarget),uint8ToUtf8=function(uintArray){return decodeURIComponent(escape(String.fromCharCode.apply(null,uintArray)))},VTT_LINE_TERMINATORS=new Uint8Array("\n\n".split("").map(function(_char3){return _char3.charCodeAt(0)})),VTTSegmentLoader=function(_SegmentLoader){function VTTSegmentLoader(settings,options){var _this;return void 0===options&&(options={}),(_this=_SegmentLoader.call(this,settings,options)||this).mediaSource_=null,_this.subtitlesTrack_=null,_this.loaderType_="subtitle",_this.featuresNativeTextTracks_=settings.featuresNativeTextTracks,_this.shouldSaveSegmentTimingInfo_=!1,_this}inheritsLoose_default()(VTTSegmentLoader,_SegmentLoader);var _proto=VTTSegmentLoader.prototype;return _proto.createTransmuxer_=function(){return null},_proto.buffered_=function(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues||!this.subtitlesTrack_.cues.length)return videojs.createTimeRanges();var cues=this.subtitlesTrack_.cues;return videojs.createTimeRanges([[cues[0].startTime,cues[cues.length-1].startTime]])},_proto.initSegmentForMap=function(map,set){if(void 0===set&&(set=!1),!map)return null;var id=initSegmentId(map),storedMap=this.initSegments_[id];if(set&&!storedMap&&map.bytes){var combinedSegment=new Uint8Array(VTT_LINE_TERMINATORS.byteLength+map.bytes.byteLength);combinedSegment.set(map.bytes),combinedSegment.set(VTT_LINE_TERMINATORS,map.bytes.byteLength),this.initSegments_[id]=storedMap={resolvedUri:map.resolvedUri,byterange:map.byterange,bytes:combinedSegment}}return storedMap||map},_proto.couldBeginLoading_=function(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()},_proto.init_=function(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()},_proto.track=function(_track){return void 0===_track||(this.subtitlesTrack_=_track,"INIT"===this.state&&this.couldBeginLoading_()&&this.init_()),this.subtitlesTrack_},_proto.remove=function(start,end){removeCuesFromTrack(start,end,this.subtitlesTrack_)},_proto.fillBuffer_=function(){var _this2=this,segmentInfo=this.chooseNextRequest_();if(segmentInfo){if(null===this.syncController_.timestampOffsetForTimeline(segmentInfo.timeline))return this.syncController_.one("timestampoffset",function(){_this2.state="READY",_this2.paused()||_this2.monitorBuffer_()}),void(this.state="WAITING_ON_TIMELINE");this.loadSegment_(segmentInfo)}},_proto.timestampOffsetForSegment_=function(){return null},_proto.chooseNextRequest_=function(){return this.skipEmptySegments_(_SegmentLoader.prototype.chooseNextRequest_.call(this))},_proto.skipEmptySegments_=function(segmentInfo){for(;segmentInfo&&segmentInfo.segment.empty;){if(segmentInfo.mediaIndex+1>=segmentInfo.playlist.segments.length){segmentInfo=null;break}segmentInfo=this.generateSegmentInfo_({playlist:segmentInfo.playlist,mediaIndex:segmentInfo.mediaIndex+1,startOfSegment:segmentInfo.startOfSegment+segmentInfo.duration,isSyncRequest:segmentInfo.isSyncRequest})}return segmentInfo},_proto.stopForError=function(error){this.error(error),this.state="READY",this.pause(),this.trigger("error")},_proto.segmentRequestFinished_=function(error,simpleSegment,result){var _this3=this;if(this.subtitlesTrack_){if(this.saveTransferStats_(simpleSegment.stats),!this.pendingSegment_)return this.state="READY",void(this.mediaRequestsAborted+=1);if(error)return-101===error.code&&this.handleTimeout_(),-102===error.code?this.mediaRequestsAborted+=1:this.mediaRequestsErrored+=1,void this.stopForError(error);var segmentInfo=this.pendingSegment_;this.saveBandwidthRelatedStats_(segmentInfo.duration,simpleSegment.stats),this.state="APPENDING",this.trigger("appending");var segment=segmentInfo.segment;if(segment.map&&(segment.map.bytes=simpleSegment.map.bytes),segmentInfo.bytes=simpleSegment.bytes,"function"!=typeof window_default().WebVTT&&this.subtitlesTrack_&&this.subtitlesTrack_.tech_){var loadHandler,errorHandler=function(){_this3.subtitlesTrack_.tech_.off("vttjsloaded",loadHandler),_this3.stopForError({message:"Error loading vtt.js"})};return loadHandler=function(){_this3.subtitlesTrack_.tech_.off("vttjserror",errorHandler),_this3.segmentRequestFinished_(error,simpleSegment,result)},this.state="WAITING_ON_VTTJS",this.subtitlesTrack_.tech_.one("vttjsloaded",loadHandler),void this.subtitlesTrack_.tech_.one("vttjserror",errorHandler)}segment.requested=!0;try{this.parseVTTCues_(segmentInfo)}catch(e){return void this.stopForError({message:e.message})}if(this.updateTimeMapping_(segmentInfo,this.syncController_.timelines[segmentInfo.timeline],this.playlist_),segmentInfo.timingInfo=segmentInfo.cues.length?{start:segmentInfo.cues[0].startTime,end:segmentInfo.cues[segmentInfo.cues.length-1].endTime}:{start:segmentInfo.startOfSegment,end:segmentInfo.startOfSegment+segmentInfo.duration},segmentInfo.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");segmentInfo.byteLength=segmentInfo.bytes.byteLength,this.mediaSecondsLoaded+=segment.duration,segmentInfo.cues.forEach(function(cue){_this3.subtitlesTrack_.addCue(_this3.featuresNativeTextTracks_?new(window_default().VTTCue)(cue.startTime,cue.endTime,cue.text):cue)}),function(track){var cues=track.cues;if(cues)for(var i=0;i<cues.length;i++){for(var duplicates=[],occurrences=0,j=0;j<cues.length;j++)cues[i].startTime===cues[j].startTime&&cues[i].endTime===cues[j].endTime&&cues[i].text===cues[j].text&&++occurrences>1&&duplicates.push(cues[j]);duplicates.length&&duplicates.forEach(function(dupe){return track.removeCue(dupe)})}}(this.subtitlesTrack_),this.handleAppendsDone_()}else this.state="READY"},_proto.handleData_=function(){},_proto.updateTimingInfoEnd_=function(){},_proto.parseVTTCues_=function(segmentInfo){var decoder,decodeBytesToString=!1;"function"==typeof window_default().TextDecoder?decoder=new(window_default().TextDecoder)("utf8"):(decoder=window_default().WebVTT.StringDecoder(),decodeBytesToString=!0);var parser=new(window_default().WebVTT.Parser)(window_default(),window_default().vttjs,decoder);if(segmentInfo.cues=[],segmentInfo.timestampmap={MPEGTS:0,LOCAL:0},parser.oncue=segmentInfo.cues.push.bind(segmentInfo.cues),parser.ontimestampmap=function(map){segmentInfo.timestampmap=map},parser.onparsingerror=function(error){videojs.log.warn("Error encountered when parsing cues: "+error.message)},segmentInfo.segment.map){var mapData=segmentInfo.segment.map.bytes;decodeBytesToString&&(mapData=uint8ToUtf8(mapData)),parser.parse(mapData)}var segmentData=segmentInfo.bytes;decodeBytesToString&&(segmentData=uint8ToUtf8(segmentData)),parser.parse(segmentData),parser.flush()},_proto.updateTimeMapping_=function(segmentInfo,mappingObj,playlist){var segment=segmentInfo.segment;if(mappingObj)if(segmentInfo.cues.length){var timestampmap=segmentInfo.timestampmap,diff=timestampmap.MPEGTS/clock.ONE_SECOND_IN_TS-timestampmap.LOCAL+mappingObj.mapping;segmentInfo.cues.forEach(function(cue){cue.startTime+=diff,cue.endTime+=diff}),playlist.syncInfo||(playlist.syncInfo={mediaSequence:playlist.mediaSequence+segmentInfo.mediaIndex,time:Math.min(segmentInfo.cues[0].startTime,segmentInfo.cues[segmentInfo.cues.length-1].startTime-segment.duration)})}else segment.empty=!0},VTTSegmentLoader}(SegmentLoader),findAdCue=function(track,mediaTime){for(var cues=track.cues,i=0;i<cues.length;i++){var cue=cues[i];if(mediaTime>=cue.adStartTime&&mediaTime<=cue.adEndTime)return cue}return null},syncPointStrategies=[{name:"VOD",run:function(syncController,playlist,duration,currentTimeline,currentTime){return duration!==1/0?{time:0,segmentIndex:0,partIndex:null}:null}},{name:"ProgramDateTime",run:function(syncController,playlist,duration,currentTimeline,currentTime){if(!Object.keys(syncController.timelineToDatetimeMappings).length)return null;var syncPoint=null,lastDistance=null,partsAndSegments=getPartsAndSegments(playlist);currentTime=currentTime||0;for(var i=0;i<partsAndSegments.length;i++){var partAndSegment=partsAndSegments[playlist.endList||0===currentTime?i:partsAndSegments.length-(i+1)],segment=partAndSegment.segment,datetimeMapping=syncController.timelineToDatetimeMappings[segment.timeline];if(datetimeMapping&&segment.dateTimeObject){var start=segment.dateTimeObject.getTime()/1e3+datetimeMapping;if(segment.parts&&"number"==typeof partAndSegment.partIndex)for(var z=0;z<partAndSegment.partIndex;z++)start+=segment.parts[z].duration;var distance=Math.abs(currentTime-start);if(null!==lastDistance&&(0===distance||lastDistance<distance))break;lastDistance=distance,syncPoint={time:start,segmentIndex:partAndSegment.segmentIndex,partIndex:partAndSegment.partIndex}}}return syncPoint}},{name:"Segment",run:function(syncController,playlist,duration,currentTimeline,currentTime){var syncPoint=null,lastDistance=null;currentTime=currentTime||0;for(var partsAndSegments=getPartsAndSegments(playlist),i=0;i<partsAndSegments.length;i++){var partAndSegment=partsAndSegments[playlist.endList||0===currentTime?i:partsAndSegments.length-(i+1)],segment=partAndSegment.segment,start=partAndSegment.part&&partAndSegment.part.start||segment&&segment.start;if(segment.timeline===currentTimeline&&void 0!==start){var distance=Math.abs(currentTime-start);if(null!==lastDistance&&lastDistance<distance)break;(!syncPoint||null===lastDistance||lastDistance>=distance)&&(lastDistance=distance,syncPoint={time:start,segmentIndex:partAndSegment.segmentIndex,partIndex:partAndSegment.partIndex})}}return syncPoint}},{name:"Discontinuity",run:function(syncController,playlist,duration,currentTimeline,currentTime){var syncPoint=null;if(currentTime=currentTime||0,playlist.discontinuityStarts&&playlist.discontinuityStarts.length)for(var lastDistance=null,i=0;i<playlist.discontinuityStarts.length;i++){var segmentIndex=playlist.discontinuityStarts[i],discontinuitySync=syncController.discontinuities[playlist.discontinuitySequence+i+1];if(discontinuitySync){var distance=Math.abs(currentTime-discontinuitySync.time);if(null!==lastDistance&&lastDistance<distance)break;(!syncPoint||null===lastDistance||lastDistance>=distance)&&(lastDistance=distance,syncPoint={time:discontinuitySync.time,segmentIndex:segmentIndex,partIndex:null})}}return syncPoint}},{name:"Playlist",run:function(syncController,playlist,duration,currentTimeline,currentTime){return playlist.syncInfo?{time:playlist.syncInfo.time,segmentIndex:playlist.syncInfo.mediaSequence-playlist.mediaSequence,partIndex:null}:null}}],SyncController=function(_videojs$EventTarget){function SyncController(options){var _this;return(_this=_videojs$EventTarget.call(this)||this).timelines=[],_this.discontinuities=[],_this.timelineToDatetimeMappings={},_this.logger_=logger("SyncController"),_this}inheritsLoose_default()(SyncController,_videojs$EventTarget);var _proto=SyncController.prototype;return _proto.getSyncPoint=function(playlist,duration,currentTimeline,currentTime){var syncPoints=this.runStrategies_(playlist,duration,currentTimeline,currentTime);return syncPoints.length?this.selectSyncPoint_(syncPoints,{key:"time",value:currentTime}):null},_proto.getExpiredTime=function(playlist,duration){if(!playlist||!playlist.segments)return null;var syncPoints=this.runStrategies_(playlist,duration,playlist.discontinuitySequence,0);if(!syncPoints.length)return null;var syncPoint=this.selectSyncPoint_(syncPoints,{key:"segmentIndex",value:0});return syncPoint.segmentIndex>0&&(syncPoint.time*=-1),Math.abs(syncPoint.time+sumDurations({defaultDuration:playlist.targetDuration,durationList:playlist.segments,startIndex:syncPoint.segmentIndex,endIndex:0}))},_proto.runStrategies_=function(playlist,duration,currentTimeline,currentTime){for(var syncPoints=[],i=0;i<syncPointStrategies.length;i++){var strategy=syncPointStrategies[i],syncPoint=strategy.run(this,playlist,duration,currentTimeline,currentTime);syncPoint&&(syncPoint.strategy=strategy.name,syncPoints.push({strategy:strategy.name,syncPoint:syncPoint}))}return syncPoints},_proto.selectSyncPoint_=function(syncPoints,target){for(var bestSyncPoint=syncPoints[0].syncPoint,bestDistance=Math.abs(syncPoints[0].syncPoint[target.key]-target.value),bestStrategy=syncPoints[0].strategy,i=1;i<syncPoints.length;i++){var newDistance=Math.abs(syncPoints[i].syncPoint[target.key]-target.value);newDistance<bestDistance&&(bestDistance=newDistance,bestSyncPoint=syncPoints[i].syncPoint,bestStrategy=syncPoints[i].strategy)}return this.logger_("syncPoint for ["+target.key+": "+target.value+"] chosen with strategy ["+bestStrategy+"]: [time:"+bestSyncPoint.time+", segmentIndex:"+bestSyncPoint.segmentIndex+("number"==typeof bestSyncPoint.partIndex?",partIndex:"+bestSyncPoint.partIndex:"")+"]"),bestSyncPoint},_proto.saveExpiredSegmentInfo=function(oldPlaylist,newPlaylist){var mediaSequenceDiff=newPlaylist.mediaSequence-oldPlaylist.mediaSequence;if(mediaSequenceDiff>86400)videojs.log.warn("Not saving expired segment info. Media sequence gap "+mediaSequenceDiff+" is too large.");else for(var i=mediaSequenceDiff-1;i>=0;i--){var lastRemovedSegment=oldPlaylist.segments[i];if(lastRemovedSegment&&void 0!==lastRemovedSegment.start){newPlaylist.syncInfo={mediaSequence:oldPlaylist.mediaSequence+i,time:lastRemovedSegment.start},this.logger_("playlist refresh sync: [time:"+newPlaylist.syncInfo.time+", mediaSequence: "+newPlaylist.syncInfo.mediaSequence+"]"),this.trigger("syncinfoupdate");break}}},_proto.setDateTimeMappingForStart=function(playlist){if(this.timelineToDatetimeMappings={},playlist.segments&&playlist.segments.length&&playlist.segments[0].dateTimeObject){var firstSegment=playlist.segments[0],playlistTimestamp=firstSegment.dateTimeObject.getTime()/1e3;this.timelineToDatetimeMappings[firstSegment.timeline]=-playlistTimestamp}},_proto.saveSegmentTimingInfo=function(_ref){var segmentInfo=_ref.segmentInfo,shouldSaveTimelineMapping=_ref.shouldSaveTimelineMapping,didCalculateSegmentTimeMapping=this.calculateSegmentTimeMapping_(segmentInfo,segmentInfo.timingInfo,shouldSaveTimelineMapping),segment=segmentInfo.segment;didCalculateSegmentTimeMapping&&(this.saveDiscontinuitySyncInfo_(segmentInfo),segmentInfo.playlist.syncInfo||(segmentInfo.playlist.syncInfo={mediaSequence:segmentInfo.playlist.mediaSequence+segmentInfo.mediaIndex,time:segment.start}));var dateTime=segment.dateTimeObject;segment.discontinuity&&shouldSaveTimelineMapping&&dateTime&&(this.timelineToDatetimeMappings[segment.timeline]=-dateTime.getTime()/1e3)},_proto.timestampOffsetForTimeline=function(timeline){return void 0===this.timelines[timeline]?null:this.timelines[timeline].time},_proto.mappingForTimeline=function(timeline){return void 0===this.timelines[timeline]?null:this.timelines[timeline].mapping},_proto.calculateSegmentTimeMapping_=function(segmentInfo,timingInfo,shouldSaveTimelineMapping){var start,end,segment=segmentInfo.segment,part=segmentInfo.part,mappingObj=this.timelines[segmentInfo.timeline];if("number"==typeof segmentInfo.timestampOffset)mappingObj={time:segmentInfo.startOfSegment,mapping:segmentInfo.startOfSegment-timingInfo.start},shouldSaveTimelineMapping&&(this.timelines[segmentInfo.timeline]=mappingObj,this.trigger("timestampoffset"),this.logger_("time mapping for timeline "+segmentInfo.timeline+": [time: "+mappingObj.time+"] [mapping: "+mappingObj.mapping+"]")),start=segmentInfo.startOfSegment,end=timingInfo.end+mappingObj.mapping;else{if(!mappingObj)return!1;start=timingInfo.start+mappingObj.mapping,end=timingInfo.end+mappingObj.mapping}return part&&(part.start=start,part.end=end),(!segment.start||start<segment.start)&&(segment.start=start),segment.end=end,!0},_proto.saveDiscontinuitySyncInfo_=function(segmentInfo){var playlist=segmentInfo.playlist,segment=segmentInfo.segment;if(segment.discontinuity)this.discontinuities[segment.timeline]={time:segment.start,accuracy:0};else if(playlist.discontinuityStarts&&playlist.discontinuityStarts.length)for(var i=0;i<playlist.discontinuityStarts.length;i++){var segmentIndex=playlist.discontinuityStarts[i],discontinuity=playlist.discontinuitySequence+i+1,mediaIndexDiff=segmentIndex-segmentInfo.mediaIndex,accuracy=Math.abs(mediaIndexDiff);if(!this.discontinuities[discontinuity]||this.discontinuities[discontinuity].accuracy>accuracy){var time;time=mediaIndexDiff<0?segment.start-sumDurations({defaultDuration:playlist.targetDuration,durationList:playlist.segments,startIndex:segmentInfo.mediaIndex,endIndex:segmentIndex}):segment.end+sumDurations({defaultDuration:playlist.targetDuration,durationList:playlist.segments,startIndex:segmentInfo.mediaIndex+1,endIndex:segmentIndex}),this.discontinuities[discontinuity]={time:time,accuracy:accuracy}}}},_proto.dispose=function(){this.trigger("dispose"),this.off()},SyncController}(videojs.EventTarget),TimelineChangeController=function(_videojs$EventTarget){function TimelineChangeController(){var _this;return(_this=_videojs$EventTarget.call(this)||this).pendingTimelineChanges_={},_this.lastTimelineChanges_={},_this}inheritsLoose_default()(TimelineChangeController,_videojs$EventTarget);var _proto=TimelineChangeController.prototype;return _proto.clearPendingTimelineChange=function(type){this.pendingTimelineChanges_[type]=null,this.trigger("pendingtimelinechange")},_proto.pendingTimelineChange=function(_ref){var type=_ref.type,from=_ref.from,to=_ref.to;return"number"==typeof from&&"number"==typeof to&&(this.pendingTimelineChanges_[type]={type:type,from:from,to:to},this.trigger("pendingtimelinechange")),this.pendingTimelineChanges_[type]},_proto.lastTimelineChange=function(_ref2){var type=_ref2.type,from=_ref2.from,to=_ref2.to;return"number"==typeof from&&"number"==typeof to&&(this.lastTimelineChanges_[type]={type:type,from:from,to:to},delete this.pendingTimelineChanges_[type],this.trigger("timelinechange")),this.lastTimelineChanges_[type]},_proto.dispose=function(){this.trigger("dispose"),this.pendingTimelineChanges_={},this.lastTimelineChanges_={},this.off()},TimelineChangeController}(videojs.EventTarget),workerCode=transform(getWorkerString(function(){function createCommonjsModule(fn,basedir,module){return fn(module={path:basedir,exports:{},require:function(path,base){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},module.exports),module.exports}var createClass=createCommonjsModule(function(module){function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}module.exports=function(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor},module.exports.default=module.exports,module.exports.__esModule=!0}),setPrototypeOf=createCommonjsModule(function(module){function _setPrototypeOf(o,p){return module.exports=_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o},module.exports.default=module.exports,module.exports.__esModule=!0,_setPrototypeOf(o,p)}module.exports=_setPrototypeOf,module.exports.default=module.exports,module.exports.__esModule=!0}),inheritsLoose=createCommonjsModule(function(module){module.exports=function(subClass,superClass){subClass.prototype=Object.create(superClass.prototype),subClass.prototype.constructor=subClass,setPrototypeOf(subClass,superClass)},module.exports.default=module.exports,module.exports.__esModule=!0}),Stream=function(){function Stream(){this.listeners={}}var _proto=Stream.prototype;return _proto.on=function(type,listener){this.listeners[type]||(this.listeners[type]=[]),this.listeners[type].push(listener)},_proto.off=function(type,listener){if(!this.listeners[type])return!1;var index=this.listeners[type].indexOf(listener);return this.listeners[type]=this.listeners[type].slice(0),this.listeners[type].splice(index,1),index>-1},_proto.trigger=function(type){var callbacks=this.listeners[type];if(callbacks)if(2===arguments.length)for(var length=callbacks.length,i=0;i<length;++i)callbacks[i].call(this,arguments[1]);else for(var args=Array.prototype.slice.call(arguments,1),_length=callbacks.length,_i=0;_i<_length;++_i)callbacks[_i].apply(this,args)},_proto.dispose=function(){this.listeners={}},_proto.pipe=function(destination){this.on("data",function(data){destination.push(data)})},Stream}(),aesTables=null,AES=function(){function AES(key){var i,j,tmp;aesTables||(aesTables=function(){var i,x,xInv,x2,x4,s,tEnc,tDec,tables=[[[],[],[],[],[]],[[],[],[],[],[]]],encTable=tables[0],decTable=tables[1],sbox=encTable[4],sboxInv=decTable[4],d=[],th=[];for(i=0;i<256;i++)th[(d[i]=i<<1^283*(i>>7))^i]=i;for(x=xInv=0;!sbox[x];x^=x2||1,xInv=th[xInv]||1)for(sbox[x]=s=(s=xInv^xInv<<1^xInv<<2^xInv<<3^xInv<<4)>>8^255&s^99,sboxInv[s]=x,tDec=16843009*d[x4=d[x2=d[x]]]^65537*x4^257*x2^16843008*x,tEnc=257*d[s]^16843008*s,i=0;i<4;i++)encTable[i][x]=tEnc=tEnc<<24^tEnc>>>8,decTable[i][s]=tDec=tDec<<24^tDec>>>8;for(i=0;i<5;i++)encTable[i]=encTable[i].slice(0),decTable[i]=decTable[i].slice(0);return tables}()),this._tables=[[aesTables[0][0].slice(),aesTables[0][1].slice(),aesTables[0][2].slice(),aesTables[0][3].slice(),aesTables[0][4].slice()],[aesTables[1][0].slice(),aesTables[1][1].slice(),aesTables[1][2].slice(),aesTables[1][3].slice(),aesTables[1][4].slice()]];var sbox=this._tables[0][4],decTable=this._tables[1],keyLen=key.length,rcon=1;if(4!==keyLen&&6!==keyLen&&8!==keyLen)throw new Error("Invalid aes key size");var encKey=key.slice(0),decKey=[];for(this._key=[encKey,decKey],i=keyLen;i<4*keyLen+28;i++)tmp=encKey[i-1],(i%keyLen==0||8===keyLen&&i%keyLen==4)&&(tmp=sbox[tmp>>>24]<<24^sbox[tmp>>16&255]<<16^sbox[tmp>>8&255]<<8^sbox[255&tmp],i%keyLen==0&&(tmp=tmp<<8^tmp>>>24^rcon<<24,rcon=rcon<<1^283*(rcon>>7))),encKey[i]=encKey[i-keyLen]^tmp;for(j=0;i;j++,i--)tmp=encKey[3&j?i:i-4],decKey[j]=i<=4||j<4?tmp:decTable[0][sbox[tmp>>>24]]^decTable[1][sbox[tmp>>16&255]]^decTable[2][sbox[tmp>>8&255]]^decTable[3][sbox[255&tmp]]}return AES.prototype.decrypt=function(encrypted0,encrypted1,encrypted2,encrypted3,out,offset){var a2,b2,c2,i,key=this._key[1],a=encrypted0^key[0],b=encrypted3^key[1],c=encrypted2^key[2],d=encrypted1^key[3],nInnerRounds=key.length/4-2,kIndex=4,table=this._tables[1],table0=table[0],table1=table[1],table2=table[2],table3=table[3],sbox=table[4];for(i=0;i<nInnerRounds;i++)a2=table0[a>>>24]^table1[b>>16&255]^table2[c>>8&255]^table3[255&d]^key[kIndex],b2=table0[b>>>24]^table1[c>>16&255]^table2[d>>8&255]^table3[255&a]^key[kIndex+1],c2=table0[c>>>24]^table1[d>>16&255]^table2[a>>8&255]^table3[255&b]^key[kIndex+2],d=table0[d>>>24]^table1[a>>16&255]^table2[b>>8&255]^table3[255&c]^key[kIndex+3],kIndex+=4,a=a2,b=b2,c=c2;for(i=0;i<4;i++)out[(3&-i)+offset]=sbox[a>>>24]<<24^sbox[b>>16&255]<<16^sbox[c>>8&255]<<8^sbox[255&d]^key[kIndex++],a2=a,a=b,b=c,c=d,d=a2},AES}(),AsyncStream=function(_Stream){function AsyncStream(){var _this;return(_this=_Stream.call(this,Stream)||this).jobs=[],_this.delay=1,_this.timeout_=null,_this}inheritsLoose(AsyncStream,_Stream);var _proto=AsyncStream.prototype;return _proto.processJob_=function(){this.jobs.shift()(),this.timeout_=this.jobs.length?setTimeout(this.processJob_.bind(this),this.delay):null},_proto.push=function(job){this.jobs.push(job),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},AsyncStream}(Stream),ntoh=function(word){return word<<24|(65280&word)<<8|(16711680&word)>>8|word>>>24},Decrypter=function(){function Decrypter(encrypted,key,initVector,done){var step=Decrypter.STEP,encrypted32=new Int32Array(encrypted.buffer),decrypted=new Uint8Array(encrypted.byteLength),i=0;for(this.asyncStream_=new AsyncStream,this.asyncStream_.push(this.decryptChunk_(encrypted32.subarray(i,i+step),key,initVector,decrypted)),i=step;i<encrypted32.length;i+=step)initVector=new Uint32Array([ntoh(encrypted32[i-4]),ntoh(encrypted32[i-3]),ntoh(encrypted32[i-2]),ntoh(encrypted32[i-1])]),this.asyncStream_.push(this.decryptChunk_(encrypted32.subarray(i,i+step),key,initVector,decrypted));this.asyncStream_.push(function(){
/*! @name pkcs7 @version 1.0.4 @license Apache-2.0 */
var padded;
/*! @name aes-decrypter @version 3.1.2 @license Apache-2.0 */done(null,(padded=decrypted).subarray(0,padded.byteLength-padded[padded.byteLength-1]))})}return Decrypter.prototype.decryptChunk_=function(encrypted,key,initVector,decrypted){return function(){var bytes=function(encrypted,key,initVector){var init0,init1,init2,init3,encrypted0,encrypted1,encrypted2,encrypted3,wordIx,encrypted32=new Int32Array(encrypted.buffer,encrypted.byteOffset,encrypted.byteLength>>2),decipher=new AES(Array.prototype.slice.call(key)),decrypted=new Uint8Array(encrypted.byteLength),decrypted32=new Int32Array(decrypted.buffer);for(init0=initVector[0],init1=initVector[1],init2=initVector[2],init3=initVector[3],wordIx=0;wordIx<encrypted32.length;wordIx+=4)encrypted0=ntoh(encrypted32[wordIx]),encrypted1=ntoh(encrypted32[wordIx+1]),encrypted2=ntoh(encrypted32[wordIx+2]),encrypted3=ntoh(encrypted32[wordIx+3]),decipher.decrypt(encrypted0,encrypted1,encrypted2,encrypted3,decrypted32,wordIx),decrypted32[wordIx]=ntoh(decrypted32[wordIx]^init0),decrypted32[wordIx+1]=ntoh(decrypted32[wordIx+1]^init1),decrypted32[wordIx+2]=ntoh(decrypted32[wordIx+2]^init2),decrypted32[wordIx+3]=ntoh(decrypted32[wordIx+3]^init3),init0=encrypted0,init1=encrypted1,init2=encrypted2,init3=encrypted3;return decrypted}(encrypted,key,initVector);decrypted.set(bytes,encrypted.byteOffset)}},createClass(Decrypter,null,[{key:"STEP",get:function(){return 32e3}}]),Decrypter}();self.onmessage=function(event){var data=event.data,encrypted=new Uint8Array(data.encrypted.bytes,data.encrypted.byteOffset,data.encrypted.byteLength),key=new Uint32Array(data.key.bytes,data.key.byteOffset,data.key.byteLength/4),iv=new Uint32Array(data.iv.bytes,data.iv.byteOffset,data.iv.byteLength/4);new Decrypter(encrypted,key,iv,function(err,bytes){var message,transferable;self.postMessage((message={source:data.source,decrypted:bytes},transferable={},Object.keys(message).forEach(function(key){var value=message[key];transferable[key]=ArrayBuffer.isView(value)?{bytes:value.buffer,byteOffset:value.byteOffset,byteLength:value.byteLength}:value}),transferable),[bytes.buffer])})}})),Decrypter=factory(workerCode),audioTrackKind_=function(properties){var kind=properties.default?"main":"alternative";return properties.characteristics&&properties.characteristics.indexOf("public.accessibility.describes-video")>=0&&(kind="main-desc"),kind},stopLoaders=function(segmentLoader,mediaType){segmentLoader.abort(),segmentLoader.pause(),mediaType&&mediaType.activePlaylistLoader&&(mediaType.activePlaylistLoader.pause(),mediaType.activePlaylistLoader=null)},startLoaders=function(playlistLoader,mediaType){mediaType.activePlaylistLoader=playlistLoader,playlistLoader.load()},onError={AUDIO:function(type,settings){return function(){var mediaType=settings.mediaTypes[type],blacklistCurrentPlaylist=settings.blacklistCurrentPlaylist;stopLoaders(settings.segmentLoaders[type],mediaType);var activeTrack=mediaType.activeTrack(),activeGroup=mediaType.activeGroup(),id=(activeGroup.filter(function(group){return group.default})[0]||activeGroup[0]).id,defaultTrack=mediaType.tracks[id];if(activeTrack!==defaultTrack){for(var trackId in videojs.log.warn("Problem encountered loading the alternate audio track.Switching back to default."),mediaType.tracks)mediaType.tracks[trackId].enabled=mediaType.tracks[trackId]===defaultTrack;mediaType.onTrackChanged()}else blacklistCurrentPlaylist({message:"Problem encountered loading the default audio track."})}},SUBTITLES:function(type,settings){return function(){var segmentLoader=settings.segmentLoaders[type],mediaType=settings.mediaTypes[type];videojs.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."),stopLoaders(segmentLoader,mediaType);var track=mediaType.activeTrack();track&&(track.mode="disabled"),mediaType.onTrackChanged()}}},setupListeners={AUDIO:function(type,playlistLoader,settings){if(playlistLoader){var tech=settings.tech,requestOptions=settings.requestOptions,segmentLoader=settings.segmentLoaders[type];playlistLoader.on("loadedmetadata",function(){var media=playlistLoader.media();segmentLoader.playlist(media,requestOptions),(!tech.paused()||media.endList&&"none"!==tech.preload())&&segmentLoader.load()}),playlistLoader.on("loadedplaylist",function(){segmentLoader.playlist(playlistLoader.media(),requestOptions),tech.paused()||segmentLoader.load()}),playlistLoader.on("error",onError[type](type,settings))}},SUBTITLES:function(type,playlistLoader,settings){var tech=settings.tech,requestOptions=settings.requestOptions,segmentLoader=settings.segmentLoaders[type],mediaType=settings.mediaTypes[type];playlistLoader.on("loadedmetadata",function(){var media=playlistLoader.media();segmentLoader.playlist(media,requestOptions),segmentLoader.track(mediaType.activeTrack()),(!tech.paused()||media.endList&&"none"!==tech.preload())&&segmentLoader.load()}),playlistLoader.on("loadedplaylist",function(){segmentLoader.playlist(playlistLoader.media(),requestOptions),tech.paused()||segmentLoader.load()}),playlistLoader.on("error",onError[type](type,settings))}},initialize={AUDIO:function(type,settings){var vhs=settings.vhs,sourceType=settings.sourceType,segmentLoader=settings.segmentLoaders[type],requestOptions=settings.requestOptions,mediaGroups=settings.master.mediaGroups,_settings$mediaTypes$=settings.mediaTypes[type],groups=_settings$mediaTypes$.groups,tracks=_settings$mediaTypes$.tracks,logger_=_settings$mediaTypes$.logger_,masterPlaylistLoader=settings.masterPlaylistLoader,audioOnlyMaster=isAudioOnly(masterPlaylistLoader.master);for(var groupId in mediaGroups[type]&&0!==Object.keys(mediaGroups[type]).length||(mediaGroups[type]={main:{default:{default:!0}}},audioOnlyMaster&&(mediaGroups[type].main.default.playlists=masterPlaylistLoader.master.playlists)),mediaGroups[type])for(var variantLabel in groups[groupId]||(groups[groupId]=[]),mediaGroups[type][groupId]){var properties=mediaGroups[type][groupId][variantLabel],playlistLoader=void 0;if(audioOnlyMaster?(logger_("AUDIO group '"+groupId+"' label '"+variantLabel+"' is a master playlist"),properties.isMasterPlaylist=!0,playlistLoader=null):playlistLoader="vhs-json"===sourceType&&properties.playlists?new PlaylistLoader(properties.playlists[0],vhs,requestOptions):properties.resolvedUri?new PlaylistLoader(properties.resolvedUri,vhs,requestOptions):properties.playlists&&"dash"===sourceType?new DashPlaylistLoader(properties.playlists[0],vhs,requestOptions,masterPlaylistLoader):null,properties=videojs.mergeOptions({id:variantLabel,playlistLoader:playlistLoader},properties),setupListeners[type](type,properties.playlistLoader,settings),groups[groupId].push(properties),void 0===tracks[variantLabel]){var track=new videojs.AudioTrack({id:variantLabel,kind:audioTrackKind_(properties),enabled:!1,language:properties.language,default:properties.default,label:variantLabel});tracks[variantLabel]=track}}segmentLoader.on("error",onError[type](type,settings))},SUBTITLES:function(type,settings){var tech=settings.tech,vhs=settings.vhs,sourceType=settings.sourceType,segmentLoader=settings.segmentLoaders[type],requestOptions=settings.requestOptions,mediaGroups=settings.master.mediaGroups,_settings$mediaTypes$2=settings.mediaTypes[type],groups=_settings$mediaTypes$2.groups,tracks=_settings$mediaTypes$2.tracks,masterPlaylistLoader=settings.masterPlaylistLoader;for(var groupId in mediaGroups[type])for(var variantLabel in groups[groupId]||(groups[groupId]=[]),mediaGroups[type][groupId])if(!mediaGroups[type][groupId][variantLabel].forced){var properties=mediaGroups[type][groupId][variantLabel],playlistLoader=void 0;if("hls"===sourceType)playlistLoader=new PlaylistLoader(properties.resolvedUri,vhs,requestOptions);else if("dash"===sourceType){if(!properties.playlists.filter(function(p){return p.excludeUntil!==1/0}).length)return;playlistLoader=new DashPlaylistLoader(properties.playlists[0],vhs,requestOptions,masterPlaylistLoader)}else"vhs-json"===sourceType&&(playlistLoader=new PlaylistLoader(properties.playlists?properties.playlists[0]:properties.resolvedUri,vhs,requestOptions));if(properties=videojs.mergeOptions({id:variantLabel,playlistLoader:playlistLoader},properties),setupListeners[type](type,properties.playlistLoader,settings),groups[groupId].push(properties),void 0===tracks[variantLabel]){var track=tech.addRemoteTextTrack({id:variantLabel,kind:"subtitles",default:properties.default&&properties.autoselect,language:properties.language,label:variantLabel},!1).track;tracks[variantLabel]=track}}segmentLoader.on("error",onError[type](type,settings))},"CLOSED-CAPTIONS":function(type,settings){var tech=settings.tech,mediaGroups=settings.master.mediaGroups,_settings$mediaTypes$3=settings.mediaTypes[type],groups=_settings$mediaTypes$3.groups,tracks=_settings$mediaTypes$3.tracks;for(var groupId in mediaGroups[type])for(var variantLabel in groups[groupId]||(groups[groupId]=[]),mediaGroups[type][groupId]){var properties=mediaGroups[type][groupId][variantLabel];if(/^(?:CC|SERVICE)/.test(properties.instreamId)){var captionServices=tech.options_.vhs&&tech.options_.vhs.captionServices||{},newProps={label:variantLabel,language:properties.language,instreamId:properties.instreamId,default:properties.default&&properties.autoselect};if(captionServices[newProps.instreamId]&&(newProps=videojs.mergeOptions(newProps,captionServices[newProps.instreamId])),void 0===newProps.default&&delete newProps.default,groups[groupId].push(videojs.mergeOptions({id:variantLabel},properties)),void 0===tracks[variantLabel]){var track=tech.addRemoteTextTrack({id:newProps.instreamId,kind:"captions",default:newProps.default,language:newProps.language,label:newProps.label},!1).track;tracks[variantLabel]=track}}}}},groupMatch=function groupMatch(list,media){for(var i=0;i<list.length;i++){if(playlistMatch(media,list[i]))return!0;if(list[i].playlists&&groupMatch(list[i].playlists,media))return!0}return!1},activeTrack={AUDIO:function(type,settings){return function(){var tracks=settings.mediaTypes[type].tracks;for(var id in tracks)if(tracks[id].enabled)return tracks[id];return null}},SUBTITLES:function(type,settings){return function(){var tracks=settings.mediaTypes[type].tracks;for(var id in tracks)if("showing"===tracks[id].mode||"hidden"===tracks[id].mode)return tracks[id];return null}}},loaderStats=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred","mediaAppends"],sumLoaderStat=function(stat){return this.audioSegmentLoader_[stat]+this.mainSegmentLoader_[stat]},MasterPlaylistController=function(_videojs$EventTarget){function MasterPlaylistController(options){var _this;_this=_videojs$EventTarget.call(this)||this;var src=options.src,handleManifestRedirects=options.handleManifestRedirects,withCredentials=options.withCredentials,tech=options.tech,bandwidth=options.bandwidth,externVhs=options.externVhs,useCueTags=options.useCueTags,blacklistDuration=options.blacklistDuration,enableLowInitialPlaylist=options.enableLowInitialPlaylist,sourceType=options.sourceType,cacheEncryptionKeys=options.cacheEncryptionKeys,experimentalBufferBasedABR=options.experimentalBufferBasedABR,experimentalLeastPixelDiffSelector=options.experimentalLeastPixelDiffSelector,captionServices=options.captionServices;if(!src)throw new Error("A non-empty playlist URL or JSON manifest string is required");var maxPlaylistRetries=options.maxPlaylistRetries;null==maxPlaylistRetries&&(maxPlaylistRetries=1/0),Vhs$1=externVhs,_this.experimentalBufferBasedABR=Boolean(experimentalBufferBasedABR),_this.experimentalLeastPixelDiffSelector=Boolean(experimentalLeastPixelDiffSelector),_this.withCredentials=withCredentials,_this.tech_=tech,_this.vhs_=tech.vhs,_this.sourceType_=sourceType,_this.useCueTags_=useCueTags,_this.blacklistDuration=blacklistDuration,_this.maxPlaylistRetries=maxPlaylistRetries,_this.enableLowInitialPlaylist=enableLowInitialPlaylist,_this.useCueTags_&&(_this.cueTagsTrack_=_this.tech_.addTextTrack("metadata","ad-cues"),_this.cueTagsTrack_.inBandMetadataTrackDispatchType=""),_this.requestOptions_={withCredentials:withCredentials,handleManifestRedirects:handleManifestRedirects,maxPlaylistRetries:maxPlaylistRetries,timeout:null},_this.on("error",_this.pauseLoading),_this.mediaTypes_=function(){var mediaTypes={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(type){mediaTypes[type]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:noop,activeTrack:noop,getActiveGroup:noop,onGroupChanged:noop,onTrackChanged:noop,lastTrack_:null,logger_:logger("MediaGroups["+type+"]")}}),mediaTypes}(),_this.mediaSource=new(window_default().MediaSource),_this.handleDurationChange_=_this.handleDurationChange_.bind(assertThisInitialized_default()(_this)),_this.handleSourceOpen_=_this.handleSourceOpen_.bind(assertThisInitialized_default()(_this)),_this.handleSourceEnded_=_this.handleSourceEnded_.bind(assertThisInitialized_default()(_this)),_this.mediaSource.addEventListener("durationchange",_this.handleDurationChange_),_this.mediaSource.addEventListener("sourceopen",_this.handleSourceOpen_),_this.mediaSource.addEventListener("sourceended",_this.handleSourceEnded_),_this.seekable_=videojs.createTimeRanges(),_this.hasPlayed_=!1,_this.syncController_=new SyncController(options),_this.segmentMetadataTrack_=tech.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,_this.decrypter_=new Decrypter,_this.sourceUpdater_=new SourceUpdater(_this.mediaSource),_this.inbandTextTracks_={},_this.timelineChangeController_=new TimelineChangeController;var segmentLoaderSettings={vhs:_this.vhs_,parse708captions:options.parse708captions,captionServices:captionServices,mediaSource:_this.mediaSource,currentTime:_this.tech_.currentTime.bind(_this.tech_),seekable:function(){return _this.seekable()},seeking:function(){return _this.tech_.seeking()},duration:function(){return _this.duration()},hasPlayed:function(){return _this.hasPlayed_},goalBufferLength:function(){return _this.goalBufferLength()},bandwidth:bandwidth,syncController:_this.syncController_,decrypter:_this.decrypter_,sourceType:_this.sourceType_,inbandTextTracks:_this.inbandTextTracks_,cacheEncryptionKeys:cacheEncryptionKeys,sourceUpdater:_this.sourceUpdater_,timelineChangeController:_this.timelineChangeController_,experimentalExactManifestTimings:options.experimentalExactManifestTimings};_this.masterPlaylistLoader_="dash"===_this.sourceType_?new DashPlaylistLoader(src,_this.vhs_,_this.requestOptions_):new PlaylistLoader(src,_this.vhs_,_this.requestOptions_),_this.setupMasterPlaylistLoaderListeners_(),_this.mainSegmentLoader_=new SegmentLoader(videojs.mergeOptions(segmentLoaderSettings,{segmentMetadataTrack:_this.segmentMetadataTrack_,loaderType:"main"}),options),_this.audioSegmentLoader_=new SegmentLoader(videojs.mergeOptions(segmentLoaderSettings,{loaderType:"audio"}),options),_this.subtitleSegmentLoader_=new VTTSegmentLoader(videojs.mergeOptions(segmentLoaderSettings,{loaderType:"vtt",featuresNativeTextTracks:_this.tech_.featuresNativeTextTracks}),options),_this.setupSegmentLoaderListeners_(),_this.experimentalBufferBasedABR&&(_this.masterPlaylistLoader_.one("loadedplaylist",function(){return _this.startABRTimer_()}),_this.tech_.on("pause",function(){return _this.stopABRTimer_()}),_this.tech_.on("play",function(){return _this.startABRTimer_()})),loaderStats.forEach(function(stat){_this[stat+"_"]=sumLoaderStat.bind(assertThisInitialized_default()(_this),stat)}),_this.logger_=logger("MPC"),_this.triggeredFmp4Usage=!1,"none"===_this.tech_.preload()?(_this.loadOnPlay_=function(){_this.loadOnPlay_=null,_this.masterPlaylistLoader_.load()},_this.tech_.one("play",_this.loadOnPlay_)):_this.masterPlaylistLoader_.load(),_this.timeToLoadedData__=-1,_this.mainAppendsToLoadedData__=-1,_this.audioAppendsToLoadedData__=-1;var event="none"===_this.tech_.preload()?"play":"loadstart";return _this.tech_.one(event,function(){var timeToLoadedDataStart=Date.now();_this.tech_.one("loadeddata",function(){_this.timeToLoadedData__=Date.now()-timeToLoadedDataStart,_this.mainAppendsToLoadedData__=_this.mainSegmentLoader_.mediaAppends,_this.audioAppendsToLoadedData__=_this.audioSegmentLoader_.mediaAppends})}),_this}inheritsLoose_default()(MasterPlaylistController,_videojs$EventTarget);var _proto=MasterPlaylistController.prototype;return _proto.mainAppendsToLoadedData_=function(){return this.mainAppendsToLoadedData__},_proto.audioAppendsToLoadedData_=function(){return this.audioAppendsToLoadedData__},_proto.appendsToLoadedData_=function(){var main=this.mainAppendsToLoadedData_(),audio=this.audioAppendsToLoadedData_();return-1===main||-1===audio?-1:main+audio},_proto.timeToLoadedData_=function(){return this.timeToLoadedData__},_proto.checkABR_=function(){var nextPlaylist=this.selectPlaylist();nextPlaylist&&this.shouldSwitchToMedia_(nextPlaylist)&&this.switchMedia_(nextPlaylist,"abr")},_proto.switchMedia_=function(playlist,cause,delay){var oldMedia=this.media(),oldId=oldMedia&&(oldMedia.id||oldMedia.uri),newId=playlist.id||playlist.uri;oldId&&oldId!==newId&&(this.logger_("switch media "+oldId+" -> "+newId+" from "+cause),this.tech_.trigger({type:"usage",name:"vhs-rendition-change-"+cause})),this.masterPlaylistLoader_.media(playlist,delay)},_proto.startABRTimer_=function(){var _this2=this;this.stopABRTimer_(),this.abrTimer_=window_default().setInterval(function(){return _this2.checkABR_()},250)},_proto.stopABRTimer_=function(){this.tech_.scrubbing&&this.tech_.scrubbing()||(window_default().clearInterval(this.abrTimer_),this.abrTimer_=null)},_proto.getAudioTrackPlaylists_=function(){var master=this.master(),defaultPlaylists=master&&master.playlists||[];if(!master||!master.mediaGroups||!master.mediaGroups.AUDIO)return defaultPlaylists;var track,AUDIO=master.mediaGroups.AUDIO,groupKeys=Object.keys(AUDIO);if(Object.keys(this.mediaTypes_.AUDIO.groups).length)track=this.mediaTypes_.AUDIO.activeTrack();else{var defaultGroup=AUDIO.main||groupKeys.length&&AUDIO[groupKeys[0]];for(var label in defaultGroup)if(defaultGroup[label].default){track={label:label};break}}if(!track)return defaultPlaylists;var playlists=[];for(var group in AUDIO)if(AUDIO[group][track.label]){var properties=AUDIO[group][track.label];if(properties.playlists&&properties.playlists.length)playlists.push.apply(playlists,properties.playlists);else if(properties.uri)playlists.push(properties);else if(master.playlists.length)for(var i=0;i<master.playlists.length;i++){var playlist=master.playlists[i];playlist.attributes&&playlist.attributes.AUDIO&&playlist.attributes.AUDIO===group&&playlists.push(playlist)}}return playlists.length?playlists:defaultPlaylists},_proto.setupMasterPlaylistLoaderListeners_=function(){var _this3=this;this.masterPlaylistLoader_.on("loadedmetadata",function(){var media=_this3.masterPlaylistLoader_.media(),requestTimeout=1.5*media.targetDuration*1e3;_this3.requestOptions_.timeout=isLowestEnabledRendition(_this3.masterPlaylistLoader_.master,_this3.masterPlaylistLoader_.media())?0:requestTimeout,media.endList&&"none"!==_this3.tech_.preload()&&(_this3.mainSegmentLoader_.playlist(media,_this3.requestOptions_),_this3.mainSegmentLoader_.load()),function(settings){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(type){initialize[type](type,settings)});var mediaTypes=settings.mediaTypes,masterPlaylistLoader=settings.masterPlaylistLoader,tech=settings.tech,vhs=settings.vhs,_settings$segmentLoad3=settings.segmentLoaders,audioSegmentLoader=_settings$segmentLoad3.AUDIO,mainSegmentLoader=_settings$segmentLoad3.main;["AUDIO","SUBTITLES"].forEach(function(type){mediaTypes[type].activeGroup=function(type,settings){return function(track){var groups=settings.mediaTypes[type].groups,media=settings.masterPlaylistLoader.media();if(!media)return null;var variants=null;media.attributes[type]&&(variants=groups[media.attributes[type]]);var groupKeys=Object.keys(groups);if(!variants)if("AUDIO"===type&&groupKeys.length>1&&isAudioOnly(settings.master))for(var i=0;i<groupKeys.length;i++){var groupPropertyList=groups[groupKeys[i]];if(groupMatch(groupPropertyList,media)){variants=groupPropertyList;break}}else groups.main?variants=groups.main:1===groupKeys.length&&(variants=groups[groupKeys[0]]);return void 0===track?variants:null!==track&&variants&&variants.filter(function(props){return props.id===track.id})[0]||null}}(type,settings),mediaTypes[type].activeTrack=activeTrack[type](type,settings),mediaTypes[type].onGroupChanged=function(type,settings){return function(){var _settings$segmentLoad=settings.segmentLoaders,segmentLoader=_settings$segmentLoad[type],mainSegmentLoader=_settings$segmentLoad.main,mediaType=settings.mediaTypes[type],activeTrack=mediaType.activeTrack(),activeGroup=mediaType.getActiveGroup(),previousActiveLoader=mediaType.activePlaylistLoader,lastGroup=mediaType.lastGroup_;activeGroup&&lastGroup&&activeGroup.id===lastGroup.id||(mediaType.lastGroup_=activeGroup,mediaType.lastTrack_=activeTrack,stopLoaders(segmentLoader,mediaType),activeGroup&&!activeGroup.isMasterPlaylist&&(activeGroup.playlistLoader?(segmentLoader.resyncLoader(),startLoaders(activeGroup.playlistLoader,mediaType)):previousActiveLoader&&mainSegmentLoader.resetEverything()))}}(type,settings),mediaTypes[type].onGroupChanging=function(type,settings){return function(){var segmentLoader=settings.segmentLoaders[type];settings.mediaTypes[type].lastGroup_=null,segmentLoader.abort(),segmentLoader.pause()}}(type,settings),mediaTypes[type].onTrackChanged=function(type,settings){return function(){var masterPlaylistLoader=settings.masterPlaylistLoader,_settings$segmentLoad2=settings.segmentLoaders,segmentLoader=_settings$segmentLoad2[type],mainSegmentLoader=_settings$segmentLoad2.main,mediaType=settings.mediaTypes[type],activeTrack=mediaType.activeTrack(),activeGroup=mediaType.getActiveGroup(),previousActiveLoader=mediaType.activePlaylistLoader,lastTrack=mediaType.lastTrack_;if((!lastTrack||!activeTrack||lastTrack.id!==activeTrack.id)&&(mediaType.lastGroup_=activeGroup,mediaType.lastTrack_=activeTrack,stopLoaders(segmentLoader,mediaType),activeGroup)){if(activeGroup.isMasterPlaylist){if(!activeTrack||!lastTrack||activeTrack.id===lastTrack.id)return;var mpc=settings.vhs.masterPlaylistController_,newPlaylist=mpc.selectPlaylist();if(mpc.media()===newPlaylist)return;return mediaType.logger_("track change. Switching master audio from "+lastTrack.id+" to "+activeTrack.id),masterPlaylistLoader.pause(),mainSegmentLoader.resetEverything(),void mpc.fastQualityChange_(newPlaylist)}if("AUDIO"===type){if(!activeGroup.playlistLoader)return mainSegmentLoader.setAudio(!0),void mainSegmentLoader.resetEverything();segmentLoader.setAudio(!0),mainSegmentLoader.setAudio(!1)}previousActiveLoader!==activeGroup.playlistLoader?(segmentLoader.track&&segmentLoader.track(activeTrack),segmentLoader.resetEverything(),startLoaders(activeGroup.playlistLoader,mediaType)):startLoaders(activeGroup.playlistLoader,mediaType)}}}(type,settings),mediaTypes[type].getActiveGroup=function(type,_ref){var mediaTypes=_ref.mediaTypes;return function(){var activeTrack_=mediaTypes[type].activeTrack();return activeTrack_?mediaTypes[type].activeGroup(activeTrack_):null}}(type,settings)});var audioGroup=mediaTypes.AUDIO.activeGroup();if(audioGroup){var groupId=(audioGroup.filter(function(group){return group.default})[0]||audioGroup[0]).id;mediaTypes.AUDIO.tracks[groupId].enabled=!0,mediaTypes.AUDIO.onGroupChanged(),mediaTypes.AUDIO.onTrackChanged(),mediaTypes.AUDIO.getActiveGroup().playlistLoader?(mainSegmentLoader.setAudio(!1),audioSegmentLoader.setAudio(!0)):mainSegmentLoader.setAudio(!0)}masterPlaylistLoader.on("mediachange",function(){["AUDIO","SUBTITLES"].forEach(function(type){return mediaTypes[type].onGroupChanged()})}),masterPlaylistLoader.on("mediachanging",function(){["AUDIO","SUBTITLES"].forEach(function(type){return mediaTypes[type].onGroupChanging()})});var onAudioTrackChanged=function(){mediaTypes.AUDIO.onTrackChanged(),tech.trigger({type:"usage",name:"vhs-audio-change"}),tech.trigger({type:"usage",name:"hls-audio-change"})};for(var id in tech.audioTracks().addEventListener("change",onAudioTrackChanged),tech.remoteTextTracks().addEventListener("change",mediaTypes.SUBTITLES.onTrackChanged),vhs.on("dispose",function(){tech.audioTracks().removeEventListener("change",onAudioTrackChanged),tech.remoteTextTracks().removeEventListener("change",mediaTypes.SUBTITLES.onTrackChanged)}),tech.clearTracks("audio"),mediaTypes.AUDIO.tracks)tech.audioTracks().addTrack(mediaTypes.AUDIO.tracks[id])}({sourceType:_this3.sourceType_,segmentLoaders:{AUDIO:_this3.audioSegmentLoader_,SUBTITLES:_this3.subtitleSegmentLoader_,main:_this3.mainSegmentLoader_},tech:_this3.tech_,requestOptions:_this3.requestOptions_,masterPlaylistLoader:_this3.masterPlaylistLoader_,vhs:_this3.vhs_,master:_this3.master(),mediaTypes:_this3.mediaTypes_,blacklistCurrentPlaylist:_this3.blacklistCurrentPlaylist.bind(_this3)}),_this3.triggerPresenceUsage_(_this3.master(),media),_this3.setupFirstPlay(),!_this3.mediaTypes_.AUDIO.activePlaylistLoader||_this3.mediaTypes_.AUDIO.activePlaylistLoader.media()?_this3.trigger("selectedinitialmedia"):_this3.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",function(){_this3.trigger("selectedinitialmedia")})}),this.masterPlaylistLoader_.on("loadedplaylist",function(){_this3.loadOnPlay_&&_this3.tech_.off("play",_this3.loadOnPlay_);var updatedPlaylist=_this3.masterPlaylistLoader_.media();if(!updatedPlaylist){var selectedMedia;if(_this3.excludeUnsupportedVariants_(),_this3.enableLowInitialPlaylist&&(selectedMedia=_this3.selectInitialPlaylist()),selectedMedia||(selectedMedia=_this3.selectPlaylist()),!selectedMedia||!_this3.shouldSwitchToMedia_(selectedMedia))return;if(_this3.initialMedia_=selectedMedia,_this3.switchMedia_(_this3.initialMedia_,"initial"),"vhs-json"!==_this3.sourceType_||!_this3.initialMedia_.segments)return;updatedPlaylist=_this3.initialMedia_}_this3.handleUpdatedMediaPlaylist(updatedPlaylist)}),this.masterPlaylistLoader_.on("error",function(){_this3.blacklistCurrentPlaylist(_this3.masterPlaylistLoader_.error)}),this.masterPlaylistLoader_.on("mediachanging",function(){_this3.mainSegmentLoader_.abort(),_this3.mainSegmentLoader_.pause()}),this.masterPlaylistLoader_.on("mediachange",function(){var media=_this3.masterPlaylistLoader_.media(),requestTimeout=1.5*media.targetDuration*1e3;_this3.requestOptions_.timeout=isLowestEnabledRendition(_this3.masterPlaylistLoader_.master,_this3.masterPlaylistLoader_.media())?0:requestTimeout,_this3.mainSegmentLoader_.playlist(media,_this3.requestOptions_),_this3.mainSegmentLoader_.load(),_this3.tech_.trigger({type:"mediachange",bubbles:!0})}),this.masterPlaylistLoader_.on("playlistunchanged",function(){var updatedPlaylist=_this3.masterPlaylistLoader_.media();"playlist-unchanged"!==updatedPlaylist.lastExcludeReason_&&_this3.stuckAtPlaylistEnd_(updatedPlaylist)&&(_this3.blacklistCurrentPlaylist({message:"Playlist no longer updating.",reason:"playlist-unchanged"}),_this3.tech_.trigger("playliststuck"))}),this.masterPlaylistLoader_.on("renditiondisabled",function(){_this3.tech_.trigger({type:"usage",name:"vhs-rendition-disabled"}),_this3.tech_.trigger({type:"usage",name:"hls-rendition-disabled"})}),this.masterPlaylistLoader_.on("renditionenabled",function(){_this3.tech_.trigger({type:"usage",name:"vhs-rendition-enabled"}),_this3.tech_.trigger({type:"usage",name:"hls-rendition-enabled"})})},_proto.handleUpdatedMediaPlaylist=function(updatedPlaylist){this.useCueTags_&&this.updateAdCues_(updatedPlaylist),this.mainSegmentLoader_.playlist(updatedPlaylist,this.requestOptions_),this.updateDuration(!updatedPlaylist.endList),this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioSegmentLoader_&&this.audioSegmentLoader_.load())},_proto.triggerPresenceUsage_=function(master,media){var mediaGroups=master.mediaGroups||{},defaultDemuxed=!0,audioGroupKeys=Object.keys(mediaGroups.AUDIO);for(var mediaGroup in mediaGroups.AUDIO)for(var label in mediaGroups.AUDIO[mediaGroup])mediaGroups.AUDIO[mediaGroup][label].uri||(defaultDemuxed=!1);defaultDemuxed&&(this.tech_.trigger({type:"usage",name:"vhs-demuxed"}),this.tech_.trigger({type:"usage",name:"hls-demuxed"})),Object.keys(mediaGroups.SUBTITLES).length&&(this.tech_.trigger({type:"usage",name:"vhs-webvtt"}),this.tech_.trigger({type:"usage",name:"hls-webvtt"})),Vhs$1.Playlist.isAes(media)&&(this.tech_.trigger({type:"usage",name:"vhs-aes"}),this.tech_.trigger({type:"usage",name:"hls-aes"})),audioGroupKeys.length&&Object.keys(mediaGroups.AUDIO[audioGroupKeys[0]]).length>1&&(this.tech_.trigger({type:"usage",name:"vhs-alternate-audio"}),this.tech_.trigger({type:"usage",name:"hls-alternate-audio"})),this.useCueTags_&&(this.tech_.trigger({type:"usage",name:"vhs-playlist-cue-tags"}),this.tech_.trigger({type:"usage",name:"hls-playlist-cue-tags"}))},_proto.shouldSwitchToMedia_=function(nextPlaylist){var currentPlaylist=this.masterPlaylistLoader_.media()||this.masterPlaylistLoader_.pendingMedia_,currentTime=this.tech_.currentTime(),bufferLowWaterLine=this.bufferLowWaterLine(),bufferHighWaterLine=this.bufferHighWaterLine();return function(_ref){var currentPlaylist=_ref.currentPlaylist,buffered=_ref.buffered,currentTime=_ref.currentTime,nextPlaylist=_ref.nextPlaylist,bufferLowWaterLine=_ref.bufferLowWaterLine,bufferHighWaterLine=_ref.bufferHighWaterLine,duration=_ref.duration,experimentalBufferBasedABR=_ref.experimentalBufferBasedABR,log=_ref.log;if(!nextPlaylist)return videojs.log.warn("We received no playlist to switch to. Please check your stream."),!1;var sharedLogLine="allowing switch "+(currentPlaylist&&currentPlaylist.id||"null")+" -> "+nextPlaylist.id;if(!currentPlaylist)return log(sharedLogLine+" as current playlist is not set"),!0;if(nextPlaylist.id===currentPlaylist.id)return!1;var isBuffered=Boolean(findRange(buffered,currentTime).length);if(!currentPlaylist.endList)return isBuffered||"number"!=typeof currentPlaylist.partTargetDuration?(log(sharedLogLine+" as current playlist is live"),!0):(log("not "+sharedLogLine+" as current playlist is live llhls, but currentTime isn't in buffered."),!1);var forwardBuffer=timeAheadOf(buffered,currentTime),maxBufferLowWaterLine=experimentalBufferBasedABR?Config.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:Config.MAX_BUFFER_LOW_WATER_LINE;if(duration<maxBufferLowWaterLine)return log(sharedLogLine+" as duration < max low water line ("+duration+" < "+maxBufferLowWaterLine+")"),!0;var nextBandwidth=nextPlaylist.attributes.BANDWIDTH,currBandwidth=currentPlaylist.attributes.BANDWIDTH;if(nextBandwidth<currBandwidth&&(!experimentalBufferBasedABR||forwardBuffer<bufferHighWaterLine)){var logLine=sharedLogLine+" as next bandwidth < current bandwidth ("+nextBandwidth+" < "+currBandwidth+")";return experimentalBufferBasedABR&&(logLine+=" and forwardBuffer < bufferHighWaterLine ("+forwardBuffer+" < "+bufferHighWaterLine+")"),log(logLine),!0}if((!experimentalBufferBasedABR||nextBandwidth>currBandwidth)&&forwardBuffer>=bufferLowWaterLine){var _logLine=sharedLogLine+" as forwardBuffer >= bufferLowWaterLine ("+forwardBuffer+" >= "+bufferLowWaterLine+")";return experimentalBufferBasedABR&&(_logLine+=" and next bandwidth > current bandwidth ("+nextBandwidth+" > "+currBandwidth+")"),log(_logLine),!0}return log("not "+sharedLogLine+" as no switching criteria met"),!1}({buffered:this.tech_.buffered(),currentTime:currentTime,currentPlaylist:currentPlaylist,nextPlaylist:nextPlaylist,bufferLowWaterLine:bufferLowWaterLine,bufferHighWaterLine:bufferHighWaterLine,duration:this.duration(),experimentalBufferBasedABR:this.experimentalBufferBasedABR,log:this.logger_})},_proto.setupSegmentLoaderListeners_=function(){var _this4=this;this.experimentalBufferBasedABR||(this.mainSegmentLoader_.on("bandwidthupdate",function(){var nextPlaylist=_this4.selectPlaylist();_this4.shouldSwitchToMedia_(nextPlaylist)&&_this4.switchMedia_(nextPlaylist,"bandwidthupdate"),_this4.tech_.trigger("bandwidthupdate")}),this.mainSegmentLoader_.on("progress",function(){_this4.trigger("progress")})),this.mainSegmentLoader_.on("error",function(){_this4.blacklistCurrentPlaylist(_this4.mainSegmentLoader_.error())}),this.mainSegmentLoader_.on("appenderror",function(){_this4.error=_this4.mainSegmentLoader_.error_,_this4.trigger("error")}),this.mainSegmentLoader_.on("syncinfoupdate",function(){_this4.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("timestampoffset",function(){_this4.tech_.trigger({type:"usage",name:"vhs-timestamp-offset"}),_this4.tech_.trigger({type:"usage",name:"hls-timestamp-offset"})}),this.audioSegmentLoader_.on("syncinfoupdate",function(){_this4.onSyncInfoUpdate_()}),this.audioSegmentLoader_.on("appenderror",function(){_this4.error=_this4.audioSegmentLoader_.error_,_this4.trigger("error")}),this.mainSegmentLoader_.on("ended",function(){_this4.logger_("main segment loader ended"),_this4.onEndOfStream()}),this.mainSegmentLoader_.on("earlyabort",function(event){_this4.experimentalBufferBasedABR||(_this4.delegateLoaders_("all",["abort"]),_this4.blacklistCurrentPlaylist({message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},120))});var updateCodecs=function(){if(!_this4.sourceUpdater_.hasCreatedSourceBuffers())return _this4.tryToCreateSourceBuffers_();var codecs=_this4.getCodecsOrExclude_();codecs&&_this4.sourceUpdater_.addOrChangeSourceBuffers(codecs)};this.mainSegmentLoader_.on("trackinfo",updateCodecs),this.audioSegmentLoader_.on("trackinfo",updateCodecs),this.mainSegmentLoader_.on("fmp4",function(){_this4.triggeredFmp4Usage||(_this4.tech_.trigger({type:"usage",name:"vhs-fmp4"}),_this4.tech_.trigger({type:"usage",name:"hls-fmp4"}),_this4.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("fmp4",function(){_this4.triggeredFmp4Usage||(_this4.tech_.trigger({type:"usage",name:"vhs-fmp4"}),_this4.tech_.trigger({type:"usage",name:"hls-fmp4"}),_this4.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("ended",function(){_this4.logger_("audioSegmentLoader ended"),_this4.onEndOfStream()})},_proto.mediaSecondsLoaded_=function(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)},_proto.load=function(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()},_proto.smoothQualityChange_=function(media){void 0===media&&(media=this.selectPlaylist()),this.fastQualityChange_(media)},_proto.fastQualityChange_=function(media){var _this5=this;void 0===media&&(media=this.selectPlaylist()),media!==this.masterPlaylistLoader_.media()?(this.switchMedia_(media,"fast-quality"),this.mainSegmentLoader_.resetEverything(function(){_this5.tech_.setCurrentTime(videojs.browser.IE_VERSION||videojs.browser.IS_EDGE?_this5.tech_.currentTime()+.04:_this5.tech_.currentTime())})):this.logger_("skipping fastQualityChange because new media is same as old")},_proto.play=function(){if(!this.setupFirstPlay()){this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load();var seekable=this.tech_.seekable();return this.tech_.duration()===1/0&&this.tech_.currentTime()<seekable.start(0)?this.tech_.setCurrentTime(seekable.end(seekable.length-1)):void 0}},_proto.setupFirstPlay=function(){var _this6=this,media=this.masterPlaylistLoader_.media();if(!media||this.tech_.paused()||this.hasPlayed_)return!1;if(!media.endList){var seekable=this.seekable();if(!seekable.length)return!1;if(videojs.browser.IE_VERSION&&0===this.tech_.readyState())return this.tech_.one("loadedmetadata",function(){_this6.trigger("firstplay"),_this6.tech_.setCurrentTime(seekable.end(0)),_this6.hasPlayed_=!0}),!1;this.trigger("firstplay"),this.tech_.setCurrentTime(seekable.end(0))}return this.hasPlayed_=!0,this.load(),!0},_proto.handleSourceOpen_=function(){if(this.tryToCreateSourceBuffers_(),this.tech_.autoplay()){var playPromise=this.tech_.play();void 0!==playPromise&&"function"==typeof playPromise.then&&playPromise.then(null,function(e){})}this.trigger("sourceopen")},_proto.handleSourceEnded_=function(){if(this.inbandTextTracks_.metadataTrack_){var cues=this.inbandTextTracks_.metadataTrack_.cues;if(cues&&cues.length){var duration=this.duration();cues[cues.length-1].endTime=isNaN(duration)||Math.abs(duration)===1/0?Number.MAX_VALUE:duration}}},_proto.handleDurationChange_=function(){this.tech_.trigger("durationchange")},_proto.onEndOfStream=function(){var isEndOfStream=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader){var mainMediaInfo=this.mainSegmentLoader_.getCurrentMediaInfo_();isEndOfStream=!mainMediaInfo||mainMediaInfo.hasVideo?isEndOfStream&&this.audioSegmentLoader_.ended_:this.audioSegmentLoader_.ended_}isEndOfStream&&(this.stopABRTimer_(),this.sourceUpdater_.endOfStream())},_proto.stuckAtPlaylistEnd_=function(playlist){if(!this.seekable().length)return!1;var expired=this.syncController_.getExpiredTime(playlist,this.duration());if(null===expired)return!1;var absolutePlaylistEnd=Vhs$1.Playlist.playlistEnd(playlist,expired),currentTime=this.tech_.currentTime(),buffered=this.tech_.buffered();if(!buffered.length)return absolutePlaylistEnd-currentTime<=.1;var bufferedEnd=buffered.end(buffered.length-1);return bufferedEnd-currentTime<=.1&&absolutePlaylistEnd-bufferedEnd<=.1},_proto.blacklistCurrentPlaylist=function(error,blacklistDuration){void 0===error&&(error={});var currentPlaylist=error.playlist||this.masterPlaylistLoader_.media();if(blacklistDuration=blacklistDuration||error.blacklistDuration||this.blacklistDuration,!currentPlaylist)return this.error=error,void("open"!==this.mediaSource.readyState?this.trigger("error"):this.sourceUpdater_.endOfStream("network"));currentPlaylist.playlistErrors_++;var excludeUntil,playlists=this.masterPlaylistLoader_.master.playlists,enabledPlaylists=playlists.filter(isEnabled),isFinalRendition=1===enabledPlaylists.length&&enabledPlaylists[0]===currentPlaylist;if(1===playlists.length&&blacklistDuration!==1/0)return videojs.log.warn("Problem encountered with playlist "+currentPlaylist.id+". Trying again since it is the only playlist."),this.tech_.trigger("retryplaylist"),this.masterPlaylistLoader_.load(isFinalRendition);if(isFinalRendition){var reincluded=!1;playlists.forEach(function(playlist){if(playlist!==currentPlaylist){var excludeUntil=playlist.excludeUntil;void 0!==excludeUntil&&excludeUntil!==1/0&&(reincluded=!0,delete playlist.excludeUntil)}}),reincluded&&(videojs.log.warn("Removing other playlists from the exclusion list because the last rendition is about to be excluded."),this.tech_.trigger("retryplaylist"))}excludeUntil=currentPlaylist.playlistErrors_>this.maxPlaylistRetries?1/0:Date.now()+1e3*blacklistDuration,currentPlaylist.excludeUntil=excludeUntil,error.reason&&(currentPlaylist.lastExcludeReason_=error.reason),this.tech_.trigger("blacklistplaylist"),this.tech_.trigger({type:"usage",name:"vhs-rendition-blacklisted"}),this.tech_.trigger({type:"usage",name:"hls-rendition-blacklisted"});var nextPlaylist=this.selectPlaylist();if(!nextPlaylist)return this.error="Playback cannot continue. No available working or supported playlists.",void this.trigger("error");(error.internal?this.logger_:videojs.log.warn)((error.internal?"Internal problem":"Problem")+" encountered with playlist "+currentPlaylist.id+"."+(error.message?" "+error.message:"")+" Switching to playlist "+nextPlaylist.id+"."),nextPlaylist.attributes.AUDIO!==currentPlaylist.attributes.AUDIO&&this.delegateLoaders_("audio",["abort","pause"]),nextPlaylist.attributes.SUBTITLES!==currentPlaylist.attributes.SUBTITLES&&this.delegateLoaders_("subtitle",["abort","pause"]),this.delegateLoaders_("main",["abort","pause"]);var delayDuration=nextPlaylist.targetDuration/2*1e3||5e3,shouldDelay="number"==typeof nextPlaylist.lastRequest&&Date.now()-nextPlaylist.lastRequest<=delayDuration;return this.switchMedia_(nextPlaylist,"exclude",isFinalRendition||shouldDelay)},_proto.pauseLoading=function(){this.delegateLoaders_("all",["abort","pause"]),this.stopABRTimer_()},_proto.delegateLoaders_=function(filter,fnNames){var _this7=this,loaders=[],dontFilterPlaylist="all"===filter;(dontFilterPlaylist||"main"===filter)&&loaders.push(this.masterPlaylistLoader_);var mediaTypes=[];(dontFilterPlaylist||"audio"===filter)&&mediaTypes.push("AUDIO"),(dontFilterPlaylist||"subtitle"===filter)&&(mediaTypes.push("CLOSED-CAPTIONS"),mediaTypes.push("SUBTITLES")),mediaTypes.forEach(function(mediaType){var loader=_this7.mediaTypes_[mediaType]&&_this7.mediaTypes_[mediaType].activePlaylistLoader;loader&&loaders.push(loader)}),["main","audio","subtitle"].forEach(function(name){var loader=_this7[name+"SegmentLoader_"];!loader||filter!==name&&"all"!==filter||loaders.push(loader)}),loaders.forEach(function(loader){return fnNames.forEach(function(fnName){"function"==typeof loader[fnName]&&loader[fnName]()})})},_proto.setCurrentTime=function(currentTime){var buffered=findRange(this.tech_.buffered(),currentTime);return this.masterPlaylistLoader_&&this.masterPlaylistLoader_.media()&&this.masterPlaylistLoader_.media().segments?buffered&&buffered.length?currentTime:(this.mainSegmentLoader_.resetEverything(),this.mainSegmentLoader_.abort(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.resetEverything(),this.audioSegmentLoader_.abort()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.resetEverything(),this.subtitleSegmentLoader_.abort()),void this.load()):0},_proto.duration=function(){if(!this.masterPlaylistLoader_)return 0;var media=this.masterPlaylistLoader_.media();return media?media.endList?this.mediaSource?this.mediaSource.duration:Vhs$1.Playlist.duration(media):1/0:0},_proto.seekable=function(){return this.seekable_},_proto.onSyncInfoUpdate_=function(){var audioSeekable;if(this.masterPlaylistLoader_&&!this.sourceUpdater_.hasCreatedSourceBuffers()){var media=this.masterPlaylistLoader_.media();if(media){var expired=this.syncController_.getExpiredTime(media,this.duration());if(null!==expired){var master=this.masterPlaylistLoader_.master,mainSeekable=Vhs$1.Playlist.seekable(media,expired,Vhs$1.Playlist.liveEdgeDelay(master,media));if(0!==mainSeekable.length){if(this.mediaTypes_.AUDIO.activePlaylistLoader){if(media=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),null===(expired=this.syncController_.getExpiredTime(media,this.duration())))return;if(0===(audioSeekable=Vhs$1.Playlist.seekable(media,expired,Vhs$1.Playlist.liveEdgeDelay(master,media))).length)return}var oldEnd,oldStart;this.seekable_&&this.seekable_.length&&(oldEnd=this.seekable_.end(0),oldStart=this.seekable_.start(0)),this.seekable_=audioSeekable?audioSeekable.start(0)>mainSeekable.end(0)||mainSeekable.start(0)>audioSeekable.end(0)?mainSeekable:videojs.createTimeRanges([[audioSeekable.start(0)>mainSeekable.start(0)?audioSeekable.start(0):mainSeekable.start(0),audioSeekable.end(0)<mainSeekable.end(0)?audioSeekable.end(0):mainSeekable.end(0)]]):mainSeekable,this.seekable_&&this.seekable_.length&&this.seekable_.end(0)===oldEnd&&this.seekable_.start(0)===oldStart||(this.logger_("seekable updated ["+printableRange(this.seekable_)+"]"),this.tech_.trigger("seekablechanged"))}}}}},_proto.updateDuration=function(isLive){if(this.updateDuration_&&(this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.updateDuration_=null),"open"!==this.mediaSource.readyState)return this.updateDuration_=this.updateDuration.bind(this,isLive),void this.mediaSource.addEventListener("sourceopen",this.updateDuration_);if(isLive){var seekable=this.seekable();if(!seekable.length)return;(isNaN(this.mediaSource.duration)||this.mediaSource.duration<seekable.end(seekable.length-1))&&this.sourceUpdater_.setDuration(seekable.end(seekable.length-1))}else{var buffered=this.tech_.buffered(),duration=Vhs$1.Playlist.duration(this.masterPlaylistLoader_.media());buffered.length>0&&(duration=Math.max(duration,buffered.end(buffered.length-1))),this.mediaSource.duration!==duration&&this.sourceUpdater_.setDuration(duration)}},_proto.dispose=function(){var _this8=this;this.trigger("dispose"),this.decrypter_.terminate(),this.masterPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_),["AUDIO","SUBTITLES"].forEach(function(type){var groups=_this8.mediaTypes_[type].groups;for(var id in groups)groups[id].forEach(function(group){group.playlistLoader&&group.playlistLoader.dispose()})}),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.sourceUpdater_.dispose(),this.timelineChangeController_.dispose(),this.stopABRTimer_(),this.updateDuration_&&this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_),this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_),this.off()},_proto.master=function(){return this.masterPlaylistLoader_.master},_proto.media=function(){return this.masterPlaylistLoader_.media()||this.initialMedia_},_proto.areMediaTypesKnown_=function(){var usingAudioLoader=!!this.mediaTypes_.AUDIO.activePlaylistLoader,hasMainMediaInfo=!!this.mainSegmentLoader_.getCurrentMediaInfo_(),hasAudioMediaInfo=!usingAudioLoader||!!this.audioSegmentLoader_.getCurrentMediaInfo_();return!(!hasMainMediaInfo||!hasAudioMediaInfo)},_proto.getCodecsOrExclude_=function(){var _this9=this,media={main:this.mainSegmentLoader_.getCurrentMediaInfo_()||{},audio:this.audioSegmentLoader_.getCurrentMediaInfo_()||{}};media.video=media.main;var playlistCodecs=codecsForPlaylist(this.master(),this.media()),codecs={},usingAudioLoader=!!this.mediaTypes_.AUDIO.activePlaylistLoader;if(media.main.hasVideo&&(codecs.video=playlistCodecs.video||media.main.videoCodec||"avc1.4d400d"),media.main.isMuxed&&(codecs.video+=","+(playlistCodecs.audio||media.main.audioCodec||"mp4a.40.2")),(media.main.hasAudio&&!media.main.isMuxed||media.audio.hasAudio||usingAudioLoader)&&(codecs.audio=playlistCodecs.audio||media.main.audioCodec||media.audio.audioCodec||"mp4a.40.2",media.audio.isFmp4=media.main.hasAudio&&!media.main.isMuxed?media.main.isFmp4:media.audio.isFmp4),codecs.audio||codecs.video){var unsupportedAudio,unsupportedCodecs={};if(["video","audio"].forEach(function(type){if(codecs.hasOwnProperty(type)&&(codec=codecs[type],!(media[type].isFmp4?browserSupportsCodec(codec):muxerSupportsCodec(codec)))){var supporter=media[type].isFmp4?"browser":"muxer";unsupportedCodecs[supporter]=unsupportedCodecs[supporter]||[],unsupportedCodecs[supporter].push(codecs[type]),"audio"===type&&(unsupportedAudio=supporter)}var codec}),usingAudioLoader&&unsupportedAudio&&this.media().attributes.AUDIO){var audioGroup=this.media().attributes.AUDIO;this.master().playlists.forEach(function(variant){(variant.attributes&&variant.attributes.AUDIO)===audioGroup&&variant!==_this9.media()&&(variant.excludeUntil=1/0)}),this.logger_("excluding audio group "+audioGroup+" as "+unsupportedAudio+' does not support codec(s): "'+codecs.audio+'"')}if(!Object.keys(unsupportedCodecs).length){if(this.sourceUpdater_.hasCreatedSourceBuffers()&&!this.sourceUpdater_.canChangeType()){var switchMessages=[];if(["video","audio"].forEach(function(type){var newCodec=(parseCodecs(_this9.sourceUpdater_.codecs[type]||"")[0]||{}).type,oldCodec=(parseCodecs(codecs[type]||"")[0]||{}).type;newCodec&&oldCodec&&newCodec.toLowerCase()!==oldCodec.toLowerCase()&&switchMessages.push('"'+_this9.sourceUpdater_.codecs[type]+'" -> "'+codecs[type]+'"')}),switchMessages.length)return void this.blacklistCurrentPlaylist({playlist:this.media(),message:"Codec switching not supported: "+switchMessages.join(", ")+".",blacklistDuration:1/0,internal:!0})}return codecs}var message=Object.keys(unsupportedCodecs).reduce(function(acc,supporter){return acc&&(acc+=", "),acc+(supporter+' does not support codec(s): "')+unsupportedCodecs[supporter].join(",")+'"'},"")+".";this.blacklistCurrentPlaylist({playlist:this.media(),internal:!0,message:message,blacklistDuration:1/0})}else this.blacklistCurrentPlaylist({playlist:this.media(),message:"Could not determine codecs for playlist.",blacklistDuration:1/0})},_proto.tryToCreateSourceBuffers_=function(){if("open"===this.mediaSource.readyState&&!this.sourceUpdater_.hasCreatedSourceBuffers()&&this.areMediaTypesKnown_()){var codecs=this.getCodecsOrExclude_();if(codecs){this.sourceUpdater_.createSourceBuffers(codecs);var codecString=[codecs.video,codecs.audio].filter(Boolean).join(",");this.excludeIncompatibleVariants_(codecString)}}},_proto.excludeUnsupportedVariants_=function(){var _this10=this,playlists=this.master().playlists,ids=[];Object.keys(playlists).forEach(function(key){var variant=playlists[key];if(-1===ids.indexOf(variant.id)){ids.push(variant.id);var codecs=codecsForPlaylist(_this10.master,variant),unsupported=[];!codecs.audio||muxerSupportsCodec(codecs.audio)||browserSupportsCodec(codecs.audio)||unsupported.push("audio codec "+codecs.audio),!codecs.video||muxerSupportsCodec(codecs.video)||browserSupportsCodec(codecs.video)||unsupported.push("video codec "+codecs.video),codecs.text&&"stpp.ttml.im1t"===codecs.text&&unsupported.push("text codec "+codecs.text),unsupported.length&&(variant.excludeUntil=1/0,_this10.logger_("excluding "+variant.id+" for unsupported: "+unsupported.join(", ")))}})},_proto.excludeIncompatibleVariants_=function(codecString){var _this11=this,ids=[],playlists=this.master().playlists,codecs=unwrapCodecList(parseCodecs(codecString)),codecCount_=codecCount(codecs),videoDetails=codecs.video&&parseCodecs(codecs.video)[0]||null,audioDetails=codecs.audio&&parseCodecs(codecs.audio)[0]||null;Object.keys(playlists).forEach(function(key){var variant=playlists[key];if(-1===ids.indexOf(variant.id)&&variant.excludeUntil!==1/0){ids.push(variant.id);var blacklistReasons=[],variantCodecs=codecsForPlaylist(_this11.masterPlaylistLoader_.master,variant),variantCodecCount=codecCount(variantCodecs);if(variantCodecs.audio||variantCodecs.video){if(variantCodecCount!==codecCount_&&blacklistReasons.push('codec count "'+variantCodecCount+'" !== "'+codecCount_+'"'),!_this11.sourceUpdater_.canChangeType()){var variantVideoDetails=variantCodecs.video&&parseCodecs(variantCodecs.video)[0]||null,variantAudioDetails=variantCodecs.audio&&parseCodecs(variantCodecs.audio)[0]||null;variantVideoDetails&&videoDetails&&variantVideoDetails.type.toLowerCase()!==videoDetails.type.toLowerCase()&&blacklistReasons.push('video codec "'+variantVideoDetails.type+'" !== "'+videoDetails.type+'"'),variantAudioDetails&&audioDetails&&variantAudioDetails.type.toLowerCase()!==audioDetails.type.toLowerCase()&&blacklistReasons.push('audio codec "'+variantAudioDetails.type+'" !== "'+audioDetails.type+'"')}blacklistReasons.length&&(variant.excludeUntil=1/0,_this11.logger_("blacklisting "+variant.id+": "+blacklistReasons.join(" && ")))}}})},_proto.updateAdCues_=function(media){var offset=0,seekable=this.seekable();seekable.length&&(offset=seekable.start(0)),function(media,track,offset){if(void 0===offset&&(offset=0),media.segments)for(var cue,mediaTime=offset,i=0;i<media.segments.length;i++){var segment=media.segments[i];if(cue||(cue=findAdCue(track,mediaTime+segment.duration/2)),cue){if("cueIn"in segment){cue.endTime=mediaTime,cue.adEndTime=mediaTime,mediaTime+=segment.duration,cue=null;continue}if(mediaTime<cue.endTime){mediaTime+=segment.duration;continue}cue.endTime+=segment.duration}else if("cueOut"in segment&&((cue=new(window_default().VTTCue)(mediaTime,mediaTime+segment.duration,segment.cueOut)).adStartTime=mediaTime,cue.adEndTime=mediaTime+parseFloat(segment.cueOut),track.addCue(cue)),"cueOutCont"in segment){var _segment$cueOutCont$s=segment.cueOutCont.split("/").map(parseFloat),adOffset=_segment$cueOutCont$s[0],adTotal=_segment$cueOutCont$s[1];(cue=new(window_default().VTTCue)(mediaTime,mediaTime+segment.duration,"")).adStartTime=mediaTime-adOffset,cue.adEndTime=cue.adStartTime+adTotal,track.addCue(cue)}mediaTime+=segment.duration}}(media,this.cueTagsTrack_,offset)},_proto.goalBufferLength=function(){var currentTime=this.tech_.currentTime(),initial=Config.GOAL_BUFFER_LENGTH,rate=Config.GOAL_BUFFER_LENGTH_RATE,max=Math.max(initial,Config.MAX_GOAL_BUFFER_LENGTH);return Math.min(initial+currentTime*rate,max)},_proto.bufferLowWaterLine=function(){var currentTime=this.tech_.currentTime(),initial=Config.BUFFER_LOW_WATER_LINE,rate=Config.BUFFER_LOW_WATER_LINE_RATE,max=Math.max(initial,Config.MAX_BUFFER_LOW_WATER_LINE),newMax=Math.max(initial,Config.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE);return Math.min(initial+currentTime*rate,this.experimentalBufferBasedABR?newMax:max)},_proto.bufferHighWaterLine=function(){return Config.BUFFER_HIGH_WATER_LINE},MasterPlaylistController}(videojs.EventTarget),Representation=function(vhsHandler,playlist,id){var loader,playlistID,changePlaylistFn,mpc=vhsHandler.masterPlaylistController_,qualityChangeFunction=mpc[(vhsHandler.options_.smoothQualityChange?"smooth":"fast")+"QualityChange_"].bind(mpc);if(playlist.attributes){var resolution=playlist.attributes.RESOLUTION;this.width=resolution&&resolution.width,this.height=resolution&&resolution.height,this.bandwidth=playlist.attributes.BANDWIDTH}this.codecs=codecsForPlaylist(mpc.master(),playlist),this.playlist=playlist,this.id=id,this.enabled=(loader=vhsHandler.playlists,playlistID=playlist.id,changePlaylistFn=qualityChangeFunction,function(enable){var playlist=loader.master.playlists[playlistID],incompatible=isIncompatible(playlist),currentlyEnabled=isEnabled(playlist);return void 0===enable?currentlyEnabled:(enable?delete playlist.disabled:playlist.disabled=!0,enable===currentlyEnabled||incompatible||(changePlaylistFn(),loader.trigger(enable?"renditionenabled":"renditiondisabled")),enable)})},timerCancelEvents=["seeking","seeked","pause","playing","error"],PlaybackWatcher=function(){function PlaybackWatcher(options){var _this=this;this.masterPlaylistController_=options.masterPlaylistController,this.tech_=options.tech,this.seekable=options.seekable,this.allowSeeksWithinUnsafeLiveWindow=options.allowSeeksWithinUnsafeLiveWindow,this.liveRangeSafeTimeDelta=options.liveRangeSafeTimeDelta,this.media=options.media,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.timer_=null,this.checkCurrentTimeTimeout_=null,this.logger_=logger("PlaybackWatcher"),this.logger_("initialize");var playHandler=function(){return _this.monitorCurrentTime_()},canPlayHandler=function(){return _this.monitorCurrentTime_()},waitingHandler=function(){return _this.techWaiting_()},cancelTimerHandler=function(){return _this.cancelTimer_()},mpc=this.masterPlaylistController_,loaderTypes=["main","subtitle","audio"],loaderChecks={};loaderTypes.forEach(function(type){loaderChecks[type]={reset:function(){return _this.resetSegmentDownloads_(type)},updateend:function(){return _this.checkSegmentDownloads_(type)}},mpc[type+"SegmentLoader_"].on("appendsdone",loaderChecks[type].updateend),mpc[type+"SegmentLoader_"].on("playlistupdate",loaderChecks[type].reset),_this.tech_.on(["seeked","seeking"],loaderChecks[type].reset)});var setSeekingHandlers=function(fn){["main","audio"].forEach(function(type){mpc[type+"SegmentLoader_"][fn]("appended",_this.seekingAppendCheck_)})};this.seekingAppendCheck_=function(){_this.fixesBadSeeks_()&&(_this.consecutiveUpdates=0,_this.lastRecordedTime=_this.tech_.currentTime(),setSeekingHandlers("off"))},this.clearSeekingAppendCheck_=function(){return setSeekingHandlers("off")},this.watchForBadSeeking_=function(){_this.clearSeekingAppendCheck_(),setSeekingHandlers("on")},this.tech_.on("seeked",this.clearSeekingAppendCheck_),this.tech_.on("seeking",this.watchForBadSeeking_),this.tech_.on("waiting",waitingHandler),this.tech_.on(timerCancelEvents,cancelTimerHandler),this.tech_.on("canplay",canPlayHandler),this.tech_.one("play",playHandler),this.dispose=function(){_this.clearSeekingAppendCheck_(),_this.logger_("dispose"),_this.tech_.off("waiting",waitingHandler),_this.tech_.off(timerCancelEvents,cancelTimerHandler),_this.tech_.off("canplay",canPlayHandler),_this.tech_.off("play",playHandler),_this.tech_.off("seeking",_this.watchForBadSeeking_),_this.tech_.off("seeked",_this.clearSeekingAppendCheck_),loaderTypes.forEach(function(type){mpc[type+"SegmentLoader_"].off("appendsdone",loaderChecks[type].updateend),mpc[type+"SegmentLoader_"].off("playlistupdate",loaderChecks[type].reset),_this.tech_.off(["seeked","seeking"],loaderChecks[type].reset)}),_this.checkCurrentTimeTimeout_&&window_default().clearTimeout(_this.checkCurrentTimeTimeout_),_this.cancelTimer_()}}var _proto=PlaybackWatcher.prototype;return _proto.monitorCurrentTime_=function(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&window_default().clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=window_default().setTimeout(this.monitorCurrentTime_.bind(this),250)},_proto.resetSegmentDownloads_=function(type){var loader=this.masterPlaylistController_[type+"SegmentLoader_"];this[type+"StalledDownloads_"]>0&&this.logger_("resetting possible stalled download count for "+type+" loader"),this[type+"StalledDownloads_"]=0,this[type+"Buffered_"]=loader.buffered_()},_proto.checkSegmentDownloads_=function(type){var mpc=this.masterPlaylistController_,loader=mpc[type+"SegmentLoader_"],buffered=loader.buffered_(),isBufferedDifferent=function(a,b){if(a===b)return!1;if(!a&&b||!b&&a)return!0;if(a.length!==b.length)return!0;for(var i=0;i<a.length;i++)if(a.start(i)!==b.start(i)||a.end(i)!==b.end(i))return!0;return!1}(this[type+"Buffered_"],buffered);this[type+"Buffered_"]=buffered,isBufferedDifferent?this.resetSegmentDownloads_(type):(this[type+"StalledDownloads_"]++,this.logger_("found #"+this[type+"StalledDownloads_"]+" "+type+" appends that did not increase buffer (possible stalled download)",{playlistId:loader.playlist_&&loader.playlist_.id,buffered:timeRangesToArray(buffered)}),this[type+"StalledDownloads_"]<10||(this.logger_(type+" loader stalled download exclusion"),this.resetSegmentDownloads_(type),this.tech_.trigger({type:"usage",name:"vhs-"+type+"-download-exclusion"}),"subtitle"!==type&&mpc.blacklistCurrentPlaylist({message:"Excessive "+type+" segment downloading detected."},1/0)))},_proto.checkCurrentTime_=function(){if(!this.tech_.paused()&&!this.tech_.seeking()){var currentTime=this.tech_.currentTime(),buffered=this.tech_.buffered();if(this.lastRecordedTime===currentTime&&(!buffered.length||currentTime+.1>=buffered.end(buffered.length-1)))return this.techWaiting_();this.consecutiveUpdates>=5&&currentTime===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):currentTime===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=currentTime)}},_proto.cancelTimer_=function(){this.consecutiveUpdates=0,this.timer_&&(this.logger_("cancelTimer_"),clearTimeout(this.timer_)),this.timer_=null},_proto.fixesBadSeeks_=function(){if(!this.tech_.seeking())return!1;var seekTo,seekable=this.seekable(),currentTime=this.tech_.currentTime();if(this.afterSeekableWindow_(seekable,currentTime,this.media(),this.allowSeeksWithinUnsafeLiveWindow)&&(seekTo=seekable.end(seekable.length-1)),this.beforeSeekableWindow_(seekable,currentTime)){var seekableStart=seekable.start(0);seekTo=seekableStart+(seekableStart===seekable.end(0)?0:.1)}if(void 0!==seekTo)return this.logger_("Trying to seek outside of seekable at time "+currentTime+" with seekable range "+printableRange(seekable)+". Seeking to "+seekTo+"."),this.tech_.setCurrentTime(seekTo),!0;for(var sourceUpdater=this.masterPlaylistController_.sourceUpdater_,buffered=this.tech_.buffered(),audioBuffered=sourceUpdater.audioBuffer?sourceUpdater.audioBuffered():null,videoBuffered=sourceUpdater.videoBuffer?sourceUpdater.videoBuffered():null,media=this.media(),minAppendedDuration=media.partTargetDuration?media.partTargetDuration:2*(media.targetDuration-.03333333333333333),bufferedToCheck=[audioBuffered,videoBuffered],i=0;i<bufferedToCheck.length;i++)if(bufferedToCheck[i]&&timeAheadOf(bufferedToCheck[i],currentTime)<minAppendedDuration)return!1;var nextRange=findNextRange(buffered,currentTime);return 0!==nextRange.length&&(seekTo=nextRange.start(0)+.1,this.logger_("Buffered region starts ("+nextRange.start(0)+")  just beyond seek point ("+currentTime+"). Seeking to "+seekTo+"."),this.tech_.setCurrentTime(seekTo),!0)},_proto.waiting_=function(){if(!this.techWaiting_()){var currentTime=this.tech_.currentTime(),buffered=this.tech_.buffered(),currentRange=findRange(buffered,currentTime);return currentRange.length&&currentTime+3<=currentRange.end(0)?(this.cancelTimer_(),this.tech_.setCurrentTime(currentTime),this.logger_("Stopped at "+currentTime+" while inside a buffered region ["+currentRange.start(0)+" -> "+currentRange.end(0)+"]. Attempting to resume playback by seeking to the current time."),this.tech_.trigger({type:"usage",name:"vhs-unknown-waiting"}),void this.tech_.trigger({type:"usage",name:"hls-unknown-waiting"})):void 0}},_proto.techWaiting_=function(){var seekable=this.seekable(),currentTime=this.tech_.currentTime();if(this.tech_.seeking()||null!==this.timer_)return!0;if(this.beforeSeekableWindow_(seekable,currentTime)){var livePoint=seekable.end(seekable.length-1);return this.logger_("Fell out of live window at time "+currentTime+". Seeking to live point (seekable end) "+livePoint),this.cancelTimer_(),this.tech_.setCurrentTime(livePoint),this.tech_.trigger({type:"usage",name:"vhs-live-resync"}),this.tech_.trigger({type:"usage",name:"hls-live-resync"}),!0}var sourceUpdater=this.tech_.vhs.masterPlaylistController_.sourceUpdater_,buffered=this.tech_.buffered();if(this.videoUnderflow_({audioBuffered:sourceUpdater.audioBuffered(),videoBuffered:sourceUpdater.videoBuffered(),currentTime:currentTime}))return this.cancelTimer_(),this.tech_.setCurrentTime(currentTime),this.tech_.trigger({type:"usage",name:"vhs-video-underflow"}),this.tech_.trigger({type:"usage",name:"hls-video-underflow"}),!0;var nextRange=findNextRange(buffered,currentTime);if(nextRange.length>0){var difference=nextRange.start(0)-currentTime;return this.logger_("Stopped at "+currentTime+", setting timer for "+difference+", seeking to "+nextRange.start(0)),this.cancelTimer_(),this.timer_=setTimeout(this.skipTheGap_.bind(this),1e3*difference,currentTime),!0}return!1},_proto.afterSeekableWindow_=function(seekable,currentTime,playlist,allowSeeksWithinUnsafeLiveWindow){if(void 0===allowSeeksWithinUnsafeLiveWindow&&(allowSeeksWithinUnsafeLiveWindow=!1),!seekable.length)return!1;var allowedEnd=seekable.end(seekable.length-1)+.1;return!playlist.endList&&allowSeeksWithinUnsafeLiveWindow&&(allowedEnd=seekable.end(seekable.length-1)+3*playlist.targetDuration),currentTime>allowedEnd},_proto.beforeSeekableWindow_=function(seekable,currentTime){return!!(seekable.length&&seekable.start(0)>0&&currentTime<seekable.start(0)-this.liveRangeSafeTimeDelta)},_proto.videoUnderflow_=function(_ref){var videoBuffered=_ref.videoBuffered,audioBuffered=_ref.audioBuffered,currentTime=_ref.currentTime;if(videoBuffered){var gap;if(videoBuffered.length&&audioBuffered.length){var lastVideoRange=findRange(videoBuffered,currentTime-3),videoRange=findRange(videoBuffered,currentTime),audioRange=findRange(audioBuffered,currentTime);audioRange.length&&!videoRange.length&&lastVideoRange.length&&(gap={start:lastVideoRange.end(0),end:audioRange.end(0)})}else findNextRange(videoBuffered,currentTime).length||(gap=this.gapFromVideoUnderflow_(videoBuffered,currentTime));return!!gap&&(this.logger_("Encountered a gap in video from "+gap.start+" to "+gap.end+". Seeking to current time "+currentTime),!0)}},_proto.skipTheGap_=function(scheduledCurrentTime){var buffered=this.tech_.buffered(),currentTime=this.tech_.currentTime(),nextRange=findNextRange(buffered,currentTime);this.cancelTimer_(),0!==nextRange.length&&currentTime===scheduledCurrentTime&&(this.logger_("skipTheGap_:","currentTime:",currentTime,"scheduled currentTime:",scheduledCurrentTime,"nextRange start:",nextRange.start(0)),this.tech_.setCurrentTime(nextRange.start(0)+.03333333333333333),this.tech_.trigger({type:"usage",name:"vhs-gap-skip"}),this.tech_.trigger({type:"usage",name:"hls-gap-skip"}))},_proto.gapFromVideoUnderflow_=function(buffered,currentTime){for(var gaps=function(buffered){if(buffered.length<2)return videojs.createTimeRanges();for(var ranges=[],i=1;i<buffered.length;i++){var start=buffered.end(i-1),end=buffered.start(i);ranges.push([start,end])}return videojs.createTimeRanges(ranges)}(buffered),i=0;i<gaps.length;i++){var start=gaps.start(i),end=gaps.end(i);if(currentTime-start<4&&currentTime-start>2)return{start:start,end:end}}return null},PlaybackWatcher}(),defaultOptions={errorInterval:30,getSource:function(next){return next(this.tech({IWillNotUseThisInPlugins:!0}).currentSource_||this.currentSource())}},initPlugin=function initPlugin(player,options){var lastCalled=0,seekTo=0,localOptions=videojs.mergeOptions(defaultOptions,options);player.ready(function(){player.trigger({type:"usage",name:"vhs-error-reload-initialized"}),player.trigger({type:"usage",name:"hls-error-reload-initialized"})});var loadedMetadataHandler=function(){seekTo&&player.currentTime(seekTo)},setSource=function(sourceObj){null!=sourceObj&&(seekTo=player.duration()!==1/0&&player.currentTime()||0,player.one("loadedmetadata",loadedMetadataHandler),player.src(sourceObj),player.trigger({type:"usage",name:"vhs-error-reload"}),player.trigger({type:"usage",name:"hls-error-reload"}),player.play())},errorHandler=function(){return Date.now()-lastCalled<1e3*localOptions.errorInterval?(player.trigger({type:"usage",name:"vhs-error-reload-canceled"}),void player.trigger({type:"usage",name:"hls-error-reload-canceled"})):localOptions.getSource&&"function"==typeof localOptions.getSource?(lastCalled=Date.now(),localOptions.getSource.call(player,setSource)):void videojs.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!")},cleanupEvents=function cleanupEvents(){player.off("loadedmetadata",loadedMetadataHandler),player.off("error",errorHandler),player.off("dispose",cleanupEvents)};player.on("error",errorHandler),player.on("dispose",cleanupEvents),player.reloadSourceOnError=function(newOptions){cleanupEvents(),initPlugin(player,newOptions)}},Vhs={PlaylistLoader:PlaylistLoader,Playlist:Playlist,utils:utils,STANDARD_PLAYLIST_SELECTOR:lastBandwidthSelector,INITIAL_PLAYLIST_SELECTOR:function(){var _this=this,playlists=this.playlists.master.playlists.filter(Playlist.isEnabled);return stableSort(playlists,function(a,b){return comparePlaylistBandwidth(a,b)}),playlists.filter(function(playlist){return!!codecsForPlaylist(_this.playlists.master,playlist).video})[0]||null},lastBandwidthSelector:lastBandwidthSelector,movingAverageBandwidthSelector:function(decay){var average=-1,lastSystemBandwidth=-1;if(decay<0||decay>1)throw new Error("Moving average bandwidth decay must be between 0 and 1.");return function(){var pixelRatio=this.useDevicePixelRatio&&window_default().devicePixelRatio||1;return average<0&&(average=this.systemBandwidth,lastSystemBandwidth=this.systemBandwidth),this.systemBandwidth>0&&this.systemBandwidth!==lastSystemBandwidth&&(average=decay*this.systemBandwidth+(1-decay)*average,lastSystemBandwidth=this.systemBandwidth),simpleSelector(this.playlists.master,average,parseInt(safeGetComputedStyle(this.tech_.el(),"width"),10)*pixelRatio,parseInt(safeGetComputedStyle(this.tech_.el(),"height"),10)*pixelRatio,this.limitRenditionByPlayerDimensions,this.masterPlaylistController_)}},comparePlaylistBandwidth:comparePlaylistBandwidth,comparePlaylistResolution:function(left,right){var leftWidth,rightWidth;return left.attributes.RESOLUTION&&left.attributes.RESOLUTION.width&&(leftWidth=left.attributes.RESOLUTION.width),leftWidth=leftWidth||window_default().Number.MAX_VALUE,right.attributes.RESOLUTION&&right.attributes.RESOLUTION.width&&(rightWidth=right.attributes.RESOLUTION.width),leftWidth===(rightWidth=rightWidth||window_default().Number.MAX_VALUE)&&left.attributes.BANDWIDTH&&right.attributes.BANDWIDTH?left.attributes.BANDWIDTH-right.attributes.BANDWIDTH:leftWidth-rightWidth},xhr:xhrFactory()};Object.keys(Config).forEach(function(prop){Object.defineProperty(Vhs,prop,{get:function(){return videojs.log.warn("using Vhs."+prop+" is UNSAFE be sure you know what you are doing"),Config[prop]},set:function(value){videojs.log.warn("using Vhs."+prop+" is UNSAFE be sure you know what you are doing"),"number"!=typeof value||value<0?videojs.log.warn("value of Vhs."+prop+" must be greater than or equal to 0"):Config[prop]=value}})});var handleVhsMediaChange=function(qualityLevels,playlistLoader){for(var newPlaylist=playlistLoader.media(),selectedIndex=-1,i=0;i<qualityLevels.length;i++)if(qualityLevels[i].id===newPlaylist.id){selectedIndex=i;break}qualityLevels.selectedIndex_=selectedIndex,qualityLevels.trigger({selectedIndex:selectedIndex,type:"change"})};Vhs.canPlaySource=function(){return videojs.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var getVhsLocalStorage=function(){if(!window_default().localStorage)return null;var storedObject=window_default().localStorage.getItem("videojs-vhs");if(!storedObject)return null;try{return JSON.parse(storedObject)}catch(e){return null}};Vhs.supportsNativeHls=function(){if(!document_default()||!document_default().createElement)return!1;var video=document_default().createElement("video");return!!videojs.getTech("Html5").isSupported()&&["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some(function(canItPlay){return/maybe|probably/i.test(video.canPlayType(canItPlay))})}(),Vhs.supportsNativeDash=!!(document_default()&&document_default().createElement&&videojs.getTech("Html5").isSupported())&&/maybe|probably/i.test(document_default().createElement("video").canPlayType("application/dash+xml")),Vhs.supportsTypeNatively=function(type){return"hls"===type?Vhs.supportsNativeHls:"dash"===type&&Vhs.supportsNativeDash},Vhs.isSupported=function(){return videojs.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var VhsHandler=function(_Component){function VhsHandler(source,tech,options){var _this;if(_this=_Component.call(this,tech,videojs.mergeOptions(options.hls,options.vhs))||this,options.hls&&Object.keys(options.hls).length&&videojs.log.warn("Using hls options is deprecated. Use vhs instead."),"number"==typeof options.initialBandwidth&&(_this.options_.bandwidth=options.initialBandwidth),_this.logger_=logger("VhsHandler"),tech.options_&&tech.options_.playerId){var _player=videojs(tech.options_.playerId);_player.hasOwnProperty("hls")||Object.defineProperty(_player,"hls",{get:function(){return videojs.log.warn("player.hls is deprecated. Use player.tech().vhs instead."),tech.trigger({type:"usage",name:"hls-player-access"}),assertThisInitialized_default()(_this)},configurable:!0}),_player.hasOwnProperty("vhs")||Object.defineProperty(_player,"vhs",{get:function(){return videojs.log.warn("player.vhs is deprecated. Use player.tech().vhs instead."),tech.trigger({type:"usage",name:"vhs-player-access"}),assertThisInitialized_default()(_this)},configurable:!0}),_player.hasOwnProperty("dash")||Object.defineProperty(_player,"dash",{get:function(){return videojs.log.warn("player.dash is deprecated. Use player.tech().vhs instead."),assertThisInitialized_default()(_this)},configurable:!0}),_this.player_=_player}if(_this.tech_=tech,_this.source_=source,_this.stats={},_this.ignoreNextSeekingEvent_=!1,_this.setOptions_(),_this.options_.overrideNative&&tech.overrideNativeAudioTracks&&tech.overrideNativeVideoTracks)tech.overrideNativeAudioTracks(!0),tech.overrideNativeVideoTracks(!0);else if(_this.options_.overrideNative&&(tech.featuresNativeVideoTracks||tech.featuresNativeAudioTracks))throw new Error("Overriding native HLS requires emulated tracks. See https://git.io/vMpjB");return _this.on(document_default(),["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],function(event){var fullscreenElement=document_default().fullscreenElement||document_default().webkitFullscreenElement||document_default().mozFullScreenElement||document_default().msFullscreenElement;fullscreenElement&&fullscreenElement.contains(_this.tech_.el())?_this.masterPlaylistController_.fastQualityChange_():_this.masterPlaylistController_.checkABR_()}),_this.on(_this.tech_,"seeking",function(){this.ignoreNextSeekingEvent_?this.ignoreNextSeekingEvent_=!1:this.setCurrentTime(this.tech_.currentTime())}),_this.on(_this.tech_,"error",function(){this.tech_.error()&&this.masterPlaylistController_&&this.masterPlaylistController_.pauseLoading()}),_this.on(_this.tech_,"play",_this.play),_this}inheritsLoose_default()(VhsHandler,_Component);var _proto=VhsHandler.prototype;return _proto.setOptions_=function(){var _this2=this;if(this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.handleManifestRedirects=!1!==this.options_.handleManifestRedirects,this.options_.limitRenditionByPlayerDimensions=!1!==this.options_.limitRenditionByPlayerDimensions,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.smoothQualityChange=this.options_.smoothQualityChange||!1,this.options_.useBandwidthFromLocalStorage=void 0!==this.source_.useBandwidthFromLocalStorage?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.useNetworkInformationApi=this.options_.useNetworkInformationApi||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,"number"!=typeof this.options_.blacklistDuration&&(this.options_.blacklistDuration=300),"number"!=typeof this.options_.bandwidth&&this.options_.useBandwidthFromLocalStorage){var storedObject=getVhsLocalStorage();storedObject&&storedObject.bandwidth&&(this.options_.bandwidth=storedObject.bandwidth,this.tech_.trigger({type:"usage",name:"vhs-bandwidth-from-local-storage"}),this.tech_.trigger({type:"usage",name:"hls-bandwidth-from-local-storage"})),storedObject&&storedObject.throughput&&(this.options_.throughput=storedObject.throughput,this.tech_.trigger({type:"usage",name:"vhs-throughput-from-local-storage"}),this.tech_.trigger({type:"usage",name:"hls-throughput-from-local-storage"}))}"number"!=typeof this.options_.bandwidth&&(this.options_.bandwidth=Config.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===Config.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","limitRenditionByPlayerDimensions","bandwidth","smoothQualityChange","customTagParsers","customTagMappers","handleManifestRedirects","cacheEncryptionKeys","playlistSelector","initialPlaylistSelector","experimentalBufferBasedABR","liveRangeSafeTimeDelta","experimentalLLHLS","useNetworkInformationApi","experimentalExactManifestTimings","experimentalLeastPixelDiffSelector"].forEach(function(option){void 0!==_this2.source_[option]&&(_this2.options_[option]=_this2.source_[option])}),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio},_proto.src=function(_src,type){var _this3=this;if(_src){var dataUri;this.setOptions_(),this.options_.src=0===(dataUri=this.source_.src).toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,")?JSON.parse(dataUri.substring(dataUri.indexOf(",")+1)):dataUri,this.options_.tech=this.tech_,this.options_.externVhs=Vhs,this.options_.sourceType=simpleTypeFromSourceType(type),this.options_.seekTo=function(time){_this3.tech_.setCurrentTime(time)},this.options_.smoothQualityChange&&videojs.log.warn("smoothQualityChange is deprecated and will be removed in the next major version"),this.masterPlaylistController_=new MasterPlaylistController(this.options_);var playbackWatcherOptions=videojs.mergeOptions({liveRangeSafeTimeDelta:.1},this.options_,{seekable:function(){return _this3.seekable()},media:function(){return _this3.masterPlaylistController_.media()},masterPlaylistController:this.masterPlaylistController_});this.playbackWatcher_=new PlaybackWatcher(playbackWatcherOptions),this.masterPlaylistController_.on("error",function(){var player=videojs.players[_this3.tech_.options_.playerId],error=_this3.masterPlaylistController_.error;"object"!=typeof error||error.code?"string"==typeof error&&(error={message:error,code:3}):error.code=3,player.error(error)});var defaultSelector=this.options_.experimentalBufferBasedABR?Vhs.movingAverageBandwidthSelector(.55):Vhs.STANDARD_PLAYLIST_SELECTOR;this.masterPlaylistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):defaultSelector.bind(this),this.masterPlaylistController_.selectInitialPlaylist=Vhs.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.masterPlaylistController_.masterPlaylistLoader_,this.mediaSource=this.masterPlaylistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get:function(){return this.masterPlaylistController_.selectPlaylist},set:function(selectPlaylist){this.masterPlaylistController_.selectPlaylist=selectPlaylist.bind(this)}},throughput:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate},set:function(throughput){this.masterPlaylistController_.mainSegmentLoader_.throughput.rate=throughput,this.masterPlaylistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get:function(){var playerBandwidthEst=this.masterPlaylistController_.mainSegmentLoader_.bandwidth,networkInformation=window_default().navigator.connection||window_default().navigator.mozConnection||window_default().navigator.webkitConnection;if(this.options_.useNetworkInformationApi&&networkInformation){var networkInfoBandwidthEstBitsPerSec=1e3*networkInformation.downlink*1e3;playerBandwidthEst=networkInfoBandwidthEstBitsPerSec>=1e7&&playerBandwidthEst>=1e7?Math.max(playerBandwidthEst,networkInfoBandwidthEstBitsPerSec):networkInfoBandwidthEstBitsPerSec}return playerBandwidthEst},set:function(bandwidth){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=bandwidth,this.masterPlaylistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get:function(){return Math.floor(1/(1/(this.bandwidth||1)+(this.throughput>0?1/this.throughput:0)))},set:function(){videojs.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:function(){return _this3.bandwidth||0},enumerable:!0},mediaRequests:{get:function(){return _this3.masterPlaylistController_.mediaRequests_()||0},enumerable:!0},mediaRequestsAborted:{get:function(){return _this3.masterPlaylistController_.mediaRequestsAborted_()||0},enumerable:!0},mediaRequestsTimedout:{get:function(){return _this3.masterPlaylistController_.mediaRequestsTimedout_()||0},enumerable:!0},mediaRequestsErrored:{get:function(){return _this3.masterPlaylistController_.mediaRequestsErrored_()||0},enumerable:!0},mediaTransferDuration:{get:function(){return _this3.masterPlaylistController_.mediaTransferDuration_()||0},enumerable:!0},mediaBytesTransferred:{get:function(){return _this3.masterPlaylistController_.mediaBytesTransferred_()||0},enumerable:!0},mediaSecondsLoaded:{get:function(){return _this3.masterPlaylistController_.mediaSecondsLoaded_()||0},enumerable:!0},mediaAppends:{get:function(){return _this3.masterPlaylistController_.mediaAppends_()||0},enumerable:!0},mainAppendsToLoadedData:{get:function(){return _this3.masterPlaylistController_.mainAppendsToLoadedData_()||0},enumerable:!0},audioAppendsToLoadedData:{get:function(){return _this3.masterPlaylistController_.audioAppendsToLoadedData_()||0},enumerable:!0},appendsToLoadedData:{get:function(){return _this3.masterPlaylistController_.appendsToLoadedData_()||0},enumerable:!0},timeToLoadedData:{get:function(){return _this3.masterPlaylistController_.timeToLoadedData_()||0},enumerable:!0},buffered:{get:function(){return timeRangesToArray(_this3.tech_.buffered())},enumerable:!0},currentTime:{get:function(){return _this3.tech_.currentTime()},enumerable:!0},currentSource:{get:function(){return _this3.tech_.currentSource_},enumerable:!0},currentTech:{get:function(){return _this3.tech_.name_},enumerable:!0},duration:{get:function(){return _this3.tech_.duration()},enumerable:!0},master:{get:function(){return _this3.playlists.master},enumerable:!0},playerDimensions:{get:function(){return _this3.tech_.currentDimensions()},enumerable:!0},seekable:{get:function(){return timeRangesToArray(_this3.tech_.seekable())},enumerable:!0},timestamp:{get:function(){return Date.now()},enumerable:!0},videoPlaybackQuality:{get:function(){return _this3.tech_.getVideoPlaybackQuality()},enumerable:!0}}),this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_)),this.tech_.on("bandwidthupdate",function(){_this3.options_.useBandwidthFromLocalStorage&&function(options){if(!window_default().localStorage)return!1;var objectToStore=getVhsLocalStorage();objectToStore=objectToStore?videojs.mergeOptions(objectToStore,options):options;try{window_default().localStorage.setItem("videojs-vhs",JSON.stringify(objectToStore))}catch(e){return!1}}({bandwidth:_this3.bandwidth,throughput:Math.round(_this3.throughput)})}),this.masterPlaylistController_.on("selectedinitialmedia",function(){var vhsHandler;(vhsHandler=_this3).representations=function(){var master=vhsHandler.masterPlaylistController_.master(),playlists=isAudioOnly(master)?vhsHandler.masterPlaylistController_.getAudioTrackPlaylists_():master.playlists;return playlists?playlists.filter(function(media){return!isIncompatible(media)}).map(function(e,i){return new Representation(vhsHandler,e,e.id)}):[]}}),this.masterPlaylistController_.sourceUpdater_.on("createdsourcebuffers",function(){_this3.setupEme_()}),this.on(this.masterPlaylistController_,"progress",function(){this.tech_.trigger("progress")}),this.on(this.masterPlaylistController_,"firstplay",function(){this.ignoreNextSeekingEvent_=!0}),this.setupQualityLevels_(),this.tech_.el()&&(this.mediaSourceUrl_=window_default().URL.createObjectURL(this.masterPlaylistController_.mediaSource),this.tech_.src(this.mediaSourceUrl_))}},_proto.setupEme_=function(){var _ref2,player,sourceOptions,_this4=this,audioPlaylistLoader=this.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader,didSetupEmeOptions=(_ref2={player:this.player_,sourceKeySystems:this.source_.keySystems,media:this.playlists.media(),audioMedia:audioPlaylistLoader&&audioPlaylistLoader.media()},player=_ref2.player,!(!(sourceOptions=function(keySystemOptions,mainPlaylist,audioPlaylist){if(!keySystemOptions)return keySystemOptions;var codecs={};mainPlaylist&&mainPlaylist.attributes&&mainPlaylist.attributes.CODECS&&(codecs=unwrapCodecList(parseCodecs(mainPlaylist.attributes.CODECS))),audioPlaylist&&audioPlaylist.attributes&&audioPlaylist.attributes.CODECS&&(codecs.audio=audioPlaylist.attributes.CODECS);var videoContentType=getMimeForCodec(codecs.video),audioContentType=getMimeForCodec(codecs.audio),keySystemContentTypes={};for(var keySystem in keySystemOptions)keySystemContentTypes[keySystem]={},audioContentType&&(keySystemContentTypes[keySystem].audioContentType=audioContentType),videoContentType&&(keySystemContentTypes[keySystem].videoContentType=videoContentType),mainPlaylist.contentProtection&&mainPlaylist.contentProtection[keySystem]&&mainPlaylist.contentProtection[keySystem].pssh&&(keySystemContentTypes[keySystem].pssh=mainPlaylist.contentProtection[keySystem].pssh),"string"==typeof keySystemOptions[keySystem]&&(keySystemContentTypes[keySystem].url=keySystemOptions[keySystem]);return videojs.mergeOptions(keySystemOptions,keySystemContentTypes)}(_ref2.sourceKeySystems,_ref2.media,_ref2.audioMedia))||(player.currentSource().keySystems=sourceOptions,sourceOptions&&!player.eme&&(videojs.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin"),1))));this.player_.tech_.on("keystatuschange",function(e){"output-restricted"===e.status&&_this4.masterPlaylistController_.blacklistCurrentPlaylist({playlist:_this4.masterPlaylistController_.media(),message:"DRM keystatus changed to "+e.status+". Playlist will fail to play. Check for HDCP content.",blacklistDuration:1/0})}),11!==videojs.browser.IE_VERSION&&didSetupEmeOptions?(this.logger_("waiting for EME key session creation"),function(_ref){var player=_ref.player,sourceKeySystems=_ref.sourceKeySystems,audioMedia=_ref.audioMedia,mainPlaylists=_ref.mainPlaylists;if(!player.eme.initializeMediaKeys)return Promise.resolve();var playlists,keySystems,keySystemsOptionsArr=(playlists=audioMedia?mainPlaylists.concat([audioMedia]):mainPlaylists,keySystems=Object.keys(sourceKeySystems),playlists.reduce(function(keySystemsArr,playlist){if(!playlist.contentProtection)return keySystemsArr;var keySystemsOptions=keySystems.reduce(function(keySystemsObj,keySystem){var keySystemOptions=playlist.contentProtection[keySystem];return keySystemOptions&&keySystemOptions.pssh&&(keySystemsObj[keySystem]={pssh:keySystemOptions.pssh}),keySystemsObj},{});return Object.keys(keySystemsOptions).length&&keySystemsArr.push(keySystemsOptions),keySystemsArr},[])),initializationFinishedPromises=[],keySessionCreatedPromises=[];return keySystemsOptionsArr.forEach(function(keySystemsOptions){keySessionCreatedPromises.push(new Promise(function(resolve,reject){player.tech_.one("keysessioncreated",resolve)})),initializationFinishedPromises.push(new Promise(function(resolve,reject){player.eme.initializeMediaKeys({keySystems:keySystemsOptions},function(err){err?reject(err):resolve()})}))}),Promise.race([Promise.all(initializationFinishedPromises),Promise.race(keySessionCreatedPromises)])}({player:this.player_,sourceKeySystems:this.source_.keySystems,audioMedia:audioPlaylistLoader&&audioPlaylistLoader.media(),mainPlaylists:this.playlists.master.playlists}).then(function(){_this4.logger_("created EME key session"),_this4.masterPlaylistController_.sourceUpdater_.initializedEme()}).catch(function(err){_this4.logger_("error while creating EME key session",err),_this4.player_.error({message:"Failed to initialize media keys for EME",code:3})})):this.masterPlaylistController_.sourceUpdater_.initializedEme()},_proto.setupQualityLevels_=function(){var _this5=this,player=videojs.players[this.tech_.options_.playerId];player&&player.qualityLevels&&!this.qualityLevels_&&(this.qualityLevels_=player.qualityLevels(),this.masterPlaylistController_.on("selectedinitialmedia",function(){!function(qualityLevels,vhs){vhs.representations().forEach(function(rep){qualityLevels.addQualityLevel(rep)}),handleVhsMediaChange(qualityLevels,vhs.playlists)}(_this5.qualityLevels_,_this5)}),this.playlists.on("mediachange",function(){handleVhsMediaChange(_this5.qualityLevels_,_this5.playlists)}))},VhsHandler.version=function(){return{"@videojs/http-streaming":"2.12.0","mux.js":"5.14.1","mpd-parser":"0.19.2","m3u8-parser":"4.7.0","aes-decrypter":"3.1.2"}},_proto.version=function(){return this.constructor.version()},_proto.canChangeType=function(){return SourceUpdater.canChangeType()},_proto.play=function(){this.masterPlaylistController_.play()},_proto.setCurrentTime=function(currentTime){this.masterPlaylistController_.setCurrentTime(currentTime)},_proto.duration=function(){return this.masterPlaylistController_.duration()},_proto.seekable=function(){return this.masterPlaylistController_.seekable()},_proto.dispose=function(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.masterPlaylistController_&&this.masterPlaylistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.player_&&(delete this.player_.vhs,delete this.player_.dash,delete this.player_.hls),this.tech_&&this.tech_.vhs&&delete this.tech_.vhs,this.tech_&&delete this.tech_.hls,this.mediaSourceUrl_&&window_default().URL.revokeObjectURL&&(window_default().URL.revokeObjectURL(this.mediaSourceUrl_),this.mediaSourceUrl_=null),_Component.prototype.dispose.call(this)},_proto.convertToProgramTime=function(time,callback){return function(_ref){var playlist=_ref.playlist,_ref$time=_ref.time,time=void 0===_ref$time?void 0:_ref$time,callback=_ref.callback;if(!callback)throw new Error("getProgramTime: callback must be provided");if(!playlist||void 0===time)return callback({message:"getProgramTime: playlist and time must be provided"});var matchedSegment=function(time,playlist){if(!playlist||!playlist.segments||0===playlist.segments.length)return null;for(var segment,segmentEnd=0,i=0;i<playlist.segments.length&&!(time<=(segmentEnd=(segment=playlist.segments[i]).videoTimingInfo?segment.videoTimingInfo.transmuxedPresentationEnd:segmentEnd+segment.duration));i++);var lastSegment=playlist.segments[playlist.segments.length-1];if(lastSegment.videoTimingInfo&&lastSegment.videoTimingInfo.transmuxedPresentationEnd<time)return null;if(time>segmentEnd){if(time>segmentEnd+.25*lastSegment.duration)return null;segment=lastSegment}return{segment:segment,estimatedStart:segment.videoTimingInfo?segment.videoTimingInfo.transmuxedPresentationStart:segmentEnd-segment.duration,type:segment.videoTimingInfo?"accurate":"estimate"}}(time,playlist);if(!matchedSegment)return callback({message:"valid programTime was not found"});if("estimate"===matchedSegment.type)return callback({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:matchedSegment.estimatedStart});var programTimeObject={mediaSeconds:time},programTime=function(playerTime,segment){if(!segment.dateTimeObject)return null;var offsetFromSegmentStart=playerTime-(segment.videoTimingInfo.transmuxedPresentationStart+segment.videoTimingInfo.transmuxerPrependedSeconds);return new Date(segment.dateTimeObject.getTime()+1e3*offsetFromSegmentStart)}(time,matchedSegment.segment);return programTime&&(programTimeObject.programDateTime=programTime.toISOString()),callback(null,programTimeObject)}({playlist:this.masterPlaylistController_.media(),time:time,callback:callback})},_proto.seekToProgramTime=function(programTime,callback,pauseAfterSeek,retryCount){return void 0===pauseAfterSeek&&(pauseAfterSeek=!0),void 0===retryCount&&(retryCount=2),seekToProgramTime({programTime:programTime,playlist:this.masterPlaylistController_.media(),retryCount:retryCount,pauseAfterSeek:pauseAfterSeek,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:callback})},VhsHandler}(videojs.getComponent("Component")),VhsSourceHandler={name:"videojs-http-streaming",VERSION:"2.12.0",canHandleSource:function(srcObj,options){void 0===options&&(options={});var localOptions=videojs.mergeOptions(videojs.options,options);return VhsSourceHandler.canPlayType(srcObj.type,localOptions)},handleSource:function(source,tech,options){void 0===options&&(options={});var localOptions=videojs.mergeOptions(videojs.options,options);return tech.vhs=new VhsHandler(source,tech,localOptions),videojs.hasOwnProperty("hls")||Object.defineProperty(tech,"hls",{get:function(){return videojs.log.warn("player.tech().hls is deprecated. Use player.tech().vhs instead."),tech.vhs},configurable:!0}),tech.vhs.xhr=xhrFactory(),tech.vhs.src(source.src,source.type),tech.vhs},canPlayType:function(type,options){void 0===options&&(options={});var _videojs$mergeOptions2=videojs.mergeOptions(videojs.options,options).vhs.overrideNative,overrideNative=void 0===_videojs$mergeOptions2?!videojs.browser.IS_ANY_SAFARI:_videojs$mergeOptions2,supportedType=simpleTypeFromSourceType(type);return!supportedType||Vhs.supportsTypeNatively(supportedType)&&!overrideNative?"":"maybe"}};browserSupportsCodec("avc1.4d400d,mp4a.40.2")&&videojs.getTech("Html5").registerSourceHandler(VhsSourceHandler,0),videojs.VhsHandler=VhsHandler,Object.defineProperty(videojs,"HlsHandler",{get:function(){return videojs.log.warn("videojs.HlsHandler is deprecated. Use videojs.VhsHandler instead."),VhsHandler},configurable:!0}),videojs.VhsSourceHandler=VhsSourceHandler,Object.defineProperty(videojs,"HlsSourceHandler",{get:function(){return videojs.log.warn("videojs.HlsSourceHandler is deprecated. Use videojs.VhsSourceHandler instead."),VhsSourceHandler},configurable:!0}),videojs.Vhs=Vhs,Object.defineProperty(videojs,"Hls",{get:function(){return videojs.log.warn("videojs.Hls is deprecated. Use videojs.Vhs instead."),Vhs},configurable:!0}),videojs.use||(videojs.registerComponent("Hls",Vhs),videojs.registerComponent("Vhs",Vhs)),videojs.options.vhs=videojs.options.vhs||{},videojs.options.hls=videojs.options.hls||{},videojs.getPlugin&&videojs.getPlugin("reloadSourceOnError")||(videojs.registerPlugin||videojs.plugin)("reloadSourceOnError",function(options){initPlugin(this,options)});const video_es=videojs;var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},videojs_hls_quality_selector_es_classCallCheck=(function(){function AwaitValue(value){this.value=value}function AsyncGenerator(gen){var front,back;function resume(key,arg){try{var result=gen[key](arg),value=result.value;value instanceof AwaitValue?Promise.resolve(value.value).then(function(arg){resume("next",arg)},function(arg){resume("throw",arg)}):settle(result.done?"return":"normal",result.value)}catch(err){settle("throw",err)}}function settle(type,value){switch(type){case"return":front.resolve({value:value,done:!0});break;case"throw":front.reject(value);break;default:front.resolve({value:value,done:!1})}(front=front.next)?resume(front.key,front.arg):back=null}this._invoke=function(key,arg){return new Promise(function(resolve,reject){var request={key:key,arg:arg,resolve:resolve,reject:reject,next:null};back?back=back.next=request:(front=back=request,resume(key,arg))})},"function"!=typeof gen.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(AsyncGenerator.prototype[Symbol.asyncIterator]=function(){return this}),AsyncGenerator.prototype.next=function(arg){return this._invoke("next",arg)},AsyncGenerator.prototype.throw=function(arg){return this._invoke("throw",arg)},AsyncGenerator.prototype.return=function(arg){return this._invoke("return",arg)}}(),function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}),videojs_hls_quality_selector_es_inherits=function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)},possibleConstructorReturn=function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call},VideoJsButtonClass=video_es.getComponent("MenuButton"),VideoJsMenuClass=video_es.getComponent("Menu"),VideoJsComponent=video_es.getComponent("Component"),videojs_hls_quality_selector_es_Dom=video_es.dom,ConcreteButton=function(_VideoJsButtonClass){function ConcreteButton(player){return videojs_hls_quality_selector_es_classCallCheck(this,ConcreteButton),possibleConstructorReturn(this,_VideoJsButtonClass.call(this,player,{title:player.localize("Quality"),name:"QualityButton"}))}return videojs_hls_quality_selector_es_inherits(ConcreteButton,_VideoJsButtonClass),ConcreteButton.prototype.createItems=function(){return[]},ConcreteButton.prototype.createMenu=function(){var string,menu=new VideoJsMenuClass(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){var titleEl=videojs_hls_quality_selector_es_Dom.createEl("li",{className:"vjs-menu-title",innerHTML:(string=this.options_.title,"string"!=typeof string?string:string.charAt(0).toUpperCase()+string.slice(1)),tabIndex:-1}),titleComponent=new VideoJsComponent(this.player_,{el:titleEl});this.hideThreshold_+=1,menu.addItem(titleComponent)}if(this.items=this.createItems(),this.items)for(var i=0;i<this.items.length;i++)menu.addItem(this.items[i]);return menu},ConcreteButton}(VideoJsButtonClass),ConcreteMenuItem=function(_VideoJsMenuItemClass){function ConcreteMenuItem(player,item,qualityButton,plugin){videojs_hls_quality_selector_es_classCallCheck(this,ConcreteMenuItem);var _this=possibleConstructorReturn(this,_VideoJsMenuItemClass.call(this,player,{label:item.label,selectable:!0,selected:item.selected||!1}));return _this.item=item,_this.qualityButton=qualityButton,_this.plugin=plugin,_this}return videojs_hls_quality_selector_es_inherits(ConcreteMenuItem,_VideoJsMenuItemClass),ConcreteMenuItem.prototype.handleClick=function(){for(var i=0;i<this.qualityButton.items.length;++i)this.qualityButton.items[i].selected(!1);this.plugin.setQuality(this.item.value),this.selected(!0)},ConcreteMenuItem}(video_es.getComponent("MenuItem")),videojs_hls_quality_selector_es_defaults={},videojs_hls_quality_selector_es_registerPlugin=video_es.registerPlugin||video_es.plugin,HlsQualitySelectorPlugin=function(){function HlsQualitySelectorPlugin(player,options){videojs_hls_quality_selector_es_classCallCheck(this,HlsQualitySelectorPlugin),this.player=player,this.config=options,this.player.qualityLevels&&this.getHls()&&(this.createQualityButton(),this.bindPlayerEvents())}return HlsQualitySelectorPlugin.prototype.getHls=function(){return this.player.tech({IWillNotUseThisInPlugins:!0}).hls},HlsQualitySelectorPlugin.prototype.bindPlayerEvents=function(){this.player.qualityLevels().on("addqualitylevel",this.onAddQualityLevel.bind(this))},HlsQualitySelectorPlugin.prototype.createQualityButton=function(){var player=this.player;this._qualityButton=new ConcreteButton(player);var placementIndex=player.controlBar.children().length-2,concreteButtonInstance=player.controlBar.addChild(this._qualityButton,{componentClass:"qualitySelector"},this.config.placementIndex||placementIndex);if(concreteButtonInstance.addClass("vjs-quality-selector"),this.config.displayCurrentQuality)this.setButtonInnerText("auto");else{var icon=" "+(this.config.vjsIconClass||"vjs-icon-hd");concreteButtonInstance.menuButton_.$(".vjs-icon-placeholder").className+=icon}concreteButtonInstance.removeClass("vjs-hidden")},HlsQualitySelectorPlugin.prototype.setButtonInnerText=function(text){this._qualityButton.menuButton_.$(".vjs-icon-placeholder").innerHTML=text},HlsQualitySelectorPlugin.prototype.getQualityMenuItem=function(item){return new ConcreteMenuItem(this.player,item,this._qualityButton,this)},HlsQualitySelectorPlugin.prototype.onAddQualityLevel=function(){for(var _this=this,player=this.player,levels=player.qualityLevels().levels_||[],levelItems=[],_loop=function(i){if(!levelItems.filter(function(_existingItem){return _existingItem.item&&_existingItem.item.value===levels[i].height}).length){var levelItem=_this.getQualityMenuItem.call(_this,{label:levels[i].height+"p",value:levels[i].height});levelItems.push(levelItem)}},i=0;i<levels.length;++i)_loop(i);levelItems.sort(function(current,next){return"object"!==(void 0===current?"undefined":_typeof(current))||"object"!==(void 0===next?"undefined":_typeof(next))||current.item.value<next.item.value?-1:current.item.value>next.item.value?1:0}),levelItems.push(this.getQualityMenuItem.call(this,{label:player.localize("Auto"),value:"auto",selected:!0})),this._qualityButton&&(this._qualityButton.createItems=function(){return levelItems},this._qualityButton.update())},HlsQualitySelectorPlugin.prototype.setQuality=function(height){var qualityList=this.player.qualityLevels();this._currentQuality=height,this.config.displayCurrentQuality&&this.setButtonInnerText("auto"===height?height:height+"p");for(var i=0;i<qualityList.length;++i){var quality=qualityList[i];quality.enabled=quality.height===height||"auto"===height}this._qualityButton.unpressButton()},HlsQualitySelectorPlugin.prototype.getCurrentQuality=function(){return this._currentQuality||"auto"},HlsQualitySelectorPlugin}(),hlsQualitySelector=function(options){var _this2=this;this.ready(function(){!function(player,options){player.addClass("vjs-hls-quality-selector"),player.hlsQualitySelector=new HlsQualitySelectorPlugin(player,options)}(_this2,video_es.mergeOptions(videojs_hls_quality_selector_es_defaults,options))})};function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}videojs_hls_quality_selector_es_registerPlugin("hlsQualitySelector",hlsQualitySelector),hlsQualitySelector.VERSION="1.1.4";var QualityLevel=function QualityLevel(representation){var level=this;if(video_es.browser.IS_IE8)for(var prop in level=document_default().createElement("custom"),QualityLevel.prototype)"constructor"!==prop&&(level[prop]=QualityLevel.prototype[prop]);return level.id=representation.id,level.label=level.id,level.width=representation.width,level.height=representation.height,level.bitrate=representation.bandwidth,level.enabled_=representation.enabled,Object.defineProperty(level,"enabled",{get:function(){return level.enabled_()},set:function(enable){level.enabled_(enable)}}),level},QualityLevelList=function(_videojs$EventTarget){
/*! @name videojs-contrib-quality-levels @version 2.1.0 @license Apache-2.0 */
var subClass,superClass;function QualityLevelList(){var _this,list=_assertThisInitialized(_assertThisInitialized(_this=_videojs$EventTarget.call(this)||this));if(video_es.browser.IS_IE8)for(var prop in list=document_default().createElement("custom"),QualityLevelList.prototype)"constructor"!==prop&&(list[prop]=QualityLevelList.prototype[prop]);return list.levels_=[],list.selectedIndex_=-1,Object.defineProperty(list,"selectedIndex",{get:function(){return list.selectedIndex_}}),Object.defineProperty(list,"length",{get:function(){return list.levels_.length}}),list||_assertThisInitialized(_this)}superClass=_videojs$EventTarget,(subClass=QualityLevelList).prototype=Object.create(superClass.prototype),subClass.prototype.constructor=subClass,subClass.__proto__=superClass;var _proto=QualityLevelList.prototype;return _proto.addQualityLevel=function(representation){var qualityLevel=this.getQualityLevelById(representation.id);if(qualityLevel)return qualityLevel;var index=this.levels_.length;return qualityLevel=new QualityLevel(representation),""+index in this||Object.defineProperty(this,index,{get:function(){return this.levels_[index]}}),this.levels_.push(qualityLevel),this.trigger({qualityLevel:qualityLevel,type:"addqualitylevel"}),qualityLevel},_proto.removeQualityLevel=function(qualityLevel){for(var removed=null,i=0,l=this.length;i<l;i++)if(this[i]===qualityLevel){removed=this.levels_.splice(i,1)[0],this.selectedIndex_===i?this.selectedIndex_=-1:this.selectedIndex_>i&&this.selectedIndex_--;break}return removed&&this.trigger({qualityLevel:qualityLevel,type:"removequalitylevel"}),removed},_proto.getQualityLevelById=function(id){for(var i=0,l=this.length;i<l;i++){var level=this[i];if(level.id===id)return level}return null},_proto.dispose=function(){this.selectedIndex_=-1,this.levels_.length=0},QualityLevelList}(video_es.EventTarget);for(var videojs_contrib_quality_levels_es_event in QualityLevelList.prototype.allowedEvents_={change:"change",addqualitylevel:"addqualitylevel",removequalitylevel:"removequalitylevel"},QualityLevelList.prototype.allowedEvents_)QualityLevelList.prototype["on"+videojs_contrib_quality_levels_es_event]=null;var qualityLevels=function(options){return player=this,video_es.mergeOptions({},options),originalPluginFn=player.qualityLevels,qualityLevelList=new QualityLevelList,player.on("dispose",function disposeHandler(){qualityLevelList.dispose(),player.qualityLevels=originalPluginFn,player.off("dispose",disposeHandler)}),player.qualityLevels=function(){return qualityLevelList},player.qualityLevels.VERSION="2.1.0",qualityLevelList;var player,originalPluginFn,qualityLevelList};
/*! @name @yangkghjh/videojs-aspect-ratio-panel @version 0.0.1 @license MIT */
function videojs_aspect_ratio_panel_es_inheritsLoose(subClass,superClass){subClass.prototype=Object.create(superClass.prototype),subClass.prototype.constructor=subClass,subClass.__proto__=superClass}function videojs_aspect_ratio_panel_es_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(video_es.registerPlugin||video_es.plugin)("qualityLevels",qualityLevels),qualityLevels.VERSION="2.1.0";var videojs_aspect_ratio_panel_es_MenuButton=video_es.getComponent("MenuButton"),ResizerButton=function(_MenuButton){function ResizerButton(player,options){var _this;return _this=_MenuButton.call(this,player,{name:"ResizerButton"})||this,videojs_aspect_ratio_panel_es_MenuButton.apply(videojs_aspect_ratio_panel_es_assertThisInitialized(_this),arguments),_this.controlText(player.localize("Aspect Ratio")),_this}videojs_aspect_ratio_panel_es_inheritsLoose(ResizerButton,_MenuButton);var _proto=ResizerButton.prototype;return _proto.createEl=function(){return video_es.dom.createEl("div",{className:"vjs-menu-button vjs-menu-button-popup vjs-control vjs-button"})},_proto.buildCSSClass=function(){return videojs_aspect_ratio_panel_es_MenuButton.prototype.buildCSSClass.call(this)+" vjs-icon-cog"},_proto.update=function(){return videojs_aspect_ratio_panel_es_MenuButton.prototype.update.call(this)},_proto.handleClick=function(){this.player().getChild("ResizerPanel").toggleClass("vjs-hidden")},ResizerButton}(videojs_aspect_ratio_panel_es_MenuButton),videojs_aspect_ratio_panel_es_Component=video_es.getComponent("Component"),ResizerPanel=function(_Component){function ResizerPanel(player,options){var _this;_this=_Component.call(this,player,options)||this,videojs_aspect_ratio_panel_es_Component.apply(videojs_aspect_ratio_panel_es_assertThisInitialized(_this),arguments),_this.aspectRadio="origin",_this.percent=100,_this.radioWidth=1,_this.radioHeight=1,_this.currentHeight=_this.player().currentHeight(),_this.currentWidth=_this.player().currentWidth();var el=_this.el();el.childNodes[1].childNodes[1].onclick=function(){_this.toggleClass("vjs-hidden")},window.addEventListener("resize",function(){_this.currentHeight==_this.player().currentHeight()&&_this.currentWidth==_this.player().currentWidth()||(_this.currentHeight=_this.player().currentHeight(),_this.currentWidth=_this.player().currentWidth(),_this.resize())}),el.onmouseup=function(){el.onmousemove=null};var scroll=el.childNodes[1].childNodes[5].childNodes[1].childNodes[3];_this.setScrollFunc(el,scroll,function(data){_this.setPercent(data)}),_this.player().on("play",function(){_this.resize()});for(var radiosDiv=el.childNodes[1].childNodes[5].childNodes[3].childNodes,radios=[radiosDiv[1],radiosDiv[5],radiosDiv[9],radiosDiv[13]],prev="origin",i=0;i<radios.length;i++)radios[i].onchange=function(event){event.target.value!==prev&&(prev=event.target.value,_this.setAspectRadio(event.target.value))};var resetDiv=el.childNodes[1].childNodes[5].childNodes[5].childNodes[1];return resetDiv.onclick=function(event){radios[0].checked=!0,_this.reset()},_this}videojs_aspect_ratio_panel_es_inheritsLoose(ResizerPanel,_Component);var _proto=ResizerPanel.prototype;return _proto.setAspectRadio=function(radio){switch(radio){case"origin":this.aspectRadio="origin";break;case"fill":this.aspectRadio="fill";break;case"16:9":this.aspectRadio="16:9",this.radioWidth=16,this.radioHeight=9;break;case"4:3":this.aspectRadio="4:3",this.radioWidth=4,this.radioHeight=3}this.resize()},_proto.setPercent=function(percent){this.percent=percent,this.resize()},_proto.reset=function(){this.player().tech_.el().style.objectFit="contain",this.aspectRadio="origin",this.percent=100;var scroll=this.el().childNodes[1].childNodes[5].childNodes[1].childNodes[3];scroll.childNodes[1].style.left="255px",scroll.childNodes[3].style.width="255px",this.resize()},_proto.resize=function(){if(this.player().tech_.el().style.objectFit="origin"!=this.aspectRadio?"fill":"contain","origin"!=this.aspectRadio&&"fill"!=this.aspectRadio){var width=this.currentWidth,height=width*this.radioHeight/this.radioWidth;this.currentWidth/this.currentHeight>this.radioWidth/this.radioHeight&&(width=(height=this.currentHeight)*this.radioWidth/this.radioHeight),this.setPadding((this.currentWidth-width*this.percent/100)/2,(this.currentHeight-height*this.percent/100)/2)}else this.setPadding(this.currentWidth*(100-this.percent)/100/2,this.currentHeight*(100-this.percent)/100/2)},_proto.setPadding=function(w,h){w<0&&(w=0),this.player().tech_.el().style.paddingLeft=w+"px",this.player().tech_.el().style.paddingRight=w+"px",h<0&&(h=0),this.player().tech_.el().style.paddingTop=h+"px",this.player().tech_.el().style.paddingBottom=h+"px"},_proto.setScrollFunc=function(scrollDiv,scrollDom,callback){var mask=scrollDom.childNodes[3],barleft=0;scrollDom.childNodes[1].onmousedown=function(e){var leftVal=(e||window.event).clientX-this.offsetLeft,that=this;scrollDiv.onmousemove=function(e){var event=e||window.event;(barleft=event.clientX-leftVal)<0?barleft=0:barleft>255&&(barleft=255),mask.style.width=barleft+"px",that.style.left=barleft+"px",callback(parseInt(barleft/255*100)),window.getSelection?window.getSelection().removeAllRanges():document.selection.empty()}}},_proto.createEl=function(){return video_es.dom.createEl("div",{className:"vjs-resizer-modal vjs-hidden",innerHTML:'\n        <div class="vjs-resizer-modal-content">\n        <span class="vjs-resizer-modal-close">&times;</span>\n          <div class="vjs-resizer-modal-title">Aspect Ratio</div>\n          <div class="vjs-resizer-wrap">\n            <div class="vjs-resizer-size">\n              <span class="size-title">Size</span>\n              <div class="size-scroll" id="size-scroll">\n                <div class="size-scroll-bar"></div>\n                <div class="size-scroll-mask"></div>\n              </div>\n            </div>\n            <div class="radios">\n              Ratio\n              <input type="radio" name="radio" id="origin" value="origin" checked >\n              <label for="origin">Default</label>\n              <input type="radio" name="radio" id="4:3" value="4:3">\n              <label for="4:3">4:3</label>\n              <input type="radio" name="radio" id="16:9" value="16:9">\n              <label for="16:9">16:9</label>\n              <input type="radio" name="radio" id="fill" value="fill">\n              <label for="fill">Full</label>\n            </div>\n            <ul style="clear:both">\n                <li id="vjs-resizer-reset">Reset</li>\n            </ul>\n          </div>\n        </div>\n        '})},ResizerPanel}(videojs_aspect_ratio_panel_es_Component),videojs_aspect_ratio_panel_es_Plugin=video_es.getPlugin("plugin"),videojs_aspect_ratio_panel_es_defaults={},AspectRatioPanel=function(_Plugin){function AspectRatioPanel(player,options){var _this;return(_this=_Plugin.call(this,player)||this).options=video_es.mergeOptions(videojs_aspect_ratio_panel_es_defaults,options),_this.player.ready(function(){if(_this.player.addClass("vjs-aspect-ratio-panel"),"Html5"!=player.techName_)return!1;player.on(["loadedmetadata"],function(e){if("undefined"==player.aspect_ratio_initialized||1==player.aspect_ratio_initialized);else{player.aspect_ratio_initialized=!0;var controlBar=player.controlBar,fullscreenToggle=controlBar.getChild("fullscreenToggle").el();controlBar.el().insertBefore(controlBar.addChild("ResizerButton").el(),fullscreenToggle),player.addChild("ResizerPanel")}})}),video_es.registerComponent("ResizerButton",ResizerButton),video_es.registerComponent("ResizerPanel",ResizerPanel),_this}return videojs_aspect_ratio_panel_es_inheritsLoose(AspectRatioPanel,_Plugin),AspectRatioPanel}(videojs_aspect_ratio_panel_es_Plugin);AspectRatioPanel.defaultState={},AspectRatioPanel.VERSION="0.0.1",video_es.registerPlugin("aspectRatioPanel",AspectRatioPanel);var vjs_player_component_c0=["target"],VjsPlayerComponent=function(){var VjsPlayerComponent=function(){function VjsPlayerComponent(){(0,classCallCheck.Z)(this,VjsPlayerComponent)}return(0,createClass.Z)(VjsPlayerComponent,[{key:"ngOnInit",value:function(){this.player=video_es(this.target.nativeElement,Object.assign(Object.assign({},this.options),{autoplay:!0}),function(){this.volume(100)}),this.player.hlsQualitySelector({displayCurrentQuality:!0}),this.player.aspectRatioPanel()}},{key:"ngOnChanges",value:function(changes){changes.options.previousValue&&this.player.src(changes.options.currentValue.sources[0])}},{key:"ngOnDestroy",value:function(){this.player&&this.player.dispose()}}]),VjsPlayerComponent}();return VjsPlayerComponent.\u0275fac=function(t){return new(t||VjsPlayerComponent)},VjsPlayerComponent.\u0275cmp=core.Xpm({type:VjsPlayerComponent,selectors:[["app-vjs-player"]],viewQuery:function(rf,ctx){var _t;1&rf&&core.Gf(vjs_player_component_c0,7),2&rf&&core.iGM(_t=core.CRH())&&(ctx.target=_t.first)},inputs:{options:"options"},features:[core.TTD],decls:3,vars:0,consts:[["controls","","muted","","playsinline","","preload","none","data-setup",'{"liveui": true, "muted": false}',1,"video-js"],["target",""]],template:function(rf,ctx){1&rf&&(core._UZ(0,"video",0,1),core._uU(2,"\n"))},styles:['@charset "UTF-8";.vjs-modal-dialog .vjs-modal-dialog-content,.video-js .vjs-modal-dialog,.vjs-button>.vjs-icon-placeholder:before,.video-js .vjs-big-play-button .vjs-icon-placeholder:before{position:absolute;top:0;left:0;width:100%;height:100%}.vjs-button>.vjs-icon-placeholder:before,.video-js .vjs-big-play-button .vjs-icon-placeholder:before{text-align:center}@font-face{font-family:VideoJS;src:url(data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAABDkAAsAAAAAG6gAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAADsAAABUIIslek9TLzIAAAFEAAAAPgAAAFZRiV3hY21hcAAAAYQAAADaAAADPv749/pnbHlmAAACYAAAC3AAABHQZg6OcWhlYWQAAA3QAAAAKwAAADYZw251aGhlYQAADfwAAAAdAAAAJA+RCLFobXR4AAAOHAAAABMAAACM744AAGxvY2EAAA4wAAAASAAAAEhF6kqubWF4cAAADngAAAAfAAAAIAE0AIFuYW1lAAAOmAAAASUAAAIK1cf1oHBvc3QAAA/AAAABJAAAAdPExYuNeJxjYGRgYOBiMGCwY2BycfMJYeDLSSzJY5BiYGGAAJA8MpsxJzM9kYEDxgPKsYBpDiBmg4gCACY7BUgAeJxjYGS7wTiBgZWBgaWQ5RkDA8MvCM0cwxDOeI6BgYmBlZkBKwhIc01hcPjI+FGJHcRdyA4RZgQRADK3CxEAAHic7dFZbsMgAEXRS0ycyZnnOeG7y+qC8pU1dHusIOXxuoxaOlwZYWQB0Aea4quIEN4E9LzKbKjzDeM6H/mua6Lmc/p8yhg0lvdYx15ZG8uOLQOGjMp3EzqmzJizYMmKNRu27Nhz4MiJMxeu3Ljz4Ekqm7T8P52G8PP3lnTOVk++Z6iN6QZzNN1F7ptuN7eGOjDUoaGODHVsuvU8MdTO9Hd5aqgzQ50b6sJQl4a6MtS1oW4MdWuoO0PdG+rBUI+GejLUs6FeDPVqqDdDvRvqw1CfhpqM9At0iFLaAAB4nJ1YDXBTVRZ+5/22TUlJ8we0pHlJm7RJf5O8F2j6EymlSPkpxaL8U2xpa3DKj0CBhc2IW4eWKSokIoLsuMqssM64f+jA4HSdWXXXscBq67IOs3FXZ1ZYWVyRFdo899yXtIBQZ90k7717zz3v3HPPOfd854YCCj9cL9dL0RQFOqCbGJnrHb5EayiKIWN8iA/hWBblo6hUWm8TtCDwE80WMJus/irwyxOdxeB0MDb14VNJHnXYoLLSl6FfCUYO9nYPTA8Epg9090LprfbBbZ2hY0UlJUXHQp3/vtWkS6EBv8+rPMq5u9692f/dNxJNiqwC1xPE9TCUgCsSdQWgE3XQD25lkG4CN2xmTcOXWBOyser6RN6KnGbKSbmQ3+d0OI1m2W8QzLLkI2sykrWAgJJEtA8vGGW/2Q+CmT3n8zS9wZwu2DCvtuZKZN3xkrLh36yCZuUomQSqGpY8t/25VfHVhw8z4ebGBtfLb0ya9PCaDc+8dGTvk2dsh6z7WzvowlXKUSWo9MJ15a3KrEP2loOr2Ojhw6iW6hf2BDdEccQvZGpaAy7YovSwq8kr7HGllxpd71rkS6G0Sf11sl9OvMK1+jwPPODxjUwkOim9CU3ix1wNjXDfmJSEn618Bs6lpWwUpU+8PCqLMY650zjq8VhCIP17NEKTx3eaLL+s5Pi6yJWaWjTHLR1jYzPSV9VF/6Ojdb/1kO3Mk3uhHC0x6gc1BjlKQ+nQFxTYdaJkZ7ySVxLBbhR1dsboNXp1tCYKW2LRaEzpYcIx2BKNxaL0ZaUnSqfFoiNhHKR/GkX6PWUSAaJelQaqZL1EpoHNsajSEyPSoJ9IjhIxTdjHLmwZvhRDOiFTY/YeQnvrVZmiTQtGncECXtFTBZLOVwwMRgoXHAkXzMzPn1nAJJ8jYSbMDaqN2waGLzNhih/bZynUBMpIWSg7VYi7DRx2m8ALkIdRCJwI6ArJx2EI8kaDWeTQKeAFk9fjl/1AvwktjQ1P7NjyMGQyfd4vjipX6M/i52D7Cq80kqlcxEcGXRr/FEcgs0u5uGgB4VWuMFfpdn2Re6Hi3PqzmxWKsz6+ae2Pn9hXXw/fqM859UiGC0oKYYILJBqJrsn1Z1E5qOs9rQCiUQRREjm8yJcbHF5cUJufX1vAHlefw0XgUoboS3ETfQlTxBC4SOtuE8VPRJTBSCQSjZCpk7Gqzu+masaZ2y7Zjehho4F3g82BNDkAHpORG4+OCS+f6JTPmtRn/PH1kch6d04sp7AQb25aQ/pqUyXeQ8vrebG8OYQdXOQ+585u0sdW9rqalzRURiJ+9F4MweRFrKUjl1GUYhH1A27WOHw5cTFSFPMo9EeUIGnQTZHIaJ7AHLaOKsOODaNF9jkBjYG2QEsQ2xjMUAx2bBEbeTBWMHwskBjngq56S/yfgkBnWBa4K9sqKtq2t1UI8S9He5XuBRbawAdatrQEAi30Aks2+LM8WeCbalVZkWNylvJ+dqJnzVb+OHlSoKW8nPCP7Rd+CcZ2DdWAGqJ2CBFOphgywFFCFBNtfAbGtNPBCwxvygHeYMZMY9ZboBqwq/pVrsbgN5tkv152ODlbMfiqwGMBgxa4Exz3QhovRIUp6acqZmQzRq0ypDXS2TPLT02YIkQETnOE445oOGxOmXAqUJNNG7XgupMjPq2ua9asrj5yY/yuKteO1Kx0YNJTufrirLe1mZnat7OL6rnUdCWenpW6I8mAnbsY8KWs1PuSovCW9A/Z25PQ24a7cNOqgmTkLmBMgh4THgc4b9k2IVv1/g/F5nGljwPLfOgHAzJzh45V/4+WenTzmMtR5Z7us2Tys909UHqrPY7KbckoxRvRHhmVc3cJGE97uml0R1S0jdULVl7EvZtDFVBF35N9cEdjpgmAiOlFZ+Dtoh93+D3zzHr8RRNZQhnCNMNbcegOvpEwZoL+06cJQ07h+th3fZ/7PVbVC6ngTAV/KoLFuO6+2KFcU651gEb5ugPSIb1D+Xp8V4+k3sEIGnw5mYe4If4k1lFYr6SCzmM2EQ8iWtmwjnBI9kTwe1TlfAmXh7H02by9fW2gsjKwtv0aaURKil4OdV7rDL1MXIFNrhdxohcZXYTnq47WisrKitaObbf5+yvkLi5J6lCNZZ+B6GC38VNBZBDidSS/+mSvh6s+srgC8pyKMvDtt+de3c9fU76ZPfuM8ud4Kv0fyP/LqfepMT/3oZxSqpZaTa1DaQYLY8TFsHYbWYsPoRhRWfL5eSSQbhUGgGC3YLbVMk6PitTFNGpAsNrC6D1VNBKgBHMejaiuRWEWGgsSDBTJjqWIl8kJLlsaLJ2tXDr6xGfT85bM2Q06a46x2HTgvdnV8z5YDy/27J4zt6x2VtkzjoYpkq36kaBr4eQSg7tyiVweWubXZugtadl58ydapfbORfKsDTuZ0OBgx4cfdjCf5tbWNITnL120fdOi1RV1C3uKGzNdwYLcMvZ3BxoPyTOCD1XvXTp7U10gWCVmTV9b3r2z0SkGWovb2hp9I89O8a2smlyaO8muMU+dRmtzp60IzAoFpjLr1n388boLyf0dRvxhsHZ0qbWqDkwqvvpkj4l0fY6EIXRi5sQSrAvsVYwXRy4qJ2EVtD1AN7a0HWth9ymvL1xc3WTUKK/TAHA/bXDVtVWfOMfuGxGZv4Ln/jVr9jc3j1yMv0tndmyt9Vq88Y9gH1wtLX3KWjot5++jWHgAoZZkQ14wGQ20Fli71UmKJAy4xKMSTGbVdybW7FDDAut9XpD5AzWrYO7zQ8qffqF8+Ynd/clrHcdyxGy3a/3+mfNnzC/cBsveTjnTvXf1o6vzOlZw7WtqtdmPK/Errz/6NNtD72zmNOZfbmYdTGHfoofqI79Oc+R2n1lrnL6pOm0Up7kwxhTW12Amm7WYkXR2qYrF2AmgmbAsxZjwy1xpg/m1Je2vrp8v/nz2xpmlBg4E9hrMU341wVpTOh/OfmGvAnra8q6uctr60ZQHV3Q+WMQJykMj8ZsWn2QBOmmHMB+m5pDIpTFonYigiaKAhGEiAHF7EliVnQkjoLVIMPtJpBKHYd3A8GYH9jJzrWwmHx5Qjp7vDAX0suGRym1vtm/9W1/HyR8vczfMs6Sk8DSv855/5dlX9oQq52hT8syyp2rx5Id17IAyAM3wIjQPMOHzytEB64q6D5zT91yNbnx3V/nqnd017S9Y0605k3izoXLpsxde2n38yoOV9s1LcjwzNjbdX6asnBVaBj/6/DwKwPkpcqbDG7BnsXoSqWnUAmottYF6jMSdVyYZh3zVXCjwTiwwHH6sGuRiEHQGzuRX6whZkp123oy1BWE2mEfJ/tvIRtM4ZM5bDXiMsPMaAKOTyc5uL57rqyyc5y5JE5pm1i2S2iUX0CcaQ6lC6Zog7JqSqZmYlosl2K6pwNA84zRnQW6SaALYZQGW5lhCtU/W34N6o+bKfZ8cf3/Cl/+iTX3wBzpOY4mRkeNf3rptycGSshQWgGbYt5jFc2e0+DglIrwl6DVWQ7BuwaJ3Xk1J4VL5urnLl/Wf+gHU/hZoZdKNym6lG+I34FaNeZKcSpJIo2IeCVvpdsDGfKvzJnAwmeD37Ow65ZWwSowpgwX5T69s/rB55dP5BcpgDKFV8p7q2sn/1uc93bVzT/w6UrCqDTWvfCq/oCD/qZXNoUj8BL5Kp6GU017frfNXkAtiiyf/SOCEeLqnd8R/Ql9GlCRfctS6k5chvIBuQ1zCCjoCHL2DHNHIXxMJ3kQeO8lbsUXONeSfA5EjcG6/E+KdhN4bP04vBhdi883+BFBzQbxFbvZzQeY9LNBZc0FNfn5NwfDn6rCTnTw6R8o+gfpf5hCom33cRuiTlss3KHmZjD+BPN+5gXuA2ziS/Q73mLxUkpbKN/eqwz5uK0X9F3h2d1V4nGNgZGBgAOJd776+iue3+crAzc4AAje5Bfcg0xz9YHEOBiYQBQA8FQlFAHicY2BkYGBnAAGOPgaG//85+hkYGVCBMgBGGwNYAAAAeJxjYGBgYB8EmKOPgQEAQ04BfgAAAAAAAA4AaAB+AMwA4AECAUIBbAGYAcICGAJYArQC4AMwA7AD3gQwBJYE3AUkBWYFigYgBmYGtAbqB1gIEghYCG4IhAi2COh4nGNgZGBgUGYoZWBnAAEmIOYCQgaG/2A+AwAYCQG2AHicXZBNaoNAGIZfE5PQCKFQ2lUps2oXBfOzzAESyDKBQJdGR2NQR3QSSE/QE/QEPUUPUHqsvsrXjTMw83zPvPMNCuAWP3DQDAejdm1GjzwS7pMmwi75XngAD4/CQ/oX4TFe4Qt7uMMbOzjuDc0EmXCP/C7cJ38Iu+RP4QEe8CU8pP8WHmOPX2EPz87TPo202ey2OjlnQSXV/6arOjWFmvszMWtd6CqwOlKHq6ovycLaWMWVydXKFFZnmVFlZU46tP7R2nI5ncbi/dDkfDtFBA2DDXbYkhKc+V0Bqs5Zt9JM1HQGBRTm/EezTmZNKtpcAMs9Yu6AK9caF76zoLWIWcfMGOSkVduvSWechqZsz040Ib2PY3urxBJTzriT95lipz+TN1fmAAAAeJxtkMl2wjAMRfOAhABlKm2h80C3+ajgCKKDY6cegP59TYBzukAL+z1Zsq8ctaJTTKPrsUQLbXQQI0EXKXroY4AbDDHCGBNMcYsZ7nCPB8yxwCOe8IwXvOIN7/jAJ76wxHfUqWX+OzgumWAjJMV17i0Ndlr6irLKO+qftdT7i6y4uFSUvCknay+lFYZIZaQcmfH/xIFdYn98bqhra1aKTM/6lWMnyaYirx1rFUQZFBkb2zJUtoXeJCeg0WnLtHeSFc3OtrnozNwqi0TkSpBMDB1nSde5oJXW23hTS2/T0LilglXX7dmFVxLnq5U0vYATHFk3zX3BOisoQHNDFDeZnqKDy9hRNawN7Vh727hFzcJ5c8TILrKZfH7tIPxAFP0BpLeJPA==) format("woff");font-weight:normal;font-style:normal}.vjs-icon-play,.video-js .vjs-play-control .vjs-icon-placeholder,.video-js .vjs-big-play-button .vjs-icon-placeholder:before{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-play:before,.video-js .vjs-play-control .vjs-icon-placeholder:before,.video-js .vjs-big-play-button .vjs-icon-placeholder:before{content:"\\f101"}.vjs-icon-play-circle{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-play-circle:before{content:"\\f102"}.vjs-icon-pause,.video-js .vjs-play-control.vjs-playing .vjs-icon-placeholder{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-pause:before,.video-js .vjs-play-control.vjs-playing .vjs-icon-placeholder:before{content:"\\f103"}.vjs-icon-volume-mute,.video-js .vjs-mute-control.vjs-vol-0 .vjs-icon-placeholder{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-volume-mute:before,.video-js .vjs-mute-control.vjs-vol-0 .vjs-icon-placeholder:before{content:"\\f104"}.vjs-icon-volume-low,.video-js .vjs-mute-control.vjs-vol-1 .vjs-icon-placeholder{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-volume-low:before,.video-js .vjs-mute-control.vjs-vol-1 .vjs-icon-placeholder:before{content:"\\f105"}.vjs-icon-volume-mid,.video-js .vjs-mute-control.vjs-vol-2 .vjs-icon-placeholder{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-volume-mid:before,.video-js .vjs-mute-control.vjs-vol-2 .vjs-icon-placeholder:before{content:"\\f106"}.vjs-icon-volume-high,.video-js .vjs-mute-control .vjs-icon-placeholder{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-volume-high:before,.video-js .vjs-mute-control .vjs-icon-placeholder:before{content:"\\f107"}.vjs-icon-fullscreen-enter,.video-js .vjs-fullscreen-control .vjs-icon-placeholder{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-fullscreen-enter:before,.video-js .vjs-fullscreen-control .vjs-icon-placeholder:before{content:"\\f108"}.vjs-icon-fullscreen-exit,.video-js.vjs-fullscreen .vjs-fullscreen-control .vjs-icon-placeholder{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-fullscreen-exit:before,.video-js.vjs-fullscreen .vjs-fullscreen-control .vjs-icon-placeholder:before{content:"\\f109"}.vjs-icon-square{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-square:before{content:"\\f10a"}.vjs-icon-spinner{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-spinner:before{content:"\\f10b"}.vjs-icon-subtitles,.video-js .vjs-subs-caps-button .vjs-icon-placeholder,.video-js.video-js:lang(en-GB) .vjs-subs-caps-button .vjs-icon-placeholder,.video-js.video-js:lang(en-IE) .vjs-subs-caps-button .vjs-icon-placeholder,.video-js.video-js:lang(en-AU) .vjs-subs-caps-button .vjs-icon-placeholder,.video-js.video-js:lang(en-NZ) .vjs-subs-caps-button .vjs-icon-placeholder,.video-js .vjs-subtitles-button .vjs-icon-placeholder{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-subtitles:before,.video-js .vjs-subs-caps-button .vjs-icon-placeholder:before,.video-js.video-js:lang(en-GB) .vjs-subs-caps-button .vjs-icon-placeholder:before,.video-js.video-js:lang(en-IE) .vjs-subs-caps-button .vjs-icon-placeholder:before,.video-js.video-js:lang(en-AU) .vjs-subs-caps-button .vjs-icon-placeholder:before,.video-js.video-js:lang(en-NZ) .vjs-subs-caps-button .vjs-icon-placeholder:before,.video-js .vjs-subtitles-button .vjs-icon-placeholder:before{content:"\\f10c"}.vjs-icon-captions,.video-js:lang(en) .vjs-subs-caps-button .vjs-icon-placeholder,.video-js:lang(fr-CA) .vjs-subs-caps-button .vjs-icon-placeholder,.video-js .vjs-captions-button .vjs-icon-placeholder{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-captions:before,.video-js:lang(en) .vjs-subs-caps-button .vjs-icon-placeholder:before,.video-js:lang(fr-CA) .vjs-subs-caps-button .vjs-icon-placeholder:before,.video-js .vjs-captions-button .vjs-icon-placeholder:before{content:"\\f10d"}.vjs-icon-chapters,.video-js .vjs-chapters-button .vjs-icon-placeholder{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-chapters:before,.video-js .vjs-chapters-button .vjs-icon-placeholder:before{content:"\\f10e"}.vjs-icon-share{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-share:before{content:"\\f10f"}.vjs-icon-cog{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-cog:before{content:"\\f110"}.vjs-icon-circle,.vjs-seek-to-live-control .vjs-icon-placeholder,.video-js .vjs-volume-level,.video-js .vjs-play-progress{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-circle:before,.vjs-seek-to-live-control .vjs-icon-placeholder:before,.video-js .vjs-volume-level:before,.video-js .vjs-play-progress:before{content:"\\f111"}.vjs-icon-circle-outline{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-circle-outline:before{content:"\\f112"}.vjs-icon-circle-inner-circle{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-circle-inner-circle:before{content:"\\f113"}.vjs-icon-hd{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-hd:before{content:"\\f114"}.vjs-icon-cancel,.video-js .vjs-control.vjs-close-button .vjs-icon-placeholder{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-cancel:before,.video-js .vjs-control.vjs-close-button .vjs-icon-placeholder:before{content:"\\f115"}.vjs-icon-replay,.video-js .vjs-play-control.vjs-ended .vjs-icon-placeholder{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-replay:before,.video-js .vjs-play-control.vjs-ended .vjs-icon-placeholder:before{content:"\\f116"}.vjs-icon-facebook{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-facebook:before{content:"\\f117"}.vjs-icon-gplus{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-gplus:before{content:"\\f118"}.vjs-icon-linkedin{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-linkedin:before{content:"\\f119"}.vjs-icon-twitter{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-twitter:before{content:"\\f11a"}.vjs-icon-tumblr{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-tumblr:before{content:"\\f11b"}.vjs-icon-pinterest{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-pinterest:before{content:"\\f11c"}.vjs-icon-audio-description,.video-js .vjs-descriptions-button .vjs-icon-placeholder{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-audio-description:before,.video-js .vjs-descriptions-button .vjs-icon-placeholder:before{content:"\\f11d"}.vjs-icon-audio,.video-js .vjs-audio-button .vjs-icon-placeholder{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-audio:before,.video-js .vjs-audio-button .vjs-icon-placeholder:before{content:"\\f11e"}.vjs-icon-next-item{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-next-item:before{content:"\\f11f"}.vjs-icon-previous-item{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-previous-item:before{content:"\\f120"}.vjs-icon-picture-in-picture-enter,.video-js .vjs-picture-in-picture-control .vjs-icon-placeholder{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-picture-in-picture-enter:before,.video-js .vjs-picture-in-picture-control .vjs-icon-placeholder:before{content:"\\f121"}.vjs-icon-picture-in-picture-exit,.video-js.vjs-picture-in-picture .vjs-picture-in-picture-control .vjs-icon-placeholder{font-family:VideoJS;font-weight:normal;font-style:normal}.vjs-icon-picture-in-picture-exit:before,.video-js.vjs-picture-in-picture .vjs-picture-in-picture-control .vjs-icon-placeholder:before{content:"\\f122"}.video-js{display:block;vertical-align:top;box-sizing:border-box;color:#fff;background-color:#000;position:relative;padding:0;font-size:10px;line-height:1;font-weight:normal;font-style:normal;font-family:Arial,Helvetica,sans-serif;word-break:initial}.video-js:-moz-full-screen{position:absolute}.video-js:-webkit-full-screen{width:100%!important;height:100%!important}.video-js[tabindex="-1"]{outline:none}.video-js *,.video-js *:before,.video-js *:after{box-sizing:inherit}.video-js ul{font-family:inherit;font-size:inherit;line-height:inherit;list-style-position:outside;margin:0}.video-js.vjs-fluid,.video-js.vjs-16-9,.video-js.vjs-4-3,.video-js.vjs-9-16,.video-js.vjs-1-1{width:100%;max-width:100%;height:0}.video-js.vjs-16-9{padding-top:56.25%}.video-js.vjs-4-3{padding-top:75%}.video-js.vjs-9-16{padding-top:177.7777777778%}.video-js.vjs-1-1{padding-top:100%}.video-js.vjs-fill{width:100%;height:100%}.video-js .vjs-tech{position:absolute;top:0;left:0;width:100%;height:100%}body.vjs-full-window{padding:0;margin:0;height:100%}.vjs-full-window .video-js.vjs-fullscreen{position:fixed;overflow:hidden;z-index:1000;left:0;top:0;bottom:0;right:0}.video-js.vjs-fullscreen:not(.vjs-ios-native-fs){width:100%!important;height:100%!important;padding-top:0!important}.video-js.vjs-fullscreen.vjs-user-inactive{cursor:none}.vjs-hidden{display:none!important}.vjs-disabled{opacity:.5;cursor:default}.video-js .vjs-offscreen{height:1px;left:-9999px;position:absolute;top:0;width:1px}.vjs-lock-showing{display:block!important;opacity:1!important;visibility:visible!important}.vjs-no-js{padding:20px;color:#fff;background-color:#000;font-size:18px;font-family:Arial,Helvetica,sans-serif;text-align:center;width:300px;height:150px;margin:0 auto}.vjs-no-js a,.vjs-no-js a:visited{color:#66a8cc}.video-js .vjs-big-play-button{font-size:3em;line-height:1.5em;height:1.63332em;width:3em;display:block;position:absolute;top:10px;left:10px;padding:0;cursor:pointer;opacity:1;border:.06666em solid #fff;background-color:#2b333f;background-color:#2b333fb3;border-radius:.3em;transition:all .4s}.vjs-big-play-centered .vjs-big-play-button{top:50%;left:50%;margin-top:-.81666em;margin-left:-1.5em}.video-js:hover .vjs-big-play-button,.video-js .vjs-big-play-button:focus{border-color:#fff;background-color:#73859f;background-color:#73859f80;transition:all 0s}.vjs-controls-disabled .vjs-big-play-button,.vjs-has-started .vjs-big-play-button,.vjs-using-native-controls .vjs-big-play-button,.vjs-error .vjs-big-play-button{display:none}.vjs-has-started.vjs-paused.vjs-show-big-play-button-on-pause .vjs-big-play-button{display:block}.video-js button{background:none;border:none;color:inherit;display:inline-block;font-size:inherit;line-height:inherit;text-transform:none;text-decoration:none;transition:none;appearance:none}.vjs-control .vjs-button{width:100%;height:100%}.video-js .vjs-control.vjs-close-button{cursor:pointer;height:3em;position:absolute;right:0;top:.5em;z-index:2}.video-js .vjs-modal-dialog{background:rgba(0,0,0,.8);background:linear-gradient(180deg,rgba(0,0,0,.8),rgba(255,255,255,0));overflow:auto}.video-js .vjs-modal-dialog>*{box-sizing:border-box}.vjs-modal-dialog .vjs-modal-dialog-content{font-size:1.2em;line-height:1.5;padding:20px 24px;z-index:1}.vjs-menu-button{cursor:pointer}.vjs-menu-button.vjs-disabled{cursor:default}.vjs-workinghover .vjs-menu-button.vjs-disabled:hover .vjs-menu{display:none}.vjs-menu .vjs-menu-content{display:block;padding:0;margin:0;font-family:Arial,Helvetica,sans-serif;overflow:auto}.vjs-menu .vjs-menu-content>*{box-sizing:border-box}.vjs-scrubbing .vjs-control.vjs-menu-button:hover .vjs-menu{display:none}.vjs-menu li{list-style:none;margin:0;padding:.2em 0;line-height:1.4em;font-size:1.2em;text-align:center;text-transform:lowercase}.vjs-menu li.vjs-menu-item:focus,.vjs-menu li.vjs-menu-item:hover,.js-focus-visible .vjs-menu li.vjs-menu-item:hover{background-color:#73859f;background-color:#73859f80}.vjs-menu li.vjs-selected,.vjs-menu li.vjs-selected:focus,.vjs-menu li.vjs-selected:hover,.js-focus-visible .vjs-menu li.vjs-selected:hover{background-color:#fff;color:#2b333f}.video-js .vjs-menu *:not(.vjs-selected):focus:not(:focus-visible),.js-focus-visible .vjs-menu *:not(.vjs-selected):focus:not(.focus-visible){background:none}.vjs-menu li.vjs-menu-title{text-align:center;text-transform:uppercase;font-size:1em;line-height:2em;padding:0;margin:0 0 .3em;font-weight:bold;cursor:default}.vjs-menu-button-popup .vjs-menu{display:none;position:absolute;bottom:0;width:10em;left:-3em;height:0em;margin-bottom:1.5em;border-top-color:#2b333fb3}.vjs-menu-button-popup .vjs-menu .vjs-menu-content{background-color:#2b333f;background-color:#2b333fb3;position:absolute;width:100%;bottom:1.5em;max-height:15em}.vjs-layout-tiny .vjs-menu-button-popup .vjs-menu .vjs-menu-content,.vjs-layout-x-small .vjs-menu-button-popup .vjs-menu .vjs-menu-content{max-height:5em}.vjs-layout-small .vjs-menu-button-popup .vjs-menu .vjs-menu-content{max-height:10em}.vjs-layout-medium .vjs-menu-button-popup .vjs-menu .vjs-menu-content{max-height:14em}.vjs-layout-large .vjs-menu-button-popup .vjs-menu .vjs-menu-content,.vjs-layout-x-large .vjs-menu-button-popup .vjs-menu .vjs-menu-content,.vjs-layout-huge .vjs-menu-button-popup .vjs-menu .vjs-menu-content{max-height:25em}.vjs-workinghover .vjs-menu-button-popup.vjs-hover .vjs-menu,.vjs-menu-button-popup .vjs-menu.vjs-lock-showing{display:block}.video-js .vjs-menu-button-inline{transition:all .4s;overflow:hidden}.video-js .vjs-menu-button-inline:before{width:2.222222222em}.video-js .vjs-menu-button-inline:hover,.video-js .vjs-menu-button-inline:focus,.video-js .vjs-menu-button-inline.vjs-slider-active,.video-js.vjs-no-flex .vjs-menu-button-inline{width:12em}.vjs-menu-button-inline .vjs-menu{opacity:0;height:100%;width:auto;position:absolute;left:4em;top:0;padding:0;margin:0;transition:all .4s}.vjs-menu-button-inline:hover .vjs-menu,.vjs-menu-button-inline:focus .vjs-menu,.vjs-menu-button-inline.vjs-slider-active .vjs-menu{display:block;opacity:1}.vjs-no-flex .vjs-menu-button-inline .vjs-menu{display:block;opacity:1;position:relative;width:auto}.vjs-no-flex .vjs-menu-button-inline:hover .vjs-menu,.vjs-no-flex .vjs-menu-button-inline:focus .vjs-menu,.vjs-no-flex .vjs-menu-button-inline.vjs-slider-active .vjs-menu{width:auto}.vjs-menu-button-inline .vjs-menu-content{width:auto;height:100%;margin:0;overflow:hidden}.video-js .vjs-control-bar{display:none;width:100%;position:absolute;bottom:0;left:0;right:0;height:3em;background-color:#2b333f;background-color:#2b333fb3}.vjs-has-started .vjs-control-bar{display:flex;visibility:visible;opacity:1;transition:visibility .1s,opacity .1s}.vjs-has-started.vjs-user-inactive.vjs-playing .vjs-control-bar{visibility:visible;opacity:0;pointer-events:none;transition:visibility 1s,opacity 1s}.vjs-controls-disabled .vjs-control-bar,.vjs-using-native-controls .vjs-control-bar,.vjs-error .vjs-control-bar{display:none!important}.vjs-audio.vjs-has-started.vjs-user-inactive.vjs-playing .vjs-control-bar{opacity:1;visibility:visible}.vjs-has-started.vjs-no-flex .vjs-control-bar{display:table}.video-js .vjs-control{position:relative;text-align:center;margin:0;padding:0;height:100%;width:4em;flex:none}.vjs-button>.vjs-icon-placeholder:before{font-size:1.8em;line-height:1.67}.vjs-button>.vjs-icon-placeholder{display:block}.video-js .vjs-control:focus:before,.video-js .vjs-control:hover:before,.video-js .vjs-control:focus{text-shadow:0em 0em 1em white}.video-js .vjs-control-text{border:0;clip:rect(0 0 0 0);height:1px;overflow:hidden;padding:0;position:absolute;width:1px}.vjs-no-flex .vjs-control{display:table-cell;vertical-align:middle}.video-js .vjs-custom-control-spacer{display:none}.video-js .vjs-progress-control{cursor:pointer;flex:auto;display:flex;align-items:center;min-width:4em;touch-action:none}.video-js .vjs-progress-control.disabled{cursor:default}.vjs-live .vjs-progress-control{display:none}.vjs-liveui .vjs-progress-control{display:flex;align-items:center}.vjs-no-flex .vjs-progress-control{width:auto}.video-js .vjs-progress-holder{flex:auto;transition:all .2s;height:.3em}.video-js .vjs-progress-control .vjs-progress-holder{margin:0 10px}.video-js .vjs-progress-control:hover .vjs-progress-holder{font-size:1.6666666667em}.video-js .vjs-progress-control:hover .vjs-progress-holder.disabled{font-size:1em}.video-js .vjs-progress-holder .vjs-play-progress,.video-js .vjs-progress-holder .vjs-load-progress,.video-js .vjs-progress-holder .vjs-load-progress div{position:absolute;display:block;height:100%;margin:0;padding:0;width:0}.video-js .vjs-play-progress{background-color:#fff}.video-js .vjs-play-progress:before{font-size:.9em;position:absolute;right:-.5em;top:-.3333333333em;z-index:1}.video-js .vjs-load-progress{background:rgba(115,133,159,.5)}.video-js .vjs-load-progress div{background:rgba(115,133,159,.75)}.video-js .vjs-time-tooltip{background-color:#fff;background-color:#fffc;border-radius:.3em;color:#000;float:right;font-family:Arial,Helvetica,sans-serif;font-size:1em;padding:6px 8px 8px;pointer-events:none;position:absolute;top:-3.4em;visibility:hidden;z-index:1}.video-js .vjs-progress-holder:focus .vjs-time-tooltip{display:none}.video-js .vjs-progress-control:hover .vjs-time-tooltip,.video-js .vjs-progress-control:hover .vjs-progress-holder:focus .vjs-time-tooltip{display:block;font-size:.6em;visibility:visible}.video-js .vjs-progress-control.disabled:hover .vjs-time-tooltip{font-size:1em}.video-js .vjs-progress-control .vjs-mouse-display{display:none;position:absolute;width:1px;height:100%;background-color:#000;z-index:1}.vjs-no-flex .vjs-progress-control .vjs-mouse-display{z-index:0}.video-js .vjs-progress-control:hover .vjs-mouse-display{display:block}.video-js.vjs-user-inactive .vjs-progress-control .vjs-mouse-display{visibility:hidden;opacity:0;transition:visibility 1s,opacity 1s}.video-js.vjs-user-inactive.vjs-no-flex .vjs-progress-control .vjs-mouse-display{display:none}.vjs-mouse-display .vjs-time-tooltip{color:#fff;background-color:#000;background-color:#000c}.video-js .vjs-slider{position:relative;cursor:pointer;padding:0;margin:0 .45em;-webkit-touch-callout:none;user-select:none;background-color:#73859f;background-color:#73859f80}.video-js .vjs-slider.disabled{cursor:default}.video-js .vjs-slider:focus{text-shadow:0em 0em 1em white;box-shadow:0 0 1em #fff}.video-js .vjs-mute-control{cursor:pointer;flex:none}.video-js .vjs-volume-control{cursor:pointer;margin-right:1em;display:flex}.video-js .vjs-volume-control.vjs-volume-horizontal{width:5em}.video-js .vjs-volume-panel .vjs-volume-control{visibility:visible;opacity:0;width:1px;height:1px;margin-left:-1px}.video-js .vjs-volume-panel{transition:width 1s}.video-js .vjs-volume-panel.vjs-hover .vjs-volume-control,.video-js .vjs-volume-panel:active .vjs-volume-control,.video-js .vjs-volume-panel:focus .vjs-volume-control,.video-js .vjs-volume-panel .vjs-volume-control:active,.video-js .vjs-volume-panel.vjs-hover .vjs-mute-control~.vjs-volume-control,.video-js .vjs-volume-panel .vjs-volume-control.vjs-slider-active{visibility:visible;opacity:1;position:relative;transition:visibility .1s,opacity .1s,height .1s,width .1s,left 0s,top 0s}.video-js .vjs-volume-panel.vjs-hover .vjs-volume-control.vjs-volume-horizontal,.video-js .vjs-volume-panel:active .vjs-volume-control.vjs-volume-horizontal,.video-js .vjs-volume-panel:focus .vjs-volume-control.vjs-volume-horizontal,.video-js .vjs-volume-panel .vjs-volume-control:active.vjs-volume-horizontal,.video-js .vjs-volume-panel.vjs-hover .vjs-mute-control~.vjs-volume-control.vjs-volume-horizontal,.video-js .vjs-volume-panel .vjs-volume-control.vjs-slider-active.vjs-volume-horizontal{width:5em;height:3em;margin-right:0}.video-js .vjs-volume-panel.vjs-hover .vjs-volume-control.vjs-volume-vertical,.video-js .vjs-volume-panel:active .vjs-volume-control.vjs-volume-vertical,.video-js .vjs-volume-panel:focus .vjs-volume-control.vjs-volume-vertical,.video-js .vjs-volume-panel .vjs-volume-control:active.vjs-volume-vertical,.video-js .vjs-volume-panel.vjs-hover .vjs-mute-control~.vjs-volume-control.vjs-volume-vertical,.video-js .vjs-volume-panel .vjs-volume-control.vjs-slider-active.vjs-volume-vertical{left:-3.5em;transition:left 0s}.video-js .vjs-volume-panel.vjs-volume-panel-horizontal.vjs-hover,.video-js .vjs-volume-panel.vjs-volume-panel-horizontal:active,.video-js .vjs-volume-panel.vjs-volume-panel-horizontal.vjs-slider-active{width:10em;transition:width .1s}.video-js .vjs-volume-panel.vjs-volume-panel-horizontal.vjs-mute-toggle-only{width:4em}.video-js .vjs-volume-panel .vjs-volume-control.vjs-volume-vertical{height:8em;width:3em;left:-3000em;transition:visibility 1s,opacity 1s,height 1s 1s,width 1s 1s,left 1s 1s,top 1s 1s}.video-js .vjs-volume-panel .vjs-volume-control.vjs-volume-horizontal{transition:visibility 1s,opacity 1s,height 1s 1s,width 1s,left 1s 1s,top 1s 1s}.video-js.vjs-no-flex .vjs-volume-panel .vjs-volume-control.vjs-volume-horizontal{width:5em;height:3em;visibility:visible;opacity:1;position:relative;transition:none}.video-js.vjs-no-flex .vjs-volume-control.vjs-volume-vertical,.video-js.vjs-no-flex .vjs-volume-panel .vjs-volume-control.vjs-volume-vertical{position:absolute;bottom:3em;left:.5em}.video-js .vjs-volume-panel{display:flex}.video-js .vjs-volume-bar{margin:1.35em .45em}.vjs-volume-bar.vjs-slider-horizontal{width:5em;height:.3em}.vjs-volume-bar.vjs-slider-vertical{width:.3em;height:5em;margin:1.35em auto}.video-js .vjs-volume-level{position:absolute;bottom:0;left:0;background-color:#fff}.video-js .vjs-volume-level:before{position:absolute;font-size:.9em;z-index:1}.vjs-slider-vertical .vjs-volume-level{width:.3em}.vjs-slider-vertical .vjs-volume-level:before{top:-.5em;left:-.3em;z-index:1}.vjs-slider-horizontal .vjs-volume-level{height:.3em}.vjs-slider-horizontal .vjs-volume-level:before{top:-.3em;right:-.5em}.video-js .vjs-volume-panel.vjs-volume-panel-vertical{width:4em}.vjs-volume-bar.vjs-slider-vertical .vjs-volume-level{height:100%}.vjs-volume-bar.vjs-slider-horizontal .vjs-volume-level{width:100%}.video-js .vjs-volume-vertical{width:3em;height:8em;bottom:8em;background-color:#2b333f;background-color:#2b333fb3}.video-js .vjs-volume-horizontal .vjs-menu{left:-2em}.video-js .vjs-volume-tooltip{background-color:#fff;background-color:#fffc;border-radius:.3em;color:#000;float:right;font-family:Arial,Helvetica,sans-serif;font-size:1em;padding:6px 8px 8px;pointer-events:none;position:absolute;top:-3.4em;visibility:hidden;z-index:1}.video-js .vjs-volume-control:hover .vjs-volume-tooltip,.video-js .vjs-volume-control:hover .vjs-progress-holder:focus .vjs-volume-tooltip{display:block;font-size:1em;visibility:visible}.video-js .vjs-volume-vertical:hover .vjs-volume-tooltip,.video-js .vjs-volume-vertical:hover .vjs-progress-holder:focus .vjs-volume-tooltip{left:1em;top:-12px}.video-js .vjs-volume-control.disabled:hover .vjs-volume-tooltip{font-size:1em}.video-js .vjs-volume-control .vjs-mouse-display{display:none;position:absolute;width:100%;height:1px;background-color:#000;z-index:1}.video-js .vjs-volume-horizontal .vjs-mouse-display{width:1px;height:100%}.vjs-no-flex .vjs-volume-control .vjs-mouse-display{z-index:0}.video-js .vjs-volume-control:hover .vjs-mouse-display{display:block}.video-js.vjs-user-inactive .vjs-volume-control .vjs-mouse-display{visibility:hidden;opacity:0;transition:visibility 1s,opacity 1s}.video-js.vjs-user-inactive.vjs-no-flex .vjs-volume-control .vjs-mouse-display{display:none}.vjs-mouse-display .vjs-volume-tooltip{color:#fff;background-color:#000;background-color:#000c}.vjs-poster{display:inline-block;vertical-align:middle;background-repeat:no-repeat;background-position:50% 50%;background-size:contain;background-color:#000;cursor:pointer;margin:0;padding:0;position:absolute;top:0;right:0;bottom:0;left:0;height:100%}.vjs-has-started .vjs-poster{display:none}.vjs-audio.vjs-has-started .vjs-poster{display:block}.vjs-using-native-controls .vjs-poster{display:none}.video-js .vjs-live-control{display:flex;align-items:flex-start;flex:auto;font-size:1em;line-height:3em}.vjs-no-flex .vjs-live-control{display:table-cell;width:auto;text-align:left}.video-js:not(.vjs-live) .vjs-live-control,.video-js.vjs-liveui .vjs-live-control{display:none}.video-js .vjs-seek-to-live-control{align-items:center;cursor:pointer;flex:none;display:inline-flex;height:100%;padding-left:.5em;padding-right:.5em;font-size:1em;line-height:3em;width:auto;min-width:4em}.vjs-no-flex .vjs-seek-to-live-control{display:table-cell;width:auto;text-align:left}.video-js.vjs-live:not(.vjs-liveui) .vjs-seek-to-live-control,.video-js:not(.vjs-live) .vjs-seek-to-live-control{display:none}.vjs-seek-to-live-control.vjs-control.vjs-at-live-edge{cursor:auto}.vjs-seek-to-live-control .vjs-icon-placeholder{margin-right:.5em;color:#888}.vjs-seek-to-live-control.vjs-control.vjs-at-live-edge .vjs-icon-placeholder{color:red}.video-js .vjs-time-control{flex:none;font-size:1em;line-height:3em;min-width:2em;width:auto;padding-left:1em;padding-right:1em}.vjs-live .vjs-time-control{display:none}.video-js .vjs-current-time,.vjs-no-flex .vjs-current-time{display:none}.video-js .vjs-duration,.vjs-no-flex .vjs-duration{display:none}.vjs-time-divider{display:none;line-height:3em}.vjs-live .vjs-time-divider{display:none}.video-js .vjs-play-control{cursor:pointer}.video-js .vjs-play-control .vjs-icon-placeholder{flex:none}.vjs-text-track-display{position:absolute;bottom:3em;left:0;right:0;top:0;pointer-events:none}.video-js.vjs-user-inactive.vjs-playing .vjs-text-track-display{bottom:1em}.video-js .vjs-text-track{font-size:1.4em;text-align:center;margin-bottom:.1em}.vjs-subtitles{color:#fff}.vjs-captions{color:#fc6}.vjs-tt-cue{display:block}video::-webkit-media-text-track-display{transform:translateY(-3em)}.video-js.vjs-user-inactive.vjs-playing video::-webkit-media-text-track-display{transform:translateY(-1.5em)}.video-js .vjs-picture-in-picture-control{cursor:pointer;flex:none}.video-js .vjs-fullscreen-control{cursor:pointer;flex:none}.vjs-playback-rate>.vjs-menu-button,.vjs-playback-rate .vjs-playback-rate-value{position:absolute;top:0;left:0;width:100%;height:100%}.vjs-playback-rate .vjs-playback-rate-value{pointer-events:none;font-size:1.5em;line-height:2;text-align:center}.vjs-playback-rate .vjs-menu{width:4em;left:0em}.vjs-error .vjs-error-display .vjs-modal-dialog-content{font-size:1.4em;text-align:center}.vjs-error .vjs-error-display:before{color:#fff;content:"X";font-family:Arial,Helvetica,sans-serif;font-size:4em;left:0;line-height:1;margin-top:-.5em;position:absolute;text-shadow:.05em .05em .1em #000;text-align:center;top:50%;vertical-align:middle;width:100%}.vjs-loading-spinner{display:none;position:absolute;top:50%;left:50%;margin:-25px 0 0 -25px;opacity:.85;text-align:left;border:6px solid rgba(43,51,63,.7);box-sizing:border-box;background-clip:padding-box;width:50px;height:50px;border-radius:25px;visibility:hidden}.vjs-seeking .vjs-loading-spinner,.vjs-waiting .vjs-loading-spinner{display:block;animation:vjs-spinner-show 0s linear .3s forwards}.vjs-loading-spinner:before,.vjs-loading-spinner:after{content:"";position:absolute;margin:-6px;box-sizing:inherit;width:inherit;height:inherit;border-radius:inherit;opacity:1;border:inherit;border-color:transparent;border-top-color:#fff}.vjs-seeking .vjs-loading-spinner:before,.vjs-seeking .vjs-loading-spinner:after,.vjs-waiting .vjs-loading-spinner:before,.vjs-waiting .vjs-loading-spinner:after{animation:vjs-spinner-spin 1.1s cubic-bezier(.6,.2,0,.8) infinite,vjs-spinner-fade 1.1s linear infinite}.vjs-seeking .vjs-loading-spinner:before,.vjs-waiting .vjs-loading-spinner:before{border-top-color:#fff}.vjs-seeking .vjs-loading-spinner:after,.vjs-waiting .vjs-loading-spinner:after{border-top-color:#fff;animation-delay:.44s}@keyframes vjs-spinner-show{to{visibility:visible}}@keyframes vjs-spinner-spin{to{transform:rotate(360deg)}}@keyframes vjs-spinner-fade{0%{border-top-color:#73859f}20%{border-top-color:#73859f}35%{border-top-color:#fff}60%{border-top-color:#73859f}to{border-top-color:#73859f}}.vjs-chapters-button .vjs-menu ul{width:24em}.video-js .vjs-subs-caps-button+.vjs-menu .vjs-captions-menu-item .vjs-menu-item-text .vjs-icon-placeholder{vertical-align:middle;display:inline-block;margin-bottom:-.1em}.video-js .vjs-subs-caps-button+.vjs-menu .vjs-captions-menu-item .vjs-menu-item-text .vjs-icon-placeholder:before{font-family:VideoJS;content:"\\f10d";font-size:1.5em;line-height:inherit}.video-js .vjs-audio-button+.vjs-menu .vjs-main-desc-menu-item .vjs-menu-item-text .vjs-icon-placeholder{vertical-align:middle;display:inline-block;margin-bottom:-.1em}.video-js .vjs-audio-button+.vjs-menu .vjs-main-desc-menu-item .vjs-menu-item-text .vjs-icon-placeholder:before{font-family:VideoJS;content:" \\f11d";font-size:1.5em;line-height:inherit}.video-js.vjs-layout-small .vjs-current-time,.video-js.vjs-layout-small .vjs-time-divider,.video-js.vjs-layout-small .vjs-duration,.video-js.vjs-layout-small .vjs-remaining-time,.video-js.vjs-layout-small .vjs-playback-rate,.video-js.vjs-layout-small .vjs-chapters-button,.video-js.vjs-layout-small .vjs-descriptions-button,.video-js.vjs-layout-small .vjs-captions-button,.video-js.vjs-layout-small .vjs-subtitles-button,.video-js.vjs-layout-small .vjs-audio-button,.video-js.vjs-layout-small .vjs-volume-control,.video-js.vjs-layout-x-small .vjs-current-time,.video-js.vjs-layout-x-small .vjs-time-divider,.video-js.vjs-layout-x-small .vjs-duration,.video-js.vjs-layout-x-small .vjs-remaining-time,.video-js.vjs-layout-x-small .vjs-playback-rate,.video-js.vjs-layout-x-small .vjs-chapters-button,.video-js.vjs-layout-x-small .vjs-descriptions-button,.video-js.vjs-layout-x-small .vjs-captions-button,.video-js.vjs-layout-x-small .vjs-subtitles-button,.video-js.vjs-layout-x-small .vjs-audio-button,.video-js.vjs-layout-x-small .vjs-volume-control,.video-js.vjs-layout-tiny .vjs-current-time,.video-js.vjs-layout-tiny .vjs-time-divider,.video-js.vjs-layout-tiny .vjs-duration,.video-js.vjs-layout-tiny .vjs-remaining-time,.video-js.vjs-layout-tiny .vjs-playback-rate,.video-js.vjs-layout-tiny .vjs-chapters-button,.video-js.vjs-layout-tiny .vjs-descriptions-button,.video-js.vjs-layout-tiny .vjs-captions-button,.video-js.vjs-layout-tiny .vjs-subtitles-button,.video-js.vjs-layout-tiny .vjs-audio-button,.video-js.vjs-layout-tiny .vjs-volume-control{display:none}.video-js.vjs-layout-small .vjs-volume-panel.vjs-volume-panel-horizontal:hover,.video-js.vjs-layout-small .vjs-volume-panel.vjs-volume-panel-horizontal:active,.video-js.vjs-layout-small .vjs-volume-panel.vjs-volume-panel-horizontal.vjs-slider-active,.video-js.vjs-layout-small .vjs-volume-panel.vjs-volume-panel-horizontal.vjs-hover,.video-js.vjs-layout-x-small .vjs-volume-panel.vjs-volume-panel-horizontal:hover,.video-js.vjs-layout-x-small .vjs-volume-panel.vjs-volume-panel-horizontal:active,.video-js.vjs-layout-x-small .vjs-volume-panel.vjs-volume-panel-horizontal.vjs-slider-active,.video-js.vjs-layout-x-small .vjs-volume-panel.vjs-volume-panel-horizontal.vjs-hover,.video-js.vjs-layout-tiny .vjs-volume-panel.vjs-volume-panel-horizontal:hover,.video-js.vjs-layout-tiny .vjs-volume-panel.vjs-volume-panel-horizontal:active,.video-js.vjs-layout-tiny .vjs-volume-panel.vjs-volume-panel-horizontal.vjs-slider-active,.video-js.vjs-layout-tiny .vjs-volume-panel.vjs-volume-panel-horizontal.vjs-hover{width:auto;width:initial}.video-js.vjs-layout-x-small:not(.vjs-liveui) .vjs-subs-caps-button,.video-js.vjs-layout-x-small:not(.vjs-live) .vjs-subs-caps-button,.video-js.vjs-layout-tiny .vjs-subs-caps-button{display:none}.video-js.vjs-layout-x-small.vjs-liveui .vjs-custom-control-spacer,.video-js.vjs-layout-tiny .vjs-custom-control-spacer{flex:auto;display:block}.video-js.vjs-layout-x-small.vjs-liveui.vjs-no-flex .vjs-custom-control-spacer,.video-js.vjs-layout-tiny.vjs-no-flex .vjs-custom-control-spacer{width:auto}.video-js.vjs-layout-x-small.vjs-liveui .vjs-progress-control,.video-js.vjs-layout-tiny .vjs-progress-control{display:none}.vjs-modal-dialog.vjs-text-track-settings{background-color:#2b333f;background-color:#2b333fbf;color:#fff;height:70%}.vjs-text-track-settings .vjs-modal-dialog-content{display:table}.vjs-text-track-settings .vjs-track-settings-colors,.vjs-text-track-settings .vjs-track-settings-font,.vjs-text-track-settings .vjs-track-settings-controls{display:table-cell}.vjs-text-track-settings .vjs-track-settings-controls{text-align:right;vertical-align:bottom}@supports (display: grid){.vjs-text-track-settings .vjs-modal-dialog-content{display:grid;grid-template-columns:1fr 1fr;grid-template-rows:1fr;padding:20px 24px 0}.vjs-track-settings-controls .vjs-default-button{margin-bottom:20px}.vjs-text-track-settings .vjs-track-settings-controls{grid-column:1/-1}.vjs-layout-small .vjs-text-track-settings .vjs-modal-dialog-content,.vjs-layout-x-small .vjs-text-track-settings .vjs-modal-dialog-content,.vjs-layout-tiny .vjs-text-track-settings .vjs-modal-dialog-content{grid-template-columns:1fr}}.vjs-track-setting>select{margin-right:1em;margin-bottom:.5em}.vjs-text-track-settings fieldset{margin:5px;padding:3px;border:none}.vjs-text-track-settings fieldset span{display:inline-block}.vjs-text-track-settings fieldset span>select{max-width:7.3em}.vjs-text-track-settings legend{color:#fff;margin:0 0 5px}.vjs-text-track-settings .vjs-label{position:absolute;clip:rect(1px 1px 1px 1px);clip:rect(1px,1px,1px,1px);display:block;margin:0 0 5px;padding:0;border:0;height:1px;width:1px;overflow:hidden}.vjs-track-settings-controls button:focus,.vjs-track-settings-controls button:active{outline-style:solid;outline-width:medium;background-image:linear-gradient(0deg,#fff 88%,#73859f 100%)}.vjs-track-settings-controls button:hover{color:#2b333fbf}.vjs-track-settings-controls button{background-color:#fff;background-image:linear-gradient(-180deg,#fff 88%,#73859f 100%);color:#2b333f;cursor:pointer;border-radius:2px}.vjs-track-settings-controls .vjs-default-button{margin-right:1em}@media print{.video-js>*:not(.vjs-tech):not(.vjs-poster){visibility:hidden}}.vjs-resize-manager{position:absolute;top:0;left:0;width:100%;height:100%;border:none;z-index:-1000}.js-focus-visible .video-js *:focus:not(.focus-visible){outline:none}.video-js *:focus:not(:focus-visible){outline:none}.video-js{position:relative!important;width:100%!important;height:calc(100vh - 85px)}.hide-captions .vjs-texttrack-settings,.hide-captions .vjs-text-track-display,.hide-captions .vjs-subs-caps-button{display:none}\n'],encapsulation:2}),VjsPlayerComponent}(),hls=__webpack_require__(74026),hls_default=__webpack_require__.n(hls),html_video_player_component_c0=["videoPlayer"],HtmlVideoPlayerComponent=function(){var HtmlVideoPlayerComponent=function(){function HtmlVideoPlayerComponent(){(0,classCallCheck.Z)(this,HtmlVideoPlayerComponent)}return(0,createClass.Z)(HtmlVideoPlayerComponent,[{key:"ngOnChanges",value:function(changes){changes.channel&&changes.channel.currentValue&&this.playChannel(changes.channel.currentValue)}},{key:"playChannel",value:function(channel){this.hls&&this.hls.destroy();var url=channel.url+channel.epgParams;hls_default()&&hls_default().isSupported()?(console.log("... switching channel to ",channel.name,url),this.hls=new(hls_default()),this.hls.attachMedia(this.videoPlayer.nativeElement),this.hls.loadSource(url),this.handlePlayOperation()):console.error("something wrong with hls.js init...")}},{key:"disableCaptions",value:function(){for(var i=0;i<this.videoPlayer.nativeElement.textTracks.length;i++)this.videoPlayer.nativeElement.textTracks[i].mode="hidden"}},{key:"handlePlayOperation",value:function(){var _this=this,playPromise=this.videoPlayer.nativeElement.play();void 0!==playPromise&&playPromise.then(function(){_this.showCaptions||_this.disableCaptions()}).catch(function(){})}},{key:"ngOnDestroy",value:function(){this.hls&&this.hls.destroy()}}]),HtmlVideoPlayerComponent}();return HtmlVideoPlayerComponent.\u0275fac=function(t){return new(t||HtmlVideoPlayerComponent)},HtmlVideoPlayerComponent.\u0275cmp=core.Xpm({type:HtmlVideoPlayerComponent,selectors:[["app-html-video-player"]],viewQuery:function(rf,ctx){var _t;1&rf&&core.Gf(html_video_player_component_c0,5),2&rf&&core.iGM(_t=core.CRH())&&(ctx.videoPlayer=_t.first)},inputs:{channel:"channel",showCaptions:"showCaptions"},features:[core.TTD],decls:3,vars:0,consts:[["id","video-player","autoplay","true","controls","true","muted","muted"],["videoPlayer",""]],template:function(rf,ctx){1&rf&&(core._UZ(0,"video",0,1),core._uU(2,"\n"))},styles:["#video-player[_ngcontent-%COMP%]{width:100%;height:calc(100vh - 100px)}"]}),HtmlVideoPlayerComponent}(),video_player_component_c0=["sidenav"];function VideoPlayerComponent_ng_container_6_Template(rf,ctx){if(1&rf&&(core.ynx(0),core._uU(1,"\n            "),core.TgZ(2,"app-channel-list-container",8),core._uU(3,"\n            "),core.qZA(),core._uU(4,"\n        "),core.BQk()),2&rf){var channels_r5=ctx.ngIf;core.xp6(2),core.Q6J("channelList",channels_r5)}}function VideoPlayerComponent_ng_container_12_button_22_Template(rf,ctx){if(1&rf){var _r10=core.EpF();core.TgZ(0,"button",14),core.NdJ("click",function(){return core.CHM(_r10),core.oxw(2),core.MAs(26).toggle()}),core.ALo(1,"translate"),core._uU(2,"\n                    EPG\n                "),core.qZA()}2&rf&&core.Q6J("matTooltip",core.lcZ(1,1,"TOP_MENU.OPEN_EPG_LIST"))}var _c1=function(a0){return{src:a0,type:"application/x-mpegURL"}},_c2=function(a0){return[a0]},_c3=function(a0){return{sources:a0}};function VideoPlayerComponent_ng_container_12_app_vjs_player_27_Template(rf,ctx){if(1&rf&&core._UZ(0,"app-vjs-player",15),2&rf){var activeChannel_r6=core.oxw().ngIf,ctx_r8=core.oxw();core.ekj("hide-captions",!ctx_r8.playerSettings.showCaptions),core.Q6J("options",core.VKq(7,_c3,core.VKq(5,_c2,core.VKq(3,_c1,activeChannel_r6.url+activeChannel_r6.epgParams))))}}function VideoPlayerComponent_ng_container_12_Template(rf,ctx){if(1&rf){var _r13=core.EpF();core.ynx(0),core._uU(1,"\n            "),core._uU(2,"\n            "),core.TgZ(3,"mat-toolbar",9),core._uU(4,"\n                "),core.TgZ(5,"button",10),core.NdJ("click",function(){return core.CHM(_r13),core.oxw(),core.MAs(4).toggle()}),core.ALo(6,"translate"),core._uU(7,"\n                    "),core.TgZ(8,"mat-icon"),core._uU(9,"menu"),core.qZA(),core._uU(10,"\n                "),core.qZA(),core._uU(11,"\n                "),core.TgZ(12,"button",10),core.NdJ("click",function(){var activeChannel_r6=core.CHM(_r13).ngIf;return core.oxw().addToFavorites(activeChannel_r6)}),core.ALo(13,"translate"),core._uU(14,"\n                    "),core.TgZ(15,"mat-icon"),core._uU(16),core.ALo(17,"async"),core.qZA(),core._uU(18,"\n                "),core.qZA(),core._uU(19),core._UZ(20,"div",11),core._uU(21,"\n                "),core.YNc(22,VideoPlayerComponent_ng_container_12_button_22_Template,3,3,"button",12),core.ALo(23,"async"),core._uU(24,"\n            "),core.qZA(),core._uU(25,"\n\n            "),core._uU(26,"\n            "),core.YNc(27,VideoPlayerComponent_ng_container_12_app_vjs_player_27_Template,1,9,"app-vjs-player",13),core._uU(28,"\n        "),core.BQk()}if(2&rf){var activeChannel_r6=ctx.ngIf,ctx_r2=core.oxw();core.xp6(5),core.Q6J("matTooltip",core.lcZ(6,6,"TOP_MENU.OPEN_CHANNELS_LIST")),core.xp6(7),core.Q6J("matTooltip",core.lcZ(13,8,"TOP_MENU.TOGGLE_FAVORITE_FLAG")),core.xp6(4),core.hij("\n                        ",core.lcZ(17,10,ctx_r2.favorites$).includes(activeChannel_r6.id)?"star":"star_outline",""),core.xp6(3),core.hij("\n                ",activeChannel_r6.name,"\n                "),core.xp6(3),core.Q6J("ngIf",core.lcZ(23,12,ctx_r2.epgAvailable$)),core.xp6(5),core.Q6J("ngIf","videojs"===ctx_r2.playerSettings.player)}}function VideoPlayerComponent_app_html_video_player_16_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"app-html-video-player",16),core.ALo(1,"async"),core._uU(2,"\n        "),core.qZA()),2&rf){var ctx_r3=core.oxw();core.Q6J("channel",core.lcZ(1,2,ctx_r3.activeChannel$))("showCaptions",ctx_r3.playerSettings.showCaptions)}}var VideoPlayerComponent=function(){var VideoPlayerComponent=function(){function VideoPlayerComponent(channelQuery,channelStore,snackBar,storage){var _this=this;(0,classCallCheck.Z)(this,VideoPlayerComponent),this.channelQuery=channelQuery,this.channelStore=channelStore,this.snackBar=snackBar,this.storage=storage,this.activeChannel$=this.channelQuery.select(function(state){return state.active}).pipe((0,operators.bw)(function(channel){return _this.channelTitle=null==channel?void 0:channel.name})),this.channels$=this.channelQuery.selectAll(),this.epgAvailable$=this.channelQuery.select(function(store){return store.epgAvailable}),this.epgProgram$=this.channelQuery.select(function(store){return store.currentEpgProgram}),this.favorites$=this.channelQuery.select(function(store){return store.favorites}),this.playerSettings={player:settings_interface.Y.VideoJs,showCaptions:!1}}return(0,createClass.Z)(VideoPlayerComponent,[{key:"ngOnInit",value:function(){this.applySettings()}},{key:"applySettings",value:function(){var _this2=this;this.storage.get(store_keys_enum.L.Settings).subscribe(function(settings){settings&&Object.keys(settings).length>0&&(_this2.playerSettings={player:settings.player,showCaptions:settings.showCaptions})})}},{key:"close",value:function(){this.sideNav.close()}},{key:"addToFavorites",value:function(channel){this.snackBar.open("Favorites were updated!",null,{duration:2e3}),this.channelStore.updateFavorite(channel)}}]),VideoPlayerComponent}();return VideoPlayerComponent.\u0275fac=function(t){return new(t||VideoPlayerComponent)(core.Y36(state.p8),core.Y36(state.b4),core.Y36(snack_bar.ux),core.Y36(ngx_pwa_local_storage.BU))},VideoPlayerComponent.\u0275cmp=core.Xpm({type:VideoPlayerComponent,selectors:[["app-video-player"]],viewQuery:function(rf,ctx){var _t;1&rf&&core.Gf(video_player_component_c0,5),2&rf&&core.iGM(_t=core.CRH())&&(ctx.sideNav=_t.first)},decls:32,vars:13,consts:[[1,"main-container",3,"backdropClick"],["mode","side","opened","","disableClose","",3,"keydown.escape"],["drawer",""],[4,"ngIf"],[3,"channel","showCaptions",4,"ngIf"],[3,"channel","epgProgram"],["position","end","mode","side","disableClose","",3,"keydown.escape"],["drawerRight",""],[3,"channelList"],["color","primary"],["mat-icon-button","",3,"matTooltip","click"],[1,"spacer"],["mat-button","",3,"matTooltip","click",4,"ngIf"],[3,"options","hide-captions",4,"ngIf"],["mat-button","",3,"matTooltip","click"],[3,"options"],[3,"channel","showCaptions"]],template:function(rf,ctx){1&rf&&(core.TgZ(0,"mat-drawer-container",0),core.NdJ("backdropClick",function(){return ctx.close()}),core._uU(1,"\n    "),core._uU(2,"\n    "),core.TgZ(3,"mat-drawer",1,2),core.NdJ("keydown.escape",function(){return ctx.close()}),core._uU(5,"\n        "),core.YNc(6,VideoPlayerComponent_ng_container_6_Template,5,1,"ng-container",3),core.ALo(7,"async"),core._uU(8,"\n    "),core.qZA(),core._uU(9,"\n\n    "),core.TgZ(10,"mat-drawer-content"),core._uU(11,"\n        "),core.YNc(12,VideoPlayerComponent_ng_container_12_Template,29,14,"ng-container",3),core.ALo(13,"async"),core._uU(14,"\n        "),core._uU(15,"\n        "),core.YNc(16,VideoPlayerComponent_app_html_video_player_16_Template,3,4,"app-html-video-player",4),core._uU(17,"\n\n        "),core._uU(18,"\n        "),core._UZ(19,"app-info-overlay",5),core.ALo(20,"async"),core.ALo(21,"async"),core._uU(22,"\n    "),core.qZA(),core._uU(23,"\n    "),core._uU(24,"\n    "),core.TgZ(25,"mat-drawer",6,7),core.NdJ("keydown.escape",function(){return ctx.close()}),core._uU(27,"\n        "),core._UZ(28,"app-epg-list"),core._uU(29,"\n    "),core.qZA(),core._uU(30,"\n"),core.qZA(),core._uU(31,"\n")),2&rf&&(core.xp6(6),core.Q6J("ngIf",core.lcZ(7,5,ctx.channels$)),core.xp6(6),core.Q6J("ngIf",core.lcZ(13,7,ctx.activeChannel$)),core.xp6(4),core.Q6J("ngIf","html5"===ctx.playerSettings.player),core.xp6(3),core.Q6J("channel",core.lcZ(20,9,ctx.activeChannel$))("epgProgram",core.lcZ(21,11,ctx.epgProgram$)))},directives:[sidenav.kh,sidenav.jA,common.O5,sidenav.LW,InfoOverlayComponent,EpgListComponent,ChannelListContainerComponent,toolbar.Ye,fesm2020_button.lW,tooltip.gM,icon.Hw,VjsPlayerComponent,HtmlVideoPlayerComponent],pipes:[common.Ov,ngx_translate_core.X$],styles:[".main-container[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0}.mat-drawer-content[_ngcontent-%COMP%]{background:#000}.mat-drawer[_ngcontent-%COMP%]{width:400px;min-width:400px}.spacer[_ngcontent-%COMP%]{flex:1 1 auto}"]}),VideoPlayerComponent}(),shared_module=__webpack_require__(55505),routes=[{path:"",component:VideoPlayerComponent}],PlayerModule=function(){var PlayerModule=(0,createClass.Z)(function PlayerModule(){(0,classCallCheck.Z)(this,PlayerModule)});return PlayerModule.\u0275fac=function(t){return new(t||PlayerModule)},PlayerModule.\u0275mod=core.oAB({type:PlayerModule}),PlayerModule.\u0275inj=core.cJS({imports:[[common.ez,router.Bz.forChild(routes),shared_module.m]]}),PlayerModule}()},48582:module=>{module.exports=function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self},module.exports.default=module.exports,module.exports.__esModule=!0},27422:(module,__unused_webpack_exports,__webpack_require__)=>{var setPrototypeOf=__webpack_require__(61753),isNativeReflectConstruct=__webpack_require__(22468);function _construct(Parent,args,Class){return isNativeReflectConstruct()?(module.exports=_construct=Reflect.construct,module.exports.default=module.exports,module.exports.__esModule=!0):(module.exports=_construct=function(Parent,args,Class){var a=[null];a.push.apply(a,args);var instance=new(Function.bind.apply(Parent,a));return Class&&setPrototypeOf(instance,Class.prototype),instance},module.exports.default=module.exports,module.exports.__esModule=!0),_construct.apply(null,arguments)}module.exports=_construct,module.exports.default=module.exports,module.exports.__esModule=!0},47934:(module,__unused_webpack_exports,__webpack_require__)=>{var getPrototypeOf=__webpack_require__(29860),isNativeReflectConstruct=__webpack_require__(22468),possibleConstructorReturn=__webpack_require__(25693);module.exports=function(Derived){var hasNativeReflectConstruct=isNativeReflectConstruct();return function(){var result,Super=getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn(this,result)}},module.exports.default=module.exports,module.exports.__esModule=!0},36549:module=>{function _extends(){return module.exports=_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},module.exports.default=module.exports,module.exports.__esModule=!0,_extends.apply(this,arguments)}module.exports=_extends,module.exports.default=module.exports,module.exports.__esModule=!0},29860:module=>{function _getPrototypeOf(o){return module.exports=_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)},module.exports.default=module.exports,module.exports.__esModule=!0,_getPrototypeOf(o)}module.exports=_getPrototypeOf,module.exports.default=module.exports,module.exports.__esModule=!0},71556:(module,__unused_webpack_exports,__webpack_require__)=>{var setPrototypeOf=__webpack_require__(61753);module.exports=function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&setPrototypeOf(subClass,superClass)},module.exports.default=module.exports,module.exports.__esModule=!0},22814:(module,__unused_webpack_exports,__webpack_require__)=>{var setPrototypeOf=__webpack_require__(61753);module.exports=function(subClass,superClass){subClass.prototype=Object.create(superClass.prototype),subClass.prototype.constructor=subClass,setPrototypeOf(subClass,superClass)},module.exports.default=module.exports,module.exports.__esModule=!0},22468:module=>{module.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}},module.exports.default=module.exports,module.exports.__esModule=!0},25693:(module,__unused_webpack_exports,__webpack_require__)=>{var _typeof=__webpack_require__(34321).default,assertThisInitialized=__webpack_require__(48582);module.exports=function(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return assertThisInitialized(self)},module.exports.default=module.exports,module.exports.__esModule=!0},61753:module=>{function _setPrototypeOf(o,p){return module.exports=_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o},module.exports.default=module.exports,module.exports.__esModule=!0,_setPrototypeOf(o,p)}module.exports=_setPrototypeOf,module.exports.default=module.exports,module.exports.__esModule=!0},25893:()=>{}}]);